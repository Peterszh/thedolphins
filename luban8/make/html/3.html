!
function(e, t) {
    "use strict";
    e.rails !== t && e.error("jquery-ujs has already been loaded!");
    var i, n = e(document);
    e.rails = i = {
        linkClickSelector: "a[data-confirm], a[data-method], a[data-remote]:not([disabled]), a[data-disable-with], a[data-disable]",
        buttonClickSelector: "button[data-remote]:not([form]):not(form button), button[data-confirm]:not([form]):not(form button)",
        inputChangeSelector: "select[data-remote], input[data-remote], textarea[data-remote]",
        formSubmitSelector: "form",
        formInputClickSelector: "form input[type=submit], form input[type=image], form button[type=submit], form button:not([type]), input[type=submit][form], input[type=image][form], button[type=submit][form], button[form]:not([type])",
        disableSelector: "input[data-disable-with]:enabled, button[data-disable-with]:enabled, textarea[data-disable-with]:enabled, input[data-disable]:enabled, button[data-disable]:enabled, textarea[data-disable]:enabled",
        enableSelector: "input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled, input[data-disable]:disabled, button[data-disable]:disabled, textarea[data-disable]:disabled",
        requiredInputSelector: "input[name][required]:not([disabled]), textarea[name][required]:not([disabled])",
        fileInputSelector: "input[type=file]:not([disabled])",
        linkDisableSelector: "a[data-disable-with], a[data-disable]",
        buttonDisableSelector: "button[data-remote][data-disable-with], button[data-remote][data-disable]",
        csrfToken: function() {
            return e("meta[name=csrf-token]").attr("content")
        },
        csrfParam: function() {
            return e("meta[name=csrf-param]").attr("content")
        },
        CSRFProtection: function(e) {
            var t = i.csrfToken();
            t && e.setRequestHeader("X-CSRF-Token", t)
        },
        refreshCSRFTokens: function() {
            e('form input[name="' + i.csrfParam() + '"]').val(i.csrfToken())
        },
        fire: function(t, i, n) {
            var r = e.Event(i);
            return t.trigger(r, n),
            r.result !== !1
        },
        confirm: function(e) {
            return confirm(e)
        },
        ajax: function(t) {
            return e.ajax(t)
        },
        href: function(e) {
            return e[0].href
        },
        isRemote: function(e) {
            return e.data("remote") !== t && e.data("remote") !== !1
        },
        handleRemote: function(n) {
            var r, s, o, a, l, c;
            if (i.fire(n, "ajax:before")) {
                if (a = n.data("with-credentials") || null, l = n.data("type") || e.ajaxSettings && e.ajaxSettings.dataType, n.is("form")) {
                    r = n.data("ujs:submit-button-formmethod") || n.attr("method"),
                    s = n.data("ujs:submit-button-formaction") || n.attr("action"),
                    o = e(n[0]).serializeArray();
                    var d = n.data("ujs:submit-button");
                    d && (o.push(d), n.data("ujs:submit-button", null)),
                    n.data("ujs:submit-button-formmethod", null),
                    n.data("ujs:submit-button-formaction", null)
                } else n.is(i.inputChangeSelector) ? (r = n.data("method"), s = n.data("url"), o = n.serialize(), n.data("params") && (o = o + "&" + n.data("params"))) : n.is(i.buttonClickSelector) ? (r = n.data("method") || "get", s = n.data("url"), o = n.serialize(), n.data("params") && (o = o + "&" + n.data("params"))) : (r = n.data("method"), s = i.href(n), o = n.data("params") || null);
                return c = {
                    type: r || "GET",
                    data: o,
                    dataType: l,
                    beforeSend: function(e, r) {
                        return r.dataType === t && e.setRequestHeader("accept", "*/*;q=0.5, " + r.accepts.script),
                        !!i.fire(n, "ajax:beforeSend", [e, r]) && void n.trigger("ajax:send", e)
                    },
                    success: function(e, t, i) {
                        n.trigger("ajax:success", [e, t, i])
                    },
                    complete: function(e, t) {
                        n.trigger("ajax:complete", [e, t])
                    },
                    error: function(e, t, i) {
                        n.trigger("ajax:error", [e, t, i])
                    },
                    crossDomain: i.isCrossDomain(s)
                },
                a && (c.xhrFields = {
                    withCredentials: a
                }),
                s && (c.url = s),
                i.ajax(c)
            }
            return ! 1
        },
        isCrossDomain: function(e) {
            var t = document.createElement("a");
            t.href = location.href;
            var i = document.createElement("a");
            try {
                return i.href = e,
                i.href = i.href,
                !((!i.protocol || ":" === i.protocol) && !i.host || t.protocol + "//" + t.host == i.protocol + "//" + i.host)
            } catch(e) {
                return ! 0
            }
        },
        handleMethod: function(n) {
            var r = i.href(n),
            s = n.data("method"),
            o = n.attr("target"),
            a = i.csrfToken(),
            l = i.csrfParam(),
            c = e('<form method="post" action="' + r + '"></form>'),
            d = '<input name="_method" value="' + s + '" type="hidden" />';
            l === t || a === t || i.isCrossDomain(r) || (d += '<input name="' + l + '" value="' + a + '" type="hidden" />'),
            o && c.attr("target", o),
            c.hide().append(d).appendTo("body"),
            c.submit()
        },
        formElements: function(t, i) {
            return t.is("form") ? e(t[0].elements).filter(i) : t.find(i)
        },
        disableFormElements: function(t) {
            i.formElements(t, i.disableSelector).each(function() {
                i.disableFormElement(e(this))
            })
        },
        disableFormElement: function(e) {
            var i, n;
            i = e.is("button") ? "html": "val",
            n = e.data("disable-with"),
            n !== t && (e.data("ujs:enable-with", e[i]()), e[i](n)),
            e.prop("disabled", !0),
            e.data("ujs:disabled", !0)
        },
        enableFormElements: function(t) {
            i.formElements(t, i.enableSelector).each(function() {
                i.enableFormElement(e(this))
            })
        },
        enableFormElement: function(e) {
            var i = e.is("button") ? "html": "val";
            e.data("ujs:enable-with") !== t && (e[i](e.data("ujs:enable-with")), e.removeData("ujs:enable-with")),
            e.prop("disabled", !1),
            e.removeData("ujs:disabled")
        },
        allowAction: function(e) {
            var t, n = e.data("confirm"),
            r = !1;
            if (!n) return ! 0;
            if (i.fire(e, "confirm")) {
                try {
                    r = i.confirm(n)
                } catch(e) { (console.error || console.log).call(console, e.stack || e)
                }
                t = i.fire(e, "confirm:complete", [r])
            }
            return r && t
        },
        blankInputs: function(t, i, n) {
            var r, s, o, a, l = e(),
            c = i || "input,textarea",
            d = t.find(c),
            u = {};
            return d.each(function() {
                r = e(this),
                r.is("input[type=radio]") ? (a = r.attr("name"), u[a] || (0 === t.find('input[type=radio]:checked[name="' + a + '"]').length && (o = t.find('input[type=radio][name="' + a + '"]'), l = l.add(o)), u[a] = a)) : (s = r.is("input[type=checkbox],input[type=radio]") ? r.is(":checked") : !!r.val(), s === n && (l = l.add(r)))
            }),
            !!l.length && l
        },
        nonBlankInputs: function(e, t) {
            return i.blankInputs(e, t, !0)
        },
        stopEverything: function(t) {
            return e(t.target).trigger("ujs:everythingStopped"),
            t.stopImmediatePropagation(),
            !1
        },
        disableElement: function(e) {
            var n = e.data("disable-with");
            n !== t && (e.data("ujs:enable-with", e.html()), e.html(n)),
            e.bind("click.railsDisable",
            function(e) {
                return i.stopEverything(e)
            }),
            e.data("ujs:disabled", !0)
        },
        enableElement: function(e) {
            e.data("ujs:enable-with") !== t && (e.html(e.data("ujs:enable-with")), e.removeData("ujs:enable-with")),
            e.unbind("click.railsDisable"),
            e.removeData("ujs:disabled")
        }
    },
    i.fire(n, "rails:attachBindings") && (e.ajaxPrefilter(function(e, t, n) {
        e.crossDomain || i.CSRFProtection(n)
    }), e(window).on("pageshow.rails",
    function() {
        e(e.rails.enableSelector).each(function() {
            var t = e(this);
            t.data("ujs:disabled") && e.rails.enableFormElement(t)
        }),
        e(e.rails.linkDisableSelector).each(function() {
            var t = e(this);
            t.data("ujs:disabled") && e.rails.enableElement(t)
        })
    }), n.delegate(i.linkDisableSelector, "ajax:complete",
    function() {
        i.enableElement(e(this))
    }), n.delegate(i.buttonDisableSelector, "ajax:complete",
    function() {
        i.enableFormElement(e(this))
    }), n.delegate(i.linkClickSelector, "click.rails",
    function(t) {
        var n = e(this),
        r = n.data("method"),
        s = n.data("params"),
        o = t.metaKey || t.ctrlKey;
        if (!i.allowAction(n)) return i.stopEverything(t);
        if (!o && n.is(i.linkDisableSelector) && i.disableElement(n), i.isRemote(n)) {
            if (o && (!r || "GET" === r) && !s) return ! 0;
            var a = i.handleRemote(n);
            return a === !1 ? i.enableElement(n) : a.fail(function() {
                i.enableElement(n)
            }),
            !1
        }
        return r ? (i.handleMethod(n), !1) : void 0
    }), n.delegate(i.buttonClickSelector, "click.rails",
    function(t) {
        var n = e(this);
        if (!i.allowAction(n) || !i.isRemote(n)) return i.stopEverything(t);
        n.is(i.buttonDisableSelector) && i.disableFormElement(n);
        var r = i.handleRemote(n);
        return r === !1 ? i.enableFormElement(n) : r.fail(function() {
            i.enableFormElement(n)
        }),
        !1
    }), n.delegate(i.inputChangeSelector, "change.rails",
    function(t) {
        var n = e(this);
        return i.allowAction(n) && i.isRemote(n) ? (i.handleRemote(n), !1) : i.stopEverything(t)
    }), n.delegate(i.formSubmitSelector, "submit.rails",
    function(n) {
        var r, s, o = e(this),
        a = i.isRemote(o);
        if (!i.allowAction(o)) return i.stopEverything(n);
        if (o.attr("novalidate") === t) if (o.data("ujs:formnovalidate-button") === t) {
            if (r = i.blankInputs(o, i.requiredInputSelector, !1), r && i.fire(o, "ajax:aborted:required", [r])) return i.stopEverything(n)
        } else o.data("ujs:formnovalidate-button", t);
        if (a) {
            if (s = i.nonBlankInputs(o, i.fileInputSelector)) {
                setTimeout(function() {
                    i.disableFormElements(o)
                },
                13);
                var l = i.fire(o, "ajax:aborted:file", [s]);
                return l || setTimeout(function() {
                    i.enableFormElements(o)
                },
                13),
                l
            }
            return i.handleRemote(o),
            !1
        }
        setTimeout(function() {
            i.disableFormElements(o)
        },
        13)
    }), n.delegate(i.formInputClickSelector, "click.rails",
    function(t) {
        var n = e(this);
        if (!i.allowAction(n)) return i.stopEverything(t);
        var r = n.attr("name"),
        s = r ? {
            name: r,
            value: n.val()
        }: null,
        o = n.closest("form");
        0 === o.length && (o = e("#" + n.attr("form"))),
        o.data("ujs:submit-button", s),
        o.data("ujs:formnovalidate-button", n.attr("formnovalidate")),
        o.data("ujs:submit-button-formaction", n.attr("formaction")),
        o.data("ujs:submit-button-formmethod", n.attr("formmethod"))
    }), n.delegate(i.formSubmitSelector, "ajax:send.rails",
    function(t) {
        this === t.target && i.disableFormElements(e(this))
    }), n.delegate(i.formSubmitSelector, "ajax:complete.rails",
    function(t) {
        this === t.target && i.enableFormElements(e(this))
    }), e(function() {
        i.refreshCSRFTokens()
    }))
} (jQuery),
function(e) {
    "function" == typeof define && define.amd ? define(["jquery"], e) : e(jQuery)
} (function(e) {
    function t(t, n) {
        var r, s, o, a = t.nodeName.toLowerCase();
        return "area" === a ? (r = t.parentNode, s = r.name, !(!t.href || !s || "map" !== r.nodeName.toLowerCase()) && (o = e("img[usemap='#" + s + "']")[0], !!o && i(o))) : (/^(input|select|textarea|button|object)$/.test(a) ? !t.disabled: "a" === a ? t.href || n: n) && i(t)
    }
    function i(t) {
        return e.expr.filters.visible(t) && !e(t).parents().addBack().filter(function() {
            return "hidden" === e.css(this, "visibility")
        }).length
    }
    e.ui = e.ui || {},
    e.extend(e.ui, {
        version: "1.11.4",
        keyCode: {
            BACKSPACE: 8,
            COMMA: 188,
            DELETE: 46,
            DOWN: 40,
            END: 35,
            ENTER: 13,
            ESCAPE: 27,
            HOME: 36,
            LEFT: 37,
            PAGE_DOWN: 34,
            PAGE_UP: 33,
            PERIOD: 190,
            RIGHT: 39,
            SPACE: 32,
            TAB: 9,
            UP: 38
        }
    }),
    e.fn.extend({
        scrollParent: function(t) {
            var i = this.css("position"),
            n = "absolute" === i,
            r = t ? /(auto|scroll|hidden)/: /(auto|scroll)/,
            s = this.parents().filter(function() {
                var t = e(this);
                return (!n || "static" !== t.css("position")) && r.test(t.css("overflow") + t.css("overflow-y") + t.css("overflow-x"))
            }).eq(0);
            return "fixed" !== i && s.length ? s: e(this[0].ownerDocument || document)
        },
        uniqueId: function() {
            var e = 0;
            return function() {
                return this.each(function() {
                    this.id || (this.id = "ui-id-" + ++e)
                })
            }
        } (),
        removeUniqueId: function() {
            return this.each(function() { / ^ui - id - \d + $ / .test(this.id) && e(this).removeAttr("id")
            })
        }
    }),
    e.extend(e.expr[":"], {
        data: e.expr.createPseudo ? e.expr.createPseudo(function(t) {
            return function(i) {
                return !! e.data(i, t)
            }
        }) : function(t, i, n) {
            return !! e.data(t, n[3])
        },
        focusable: function(i) {
            return t(i, !isNaN(e.attr(i, "tabindex")))
        },
        tabbable: function(i) {
            var n = e.attr(i, "tabindex"),
            r = isNaN(n);
            return (r || n >= 0) && t(i, !r)
        }
    }),
    e("<a>").outerWidth(1).jquery || e.each(["Width", "Height"],
    function(t, i) {
        function n(t, i, n, s) {
            return e.each(r,
            function() {
                i -= parseFloat(e.css(t, "padding" + this)) || 0,
                n && (i -= parseFloat(e.css(t, "border" + this + "Width")) || 0),
                s && (i -= parseFloat(e.css(t, "margin" + this)) || 0)
            }),
            i
        }
        var r = "Width" === i ? ["Left", "Right"] : ["Top", "Bottom"],
        s = i.toLowerCase(),
        o = {
            innerWidth: e.fn.innerWidth,
            innerHeight: e.fn.innerHeight,
            outerWidth: e.fn.outerWidth,
            outerHeight: e.fn.outerHeight
        };
        e.fn["inner" + i] = function(t) {
            return void 0 === t ? o["inner" + i].call(this) : this.each(function() {
                e(this).css(s, n(this, t) + "px")
            })
        },
        e.fn["outer" + i] = function(t, r) {
            return "number" != typeof t ? o["outer" + i].call(this, t) : this.each(function() {
                e(this).css(s, n(this, t, !0, r) + "px")
            })
        }
    }),
    e.fn.addBack || (e.fn.addBack = function(e) {
        return this.add(null == e ? this.prevObject: this.prevObject.filter(e))
    }),
    e("<a>").data("a-b", "a").removeData("a-b").data("a-b") && (e.fn.removeData = function(t) {
        return function(i) {
            return arguments.length ? t.call(this, e.camelCase(i)) : t.call(this)
        }
    } (e.fn.removeData)),
    e.ui.ie = !!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),
    e.fn.extend({
        focus: function(t) {
            return function(i, n) {
                return "number" == typeof i ? this.each(function() {
                    var t = this;
                    setTimeout(function() {
                        e(t).focus(),
                        n && n.call(t)
                    },
                    i)
                }) : t.apply(this, arguments)
            }
        } (e.fn.focus),
        disableSelection: function() {
            var e = "onselectstart" in document.createElement("div") ? "selectstart": "mousedown";
            return function() {
                return this.bind(e + ".ui-disableSelection",
                function(e) {
                    e.preventDefault()
                })
            }
        } (),
        enableSelection: function() {
            return this.unbind(".ui-disableSelection")
        },
        zIndex: function(t) {
            if (void 0 !== t) return this.css("zIndex", t);
            if (this.length) for (var i, n, r = e(this[0]); r.length && r[0] !== document;) {
                if (i = r.css("position"), ("absolute" === i || "relative" === i || "fixed" === i) && (n = parseInt(r.css("zIndex"), 10), !isNaN(n) && 0 !== n)) return n;
                r = r.parent()
            }
            return 0
        }
    }),
    e.ui.plugin = {
        add: function(t, i, n) {
            var r, s = e.ui[t].prototype;
            for (r in n) s.plugins[r] = s.plugins[r] || [],
            s.plugins[r].push([i, n[r]])
        },
        call: function(e, t, i, n) {
            var r, s = e.plugins[t];
            if (s && (n || e.element[0].parentNode && 11 !== e.element[0].parentNode.nodeType)) for (r = 0; r < s.length; r++) e.options[s[r][0]] && s[r][1].apply(e.element, i)
        }
    }
}),
function(e) {
    "function" == typeof define && define.amd ? define(["jquery"], e) : e(jQuery)
} (function(e) {
    var t = 0,
    i = Array.prototype.slice;
    return e.cleanData = function(t) {
        return function(i) {
            var n, r, s;
            for (s = 0; null != (r = i[s]); s++) try {
                n = e._data(r, "events"),
                n && n.remove && e(r).triggerHandler("remove")
            } catch(e) {}
            t(i)
        }
    } (e.cleanData),
    e.widget = function(t, i, n) {
        var r, s, o, a, l = {},
        c = t.split(".")[0];
        return t = t.split(".")[1],
        r = c + "-" + t,
        n || (n = i, i = e.Widget),
        e.expr[":"][r.toLowerCase()] = function(t) {
            return !! e.data(t, r)
        },
        e[c] = e[c] || {},
        s = e[c][t],
        o = e[c][t] = function(e, t) {
            return this._createWidget ? void(arguments.length && this._createWidget(e, t)) : new o(e, t)
        },
        e.extend(o, s, {
            version: n.version,
            _proto: e.extend({},
            n),
            _childConstructors: []
        }),
        a = new i,
        a.options = e.widget.extend({},
        a.options),
        e.each(n,
        function(t, n) {
            return e.isFunction(n) ? void(l[t] = function() {
                var e = function() {
                    return i.prototype[t].apply(this, arguments)
                },
                r = function(e) {
                    return i.prototype[t].apply(this, e)
                };
                return function() {
                    var t, i = this._super,
                    s = this._superApply;
                    return this._super = e,
                    this._superApply = r,
                    t = n.apply(this, arguments),
                    this._super = i,
                    this._superApply = s,
                    t
                }
            } ()) : void(l[t] = n)
        }),
        o.prototype = e.widget.extend(a, {
            widgetEventPrefix: s ? a.widgetEventPrefix || t: t
        },
        l, {
            constructor: o,
            namespace: c,
            widgetName: t,
            widgetFullName: r
        }),
        s ? (e.each(s._childConstructors,
        function(t, i) {
            var n = i.prototype;
            e.widget(n.namespace + "." + n.widgetName, o, i._proto)
        }), delete s._childConstructors) : i._childConstructors.push(o),
        e.widget.bridge(t, o),
        o
    },
    e.widget.extend = function(t) {
        for (var n, r, s = i.call(arguments, 1), o = 0, a = s.length; o < a; o++) for (n in s[o]) r = s[o][n],
        s[o].hasOwnProperty(n) && void 0 !== r && (e.isPlainObject(r) ? t[n] = e.isPlainObject(t[n]) ? e.widget.extend({},
        t[n], r) : e.widget.extend({},
        r) : t[n] = r);
        return t
    },
    e.widget.bridge = function(t, n) {
        var r = n.prototype.widgetFullName || t;
        e.fn[t] = function(s) {
            var o = "string" == typeof s,
            a = i.call(arguments, 1),
            l = this;
            return o ? this.each(function() {
                var i, n = e.data(this, r);
                return "instance" === s ? (l = n, !1) : n ? e.isFunction(n[s]) && "_" !== s.charAt(0) ? (i = n[s].apply(n, a), i !== n && void 0 !== i ? (l = i && i.jquery ? l.pushStack(i.get()) : i, !1) : void 0) : e.error("no such method '" + s + "' for " + t + " widget instance") : e.error("cannot call methods on " + t + " prior to initialization; attempted to call method '" + s + "'")
            }) : (a.length && (s = e.widget.extend.apply(null, [s].concat(a))), this.each(function() {
                var t = e.data(this, r);
                t ? (t.option(s || {}), t._init && t._init()) : e.data(this, r, new n(s, this))
            })),
            l
        }
    },
    e.Widget = function() {},
    e.Widget._childConstructors = [],
    e.Widget.prototype = {
        widgetName: "widget",
        widgetEventPrefix: "",
        defaultElement: "<div>",
        options: {
            disabled: !1,
            create: null
        },
        _createWidget: function(i, n) {
            n = e(n || this.defaultElement || this)[0],
            this.element = e(n),
            this.uuid = t++,
            this.eventNamespace = "." + this.widgetName + this.uuid,
            this.bindings = e(),
            this.hoverable = e(),
            this.focusable = e(),
            n !== this && (e.data(n, this.widgetFullName, this), this._on(!0, this.element, {
                remove: function(e) {
                    e.target === n && this.destroy()
                }
            }), this.document = e(n.style ? n.ownerDocument: n.document || n), this.window = e(this.document[0].defaultView || this.document[0].parentWindow)),
            this.options = e.widget.extend({},
            this.options, this._getCreateOptions(), i),
            this._create(),
            this._trigger("create", null, this._getCreateEventData()),
            this._init()
        },
        _getCreateOptions: e.noop,
        _getCreateEventData: e.noop,
        _create: e.noop,
        _init: e.noop,
        destroy: function() {
            this._destroy(),
            this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),
            this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled ui-state-disabled"),
            this.bindings.unbind(this.eventNamespace),
            this.hoverable.removeClass("ui-state-hover"),
            this.focusable.removeClass("ui-state-focus")
        },
        _destroy: e.noop,
        widget: function() {
            return this.element
        },
        option: function(t, i) {
            var n, r, s, o = t;
            if (0 === arguments.length) return e.widget.extend({},
            this.options);
            if ("string" == typeof t) if (o = {},
            n = t.split("."), t = n.shift(), n.length) {
                for (r = o[t] = e.widget.extend({},
                this.options[t]), s = 0; s < n.length - 1; s++) r[n[s]] = r[n[s]] || {},
                r = r[n[s]];
                if (t = n.pop(), 1 === arguments.length) return void 0 === r[t] ? null: r[t];
                r[t] = i
            } else {
                if (1 === arguments.length) return void 0 === this.options[t] ? null: this.options[t];
                o[t] = i
            }
            return this._setOptions(o),
            this
        },
        _setOptions: function(e) {
            var t;
            for (t in e) this._setOption(t, e[t]);
            return this
        },
        _setOption: function(e, t) {
            return this.options[e] = t,
            "disabled" === e && (this.widget().toggleClass(this.widgetFullName + "-disabled", !!t), t && (this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus"))),
            this
        },
        enable: function() {
            return this._setOptions({
                disabled: !1
            })
        },
        disable: function() {
            return this._setOptions({
                disabled: !0
            })
        },
        _on: function(t, i, n) {
            var r, s = this;
            "boolean" != typeof t && (n = i, i = t, t = !1),
            n ? (i = r = e(i), this.bindings = this.bindings.add(i)) : (n = i, i = this.element, r = this.widget()),
            e.each(n,
            function(n, o) {
                function a() {
                    if (t || s.options.disabled !== !0 && !e(this).hasClass("ui-state-disabled")) return ("string" == typeof o ? s[o] : o).apply(s, arguments)
                }
                "string" != typeof o && (a.guid = o.guid = o.guid || a.guid || e.guid++);
                var l = n.match(/^([\w:-]*)\s*(.*)$/),
                c = l[1] + s.eventNamespace,
                d = l[2];
                d ? r.delegate(d, c, a) : i.bind(c, a)
            })
        },
        _off: function(t, i) {
            i = (i || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace,
            t.unbind(i).undelegate(i),
            this.bindings = e(this.bindings.not(t).get()),
            this.focusable = e(this.focusable.not(t).get()),
            this.hoverable = e(this.hoverable.not(t).get())
        },
        _delay: function(e, t) {
            function i() {
                return ("string" == typeof e ? n[e] : e).apply(n, arguments)
            }
            var n = this;
            return setTimeout(i, t || 0)
        },
        _hoverable: function(t) {
            this.hoverable = this.hoverable.add(t),
            this._on(t, {
                mouseenter: function(t) {
                    e(t.currentTarget).addClass("ui-state-hover")
                },
                mouseleave: function(t) {
                    e(t.currentTarget).removeClass("ui-state-hover")
                }
            })
        },
        _focusable: function(t) {
            this.focusable = this.focusable.add(t),
            this._on(t, {
                focusin: function(t) {
                    e(t.currentTarget).addClass("ui-state-focus")
                },
                focusout: function(t) {
                    e(t.currentTarget).removeClass("ui-state-focus")
                }
            })
        },
        _trigger: function(t, i, n) {
            var r, s, o = this.options[t];
            if (n = n || {},
            i = e.Event(i), i.type = (t === this.widgetEventPrefix ? t: this.widgetEventPrefix + t).toLowerCase(), i.target = this.element[0], s = i.originalEvent) for (r in s) r in i || (i[r] = s[r]);
            return this.element.trigger(i, n),
            !(e.isFunction(o) && o.apply(this.element[0], [i].concat(n)) === !1 || i.isDefaultPrevented())
        }
    },
    e.each({
        show: "fadeIn",
        hide: "fadeOut"
    },
    function(t, i) {
        e.Widget.prototype["_" + t] = function(n, r, s) {
            "string" == typeof r && (r = {
                effect: r
            });
            var o, a = r ? r === !0 || "number" == typeof r ? i: r.effect || i: t;
            r = r || {},
            "number" == typeof r && (r = {
                duration: r
            }),
            o = !e.isEmptyObject(r),
            r.complete = s,
            r.delay && n.delay(r.delay),
            o && e.effects && e.effects.effect[a] ? n[t](r) : a !== t && n[a] ? n[a](r.duration, r.easing, s) : n.queue(function(i) {
                e(this)[t](),
                s && s.call(n[0]),
                i()
            })
        }
    }),
    e.widget
}),
function(e) {
    "function" == typeof define && define.amd ? define(["jquery", "./widget"], e) : e(jQuery)
} (function(e) {
    var t = !1;
    return e(document).mouseup(function() {
        t = !1
    }),
    e.widget("ui.mouse", {
        version: "1.11.4",
        options: {
            cancel: "input,textarea,button,select,option",
            distance: 1,
            delay: 0
        },
        _mouseInit: function() {
            var t = this;
            this.element.bind("mousedown." + this.widgetName,
            function(e) {
                return t._mouseDown(e)
            }).bind("click." + this.widgetName,
            function(i) {
                if (!0 === e.data(i.target, t.widgetName + ".preventClickEvent")) return e.removeData(i.target, t.widgetName + ".preventClickEvent"),
                i.stopImmediatePropagation(),
                !1
            }),
            this.started = !1
        },
        _mouseDestroy: function() {
            this.element.unbind("." + this.widgetName),
            this._mouseMoveDelegate && this.document.unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate)
        },
        _mouseDown: function(i) {
            if (!t) {
                this._mouseMoved = !1,
                this._mouseStarted && this._mouseUp(i),
                this._mouseDownEvent = i;
                var n = this,
                r = 1 === i.which,
                s = !("string" != typeof this.options.cancel || !i.target.nodeName) && e(i.target).closest(this.options.cancel).length;
                return ! (r && !s && this._mouseCapture(i)) || (this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function() {
                    n.mouseDelayMet = !0
                },
                this.options.delay)), this._mouseDistanceMet(i) && this._mouseDelayMet(i) && (this._mouseStarted = this._mouseStart(i) !== !1, !this._mouseStarted) ? (i.preventDefault(), !0) : (!0 === e.data(i.target, this.widgetName + ".preventClickEvent") && e.removeData(i.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function(e) {
                    return n._mouseMove(e)
                },
                this._mouseUpDelegate = function(e) {
                    return n._mouseUp(e)
                },
                this.document.bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), i.preventDefault(), t = !0, !0))
            }
        },
        _mouseMove: function(t) {
            if (this._mouseMoved) {
                if (e.ui.ie && (!document.documentMode || document.documentMode < 9) && !t.button) return this._mouseUp(t);
                if (!t.which) return this._mouseUp(t)
            }
            return (t.which || t.button) && (this._mouseMoved = !0),
            this._mouseStarted ? (this._mouseDrag(t), t.preventDefault()) : (this._mouseDistanceMet(t) && this._mouseDelayMet(t) && (this._mouseStarted = this._mouseStart(this._mouseDownEvent, t) !== !1, this._mouseStarted ? this._mouseDrag(t) : this._mouseUp(t)), !this._mouseStarted)
        },
        _mouseUp: function(i) {
            return this.document.unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate),
            this._mouseStarted && (this._mouseStarted = !1, i.target === this._mouseDownEvent.target && e.data(i.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(i)),
            t = !1,
            !1
        },
        _mouseDistanceMet: function(e) {
            return Math.max(Math.abs(this._mouseDownEvent.pageX - e.pageX), Math.abs(this._mouseDownEvent.pageY - e.pageY)) >= this.options.distance
        },
        _mouseDelayMet: function() {
            return this.mouseDelayMet
        },
        _mouseStart: function() {},
        _mouseDrag: function() {},
        _mouseStop: function() {},
        _mouseCapture: function() {
            return ! 0
        }
    })
}),
function(e) {
    "function" == typeof define && define.amd ? define(["jquery", "./core", "./mouse", "./widget"], e) : e(jQuery)
} (function(e) {
    return e.widget("ui.resizable", e.ui.mouse, {
        version: "1.11.4",
        widgetEventPrefix: "resize",
        options: {
            alsoResize: !1,
            animate: !1,
            animateDuration: "slow",
            animateEasing: "swing",
            aspectRatio: !1,
            autoHide: !1,
            containment: !1,
            ghost: !1,
            grid: !1,
            handles: "e,s,se",
            helper: !1,
            maxHeight: null,
            maxWidth: null,
            minHeight: 10,
            minWidth: 10,
            zIndex: 90,
            resize: null,
            start: null,
            stop: null
        },
        _num: function(e) {
            return parseInt(e, 10) || 0
        },
        _isNumber: function(e) {
            return ! isNaN(parseInt(e, 10))
        },
        _hasScroll: function(t, i) {
            if ("hidden" === e(t).css("overflow")) return ! 1;
            var n = i && "left" === i ? "scrollLeft": "scrollTop",
            r = !1;
            return t[n] > 0 || (t[n] = 1, r = t[n] > 0, t[n] = 0, r)
        },
        _create: function() {
            var t, i, n, r, s, o = this,
            a = this.options;
            if (this.element.addClass("ui-resizable"), e.extend(this, {
                _aspectRatio: !!a.aspectRatio,
                aspectRatio: a.aspectRatio,
                originalElement: this.element,
                _proportionallyResizeElements: [],
                _helper: a.helper || a.ghost || a.animate ? a.helper || "ui-resizable-helper": null
            }), this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i) && (this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({
                position: this.element.css("position"),
                width: this.element.outerWidth(),
                height: this.element.outerHeight(),
                top: this.element.css("top"),
                left: this.element.css("left")
            })), this.element = this.element.parent().data("ui-resizable", this.element.resizable("instance")), this.elementIsWrapper = !0, this.element.css({
                marginLeft: this.originalElement.css("marginLeft"),
                marginTop: this.originalElement.css("marginTop"),
                marginRight: this.originalElement.css("marginRight"),
                marginBottom: this.originalElement.css("marginBottom")
            }), this.originalElement.css({
                marginLeft: 0,
                marginTop: 0,
                marginRight: 0,
                marginBottom: 0
            }), this.originalResizeStyle = this.originalElement.css("resize"), this.originalElement.css("resize", "none"), this._proportionallyResizeElements.push(this.originalElement.css({
                position: "static",
                zoom: 1,
                display: "block"
            })), this.originalElement.css({
                margin: this.originalElement.css("margin")
            }), this._proportionallyResize()), this.handles = a.handles || (e(".ui-resizable-handle", this.element).length ? {
                n: ".ui-resizable-n",
                e: ".ui-resizable-e",
                s: ".ui-resizable-s",
                w: ".ui-resizable-w",
                se: ".ui-resizable-se",
                sw: ".ui-resizable-sw",
                ne: ".ui-resizable-ne",
                nw: ".ui-resizable-nw"
            }: "e,s,se"), this._handles = e(), this.handles.constructor === String) for ("all" === this.handles && (this.handles = "n,e,s,w,se,sw,ne,nw"), t = this.handles.split(","), this.handles = {},
            i = 0; i < t.length; i++) n = e.trim(t[i]),
            s = "ui-resizable-" + n,
            r = e("<div class='ui-resizable-handle " + s + "'></div>"),
            r.css({
                zIndex: a.zIndex
            }),
            "se" === n && r.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),
            this.handles[n] = ".ui-resizable-" + n,
            this.element.append(r);
            this._renderAxis = function(t) {
                var i, n, r, s;
                t = t || this.element;
                for (i in this.handles) this.handles[i].constructor === String ? this.handles[i] = this.element.children(this.handles[i]).first().show() : (this.handles[i].jquery || this.handles[i].nodeType) && (this.handles[i] = e(this.handles[i]), this._on(this.handles[i], {
                    mousedown: o._mouseDown
                })),
                this.elementIsWrapper && this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i) && (n = e(this.handles[i], this.element), s = /sw|ne|nw|se|n|s/.test(i) ? n.outerHeight() : n.outerWidth(), r = ["padding", /ne|nw|n/.test(i) ? "Top": /se|sw|s/.test(i) ? "Bottom": /^e$/.test(i) ? "Right": "Left"].join(""), t.css(r, s), this._proportionallyResize()),
                this._handles = this._handles.add(this.handles[i])
            },
            this._renderAxis(this.element),
            this._handles = this._handles.add(this.element.find(".ui-resizable-handle")),
            this._handles.disableSelection(),
            this._handles.mouseover(function() {
                o.resizing || (this.className && (r = this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)), o.axis = r && r[1] ? r[1] : "se")
            }),
            a.autoHide && (this._handles.hide(), e(this.element).addClass("ui-resizable-autohide").mouseenter(function() {
                a.disabled || (e(this).removeClass("ui-resizable-autohide"), o._handles.show())
            }).mouseleave(function() {
                a.disabled || o.resizing || (e(this).addClass("ui-resizable-autohide"), o._handles.hide())
            })),
            this._mouseInit()
        },
        _destroy: function() {
            this._mouseDestroy();
            var t, i = function(t) {
                e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()
            };
            return this.elementIsWrapper && (i(this.element), t = this.element, this.originalElement.css({
                position: t.css("position"),
                width: t.outerWidth(),
                height: t.outerHeight(),
                top: t.css("top"),
                left: t.css("left")
            }).insertAfter(t), t.remove()),
            this.originalElement.css("resize", this.originalResizeStyle),
            i(this.originalElement),
            this
        },
        _mouseCapture: function(t) {
            var i, n, r = !1;
            for (i in this.handles) n = e(this.handles[i])[0],
            (n === t.target || e.contains(n, t.target)) && (r = !0);
            return ! this.options.disabled && r
        },
        _mouseStart: function(t) {
            var i, n, r, s = this.options,
            o = this.element;
            return this.resizing = !0,
            this._renderProxy(),
            i = this._num(this.helper.css("left")),
            n = this._num(this.helper.css("top")),
            s.containment && (i += e(s.containment).scrollLeft() || 0, n += e(s.containment).scrollTop() || 0),
            this.offset = this.helper.offset(),
            this.position = {
                left: i,
                top: n
            },
            this.size = this._helper ? {
                width: this.helper.width(),
                height: this.helper.height()
            }: {
                width: o.width(),
                height: o.height()
            },
            this.originalSize = this._helper ? {
                width: o.outerWidth(),
                height: o.outerHeight()
            }: {
                width: o.width(),
                height: o.height()
            },
            this.sizeDiff = {
                width: o.outerWidth() - o.width(),
                height: o.outerHeight() - o.height()
            },
            this.originalPosition = {
                left: i,
                top: n
            },
            this.originalMousePosition = {
                left: t.pageX,
                top: t.pageY
            },
            this.aspectRatio = "number" == typeof s.aspectRatio ? s.aspectRatio: this.originalSize.width / this.originalSize.height || 1,
            r = e(".ui-resizable-" + this.axis).css("cursor"),
            e("body").css("cursor", "auto" === r ? this.axis + "-resize": r),
            o.addClass("ui-resizable-resizing"),
            this._propagate("start", t),
            !0
        },
        _mouseDrag: function(t) {
            var i, n, r = this.originalMousePosition,
            s = this.axis,
            o = t.pageX - r.left || 0,
            a = t.pageY - r.top || 0,
            l = this._change[s];
            return this._updatePrevProperties(),
            !!l && (i = l.apply(this, [t, o, a]), this._updateVirtualBoundaries(t.shiftKey), (this._aspectRatio || t.shiftKey) && (i = this._updateRatio(i, t)), i = this._respectSize(i, t), this._updateCache(i), this._propagate("resize", t), n = this._applyChanges(), !this._helper && this._proportionallyResizeElements.length && this._proportionallyResize(), e.isEmptyObject(n) || (this._updatePrevProperties(), this._trigger("resize", t, this.ui()), this._applyChanges()), !1)
        },
        _mouseStop: function(t) {
            this.resizing = !1;
            var i, n, r, s, o, a, l, c = this.options,
            d = this;
            return this._helper && (i = this._proportionallyResizeElements, n = i.length && /textarea/i.test(i[0].nodeName), r = n && this._hasScroll(i[0], "left") ? 0 : d.sizeDiff.height, s = n ? 0 : d.sizeDiff.width, o = {
                width: d.helper.width() - s,
                height: d.helper.height() - r
            },
            a = parseInt(d.element.css("left"), 10) + (d.position.left - d.originalPosition.left) || null, l = parseInt(d.element.css("top"), 10) + (d.position.top - d.originalPosition.top) || null, c.animate || this.element.css(e.extend(o, {
                top: l,
                left: a
            })), d.helper.height(d.size.height), d.helper.width(d.size.width), this._helper && !c.animate && this._proportionallyResize()),
            e("body").css("cursor", "auto"),
            this.element.removeClass("ui-resizable-resizing"),
            this._propagate("stop", t),
            this._helper && this.helper.remove(),
            !1
        },
        _updatePrevProperties: function() {
            this.prevPosition = {
                top: this.position.top,
                left: this.position.left
            },
            this.prevSize = {
                width: this.size.width,
                height: this.size.height
            }
        },
        _applyChanges: function() {
            var e = {};
            return this.position.top !== this.prevPosition.top && (e.top = this.position.top + "px"),
            this.position.left !== this.prevPosition.left && (e.left = this.position.left + "px"),
            this.size.width !== this.prevSize.width && (e.width = this.size.width + "px"),
            this.size.height !== this.prevSize.height && (e.height = this.size.height + "px"),
            this.helper.css(e),
            e
        },
        _updateVirtualBoundaries: function(e) {
            var t, i, n, r, s, o = this.options;
            s = {
                minWidth: this._isNumber(o.minWidth) ? o.minWidth: 0,
                maxWidth: this._isNumber(o.maxWidth) ? o.maxWidth: 1 / 0,
                minHeight: this._isNumber(o.minHeight) ? o.minHeight: 0,
                maxHeight: this._isNumber(o.maxHeight) ? o.maxHeight: 1 / 0
            },
            (this._aspectRatio || e) && (t = s.minHeight * this.aspectRatio, n = s.minWidth / this.aspectRatio, i = s.maxHeight * this.aspectRatio, r = s.maxWidth / this.aspectRatio, t > s.minWidth && (s.minWidth = t), n > s.minHeight && (s.minHeight = n), i < s.maxWidth && (s.maxWidth = i), r < s.maxHeight && (s.maxHeight = r)),
            this._vBoundaries = s
        },
        _updateCache: function(e) {
            this.offset = this.helper.offset(),
            this._isNumber(e.left) && (this.position.left = e.left),
            this._isNumber(e.top) && (this.position.top = e.top),
            this._isNumber(e.height) && (this.size.height = e.height),
            this._isNumber(e.width) && (this.size.width = e.width)
        },
        _updateRatio: function(e) {
            var t = this.position,
            i = this.size,
            n = this.axis;
            return this._isNumber(e.height) ? e.width = e.height * this.aspectRatio: this._isNumber(e.width) && (e.height = e.width / this.aspectRatio),
            "sw" === n && (e.left = t.left + (i.width - e.width), e.top = null),
            "nw" === n && (e.top = t.top + (i.height - e.height), e.left = t.left + (i.width - e.width)),
            e
        },
        _respectSize: function(e) {
            var t = this._vBoundaries,
            i = this.axis,
            n = this._isNumber(e.width) && t.maxWidth && t.maxWidth < e.width,
            r = this._isNumber(e.height) && t.maxHeight && t.maxHeight < e.height,
            s = this._isNumber(e.width) && t.minWidth && t.minWidth > e.width,
            o = this._isNumber(e.height) && t.minHeight && t.minHeight > e.height,
            a = this.originalPosition.left + this.originalSize.width,
            l = this.position.top + this.size.height,
            c = /sw|nw|w/.test(i),
            d = /nw|ne|n/.test(i);
            return s && (e.width = t.minWidth),
            o && (e.height = t.minHeight),
            n && (e.width = t.maxWidth),
            r && (e.height = t.maxHeight),
            s && c && (e.left = a - t.minWidth),
            n && c && (e.left = a - t.maxWidth),
            o && d && (e.top = l - t.minHeight),
            r && d && (e.top = l - t.maxHeight),
            e.width || e.height || e.left || !e.top ? e.width || e.height || e.top || !e.left || (e.left = null) : e.top = null,
            e
        },
        _getPaddingPlusBorderDimensions: function(e) {
            for (var t = 0,
            i = [], n = [e.css("borderTopWidth"), e.css("borderRightWidth"), e.css("borderBottomWidth"), e.css("borderLeftWidth")], r = [e.css("paddingTop"), e.css("paddingRight"), e.css("paddingBottom"), e.css("paddingLeft")]; t < 4; t++) i[t] = parseInt(n[t], 10) || 0,
            i[t] += parseInt(r[t], 10) || 0;
            return {
                height: i[0] + i[2],
                width: i[1] + i[3]
            }
        },
        _proportionallyResize: function() {
            if (this._proportionallyResizeElements.length) for (var e, t = 0,
            i = this.helper || this.element; t < this._proportionallyResizeElements.length; t++) e = this._proportionallyResizeElements[t],
            this.outerDimensions || (this.outerDimensions = this._getPaddingPlusBorderDimensions(e)),
            e.css({
                height: i.height() - this.outerDimensions.height || 0,
                width: i.width() - this.outerDimensions.width || 0
            })
        },
        _renderProxy: function() {
            var t = this.element,
            i = this.options;
            this.elementOffset = t.offset(),
            this._helper ? (this.helper = this.helper || e("<div style='overflow:hidden;'></div>"), this.helper.addClass(this._helper).css({
                width: this.element.outerWidth() - 1,
                height: this.element.outerHeight() - 1,
                position: "absolute",
                left: this.elementOffset.left + "px",
                top: this.elementOffset.top + "px",
                zIndex: ++i.zIndex
            }), this.helper.appendTo("body").disableSelection()) : this.helper = this.element
        },
        _change: {
            e: function(e, t) {
                return {
                    width: this.originalSize.width + t
                }
            },
            w: function(e, t) {
                var i = this.originalSize,
                n = this.originalPosition;
                return {
                    left: n.left + t,
                    width: i.width - t
                }
            },
            n: function(e, t, i) {
                var n = this.originalSize,
                r = this.originalPosition;
                return {
                    top: r.top + i,
                    height: n.height - i
                }
            },
            s: function(e, t, i) {
                return {
                    height: this.originalSize.height + i
                }
            },
            se: function(t, i, n) {
                return e.extend(this._change.s.apply(this, arguments), this._change.e.apply(this, [t, i, n]))
            },
            sw: function(t, i, n) {
                return e.extend(this._change.s.apply(this, arguments), this._change.w.apply(this, [t, i, n]))
            },
            ne: function(t, i, n) {
                return e.extend(this._change.n.apply(this, arguments), this._change.e.apply(this, [t, i, n]))
            },
            nw: function(t, i, n) {
                return e.extend(this._change.n.apply(this, arguments), this._change.w.apply(this, [t, i, n]))
            }
        },
        _propagate: function(t, i) {
            e.ui.plugin.call(this, t, [i, this.ui()]),
            "resize" !== t && this._trigger(t, i, this.ui())
        },
        plugins: {},
        ui: function() {
            return {
                originalElement: this.originalElement,
                element: this.element,
                helper: this.helper,
                position: this.position,
                size: this.size,
                originalSize: this.originalSize,
                originalPosition: this.originalPosition
            }
        }
    }),
    e.ui.plugin.add("resizable", "animate", {
        stop: function(t) {
            var i = e(this).resizable("instance"),
            n = i.options,
            r = i._proportionallyResizeElements,
            s = r.length && /textarea/i.test(r[0].nodeName),
            o = s && i._hasScroll(r[0], "left") ? 0 : i.sizeDiff.height,
            a = s ? 0 : i.sizeDiff.width,
            l = {
                width: i.size.width - a,
                height: i.size.height - o
            },
            c = parseInt(i.element.css("left"), 10) + (i.position.left - i.originalPosition.left) || null,
            d = parseInt(i.element.css("top"), 10) + (i.position.top - i.originalPosition.top) || null;
            i.element.animate(e.extend(l, d && c ? {
                top: d,
                left: c
            }: {}), {
                duration: n.animateDuration,
                easing: n.animateEasing,
                step: function() {
                    var n = {
                        width: parseInt(i.element.css("width"), 10),
                        height: parseInt(i.element.css("height"), 10),
                        top: parseInt(i.element.css("top"), 10),
                        left: parseInt(i.element.css("left"), 10)
                    };
                    r && r.length && e(r[0]).css({
                        width: n.width,
                        height: n.height
                    }),
                    i._updateCache(n),
                    i._propagate("resize", t)
                }
            })
        }
    }),
    e.ui.plugin.add("resizable", "containment", {
        start: function() {
            var t, i, n, r, s, o, a, l = e(this).resizable("instance"),
            c = l.options,
            d = l.element,
            u = c.containment,
            h = u instanceof e ? u.get(0) : /parent/.test(u) ? d.parent().get(0) : u;
            h && (l.containerElement = e(h), /document/.test(u) || u === document ? (l.containerOffset = {
                left: 0,
                top: 0
            },
            l.containerPosition = {
                left: 0,
                top: 0
            },
            l.parentData = {
                element: e(document),
                left: 0,
                top: 0,
                width: e(document).width(),
                height: e(document).height() || document.body.parentNode.scrollHeight
            }) : (t = e(h), i = [], e(["Top", "Right", "Left", "Bottom"]).each(function(e, n) {
                i[e] = l._num(t.css("padding" + n))
            }), l.containerOffset = t.offset(), l.containerPosition = t.position(), l.containerSize = {
                height: t.innerHeight() - i[3],
                width: t.innerWidth() - i[1]
            },
            n = l.containerOffset, r = l.containerSize.height, s = l.containerSize.width, o = l._hasScroll(h, "left") ? h.scrollWidth: s, a = l._hasScroll(h) ? h.scrollHeight: r, l.parentData = {
                element: h,
                left: n.left,
                top: n.top,
                width: o,
                height: a
            }))
        },
        resize: function(t) {
            var i, n, r, s, o = e(this).resizable("instance"),
            a = o.options,
            l = o.containerOffset,
            c = o.position,
            d = o._aspectRatio || t.shiftKey,
            u = {
                top: 0,
                left: 0
            },
            h = o.containerElement,
            p = !0;
            h[0] !== document && /static/.test(h.css("position")) && (u = l),
            c.left < (o._helper ? l.left: 0) && (o.size.width = o.size.width + (o._helper ? o.position.left - l.left: o.position.left - u.left), d && (o.size.height = o.size.width / o.aspectRatio, p = !1), o.position.left = a.helper ? l.left: 0),
            c.top < (o._helper ? l.top: 0) && (o.size.height = o.size.height + (o._helper ? o.position.top - l.top: o.position.top), d && (o.size.width = o.size.height * o.aspectRatio, p = !1), o.position.top = o._helper ? l.top: 0),
            r = o.containerElement.get(0) === o.element.parent().get(0),
            s = /relative|absolute/.test(o.containerElement.css("position")),
            r && s ? (o.offset.left = o.parentData.left + o.position.left, o.offset.top = o.parentData.top + o.position.top) : (o.offset.left = o.element.offset().left, o.offset.top = o.element.offset().top),
            i = Math.abs(o.sizeDiff.width + (o._helper ? o.offset.left - u.left: o.offset.left - l.left)),
            n = Math.abs(o.sizeDiff.height + (o._helper ? o.offset.top - u.top: o.offset.top - l.top)),
            i + o.size.width >= o.parentData.width && (o.size.width = o.parentData.width - i, d && (o.size.height = o.size.width / o.aspectRatio, p = !1)),
            n + o.size.height >= o.parentData.height && (o.size.height = o.parentData.height - n, d && (o.size.width = o.size.height * o.aspectRatio, p = !1)),
            p || (o.position.left = o.prevPosition.left, o.position.top = o.prevPosition.top, o.size.width = o.prevSize.width, o.size.height = o.prevSize.height)
        },
        stop: function() {
            var t = e(this).resizable("instance"),
            i = t.options,
            n = t.containerOffset,
            r = t.containerPosition,
            s = t.containerElement,
            o = e(t.helper),
            a = o.offset(),
            l = o.outerWidth() - t.sizeDiff.width,
            c = o.outerHeight() - t.sizeDiff.height;
            t._helper && !i.animate && /relative/.test(s.css("position")) && e(this).css({
                left: a.left - r.left - n.left,
                width: l,
                height: c
            }),
            t._helper && !i.animate && /static/.test(s.css("position")) && e(this).css({
                left: a.left - r.left - n.left,
                width: l,
                height: c
            })
        }
    }),
    e.ui.plugin.add("resizable", "alsoResize", {
        start: function() {
            var t = e(this).resizable("instance"),
            i = t.options;
            e(i.alsoResize).each(function() {
                var t = e(this);
                t.data("ui-resizable-alsoresize", {
                    width: parseInt(t.width(), 10),
                    height: parseInt(t.height(), 10),
                    left: parseInt(t.css("left"), 10),
                    top: parseInt(t.css("top"), 10)
                })
            })
        },
        resize: function(t, i) {
            var n = e(this).resizable("instance"),
            r = n.options,
            s = n.originalSize,
            o = n.originalPosition,
            a = {
                height: n.size.height - s.height || 0,
                width: n.size.width - s.width || 0,
                top: n.position.top - o.top || 0,
                left: n.position.left - o.left || 0
            };
            e(r.alsoResize).each(function() {
                var t = e(this),
                n = e(this).data("ui-resizable-alsoresize"),
                r = {},
                s = t.parents(i.originalElement[0]).length ? ["width", "height"] : ["width", "height", "top", "left"];
                e.each(s,
                function(e, t) {
                    var i = (n[t] || 0) + (a[t] || 0);
                    i && i >= 0 && (r[t] = i || null)
                }),
                t.css(r)
            })
        },
        stop: function() {
            e(this).removeData("resizable-alsoresize")
        }
    }),
    e.ui.plugin.add("resizable", "ghost", {
        start: function() {
            var t = e(this).resizable("instance"),
            i = t.options,
            n = t.size;
            t.ghost = t.originalElement.clone(),
            t.ghost.css({
                opacity: .25,
                display: "block",
                position: "relative",
                height: n.height,
                width: n.width,
                margin: 0,
                left: 0,
                top: 0
            }).addClass("ui-resizable-ghost").addClass("string" == typeof i.ghost ? i.ghost: ""),
            t.ghost.appendTo(t.helper)
        },
        resize: function() {
            var t = e(this).resizable("instance");
            t.ghost && t.ghost.css({
                position: "relative",
                height: t.size.height,
                width: t.size.width
            })
        },
        stop: function() {
            var t = e(this).resizable("instance");
            t.ghost && t.helper && t.helper.get(0).removeChild(t.ghost.get(0))
        }
    }),
    e.ui.plugin.add("resizable", "grid", {
        resize: function() {
            var t, i = e(this).resizable("instance"),
            n = i.options,
            r = i.size,
            s = i.originalSize,
            o = i.originalPosition,
            a = i.axis,
            l = "number" == typeof n.grid ? [n.grid, n.grid] : n.grid,
            c = l[0] || 1,
            d = l[1] || 1,
            u = Math.round((r.width - s.width) / c) * c,
            h = Math.round((r.height - s.height) / d) * d,
            p = s.width + u,
            f = s.height + h,
            g = n.maxWidth && n.maxWidth < p,
            m = n.maxHeight && n.maxHeight < f,
            v = n.minWidth && n.minWidth > p,
            b = n.minHeight && n.minHeight > f;
            n.grid = l,
            v && (p += c),
            b && (f += d),
            g && (p -= c),
            m && (f -= d),
            /^(se|s|e)$/.test(a) ? (i.size.width = p, i.size.height = f) : /^(ne)$/.test(a) ? (i.size.width = p, i.size.height = f, i.position.top = o.top - h) : /^(sw)$/.test(a) ? (i.size.width = p, i.size.height = f, i.position.left = o.left - u) : ((f - d <= 0 || p - c <= 0) && (t = i._getPaddingPlusBorderDimensions(this)), f - d > 0 ? (i.size.height = f, i.position.top = o.top - h) : (f = d - t.height, i.size.height = f, i.position.top = o.top + s.height - f), p - c > 0 ? (i.size.width = p, i.position.left = o.left - u) : (p = c - t.width, i.size.width = p, i.position.left = o.left + s.width - p))
        }
    }),
    e.ui.resizable
}),
+
function(e) {
    "use strict";
    var t = function(t, i) {
        this.options = i,
        this.$element = e(t),
        this.$backdrop = this.isShown = null,
        this.options.remote && this.$element.find(".modal-content").load(this.options.remote, e.proxy(function() {
            this.$element.trigger("loaded.bs.modal")
        },
        this))
    };
    t.DEFAULTS = {
        backdrop: !0,
        keyboard: !0,
        show: !0
    },
    t.prototype.toggle = function(e) {
        return this[this.isShown ? "hide": "show"](e)
    },
    t.prototype.show = function(t) {
        var i = this,
        n = e.Event("show.bs.modal", {
            relatedTarget: t
        });
        this.$element.trigger(n),
        this.isShown || n.isDefaultPrevented() || (this.isShown = !0, this.escape(), this.$element.on("click.dismiss.bs.modal", '[data-dismiss="modal"]', e.proxy(this.hide, this)), this.backdrop(function() {
            var n = e.support.transition && i.$element.hasClass("fade");
            i.$element.parent().length || i.$element.appendTo(document.body),
            i.$element.show().scrollTop(0),
            n && i.$element[0].offsetWidth,
            i.$element.addClass("in").attr("aria-hidden", !1),
            i.enforceFocus();
            var r = e.Event("shown.bs.modal", {
                relatedTarget: t
            });
            n ? i.$element.find(".modal-dialog").one(e.support.transition.end,
            function() {
                i.$element.focus().trigger(r)
            }).emulateTransitionEnd(300) : i.$element.focus().trigger(r)
        }))
    },
    t.prototype.hide = function(t) {
        t && t.preventDefault(),
        t = e.Event("hide.bs.modal"),
        this.$element.trigger(t),
        this.isShown && !t.isDefaultPrevented() && (this.isShown = !1, this.escape(), e(document).off("focusin.bs.modal"), this.$element.removeClass("in").attr("aria-hidden", !0).off("click.dismiss.bs.modal"), e.support.transition && this.$element.hasClass("fade") ? this.$element.one(e.support.transition.end, e.proxy(this.hideModal, this)).emulateTransitionEnd(300) : this.hideModal())
    },
    t.prototype.enforceFocus = function() {
        e(document).off("focusin.bs.modal").on("focusin.bs.modal", e.proxy(function(e) {
            this.$element[0] === e.target || this.$element.has(e.target).length || this.$element.focus()
        },
        this))
    },
    t.prototype.escape = function() {
        this.isShown && this.options.keyboard ? this.$element.on("keyup.dismiss.bs.modal", e.proxy(function(e) {
            27 == e.which && this.hide()
        },
        this)) : this.isShown || this.$element.off("keyup.dismiss.bs.modal")
    },
    t.prototype.hideModal = function() {
        var e = this;
        this.$element.hide(),
        this.backdrop(function() {
            e.removeBackdrop(),
            e.$element.trigger("hidden.bs.modal")
        })
    },
    t.prototype.removeBackdrop = function() {
        this.$backdrop && this.$backdrop.remove(),
        this.$backdrop = null
    },
    t.prototype.backdrop = function(t) {
        var i = this.$element.hasClass("fade") ? "fade": "";
        if (this.isShown && this.options.backdrop) {
            var n = e.support.transition && i;
            if (this.$backdrop = e('<div class="modal-backdrop ' + i + '" />').appendTo(document.body), this.$element.on("click.dismiss.bs.modal", e.proxy(function(e) {
                e.target === e.currentTarget && ("static" == this.options.backdrop ? this.$element[0].focus.call(this.$element[0]) : this.hide.call(this))
            },
            this)), n && this.$backdrop[0].offsetWidth, this.$backdrop.addClass("in"), !t) return;
            n ? this.$backdrop.one(e.support.transition.end, t).emulateTransitionEnd(150) : t()
        } else ! this.isShown && this.$backdrop ? (this.$backdrop.removeClass("in"), e.support.transition && this.$element.hasClass("fade") ? this.$backdrop.one(e.support.transition.end, t).emulateTransitionEnd(150) : t()) : t && t()
    };
    var i = e.fn.modal;
    e.fn.modal = function(i, n) {
        return this.each(function() {
            var r = e(this),
            s = r.data("bs.modal"),
            o = e.extend({},
            t.DEFAULTS, r.data(), "object" == typeof i && i);
            s || r.data("bs.modal", s = new t(this, o)),
            "string" == typeof i ? s[i](n) : o.show && s.show(n)
        })
    },
    e.fn.modal.Constructor = t,
    e.fn.modal.noConflict = function() {
        return e.fn.modal = i,
        this
    },
    e(document).on("click.bs.modal.data-api", '[data-toggle="modal"]',
    function(t) {
        var i = e(this),
        n = i.attr("href"),
        r = e(i.attr("data-target") || n && n.replace(/.*(?=#[^\s]+$)/, "")),
        s = r.data("bs.modal") ? "toggle": e.extend({
            remote: !/#/.test(n) && n
        },
        r.data(), i.data());
        i.is("a") && t.preventDefault(),
        r.modal(s, this).one("hide",
        function() {
            i.is(":visible") && i.focus()
        })
    }),
    e(document).on("show.bs.modal", ".modal",
    function() {
        e(document.body).addClass("modal-open")
    }).on("hidden.bs.modal", ".modal",
    function() {
        e(document.body).removeClass("modal-open")
    })
} (jQuery),
+
function(e) {
    "use strict";
    var t = function(e, t) {
        this.type = this.options = this.enabled = this.timeout = this.hoverState = this.$element = null,
        this.init("tooltip", e, t)
    };
    t.DEFAULTS = {
        animation: !0,
        placement: "top",
        selector: !1,
        template: '<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',
        trigger: "hover focus",
        title: "",
        delay: 0,
        html: !1,
        container: !1
    },
    t.prototype.init = function(t, i, n) {
        this.enabled = !0,
        this.type = t,
        this.$element = e(i),
        this.options = this.getOptions(n);
        for (var r = this.options.trigger.split(" "), s = r.length; s--;) {
            var o = r[s];
            if ("click" == o) this.$element.on("click." + this.type, this.options.selector, e.proxy(this.toggle, this));
            else if ("manual" != o) {
                var a = "hover" == o ? "mouseenter": "focusin",
                l = "hover" == o ? "mouseleave": "focusout";
                this.$element.on(a + "." + this.type, this.options.selector, e.proxy(this.enter, this)),
                this.$element.on(l + "." + this.type, this.options.selector, e.proxy(this.leave, this))
            }
        }
        this.options.selector ? this._options = e.extend({},
        this.options, {
            trigger: "manual",
            selector: ""
        }) : this.fixTitle()
    },
    t.prototype.getDefaults = function() {
        return t.DEFAULTS
    },
    t.prototype.getOptions = function(t) {
        return t = e.extend({},
        this.getDefaults(), this.$element.data(), t),
        t.delay && "number" == typeof t.delay && (t.delay = {
            show: t.delay,
            hide: t.delay
        }),
        t
    },
    t.prototype.getDelegateOptions = function() {
        var t = {},
        i = this.getDefaults();
        return this._options && e.each(this._options,
        function(e, n) {
            i[e] != n && (t[e] = n)
        }),
        t
    },
    t.prototype.enter = function(t) {
        var i = t instanceof this.constructor ? t: e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs." + this.type);
        return clearTimeout(i.timeout),
        i.hoverState = "in",
        i.options.delay && i.options.delay.show ? void(i.timeout = setTimeout(function() {
            "in" == i.hoverState && i.show()
        },
        i.options.delay.show)) : i.show()
    },
    t.prototype.leave = function(t) {
        var i = t instanceof this.constructor ? t: e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs." + this.type);
        return clearTimeout(i.timeout),
        i.hoverState = "out",
        i.options.delay && i.options.delay.hide ? void(i.timeout = setTimeout(function() {
            "out" == i.hoverState && i.hide()
        },
        i.options.delay.hide)) : i.hide()
    },
    t.prototype.show = function() {
        var t = e.Event("show.bs." + this.type);
        if (this.hasContent() && this.enabled) {
            if (this.$element.trigger(t), t.isDefaultPrevented()) return;
            var i = this,
            n = this.tip();
            this.setContent(),
            this.options.animation && n.addClass("fade");
            var r = "function" == typeof this.options.placement ? this.options.placement.call(this, n[0], this.$element[0]) : this.options.placement,
            s = /\s?auto?\s?/i,
            o = s.test(r);
            o && (r = r.replace(s, "") || "top"),
            n.detach().css({
                top: 0,
                left: 0,
                display: "block"
            }).addClass(r),
            this.options.container ? n.appendTo(this.options.container) : n.insertAfter(this.$element);
            var a = this.getPosition(),
            l = n[0].offsetWidth,
            c = n[0].offsetHeight;
            if (o) {
                var d = this.$element.parent(),
                u = r,
                h = document.documentElement.scrollTop || document.body.scrollTop,
                p = "body" == this.options.container ? window.innerWidth: d.outerWidth(),
                f = "body" == this.options.container ? window.innerHeight: d.outerHeight(),
                g = "body" == this.options.container ? 0 : d.offset().left;
                r = "bottom" == r && a.top + a.height + c - h > f ? "top": "top" == r && a.top - h - c < 0 ? "bottom": "right" == r && a.right + l > p ? "left": "left" == r && a.left - l < g ? "right": r,
                n.removeClass(u).addClass(r)
            }
            var m = this.getCalculatedOffset(r, a, l, c);
            this.applyPlacement(m, r),
            this.hoverState = null;
            var v = function() {
                i.$element.trigger("shown.bs." + i.type)
            };
            e.support.transition && this.$tip.hasClass("fade") ? n.one(e.support.transition.end, v).emulateTransitionEnd(150) : v()
        }
    },
    t.prototype.applyPlacement = function(t, i) {
        var n, r = this.tip(),
        s = r[0].offsetWidth,
        o = r[0].offsetHeight,
        a = parseInt(r.css("margin-top"), 10),
        l = parseInt(r.css("margin-left"), 10);
        isNaN(a) && (a = 0),
        isNaN(l) && (l = 0),
        t.top = t.top + a,
        t.left = t.left + l,
        e.offset.setOffset(r[0], e.extend({
            using: function(e) {
                r.css({
                    top: Math.round(e.top),
                    left: Math.round(e.left)
                })
            }
        },
        t), 0),
        r.addClass("in");
        var c = r[0].offsetWidth,
        d = r[0].offsetHeight;
        if ("top" == i && d != o && (n = !0, t.top = t.top + o - d), /bottom|top/.test(i)) {
            var u = 0;
            t.left < 0 && (u = t.left * -2, t.left = 0, r.offset(t), c = r[0].offsetWidth, d = r[0].offsetHeight),
            this.replaceArrow(u - s + c, c, "left")
        } else this.replaceArrow(d - o, d, "top");
        n && r.offset(t)
    },
    t.prototype.replaceArrow = function(e, t, i) {
        this.arrow().css(i, e ? 50 * (1 - e / t) + "%": "")
    },
    t.prototype.setContent = function() {
        var e = this.tip(),
        t = this.getTitle();
        e.find(".tooltip-inner")[this.options.html ? "html": "text"](t),
        e.removeClass("fade in top bottom left right")
    },
    t.prototype.hide = function() {
        function t() {
            "in" != i.hoverState && n.detach(),
            i.$element.trigger("hidden.bs." + i.type)
        }
        var i = this,
        n = this.tip(),
        r = e.Event("hide.bs." + this.type);
        if (this.$element.trigger(r), !r.isDefaultPrevented()) return n.removeClass("in"),
        e.support.transition && this.$tip.hasClass("fade") ? n.one(e.support.transition.end, t).emulateTransitionEnd(150) : t(),
        this.hoverState = null,
        this
    },
    t.prototype.fixTitle = function() {
        var e = this.$element; (e.attr("title") || "string" != typeof e.attr("data-original-title")) && e.attr("data-original-title", e.attr("title") || "").attr("title", "")
    },
    t.prototype.hasContent = function() {
        return this.getTitle()
    },
    t.prototype.getPosition = function() {
        var t = this.$element[0];
        return e.extend({},
        "function" == typeof t.getBoundingClientRect ? t.getBoundingClientRect() : {
            width: t.offsetWidth,
            height: t.offsetHeight
        },
        this.$element.offset())
    },
    t.prototype.getCalculatedOffset = function(e, t, i, n) {
        return "bottom" == e ? {
            top: t.top + t.height,
            left: t.left + t.width / 2 - i / 2
        }: "top" == e ? {
            top: t.top - n,
            left: t.left + t.width / 2 - i / 2
        }: "left" == e ? {
            top: t.top + t.height / 2 - n / 2,
            left: t.left - i
        }: {
            top: t.top + t.height / 2 - n / 2,
            left: t.left + t.width
        }
    },
    t.prototype.getTitle = function() {
        var e, t = this.$element,
        i = this.options;
        return e = t.attr("data-original-title") || ("function" == typeof i.title ? i.title.call(t[0]) : i.title)
    },
    t.prototype.tip = function() {
        return this.$tip = this.$tip || e(this.options.template)
    },
    t.prototype.arrow = function() {
        return this.$arrow = this.$arrow || this.tip().find(".tooltip-arrow")
    },
    t.prototype.validate = function() {
        this.$element[0].parentNode || (this.hide(), this.$element = null, this.options = null)
    },
    t.prototype.enable = function() {
        this.enabled = !0
    },
    t.prototype.disable = function() {
        this.enabled = !1
    },
    t.prototype.toggleEnabled = function() {
        this.enabled = !this.enabled
    },
    t.prototype.toggle = function(t) {
        var i = t ? e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs." + this.type) : this;
        i.tip().hasClass("in") ? i.leave(i) : i.enter(i)
    },
    t.prototype.destroy = function() {
        clearTimeout(this.timeout),
        this.hide().$element.off("." + this.type).removeData("bs." + this.type)
    };
    var i = e.fn.tooltip;
    e.fn.tooltip = function(i) {
        return this.each(function() {
            var n = e(this),
            r = n.data("bs.tooltip"),
            s = "object" == typeof i && i; (r || "destroy" != i) && (r || n.data("bs.tooltip", r = new t(this, s)), "string" == typeof i && r[i]())
        })
    },
    e.fn.tooltip.Constructor = t,
    e.fn.tooltip.noConflict = function() {
        return e.fn.tooltip = i,
        this
    }
} (jQuery),
+
function(e) {
    "use strict";
    var t = function(t, i) {
        this.$element = e(t),
        this.$indicators = this.$element.find(".carousel-indicators"),
        this.options = i,
        this.paused = this.sliding = this.interval = this.$active = this.$items = null,
        "hover" == this.options.pause && this.$element.on("mouseenter", e.proxy(this.pause, this)).on("mouseleave", e.proxy(this.cycle, this))
    };
    t.DEFAULTS = {
        interval: 5e3,
        pause: "hover",
        wrap: !0
    },
    t.prototype.cycle = function(t) {
        return t || (this.paused = !1),
        this.interval && clearInterval(this.interval),
        this.options.interval && !this.paused && (this.interval = setInterval(e.proxy(this.next, this), this.options.interval)),
        this
    },
    t.prototype.getActiveIndex = function() {
        return this.$active = this.$element.find(".item.active"),
        this.$items = this.$active.parent().children(),
        this.$items.index(this.$active)
    },
    t.prototype.to = function(t) {
        var i = this,
        n = this.getActiveIndex();
        if (! (t > this.$items.length - 1 || t < 0)) return this.sliding ? this.$element.one("slid.bs.carousel",
        function() {
            i.to(t)
        }) : n == t ? this.pause().cycle() : this.slide(t > n ? "next": "prev", e(this.$items[t]))
    },
    t.prototype.pause = function(t) {
        return t || (this.paused = !0),
        this.$element.find(".next, .prev").length && e.support.transition && (this.$element.trigger(e.support.transition.end), this.cycle(!0)),
        this.interval = clearInterval(this.interval),
        this
    },
    t.prototype.next = function() {
        if (!this.sliding) return this.slide("next")
    },
    t.prototype.prev = function() {
        if (!this.sliding) return this.slide("prev")
    },
    t.prototype.slide = function(t, i) {
        var n = this.$element.find(".item.active"),
        r = i || n[t](),
        s = this.interval,
        o = "next" == t ? "left": "right",
        a = "next" == t ? "first": "last",
        l = this;
        if (!r.length) {
            if (!this.options.wrap) return;
            r = this.$element.find(".item")[a]()
        }
        if (r.hasClass("active")) return this.sliding = !1;
        var c = e.Event("slide.bs.carousel", {
            relatedTarget: r[0],
            direction: o
        });
        return this.$element.trigger(c),
        c.isDefaultPrevented() ? void 0 : (this.sliding = !0, s && this.pause(), this.$indicators.length && (this.$indicators.find(".active").removeClass("active"), this.$element.one("slid.bs.carousel",
        function() {
            var t = e(l.$indicators.children()[l.getActiveIndex()]);
            t && t.addClass("active")
        })), e.support.transition && this.$element.hasClass("slide") ? (r.addClass(t), r[0].offsetWidth, n.addClass(o), r.addClass(o), n.one(e.support.transition.end,
        function() {
            r.removeClass([t, o].join(" ")).addClass("active"),
            n.removeClass(["active", o].join(" ")),
            l.sliding = !1,
            setTimeout(function() {
                l.$element.trigger("slid.bs.carousel")
            },
            0)
        }).emulateTransitionEnd(1e3 * n.css("transition-duration").slice(0, -1))) : (n.removeClass("active"), r.addClass("active"), this.sliding = !1, this.$element.trigger("slid.bs.carousel")), s && this.cycle(), this)
    };
    var i = e.fn.carousel;
    e.fn.carousel = function(i) {
        return this.each(function() {
            var n = e(this),
            r = n.data("bs.carousel"),
            s = e.extend({},
            t.DEFAULTS, n.data(), "object" == typeof i && i),
            o = "string" == typeof i ? i: s.slide;
            r || n.data("bs.carousel", r = new t(this, s)),
            "number" == typeof i ? r.to(i) : o ? r[o]() : s.interval && r.pause().cycle()
        })
    },
    e.fn.carousel.Constructor = t,
    e.fn.carousel.noConflict = function() {
        return e.fn.carousel = i,
        this
    },
    e(document).on("click.bs.carousel.data-api", "[data-slide], [data-slide-to]",
    function(t) {
        var i, n = e(this),
        r = e(n.attr("data-target") || (i = n.attr("href")) && i.replace(/.*(?=#[^\s]+$)/, "")),
        s = e.extend({},
        r.data(), n.data()),
        o = n.attr("data-slide-to");
        o && (s.interval = !1),
        r.carousel(s),
        (o = n.attr("data-slide-to")) && r.data("bs.carousel").to(o),
        t.preventDefault()
    }),
    e(window).on("load",
    function() {
        e('[data-ride="carousel"]').each(function() {
            var t = e(this);
            t.carousel(t.data())
        })
    })
} (jQuery),
+
function(e) {
    "use strict";
    function t() {
        var e = document.createElement("bootstrap"),
        t = {
            WebkitTransition: "webkitTransitionEnd",
            MozTransition: "transitionend",
            OTransition: "oTransitionEnd otransitionend",
            transition: "transitionend"
        };
        for (var i in t) if (void 0 !== e.style[i]) return {
            end: t[i]
        };
        return ! 1
    }
    e.fn.emulateTransitionEnd = function(t) {
        var i = !1,
        n = this;
        e(this).one(e.support.transition.end,
        function() {
            i = !0
        });
        var r = function() {
            i || e(n).trigger(e.support.transition.end)
        };
        return setTimeout(r, t),
        this
    },
    e(function() {
        e.support.transition = t()
    })
} (jQuery),
+
function(e) {
    "use strict";
    function t(t) {
        e(n).remove(),
        e(r).each(function() {
            var n = i(e(this)),
            r = {
                relatedTarget: this
            };
            n.hasClass("open") && (n.trigger(t = e.Event("hide.bs.dropdown", r)), t.isDefaultPrevented() || n.removeClass("open").trigger("hidden.bs.dropdown", r))
        })
    }
    function i(t) {
        var i = t.attr("data-target");
        i || (i = t.attr("href"), i = i && /#[A-Za-z]/.test(i) && i.replace(/.*(?=#[^\s]*$)/, ""));
        var n = i && e(i);
        return n && n.length ? n: t.parent()
    }
    var n = ".dropdown-backdrop",
    r = "[data-toggle=dropdown]",
    s = function(t) {
        e(t).on("click.bs.dropdown", this.toggle)
    };
    s.prototype.toggle = function(n) {
        var r = e(this);
        if (!r.is(".disabled, :disabled")) {
            var s = i(r),
            o = s.hasClass("open");
            if (t(), !o) {
                "ontouchstart" in document.documentElement && !s.closest(".navbar-nav").length && e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click", t);
                var a = {
                    relatedTarget: this
                };
                if (s.trigger(n = e.Event("show.bs.dropdown", a)), n.isDefaultPrevented()) return;
                s.toggleClass("open").trigger("shown.bs.dropdown", a),
                r.focus()
            }
            return ! 1
        }
    },
    s.prototype.keydown = function(t) {
        if (/(38|40|27)/.test(t.keyCode)) {
            var n = e(this);
            if (t.preventDefault(), t.stopPropagation(), !n.is(".disabled, :disabled")) {
                var s = i(n),
                o = s.hasClass("open");
                if (!o || o && 27 == t.keyCode) return 27 == t.which && s.find(r).focus(),
                n.click();
                var a = " li:not(.divider):visible a",
                l = s.find("[role=menu]" + a + ", [role=listbox]" + a);
                if (l.length) {
                    var c = l.index(l.filter(":focus"));
                    38 == t.keyCode && c > 0 && c--,
                    40 == t.keyCode && c < l.length - 1 && c++,
                    ~c || (c = 0),
                    l.eq(c).focus()
                }
            }
        }
    };
    var o = e.fn.dropdown;
    e.fn.dropdown = function(t) {
        return this.each(function() {
            var i = e(this),
            n = i.data("bs.dropdown");
            n || i.data("bs.dropdown", n = new s(this)),
            "string" == typeof t && n[t].call(i)
        })
    },
    e.fn.dropdown.Constructor = s,
    e.fn.dropdown.noConflict = function() {
        return e.fn.dropdown = o,
        this
    },
    e(document).on("click.bs.dropdown.data-api", t).on("click.bs.dropdown.data-api", ".dropdown form",
    function(e) {
        e.stopPropagation()
    }).on("click.bs.dropdown.data-api", r, s.prototype.toggle).on("keydown.bs.dropdown.data-api", r + ", [role=menu], [role=listbox]", s.prototype.keydown)
} (jQuery),
function(e) {
    "function" == typeof define && define.amd ? define(["jquery"], e) : e("object" == typeof module && "object" == typeof module.exports ? require("jquery") : jQuery)
} (function(e) {
    function t() {
        var t = s.settings;
        if (t.autoDispose && !e.contains(document.documentElement, this)) return e(this).timeago("dispose"),
        this;
        var o = i(this);
        return isNaN(o.datetime) || (0 == t.cutoff || Math.abs(r(o.datetime)) < t.cutoff) && e(this).text(n(o.datetime, e(this).attr("lang") ? e(this).attr("lang") : s.settings.lang)),
        this
    }
    function i(t) {
        if (t = e(t), !t.data("timeago")) {
            t.data("timeago", {
                datetime: s.datetime(t)
            });
            var i = e.trim(t.text());
            s.settings.localeTitle ? t.attr("title", t.data("timeago").datetime.toLocaleString()) : !(i.length > 0) || s.isTime(t) && t.attr("title") || t.attr("title", i)
        }
        return t.data("timeago")
    }
    function n(e, t) {
        return s.inWords(r(e), t)
    }
    function r(e) {
        return (new Date).getTime() - e.getTime()
    }
    e.timeago = function(t) {
        return n(t instanceof Date ? t: "string" == typeof t ? e.timeago.parse(t) : "number" == typeof t ? new Date(t) : e.timeago.datetime(t))
    };
    var s = e.timeago;
    e.extend(e.timeago, {
        settings: {
            refreshMillis: 6e4,
            allowPast: !0,
            allowFuture: !1,
            localeTitle: !1,
            cutoff: 0,
            autoDispose: !0,
            lang: "en",
            strings: {
                en: {
                    prefixAgo: null,
                    prefixFromNow: null,
                    suffixAgo: "ago",
                    suffixFromNow: "from now",
                    inPast: "any moment now",
                    seconds: "less than a minute",
                    minute: "about a minute",
                    minutes: "%d minutes",
                    hour: "about an hour",
                    hours: "about %d hours",
                    day: "a day",
                    days: "%d days",
                    month: "about a month",
                    months: "%d months",
                    year: "about a year",
                    years: "%d years",
                    wordSeparator: " ",
                    numbers: []
                }
            }
        },
        inWords: function(t, i) {
            function n(i, n) {
                var s = e.isFunction(i) ? i(n, t) : i,
                o = r.numbers && r.numbers[n] || n;
                return s.replace(/%d/i, o)
            }
            if (!this.settings.allowPast && !this.settings.allowFuture) throw "timeago allowPast and allowFuture settings can not both be set to false.";
            var r = this.settings.strings[i] || this.settings.strings[this.settings.lang] || this.settings.strings.en,
            s = r.prefixAgo,
            o = r.suffixAgo;
            if (this.settings.allowFuture && t < 0 && (s = r.prefixFromNow, o = r.suffixFromNow), !this.settings.allowPast && t >= 0) return r.inPast;
            var a = Math.abs(t) / 1e3,
            l = a / 60,
            c = l / 60,
            d = c / 24,
            u = d / 365,
            h = a < 45 && n(r.seconds, Math.round(a)) || a < 90 && n(r.minute, 1) || l < 45 && n(r.minutes, Math.round(l)) || l < 90 && n(r.hour, 1) || c < 24 && n(r.hours, Math.round(c)) || c < 42 && n(r.day, 1) || d < 30 && n(r.days, Math.round(d)) || d < 45 && n(r.month, 1) || d < 365 && n(r.months, Math.round(d / 30)) || u < 1.5 && n(r.year, 1) || n(r.years, Math.round(u)),
            p = r.wordSeparator || "";
            return void 0 === r.wordSeparator && (p = " "),
            e.trim([s, h, o].join(p))
        },
        parse: function(t) {
            var i = e.trim(t);
            return i = i.replace(/\.\d+/, ""),
            i = i.replace(/-/, "/").replace(/-/, "/"),
            i = i.replace(/T/, " ").replace(/Z/, " UTC"),
            i = i.replace(/([\+\-]\d\d)\:?(\d\d)/, " $1$2"),
            i = i.replace(/([\+\-]\d\d)$/, " $100"),
            new Date(i)
        },
        datetime: function(t) {
            var i = s.isTime(t) ? e(t).attr("datetime") : e(t).attr("title");
            return s.parse(i)
        },
        isTime: function(t) {
            return "time" === e(t).get(0).tagName.toLowerCase()
        }
    });
    var o = {
        init: function() {
            var i = e.proxy(t, this);
            i();
            var n = s.settings;
            n.refreshMillis > 0 && (this._timeagoInterval = setInterval(i, n.refreshMillis))
        },
        update: function(i) {
            var n = i instanceof Date ? i: s.parse(i);
            e(this).data("timeago", {
                datetime: n
            }),
            s.settings.localeTitle && e(this).attr("title", n.toLocaleString()),
            t.apply(this)
        },
        updateFromDOM: function() {
            e(this).data("timeago", {
                datetime: s.parse(s.isTime(this) ? e(this).attr("datetime") : e(this).attr("title"))
            }),
            t.apply(this)
        },
        dispose: function() {
            this._timeagoInterval && (window.clearInterval(this._timeagoInterval), this._timeagoInterval = null)
        }
    };
    e.fn.timeago = function(e, t) {
        var i = e ? o[e] : o.init;
        if (!i) throw new Error("Unknown function name '" + e + "' for timeago");
        return this.each(function() {
            i.call(this, t)
        }),
        this
    },
    document.createElement("abbr"),
    document.createElement("time")
}),
function(e) {
    e(document).on("ready turbolinks:load page:load ajax:success",
    function() {
        e("time[data-time-ago]").timeago()
    })
} (jQuery),
function() {
    var e, t, i, n, r, s, o, a, l, c, d = [].slice,
    u = [].indexOf ||
    function(e) {
        for (var t = 0,
        i = this.length; t < i; t++) if (t in this && this[t] === e) return t;
        return - 1
    },
    h = function(e, t) {
        function i() {
            this.constructor = e
        }
        for (var n in t) p.call(t, n) && (e[n] = t[n]);
        return i.prototype = t.prototype,
        e.prototype = new i,
        e.__super__ = t.prototype,
        e
    },
    p = {}.hasOwnProperty,
    f = function(e, t) {
        return function() {
            return e.apply(t, arguments)
        }
    };
    i = {
        bind: function(e, t) {
            var i, n, r, s, o;
            for (n = e.split(" "), this.hasOwnProperty("_callbacks") || this._callbacks || (this._callbacks = {}), r = 0, s = n.length; r < s; r++) o = n[r],
            (i = this._callbacks)[o] || (i[o] = []),
            this._callbacks[o].push(t);
            return this
        },
        one: function(e, t) {
            var i;
            return this.bind(e, i = function() {
                return this.unbind(e, i),
                t.apply(this, arguments)
            })
        },
        trigger: function() {
            var e, t, i, n, r, s, o;
            if (e = 1 <= arguments.length ? d.call(arguments, 0) : [], i = e.shift(), s = null != (o = this._callbacks) ? o[i] : void 0) {
                for (n = 0, r = s.length; n < r && (t = s[n], t.apply(this, e) !== !1); n++);
                return ! 0
            }
        },
        listenTo: function(e, t, i) {
            return e.bind(t, i),
            this.listeningTo || (this.listeningTo = []),
            this.listeningTo.push({
                obj: e,
                ev: t,
                callback: i
            }),
            this
        },
        listenToOnce: function(e, t, i) {
            var n, r;
            return r = this.listeningToOnce || (this.listeningToOnce = []),
            e.bind(t, n = function() {
                var s, o, a, l, c;
                for (o = -1, s = a = 0, l = r.length; a < l; s = ++a) c = r[s],
                c.obj === e && c.ev === t && c.callback === n && (o = s);
                return e.unbind(t, n),
                o !== -1 && r.splice(o, 1),
                i.apply(this, arguments)
            }),
            r.push({
                obj: e,
                ev: t,
                callback: n
            }),
            this
        },
        stopListening: function(t, i, n) {
            var r, s, o, a, l, c, d, h, p, f, g, m, v, b, y, _, w, M;
            if (0 === arguments.length) {
                for (_ = [this.listeningTo, this.listeningToOnce], l = 0, h = _.length; l < h; l++) if (m = _[l], null != m ? m.length: void 0) for (c = 0, p = m.length; c < p; c++) v = m[c],
                v.obj.unbind(v.ev, v.callback);
                this.listeningTo = void 0,
                this.listeningToOnce = void 0
            } else if (t) for (i = i ? i.split(" ") : [void 0], w = [this.listeningTo, this.listeningToOnce], d = 0, f = w.length; d < f; d++) if (m = w[d]) for (b = 0, g = i.length; b < g; b++) for (s = i[b], a = y = M = m.length - 1; M <= 0 ? y <= 0 : y >= 0; a = M <= 0 ? ++y: --y) v = m[a],
            v.obj === t && (n && v.callback !== n || (s && s !== v.ev ? s && (o = v.ev.split(" "), u.call(o, s) >= 0 && (o = function() {
                var e, t, i;
                for (i = [], t = 0, e = o.length; t < e; t++) r = o[t],
                r !== s && i.push(r);
                return i
            } (), v.ev = e.trim(o.join(" ")), v.obj.unbind(s, v.callback))) : (v.obj.unbind(v.ev, v.callback), a !== -1 && m.splice(a, 1))));
            return this
        },
        unbind: function(e, t) {
            var i, n, r, s, o, a, l, c, d, u;
            if (0 === arguments.length) return this._callbacks = {},
            this;
            if (!e) return this;
            for (n = e.split(" "), s = 0, a = n.length; s < a; s++) if (d = n[s], c = null != (u = this._callbacks) ? u[d] : void 0) if (t) {
                for (r = o = 0, l = c.length; o < l; r = ++o) if (i = c[r], i === t) {
                    c = c.slice(),
                    c.splice(r, 1),
                    this._callbacks[d] = c;
                    break
                }
            } else delete this._callbacks[d];
            return this
        }
    },
    i.on = i.bind,
    i.off = i.unbind,
    n = {
        trace: !0,
        logPrefix: "(App)",
        log: function() {
            var e;
            if (e = 1 <= arguments.length ? d.call(arguments, 0) : [], this.trace) return this.logPrefix && e.unshift(this.logPrefix),
            "undefined" != typeof console && null !== console && "function" == typeof console.log && console.log.apply(console, e),
            this
        }
    },
    c = ["included", "extended"],
    s = function() {
        function e() {
            "function" == typeof this.init && this.init.apply(this, arguments)
        }
        return e.include = function(e) {
            var t, i, n;
            if (!e) throw new Error("include(obj) requires obj");
            for (t in e) n = e[t],
            u.call(c, t) < 0 && (this.prototype[t] = n);
            return null != (i = e.included) && i.apply(this),
            this
        },
        e.extend = function(e) {
            var t, i, n;
            if (!e) throw new Error("extend(obj) requires obj");
            for (t in e) n = e[t],
            u.call(c, t) < 0 && (this[t] = n);
            return null != (i = e.extended) && i.apply(this),
            this
        },
        e.proxy = function(e) {
            return function(t) {
                return function() {
                    return e.apply(t, arguments)
                }
            } (this)
        },
        e.prototype.proxy = function(e) {
            return function(t) {
                return function() {
                    return e.apply(t, arguments)
                }
            } (this)
        },
        e
    } (),
    r = function(t) {
        function n(e) {
            n.__super__.constructor.apply(this, arguments),
            null != this.constructor.uuid && "function" == typeof this.constructor.uuid ? (this.cid = this.constructor.uuid(), this.id || (this.id = this.cid)) : this.cid = (null != e ? e.cid: void 0) || this.constructor.uid("c-"),
            e && this.load(e)
        }
        return h(n, t),
        n.extend(i),
        n.include(i),
        n.records = [],
        n.irecords = {},
        n.attributes = [],
        n.configure = function() {
            var e, t;
            return t = arguments[0],
            e = 2 <= arguments.length ? d.call(arguments, 1) : [],
            this.className = t,
            this.deleteAll(),
            e.length && (this.attributes = e),
            this.attributes && (this.attributes = l(this.attributes)),
            this.attributes || (this.attributes = []),
            this.unbind(),
            this
        },
        n.toString = function() {
            return this.className + "(" + this.attributes.join(", ") + ")"
        },
        n.find = function(e, t) {
            var i;
            return null == t && (t = this.notFound),
            (null != (i = this.irecords[e]) ? i.clone() : void 0) || ("function" == typeof t ? t(e) : void 0)
        },
        n.findAll = function(e, t) {
            var i, n, r, s;
            for (s = [], n = 0, r = e.length; n < r; n++) i = e[n],
            this.find(i, t) && s.push(this.find(i));
            return s
        },
        n.notFound = function() {
            return null
        },
        n.exists = function(e) {
            return Boolean(this.irecords[e])
        },
        n.addRecord = function(e, t) {
            var i;
            return (i = this.irecords[e.id || e.cid]) ? i.refresh(e) : (e.id || (e.id = e.cid), this.irecords[e.id] = this.irecords[e.cid] = e, void 0 !== t ? this.records.splice(t, 0, e) : this.records.push(e)),
            e
        },
        n.refresh = function(e, t) {
            var i, n, r, s, o;
            for (null == t && (t = {}), t.clear && this.deleteAll(), s = this.fromJSON(e), Array.isArray(s) || (s = [s]), i = 0, n = s.length; i < n; i++) r = s[i],
            this.addRecord(r);
            return this.sort(),
            o = this.cloneArray(s),
            this.trigger("refresh", o, t),
            o
        },
        n.select = function(e) {
            var t, i, n, r, s;
            for (r = this.records, s = [], t = 0, i = r.length; t < i; t++) n = r[t],
            e(n) && s.push(n.clone());
            return s
        },
        n.findByAttribute = function(e, t) {
            var i, n, r, s;
            for (s = this.records, i = 0, n = s.length; i < n; i++) if (r = s[i], r[e] === t) return r.clone();
            return null
        },
        n.findAllByAttribute = function(e, t) {
            return this.select(function(i) {
                return i[e] === t
            })
        },
        n.each = function(e) {
            var t, i, n, r, s;
            for (r = this.records, s = [], t = 0, i = r.length; t < i; t++) n = r[t],
            s.push(e(n.clone()));
            return s
        },
        n.all = function() {
            return this.cloneArray(this.records)
        },
        n.slice = function(e, t) {
            return null == e && (e = 0),
            this.cloneArray(this.records.slice(e, t))
        },
        n.first = function(e) {
            var t;
            return null == e && (e = 1),
            e > 1 ? this.cloneArray(this.records.slice(0, e)) : null != (t = this.records[0]) ? t.clone() : void 0
        },
        n.last = function(e) {
            var t;
            return "number" == typeof e ? this.cloneArray(this.records.slice( - e)) : null != (t = this.records[this.records.length - 1]) ? t.clone() : void 0
        },
        n.count = function() {
            return this.records.length
        },
        n.deleteAll = function() {
            return this.records = [],
            this.irecords = {}
        },
        n.destroyAll = function(e) {
            var t, i, n, r, s;
            for (r = this.records, s = [], t = 0, i = r.length; t < i; t++) n = r[t],
            s.push(n.destroy(e));
            return s
        },
        n.update = function(e, t, i) {
            return this.find(e).updateAttributes(t, i)
        },
        n.create = function(e, t) {
            var i;
            return i = new this(e),
            i.save(t)
        },
        n.destroy = function(e, t) {
            return this.find(e).destroy(t)
        },
        n.change = function(e) {
            return "function" == typeof e ? this.bind("change", e) : this.trigger.apply(this, ["change"].concat(d.call(arguments)))
        },
        n.fetch = function(e) {
            return "function" == typeof e ? this.bind("fetch", e) : this.trigger.apply(this, ["fetch"].concat(d.call(arguments)))
        },
        n.toJSON = function() {
            return this.records
        },
        n.beforeFromJSON = function(e) {
            return e
        },
        n.fromJSON = function(e) {
            var t, i, n, r;
            if (e) {
                if ("string" == typeof e && (e = JSON.parse(e)), e = this.beforeFromJSON(e), Array.isArray(e)) {
                    for (n = [], t = 0, i = e.length; t < i; t++) r = e[t],
                    r instanceof this ? n.push(r) : n.push(new this(r));
                    return n
                }
                return e instanceof this ? e: new this(e)
            }
        },
        n.fromForm = function() {
            var e;
            return (e = new this).fromForm.apply(e, arguments)
        },
        n.sort = function() {
            return this.comparator && this.records.sort(this.comparator),
            this
        },
        n.cloneArray = function(e) {
            var t, i, n, r;
            for (n = [], t = 0, i = e.length; t < i; t++) r = e[t],
            n.push(r.clone());
            return n
        },
        n.idCounter = 0,
        n.uid = function(e) {
            var t;
            return null == e && (e = ""),
            t = e + this.idCounter++,
            this.exists(t) && (t = this.uid(e)),
            t
        },
        n.prototype.isNew = function() {
            return ! this.exists()
        },
        n.prototype.isValid = function() {
            return ! this.validate()
        },
        n.prototype.validate = function() {},
        n.prototype.load = function(e) {
            var t, i;
            e.id && (this.id = e.id);
            for (t in e) if (i = e[t], "function" == typeof this[t]) {
                if ("function" == typeof i) continue;
                this[t](i)
            } else this[t] = i;
            return this
        },
        n.prototype.attributes = function() {
            var e, t, i, n, r;
            for (r = {},
            n = this.constructor.attributes, e = 0, i = n.length; e < i; e++) t = n[e],
            t in this && ("function" == typeof this[t] ? r[t] = this[t]() : r[t] = this[t]);
            return this.id && (r.id = this.id),
            r
        },
        n.prototype.eql = function(e) {
            return e && e.constructor === this.constructor && (e.cid === this.cid || e.id && e.id === this.id)
        },
        n.prototype.save = function(e) {
            var t, i;
            return null == e && (e = {}),
            e.validate !== !1 && (t = this.validate()) ? (this.trigger("error", this, t), !1) : (this.trigger("beforeSave", this, e), i = this.isNew() ? this.create(e) : this.update(e), this.stripCloneAttrs(), this.trigger("save", i, e), i)
        },
        n.prototype.stripCloneAttrs = function() {
            var e, t;
            if (!this.hasOwnProperty("cid")) {
                for (e in this) p.call(this, e) && (t = this[e], u.call(this.constructor.attributes, e) >= 0 && delete this[e]);
                return this
            }
        },
        n.prototype.updateAttribute = function(e, t, i) {
            var n;
            return n = {},
            n[e] = t,
            this.updateAttributes(n, i)
        },
        n.prototype.updateAttributes = function(e, t) {
            return this.load(e),
            this.save(t)
        },
        n.prototype.changeID = function(e) {
            var t;
            if (e !== this.id) return t = this.constructor.irecords,
            t[e] = t[this.id],
            this.cid !== this.id && delete t[this.id],
            this.id = e,
            this.save()
        },
        n.prototype.remove = function(e) {
            var t, i, n, r, s;
            for (null == e && (e = {}), s = this.constructor.records.slice(0), t = i = 0, n = s.length; i < n; t = ++i) if (r = s[t], this.eql(r)) {
                s.splice(t, 1);
                break
            }
            if (this.constructor.records = s, e.clear) return delete this.constructor.irecords[this.id],
            delete this.constructor.irecords[this.cid]
        },
        n.prototype.destroy = function(e) {
            return null == e && (e = {}),
            null == e.clear && (e.clear = !0),
            this.trigger("beforeDestroy", this, e),
            this.remove(e),
            this.destroyed = !0,
            this.trigger("destroy", this, e),
            this.trigger("change", this, "destroy", e),
            this.listeningTo && this.stopListening(),
            this.unbind(),
            this
        },
        n.prototype.dup = function(e) {
            var t, i;
            return null == e && (e = !0),
            t = this.attributes(),
            e ? delete t.id: t.cid = this.cid,
            i = new this.constructor(t),
            e || this._callbacks && (i._callbacks = this._callbacks),
            i
        },
        n.prototype.clone = function() {
            return a(this)
        },
        n.prototype.reload = function() {
            var e;
            return this.isNew() ? this: (e = this.constructor.find(this.id), this.load(e.attributes()), e)
        },
        n.prototype.refresh = function(e) {
            return e = this.constructor.fromJSON(e),
            e.id && this.id !== e.id && this.changeID(e.id),
            this.constructor.irecords[this.id].load(e),
            this.trigger("refresh", this),
            this.trigger("change", this, "refresh"),
            this
        },
        n.prototype.toJSON = function() {
            return this.attributes()
        },
        n.prototype.toString = function() {
            return "<" + this.constructor.className + " (" + JSON.stringify(this) + ")>"
        },
        n.prototype.fromForm = function(t) {
            var i, n, r, s, o, a, l, c, d, u, h, p, f, g;
            for (g = {},
            h = e(t).find("[type=checkbox]:not([value])"), n = 0, a = h.length; n < a; n++) i = h[n],
            g[i.name] = e(i).prop("checked");
            for (p = e(t).find('[type=checkbox][name$="[]"]'), r = 0, l = p.length; r < l; r++) i = p[r],
            d = i.name.replace(/\[\]$/, ""),
            g[d] || (g[d] = []),
            e(i).prop("checked") && g[d].push(i.value);
            for (f = e(t).serializeArray(), o = 0, c = f.length; o < c; o++) s = f[o],
            g[u = s.name] || (g[u] = s.value);
            return this.load(g)
        },
        n.prototype.exists = function() {
            return this.constructor.exists(this.id)
        },
        n.prototype.update = function(e) {
            var t, i;
            return this.trigger("beforeUpdate", this, e),
            i = this.constructor.irecords,
            i[this.id].load(this.attributes()),
            this.constructor.sort(),
            t = i[this.id].clone(),
            t.trigger("update", t, e),
            t.trigger("change", t, "update", e),
            t
        },
        n.prototype.create = function(e) {
            var t, i;
            return this.trigger("beforeCreate", this, e),
            this.id || (this.id = this.cid),
            i = this.dup(!1),
            this.constructor.addRecord(i, e.idx),
            this.constructor.sort(),
            t = i.clone(),
            t.trigger("create", t, e),
            t.trigger("change", t, "create", e),
            t
        },
        n.prototype.bind = function() {
            var e;
            return e = this.constructor.irecords[this.id] || this,
            i.bind.apply(e, arguments)
        },
        n.prototype.one = function() {
            var e;
            return e = this.constructor.irecords[this.id] || this,
            i.one.apply(e, arguments)
        },
        n.prototype.unbind = function() {
            var e;
            return e = this.constructor.irecords[this.id] || this,
            i.unbind.apply(e, arguments)
        },
        n.prototype.trigger = function() {
            var e;
            return i.trigger.apply(this, arguments),
            "refresh" === arguments[0] || (e = this.constructor).trigger.apply(e, arguments)
        },
        n
    } (s),
    r.prototype.on = r.prototype.bind,
    r.prototype.off = r.prototype.unbind,
    t = function(t) {
        function r(t) {
            this.release = f(this.release, this);
            var i, n, s, o, a;
            this.options = t,
            o = this.options;
            for (n in o) a = o[n],
            this[n] = a;
            for (this.el || (this.el = document.createElement(this.tag)), this.el = e(this.el), this.className && this.el.addClass(this.className), this.attributes && this.el.attr(this.attributes), this.events || (this.events = this.constructor.events), this.elements || (this.elements = this.constructor.elements), i = this; s = i.constructor.__super__;) s.events && (this.events = e.extend({},
            s.events, this.events)),
            s.elements && (this.elements = e.extend({},
            s.elements, this.elements)),
            i = s;
            this.events && this.delegateEvents(this.events),
            this.elements && this.refreshElements(),
            r.__super__.constructor.apply(this, arguments)
        }
        return h(r, t),
        r.include(i),
        r.include(n),
        r.prototype.eventSplitter = /^(\S+)\s*(.*)$/,
        r.prototype.tag = "div",
        r.prototype.release = function() {
            return this.trigger("release", this),
            this.el.remove(),
            this.unbind(),
            this.stopListening()
        },
        r.prototype.$ = function(e) {
            return this.el.find(e)
        },
        r.prototype.delegateEvents = function(e) {
            var t, i, n, r, s, o;
            s = [];
            for (i in e) {
                if (r = e[i], "function" == typeof r) r = function(e) {
                    return function(t) {
                        return function() {
                            return t.apply(e, arguments),
                            !0
                        }
                    }
                } (this)(r);
                else {
                    if (!this[r]) throw new Error(r + " doesn't exist");
                    r = function(e) {
                        return function(t) {
                            return function() {
                                return e[t].apply(e, arguments),
                                !0
                            }
                        }
                    } (this)(r)
                }
                n = i.match(this.eventSplitter),
                t = n[1],
                o = n[2],
                "" === o ? s.push(this.el.bind(t, r)) : s.push(this.el.on(t, o, r))
            }
            return s
        },
        r.prototype.refreshElements = function() {
            var e, t, i, n;
            t = this.elements,
            i = [];
            for (e in t) n = t[e],
            i.push(this[n] = this.$(e));
            return i
        },
        r.prototype.delay = function(e, t) {
            return setTimeout(this.proxy(e), t || 0)
        },
        r.prototype.html = function(e) {
            return this.el.html(e.el || e),
            this.refreshElements(),
            this.el
        },
        r.prototype.append = function() {
            var e, t, i;
            return t = 1 <= arguments.length ? d.call(arguments, 0) : [],
            t = function() {
                var i, n, r;
                for (r = [], i = 0, n = t.length; i < n; i++) e = t[i],
                r.push(e.el || e);
                return r
            } (),
            (i = this.el).append.apply(i, t),
            this.refreshElements(),
            this.el
        },
        r.prototype.appendTo = function(e) {
            return this.el.appendTo(e.el || e),
            this.refreshElements(),
            this.el
        },
        r.prototype.prepend = function() {
            var e, t, i;
            return t = 1 <= arguments.length ? d.call(arguments, 0) : [],
            t = function() {
                var i, n, r;
                for (r = [], i = 0, n = t.length; i < n; i++) e = t[i],
                r.push(e.el || e);
                return r
            } (),
            (i = this.el).prepend.apply(i, t),
            this.refreshElements(),
            this.el
        },
        r.prototype.replace = function(t) {
            var i, n, r;
            return t = t.el || t,
            "string" == typeof t && (t = e.trim(t)),
            r = [this.el, e((null != (n = e.parseHTML(t)) ? n[0] : void 0) || t)],
            i = r[0],
            this.el = r[1],
            i.replaceWith(this.el),
            this.delegateEvents(this.events),
            this.refreshElements(),
            this.el
        },
        r
    } (s),
    e = ("undefined" != typeof window && null !== window ? window.jQuery: void 0) || ("undefined" != typeof window && null !== window ? window.Zepto: void 0) ||
    function(e) {
        return e
    },
    a = Object.create ||
    function(e) {
        var t;
        return t = function() {},
        t.prototype = e,
        new t
    },
    l = function(e) {
        return Array.prototype.slice.call(e, 0)
    },
    o = this.Spine = {},
    "undefined" != typeof module && null !== module && (module.exports = o),
    o.version = "1.6.0",
    o.$ = e,
    o.Events = i,
    o.Log = n,
    o.Module = s,
    o.Controller = t,
    o.Model = r,
    s.extend.call(o, i),
    s.create = s.sub = t.create = t.sub = r.sub = function(e, t) {
        var i;
        return i = function(e) {
            function t() {
                return t.__super__.constructor.apply(this, arguments)
            }
            return h(t, e),
            t
        } (this),
        e && i.include(e),
        t && i.extend(t),
        "function" == typeof i.unbind && i.unbind(),
        i
    },
    r.setup = function(e, t) {
        var i;
        return null == t && (t = []),
        i = function(e) {
            function t() {
                return t.__super__.constructor.apply(this, arguments)
            }
            return h(t, e),
            t
        } (this),
        i.configure.apply(i, [e].concat(d.call(t))),
        i
    },
    o.Class = s
}.call(this),
function() {
    var e, t, i, n, r, s, o, a, l, c, d, u = [].slice,
    h = function(e, t) {
        return function() {
            return e.apply(t, arguments)
        }
    },
    p = function(e, t) {
        function i() {
            this.constructor = e
        }
        for (var n in t) f.call(t, n) && (e[n] = t[n]);
        return i.prototype = t.prototype,
        e.prototype = new i,
        e.__super__ = t.prototype,
        e
    },
    f = {}.hasOwnProperty;
    d = this.Spine || require("spine"),
    e = d.$,
    a = d.Model,
    l = e({}),
    t = {
        getURL: function(e) {
            return null != e.className ? this.generateURL(e) : this.generateURL(e, encodeURIComponent(e.id))
        },
        getCollectionURL: function(e) {
            return this.generateURL(e)
        },
        getScope: function(e) {
            return ("function" == typeof e.scope ? e.scope() : void 0) || e.scope
        },
        getCollection: function(e) {
            return e.url !== e.generateURL ? "function" == typeof e.url ? e.url() : e.url: null != e.className ? e.className.toLowerCase() + "s": void 0
        },
        generateURL: function() {
            var e, i, n, r, s;
            return n = arguments[0],
            e = 2 <= arguments.length ? u.call(arguments, 1) : [],
            i = t.getCollection(n) || t.getCollection(n.constructor),
            s = t.getScope(n) || t.getScope(n.constructor),
            e.unshift(i),
            e.unshift(s),
            r = e.join("/"),
            r = r.replace(/(\/\/)/g, "/"),
            r = r.replace(/^\/|\/$/g, ""),
            0 !== r.indexOf("../") ? a.host + "/" + r: r
        },
        enabled: !0,
        disable: function(e) {
            var t;
            if (!this.enabled) return e();
            this.enabled = !1;
            try {
                return e()
            } catch(e) {
                throw t = e
            } finally {
                this.enabled = !0
            }
        },
        queue: function(e) {
            return e ? l.queue(e) : l.queue()
        },
        clearQueue: function() {
            return this.queue([])
        },
        config: {
            loadMethod: "GET",
            updateMethod: "PUT",
            createMethod: "POST",
            destroyMethod: "DELETE"
        }
    },
    i = function() {
        function i() {}
        return i.prototype.defaults = {
            dataType: "json",
            processData: !1,
            headers: {
                "X-Requested-With": "XMLHttpRequest"
            }
        },
        i.prototype.queue = t.queue,
        i.prototype.ajax = function(t, i) {
            return e.ajax(this.ajaxSettings(t, i))
        },
        i.prototype.ajaxQueue = function(i, n, r) {
            var s, o, a, c, d, h;
            return o = null,
            s = e.Deferred(),
            c = s.promise(),
            t.enabled ? (h = this.ajaxSettings(i, n), a = void 0 !== h.parallel ? h.parallel: "GET" === h.type, d = function(i) {
                var n, c, d;
                if (null != (null != r ? r.id: void 0) && (null == h.url && (h.url = t.getURL(r)), null != (n = h.data) && (n.id = r.id)), "string" != typeof h.data && h.processData !== !0 && (h.data = JSON.stringify(h.data)), d = function() {
                    return s.resolve.apply(this, u.call(arguments).concat([h]))
                },
                c = function() {
                    return s.reject.apply(this, u.call(arguments).concat([h]))
                },
                o = e.ajax(h), o.done(d), o.fail(c), o.then(i, i), a) return l.dequeue()
            },
            c.abort = function(t) {
                var i;
                return o ? o.abort(t) : (i = e.inArray(d, this.queue()), i > -1 && this.queue().splice(i, 1), s.rejectWith(h.context || h, [c, t, ""]), c)
            },
            this.queue(d), c) : c
        },
        i.prototype.ajaxSettings = function(t, i) {
            return e.extend({},
            this.defaults, i, t)
        },
        i
    } (),
    n = function(e) {
        function i(e) {
            this.model = e,
            this.failResponse = h(this.failResponse, this),
            this.recordsResponse = h(this.recordsResponse, this)
        }
        return p(i, e),
        i.prototype.find = function(e, i, n) {
            var r;
            return null == n && (n = {}),
            r = new this.model({
                id: e
            }),
            this.ajaxQueue(i, {
                type: n.method || t.config.loadMethod,
                url: n.url || t.getURL(r),
                parallel: n.parallel
            }).done(this.recordsResponse(n)).fail(this.failResponse(n))
        },
        i.prototype.all = function(e, i) {
            return null == i && (i = {}),
            this.ajaxQueue(e, {
                type: i.method || t.config.loadMethod,
                url: i.url || t.getURL(this.model),
                parallel: i.parallel
            }).done(this.recordsResponse(i)).fail(this.failResponse(i))
        },
        i.prototype.fetch = function(e, t) {
            var i;
            return null == e && (e = {}),
            null == t && (t = {}),
            (i = e.id) ? (delete e.id, this.find(i, e, t).done(function(e) {
                return function(i) {
                    return e.model.refresh(i, t)
                }
            } (this))) : this.all(e, t).done(function(e) {
                return function(i) {
                    return e.model.refresh(i, t)
                }
            } (this))
        },
        i.prototype.recordsResponse = function(e) {
            return function(t) {
                return function(i, n, r, s) {
                    var o;
                    return t.model.trigger("ajaxSuccess", null, n, r, s),
                    null != (o = e.done) ? o.call(t.model, s) : void 0
                }
            } (this)
        },
        i.prototype.failResponse = function(e) {
            return function(t) {
                return function(i, n, r, s) {
                    var o;
                    return t.model.trigger("ajaxError", null, i, n, r, s),
                    null != (o = e.fail) ? o.call(t.model, s) : void 0
                }
            } (this)
        },
        i
    } (i),
    c = function(e) {
        function i(e) {
            this.record = e,
            this.failResponse = h(this.failResponse, this),
            this.recordResponse = h(this.recordResponse, this),
            this.model = this.record.constructor
        }
        return p(i, e),
        i.prototype.reload = function(e, i) {
            return null == i && (i = {}),
            this.ajaxQueue(e, {
                type: i.method || t.config.loadMethod,
                url: i.url,
                parallel: i.parallel
            },
            this.record).done(this.recordResponse(i)).fail(this.failResponse(i))
        },
        i.prototype.create = function(e, i) {
            return null == i && (i = {}),
            this.ajaxQueue(e, {
                type: i.method || t.config.createMethod,
                contentType: "application/json",
                data: this.record.toJSON(),
                url: i.url || t.getCollectionURL(this.record),
                parallel: i.parallel
            }).done(this.recordResponse(i)).fail(this.failResponse(i))
        },
        i.prototype.update = function(e, i) {
            return null == i && (i = {}),
            this.ajaxQueue(e, {
                type: i.method || t.config.updateMethod,
                contentType: "application/json",
                data: this.record.toJSON(),
                url: i.url,
                parallel: i.parallel
            },
            this.record).done(this.recordResponse(i)).fail(this.failResponse(i))
        },
        i.prototype.destroy = function(e, i) {
            return null == i && (i = {}),
            this.ajaxQueue(e, {
                type: i.method || t.config.destroyMethod,
                url: i.url,
                parallel: i.parallel
            },
            this.record).done(this.recordResponse(i)).fail(this.failResponse(i))
        },
        i.prototype.recordResponse = function(e) {
            return function(t) {
                return function(i, n, r, s) {
                    var o;
                    return null != i && Object.getOwnPropertyNames(i).length && !t.record.destroyed && t.record.refresh(i, {
                        ajax: !1
                    }),
                    t.record.trigger("ajaxSuccess", t.record, t.model.fromJSON(i), n, r, s),
                    null != (o = e.done) ? o.call(t.record, s) : void 0
                }
            } (this)
        },
        i.prototype.failResponse = function(e) {
            return function(t) {
                return function(i, n, r, s) {
                    var o;
                    switch (s.type) {
                    case "POST":
                        t.createFailed();
                        break;
                    case "DELETE":
                        t.destroyFailed()
                    }
                    return t.record.trigger("ajaxError", t.record, i, n, r, s),
                    null != (o = e.fail) ? o.call(t.record, s) : void 0
                }
            } (this)
        },
        i.prototype.createFailed = function() {
            return this.record.remove({
                clear: !0
            })
        },
        i.prototype.destroyFailed = function() {
            return this.record.destroyed = !1,
            this.record.constructor.refresh(this.record)
        },
        i
    } (i),
    a.host = "",
    s = {
        include: function() {
            var e;
            return e = 1 <= arguments.length ? u.call(arguments, 0) : [],
            e.unshift(encodeURIComponent(this.id)),
            t.generateURL.apply(t, [this].concat(u.call(e)))
        },
        extend: function() {
            var e;
            return e = 1 <= arguments.length ? u.call(arguments, 0) : [],
            t.generateURL.apply(t, [this].concat(u.call(e)))
        }
    },
    o = {
        ajax: function() {
            return new c(this)
        },
        generateURL: s.include,
        url: s.include
    },
    r = {
        ajax: function() {
            return new n(this)
        },
        generateURL: s.extend,
        url: s.extend
    },
    a.Ajax = {
        extended: function() {
            return this.fetch(this.ajaxFetch),
            this.change(this.ajaxChange),
            this.extend(r),
            this.include(o)
        },
        ajaxFetch: function() {
            var e;
            return (e = this.ajax()).fetch.apply(e, arguments)
        },
        ajaxChange: function(e, t, i) {
            var n;
            if (null == i && (i = {}), i.ajax !== !1) return "function" == typeof(n = e.ajax())[t] ? n[t](i.ajax, i) : void 0
        }
    },
    a.Ajax.Methods = {
        extended: function() {
            return this.extend(r),
            this.include(o)
        }
    },
    t.defaults = i.prototype.defaults,
    t.Base = i,
    t.Singleton = c,
    t.Collection = n,
    d.Ajax = t,
    "undefined" != typeof module && null !== module && (module.exports = t)
}.call(this),
function() {
    var e;
    window.MB = {},
    window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame,
    MB.locale = window.MBLocale,
    MB.v = {},
    MB.l = {},
    MB.f = {},
    MB.config = {
        showRuler: !0,
        showGeneral: !0
    },
    MB.maxTimestamp = 1,
    MB.checkFA = function(e) {
        var t, i;
        for (t = i = 12; i >= 1; t = --i) $("#fontawesome .ah").css("font-size", t + "px"),
        $("#fontawesome .ah").css("line-height", "100%"),
        $("#fontawesome .ah").text("a").height() === t && (MB.config.minFS = t);
        return 0 !== $("#fontawesome i").width() ? e() : setTimeout(function() {
            return MB.checkFA(e)
        },
        10)
    },
    MB.ga = function() {
        if (window.ga) return window.ga.apply(window, arguments)
    },
    MB.mp = function(e) {
        return window.mixpanel && !this[e] && window.mixpanel.track(e),
        this[e] = !0
    },
    MB.mpIdentify = function() {
        if (window.mixpanel && MB.user.id) return mixpanel.identify(MB.user.id),
        mixpanel.people.set({
            $name: MB.user.name,
            $email: MB.user.email,
            $plan: MB.user.plan,
            $trial: MB.user.trial,
            $expired: MB.user.expired,
            $next_billing_on: MB.user.next_billing_on ? new Date(MB.user.next_billing_on) : null,
            $value: MB.user.value,
            $email_validated: MB.user.email_validated,
            $referrer: MB.user.referrer,
            $mobile: MB.user.mobile,
            $projects_count: Project.count(),
            $created_at: new Date(MB.user.created_at),
            $login_times: MB.user.login_times,
            $role: MB.user.role
        })
    },
    MB.giIdentify = function() {
        if (window._vds && MB.user.id) return _vds.push(["setCS1", "name", MB.user.name]),
        _vds.push(["setCS2", "email", MB.user.email]),
        _vds.push(["setCS3", "plan", MB.user.plan]),
        _vds.push(["setCS5", "value", MB.user.value]),
        _vds.push(["setCS6", "login_times", MB.user.login_times]),
        _vds.push(["setCS7", "created_at", new Date(MB.user.created_at)]),
        _vds.push(["setCS8", "next_billing_on", MB.user.next_billing_on ? new Date(MB.user.next_billing_on) : null])
    },
    MB.trackOrder = function(e) {
        return MB.ga("ec:setAction", "purchase", {
            id: e.id,
            affiliation: e.affiliation,
            revenue: e.revenue
        }),
        MB.ga("send", "event", "goal", "paid"),
        MB.mp("\u4ed8\u8d39\u6210\u529f")
    },
    MB.isMac = function() {
        return /(Macintosh)/i.test(navigator.userAgent)
    },
    MB.isWindows = function() {
        return /(Windows)/i.test(navigator.userAgent)
    },
    MB.isElectron = function() {
        return /Electron/i.test(navigator.userAgent)
    },
    MB.isPhantom = function() {
        return /Phantom/i.test(navigator.userAgent)
    },
    MB.isWechat = function() {
        return /MicroMessenger/i.test(navigator.userAgent)
    },
    MB.isEmbedded = function() {
        return $("body").hasClass("embed")
    },
    MB.isLocal = function() {
        return !! window.MBData
    },
    MB.isChrome = function() {
        return /Chrome/i.test(navigator.userAgent)
    },
    MB.isFirefox = function() {
        return /Firefox/i.test(navigator.userAgent)
    },
    MB.isMobile = function() {
        return /(iPod|iPhone|iPad|Android)/.test(navigator.userAgent)
    },
    MB.isAndroid = function() {
        return /Android/i.test(navigator.userAgent)
    },
    MB.isiPad = function() {
        return /(iPad)/.test(navigator.userAgent)
    },
    MB.isIOS = function() {
        return /(iPod|iPhone|iPad)/.test(navigator.userAgent)
    },
    MB.isIOS9 = function() {
        return MB.isIOS() && window.navigator.standalone && /(9_0|9_1)/.test(navigator.userAgent) && ($(window).height() > $(window).width() || MB.isiPad())
    },
    MB.validDevice = function(e) {
        return $(window).width() === e.width && $(window).height() === e.height
    },
    MB.pointInRect = function(e, t, i) {
        return e > i.left && e < i.left + i.width && t > i.top && t < i.top + i.height
    },
    MB.setProject = function(e) {
        return MB.currentProject = e,
        $("body").data("scale", e.scale),
        $("#design").removeClass("project template combo").addClass(e.type()),
        $("title").html(I18N.site_title + " - " + e.name),
        e.setup()
    },
    MB.project = function() {
        return MB.currentProject
    },
    MB.staticMap = function() {
        var e;
        return e = /modao.cc/.test(MBServer) ? "zh-CN": "en",
        "/images/workspace/staticmap_" + MB.locale + ".png"
    },
    MB.viewOnly = function(e) {
        return e.isCollaborated() && e.expired
    },
    MB.promptRenew = function(e, t) {
        var i;
        if (e.expired) return i = "renew_modal",
        MB.mp("\u63d0\u793a\u4ed8\u8d39, \u539f\u56e0: " + t),
        MB.ga("send", "event", "goal", "\u5f39\u51fa\u4e86\u7eed\u8d39\u63d0\u793a"),
        MB.user && e.owner_id !== MB.user.id ? $("#" + i + " .btn-primary").hide() : $("#" + i + " .btn-primary").show(),
        $("#" + i + " p.limit").hide(),
        $("#" + i + " p." + t).show(),
        $("#" + i).modal(),
        !0
    },
    MB.exceedProjectQuota = function(e) {
        return e && e.expired && e.owner_id !== MB.user.id ? MB.promptRenew(e, "team_expired") : !!(MB.user.expired && Project.count() >= MB.user.limitation.projects) && MB.promptRenew(Project.first(), "projects_quota")
    },
    MB.exceedWidgetLimit = function() {
        if (Widget.count() > 5e4 || Widgetstate.serverCount() > 2e4) return MB.renderWarningModal({
            message: I18N.exceed_screen_limit
        }),
        !0
    },
    MB.scale = function() {
        return $("body").data("scale")
    },
    MB.preference = function() {
        return Preference.first()
    },
    MB.readDataURL = function(e, t) {
        var i, n;
        if (e) return n = /^image\/(png|jpg|jpeg|gif|svg|tiff|svg\+xml)$/i,
        n.test(e.type) ? e.size > 1024e3 ? void $("#file_too_large").modal() : (i = new FileReader, i.onload = function(e) {
            var i, n;
            return i = e.target.result,
            n = new Image,
            n.onload = function() {
                return t(i, n.width, n.height)
            },
            n.src = i
        },
        i.readAsDataURL(e)) : void alert(I18N.unsupported)
    },
    MB.supportedBrowser = function() {
        return /(Webkit|Firefox|Coding_iOS)/i.test(navigator.userAgent)
    },
    MB.nextgid = function(e) {
        return e ? e.substr(0, 21) + "-" + Math.uuid(21, 16) : null
    },
    MB.triggerProgress = function(e) {
        var t, i;
        return $("body").trigger("queue:save"),
        i = MB.workspace.autoSaver.queue.length,
        t = setInterval(function() {
            var i;
            if (i = MB.workspace.autoSaver.queue.length, 0 === i && (clearInterval(t), "function" == typeof e)) return e()
        },
        1e3)
    },
    MB.checkDupProgress = function(e, t) {
        return setTimeout(function() {
            return function() {
                var i, n;
                return n = "/sidekiq/critical/job/" + e + ".json",
                i = $.getJSON(n,
                function(i) {
                    return "complete" === i.result ? "function" == typeof t ? t() : window.location.reload() : MB.checkDupProgress(e, t)
                })
            }
        } (this), 2e3)
    },
    MB.unescape = function(e) {
        var t;
        return t = {
            "&amp;": "&",
            "&lt;": "<",
            "&gt;": ">"
        },
        e.replace(/(&amp;|&lt;|&gt;)/g,
        function(e) {
            return t[e]
        })
    },
    MB.hex = function(e) {
        return ("0" + parseInt(e).toString(16)).slice( - 2)
    },
    MB.rgb2hex = function(e) {
        return e && "rgba(0, 0, 0, 0)" !== e && "transparent" !== e ? (e = e.match(/^rgb[a]*\((\d+),\s*(\d+),\s*(\d+)/), "#" + this.hex(e[1]) + this.hex(e[2]) + this.hex(e[3])) : "transparent"
    },
    MB.hex2rgb = function(e) {
        return e = parseInt(e.indexOf("#") > -1 ? e.substring(1) : e, 16),
        {
            r: e >> 16,
            g: (65280 & e) >> 8,
            b: 255 & e
        }
    },
    MB.activePanel = function() {
        return MB.toolboxes && MB.toolboxes.state.activePanelState && $("#screens .panel.selected").length
    },
    MB.canvasLeft = function() {
        var e, t;
        return e = $("#screens"),
        t = $("#screen").position().left + e.position().left,
        MB.activePanel() && (t += $(".panel.selected").position().left),
        t - MB.currentScreen.w() / 2 - e[0].scrollLeft
    },
    MB.canvasTop = function() {
        var e;
        return e = 116 - $("#screens")[0].scrollTop,
        MB.activePanel() && (e += $(".panel.selected").position().top),
        e
    },
    MB.canvasWidth = function() {
        return $("#canvas").width()
    },
    MB.canvasHeight = function() {
        return $("#canvas").height()
    },
    MB.scrollbarWidth = function() {
        var e;
        return this._scrollbarWidth ? this._scrollbarWidth: (e = document.createElement("div"), e.className = "scrollbar-measure", document.body.appendChild(e), this._scrollbarWidth = e.offsetWidth - e.clientWidth, document.body.removeChild(e), this._scrollbarWidth)
    },
    MB.trigger = function(e, t) {
        return $("body").trigger(e, t)
    },
    MB.timing = function(e, t) {
        var i, n;
        return n = new Date,
        t(),
        i = new Date,
        console.log(e + ": " + (i - n))
    },
    MB.penetrateSelect = function(e, t) {
        var i, n, r, s, o, a, l;
        for (o = MB.currentScreen, a = e.clientX - MB.canvasLeft(), l = e.clientY - MB.canvasTop(), n = o.citems().sort(function(e, t) {
            return t.z - e.z || t.timestamp - e.timestamp
        }), r = 0, s = n.length; r < s; r++) if (i = n[r], i.cid !== t && a > i.l() && a < i.r() && l > i.t() && l < i.b()) return $("body").trigger("selection:clear"),
        $("body").trigger("selection:select", [[i]]),
        !0;
        return ! 1
    },
    MB.shouldDisplay = function(e) {
        return e ? null: "none"
    },
    MB.lastTimestamp = function() {
        return MB.maxTimestamp + 1
    },
    MB.safeAlert = function(e) {
        return $("#safe-modal").find("#alert-msg").html(e),
        $("#safe-modal").modal({
            backdrop: "static"
        })
    },
    MB.safeLoading = function(e) {
        return $("#safemode .text").html(e),
        $("#safemode .progress").text(""),
        $("#safemode").show()
    },
    MB.globalStateAlert = function() {
        return ! (!MB.currentScreen.cscreenstates().length || $("#ssliglobal").hasClass("active")) && ($("#global-state-warning").modal({
            backdrop: "static"
        }), !0)
    },
    MB.clearPasteBoard = function() {
        return $("#clipboard").focus().select(),
        document.execCommand("copy"),
        setTimeout(function() {
            return $("#clipboard").blur()
        },
        100)
    },
    MB.reportPerformance = function(e) {
        var t;
        if (window.performance && window.performance.memory && (t = window.performance.memory, t.usedJSHeapSize > 2e8)) return MB.ga("send", "event", "performance", "used:" + t.usedJSHeapSize / 1e6 + ",total:" + t.totalJSHeapSize / 1e6 + ",limit:" + t.jsHeapSizeLimit / 1e6 + "(" + MB.user.id + ")(" + e + ")")
    },
    MB.supportsPassive = !1,
    MB.f.inSharing = /^\/app/.test(window.location.pathname);
    try {
        e = Object.defineProperty({},
        "passive", {
            get: function() {
                return MB.supportsPassive = !0
            }
        }),
        window.addEventListener("test", null, e)
    } catch(e) {}
}.call(this),
function() {
    var e, t, i;
    MB.COMPONENTS = {
        basic: {
            name: I18N.basic,
            group: !0
        },
        label: {
            id: "label",
            text: I18N.w.label,
            tb_text: I18N.w.label,
            width: 33,
            height: 45,
            fs: 16,
            br: 0,
            bs: 0,
            ha: "center",
            va: "middle",
            z: 5,
            lh: 1.45
        },
        text_view: {
            id: "text_view",
            text: I18N.w.text_view_placeholder,
            tb_text: I18N.w.text_view,
            width: 200,
            height: 65,
            fs: 13,
            br: 0,
            bs: 0,
            ha: "left",
            va: "top",
            z: 5,
            lh: 1.45
        },
        icon_button: {
            id: "icon_button",
            text: "",
            icon: "star",
            tb_icon: "star",
            width: 45,
            height: 45,
            br: 0,
            bs: 0,
            is: 24,
            z: 5,
            tooltip: I18N.icon_tooltip
        },
        image_view: {
            id: "image_view",
            text: "",
            width: 200,
            height: 120,
            tb_icon: "picture-o",
            br: 0,
            bs: 0,
            z: 5
        },
        button: {
            id: "button",
            text: I18N.w.button,
            tb_text: I18N.w.button,
            width: 80,
            height: 30,
            fs: 14,
            br: 8,
            bs: 1,
            ha: "center",
            va: "middle",
            z: 5,
            icon: "",
            is: 14,
            padding: 8
        },
        mtooltip: {
            id: "mtooltip",
            text: I18N.w.mtooltip,
            tb_text: I18N.w.mtooltip,
            width: 220,
            height: 40,
            fs: 14,
            br: 5,
            ha: "left",
            va: "top",
            z: 5,
            lh: 1.45,
            bg: "#8DFA69",
            bc: "#5FE163",
            bs: 1,
            padding: 10
        },
        webpage: {
            id: "webpage",
            text: "about:blank",
            tb_text: I18N.w.webpage,
            width: "100%",
            height: 400,
            z: 5,
            ha: "center"
        },
        functional: {
            name: I18N.functional_widgets,
            group: !0
        },
        pg: {
            id: "pg",
            tb_icon: "tap",
            icon: "tap",
            width: 52,
            height: 52,
            br: 0,
            bs: 0,
            z: 7,
            tooltip: I18N.pg_tooltip,
            zoomable: " "
        },
        lr: {
            id: "lr",
            tb_text: I18N.w.lr,
            width: 45,
            height: 45,
            br: 0,
            bs: 0,
            z: 7,
            tooltip: I18N.lr_tooltip
        },
        sticky: {
            id: "sticky",
            tb_text: I18N.w.sticky,
            tooltip: I18N.sticky_tooltip,
            width: 200,
            height: 180,
            padding: 8,
            fs: 14,
            lh: 1.45,
            z: 10
        },
        shapes: {
            name: I18N.shapes,
            group: !0
        },
        rounded_rect: {
            id: "rounded_rect",
            text: "",
            width: 200,
            height: 100,
            br: 0,
            bs: 1,
            fs: 14,
            ha: "center",
            va: "middle",
            lh: 1.45,
            z: 5
        },
        circle_rect: {
            id: "circle_rect",
            text: "",
            width: 100,
            height: 100,
            br: 100,
            bs: 1,
            fs: 14,
            ha: "center",
            va: "middle",
            lh: 1.45,
            z: 5
        },
        hr: {
            id: "hr",
            text: "",
            width: 150,
            height: 10,
            z: 5,
            zoomable: "w,e,n"
        },
        ve: {
            id: "ve",
            text: "",
            width: 10,
            height: 150,
            z: 5,
            zoomable: "n,s,w"
        },
        triangleb: {
            id: "triangleb",
            text: "",
            width: 40,
            height: 30,
            z: 5
        },
        triangletl: {
            id: "triangletl",
            text: "",
            width: 40,
            height: 40,
            z: 5
        },
        minputs: {
            name: I18N.minputs,
            group: !0
        },
        mtext_input: {
            id: "mtext_input",
            text: I18N.w.mtext_input,
            tb_text: I18N.w.mtext_input,
            width: 200,
            height: 30,
            fs: 14,
            br: 8,
            bs: 1,
            ha: "left",
            va: "middle",
            z: 5,
            padding: 8
        },
        mtextarea: {
            id: "mtextarea",
            text: I18N.w.mtextarea,
            tb_text: I18N.w.mtextarea,
            width: 280,
            height: 100,
            fs: 14,
            lh: 1.45,
            br: 8,
            bs: 1,
            ha: "left",
            z: 5,
            padding: 8
        },
        mcheckbox2: {
            id: "mcheckbox2",
            tb_icon: "check",
            width: 30,
            height: 30,
            z: 5,
            checked: !1
        },
        mradiobutton: {
            id: "mradiobutton",
            tb_icon: "dot-circle-o",
            width: 30,
            height: 30,
            z: 5,
            checked: !1
        },
        mfile_input: {
            id: "mfile_input",
            tb_text: I18N.w.mfile_input,
            width: 200,
            height: 30,
            z: 5,
            padding: 8
        },
        mselect: {
            id: "mselect",
            text: "1\n2\n3",
            tb_text: I18N.w.mselect,
            width: 200,
            height: 30,
            fs: 14,
            bs: 1,
            z: 5,
            lh: 1.45,
            padding: 8
        },
        "switch": {
            id: "switch",
            text: "",
            width: 50,
            height: 30,
            br: 0,
            bs: 0,
            z: 5,
            zoomable: " ",
            checked: !0
        },
        bars: {
            name: I18N.bars,
            group: !0
        },
        navigation_bar: {
            id: "navigation_bar",
            text: I18N.w.navbar_title,
            tb_text: I18N.w.navigation_bar,
            width: "100%",
            height: 45,
            fs: 18,
            z: 4,
            zoomable: "s",
            ha: "center"
        },
        search_bar: {
            id: "search_bar",
            text: I18N.w.search,
            tb_text: I18N.w.search,
            width: "100%",
            height: 45,
            tb_icon: "search",
            fs: 14,
            ha: "left",
            z: 5,
            zoomable: "w,e"
        },
        tab_bar: {
            id: "tab_bar",
            text: "",
            tb_text: I18N.w.tab_bar,
            width: "100%",
            height: 45,
            z: 4,
            zoomable: "n"
        },
        tab_item: {
            id: "tab_item",
            text: I18N.w.tab_item,
            tb_text: I18N.w.tab_item,
            tb_icon: "home",
            icon: "home",
            width: 80,
            height: 45,
            fs: 12,
            is: 24,
            z: 5,
            ha: "center",
            zoomable: "w,e"
        },
        rectangle: {
            id: "rectangle",
            text: "",
            width: "100%",
            height: 100,
            z: 5,
            zoomable: "n,s"
        },
        others: {
            name: I18N.others,
            group: !0
        },
        map_view: {
            id: "map_view",
            text: "",
            width: "100%",
            height: 230,
            z: 4
        },
        keyboard: {
            id: "keyboard",
            text: I18N["return"],
            width: "100%",
            tb_icon: "keyboard-o",
            z: 3,
            zoomable: " ",
            numeric: !1
        },
        status_bar: {
            id: "status_bar",
            text: I18N.carrier,
            tb_text: I18N.carrier,
            width: "100%",
            height: 20,
            tb_icon: "signal",
            z: 3,
            zoomable: " "
        }
    },
    MB.SHELLS = {
        ipad_3_4: {
            device: "ipad",
            bg: "ipad",
            width: 881,
            height: 1247,
            top: 111,
            left: 56.5
        },
        web: {
            device: "web",
            bg: "desktop",
            width: 960,
            height: 1200,
            top: 0,
            left: 0
        },
        iphone_5: {
            device: "iphone_5",
            bg: "iphone_se",
            width: 384,
            height: 798,
            top: 119,
            left: 32
        },
        iphone_6: {
            device: "iphone_6",
            bg: "iphone_7",
            width: 435,
            height: 888,
            top: 114,
            left: 30
        },
        iphone_6_plus: {
            device: "iphone_6_plus",
            bg: "iphone_7_plus",
            width: 482,
            height: 983,
            top: 127,
            left: 34.33
        },
        Huawei: {
            device: "huawei",
            bg: "huawei_p9",
            width: 400,
            height: 800,
            top: 77,
            left: 20
        },
        samsung: {
            device: "samsung",
            bg: "samsung_s7",
            width: 398,
            height: 804,
            top: 85,
            left: 19
        },
        android: {
            device: "android",
            bg: "google_pixel",
            width: 408,
            height: 820,
            top: 84.6,
            left: 24
        }
    },
    MB.INSPECTABLES = {
        label: ["locked", "text", "fs", "br", "bs", "ha", "va", "width", "height", "top", "left", "z", "th", "lh", "td", "bo", "i", "bg", "bc", "tc", "o", "ts", "tsc", "ds", "sc", "ro", "padding", "ls", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration"],
        text_view: ["locked", "text", "fs", "br", "bs", "ha", "va", "width", "height", "top", "left", "z", "th", "lh", "td", "bo", "i", "bg", "bc", "tc", "o", "ts", "tsc", "ds", "sc", "ro", "padding", "ls", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration", "clip"],
        sticky: ["locked", "text", "fs", "ha", "lh", "bo", "i", "td", "width", "height", "top", "left", "bg", "tc", "th", "slw", "slt", "padding"],
        button: ["locked", "text", "fs", "br", "bs", "ha", "va", "width", "height", "top", "left", "z", "th", "td", "bo", "i", "bg", "bc", "tc", "o", "ts", "tsc", "ds", "sc", "ro", "ls", "icon", "is", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration"],
        icon_button: ["locked", "is", "icon", "br", "bs", "top", "left", "width", "height", "z", "th", "bg", "bc", "tc", "o", "ds", "sc", "ro", "ls", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration"],
        text_field: ["locked", "text", "fs", "br", "bs", "ha", "va", "width", "height", "top", "left", "z", "th", "bg", "bc", "tc", "o", "ds", "sc", "ro", "td", "bo", "i", "ls", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration"],
        mtext_input: ["locked", "text", "fs", "br", "bs", "ha", "width", "height", "top", "left", "z", "th", "bg", "bc", "tc", "o", "ds", "sc", "td", "bo", "i", "ls", "fixed", "fixed_type", "input_type"],
        mtextarea: ["locked", "text", "fs", "br", "bs", "ha", "width", "height", "top", "left", "z", "th", "lh", "bg", "bc", "tc", "o", "ds", "sc", "td", "bo", "i", "ls", "fixed", "fixed_type", "padding"],
        mselect: ["locked", "text", "fs", "bs", "width", "height", "top", "left", "z", "th", "lh", "bg", "bc", "tc", "o", "ds", "sc", "td", "bo", "i", "ls", "fixed", "fixed_type"],
        "switch": ["locked", "top", "left", "z", "checked", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration"],
        mcheckbox2: ["locked", "top", "left", "width", "height", "z", "o", "checked", "fixed", "fixed_type"],
        mradiobutton: ["locked", "top", "left", "width", "height", "z", "o", "checked", "fixed", "fixed_type"],
        mfile_input: ["locked", "top", "left", "width", "height", "z", "o", "fixed", "fixed_type"],
        image_view: ["locked", "bs", "br", "width", "height", "top", "left", "image", "z", "th", "bg", "bc", "tc", "o", "p", "ds", "sc", "ro", "ls", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration", "clip", "filter"],
        map_view: ["locked", "width", "height", "top", "left", "z", "fixed", "fixed_type"],
        navigation_bar: ["locked", "text", "fs", "z", "height", "th", "td", "bo", "i", "bg", "tc", "bc", "o", "ts", "tsc", "ds", "sc"],
        search_bar: ["locked", "text", "fs", "top", "left", "width", "ha", "z", "th", "bg", "tc", "bc", "o", "ds", "sc", "ro", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration"],
        tab_item: ["locked", "text", "is", "icon", "width", "left", "top", "fs", "z", "th", "bg", "tc", "o", "ds", "sc", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration"],
        tab_bar: ["locked", "height", "z", "th", "bg", "bc", "o", "ds", "sc", "ani_name", "ani_delay", "ani_count", "ani_duration"],
        hr: ["locked", "width", "height", "top", "left", "z", "th", "bc", "ls", "ro", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration"],
        ve: ["locked", "width", "height", "top", "left", "z", "th", "bc", "ls", "ro", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration"],
        keyboard: ["locked", "z", "numeric"],
        status_bar: ["locked", "text", "th", "bg", "tc", "bc", "o", "z"],
        rectangle: ["locked", "height", "top", "left", "z", "th", "bg", "bc", "o", "ds", "sc", "ro", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration"],
        rounded_rect: ["locked", "text", "fs", "br", "bs", "ha", "va", "width", "height", "top", "left", "z", "lh", "th", "td", "bo", "i", "bg", "bc", "tc", "o", "ts", "tsc", "ds", "sc", "ro", "padding", "ls", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration"],
        circle_rect: ["locked", "text", "fs", "bs", "ha", "va", "width", "height", "top", "left", "z", "lh", "th", "td", "bo", "i", "bg", "bc", "tc", "o", "ts", "tsc", "ds", "sc", "ro", "padding", "ls", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration"],
        triangleb: ["locked", "width", "height", "top", "left", "z", "th", "tc", "o", "ro", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration"],
        triangletl: ["locked", "width", "height", "top", "left", "z", "th", "tc", "o", "ro", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration"],
        lr: ["locked", "width", "height", "top", "left", "z", "fixed", "fixed_type"],
        webpage: ["locked", "width", "height", "top", "left", "z", "text"],
        pg: ["locked", "icon"],
        mtooltip: ["locked", "text", "fs", "br", "ha", "va", "width", "height", "top", "left", "z", "th", "lh", "td", "bo", "i", "bg", "tc", "o", "ts", "tsc", "ds", "sc", "bs", "bc", "ro", "padding", "tt_placement", "tt_offset", "tt_arrow_size", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration"]
    },
    MB.INSPECTABLES.pg = ["left", "top"],
    t = MB.INSPECTABLES;
    for (e in t) i = t[e],
    i.push("v");
    window.Spine && (Spine.Model.prototype.refresh = function(e) {
        var t;
        return t = this.constructor.irecords[this.id],
        t && t.load(e),
        this.trigger("refresh"),
        this
    },
    Spine.Model.State = {
        lsave: function(e, t) {
            var i, n, r, s, o, a, l, c, d, u;
            if (null == e && (e = !0), null == t && (t = !0), Spine.Ajax.disable(function(e) {
                return function() {
                    return e.save()
                }
            } (this)), !e) return ! 0;
            if (n = this.getState("default").dup(), d = this.getState(this.screenstate_cid), d.restore(this), d.lsave(), s = $("#ssliglobal").hasClass("active"), !s && "default" !== this.screenstate_cid) return ! 0;
            if (i = this.cs(), !i || !t) return ! 0;
            for (c = i.cscreenstates(), o = 0, a = c.length; o < a; o++) u = c[o],
            u.cid !== this.screenstate_cid && (l = this.getState(u.cid), l.exists() || "default" !== this.screenstate_cid ? l.exists() && s && (r = l.gid, l.restore(this), l.gid = r, l.lsave(!0, !1)) : (l.restore(n), l.lsave(!0, !1)));
            return "default" !== this.screenstate_cid && s && (l = this.getState("default"), r = l.gid, l.restore(this), l.gid = r, l.lsave(!0, !1)),
            !0
        },
        setState: function(e, t) {
            var i, n, r, s;
            if (e || (e = "default"), s = this.screenstate_cid || "default", s !== e) return i = this.getState("default"),
            i.exists() || i.lsave(!1, !1),
            r = this.getState(s),
            r.exists() && r.restore(this),
            n = this.getState(e),
            n.exists() ? this.restore(n) : this.restore(i),
            t ? (this.screenstate_cid = e, this.lsave(!1, !1)) : void 0
        }
    },
    Spine.Model.Dirty = {
        lsave: function(e) {
            return null == e && (e = !0),
            Spine.Ajax.disable(function(e) {
                return function() {
                    return e.save()
                }
            } (this)),
            e && $("body").trigger("queue:add", [this, !1]),
            !0
        },
        ldestroy: function(e) {
            if (null == e && (e = !0), Spine.Ajax.disable(function(e) {
                return function() {
                    return e.destroy()
                }
            } (this)), e) return $("body").trigger("queue:add", [this, !0])
        }
    })
}.call(this),
function() {
    MB.themes = {
        light: [],
        dark: ["#444", "#555", "#666"],
        indigo: ["#3949ab", "#3f51b5", "#5c6bc0"],
        pink: ["#d81b60", "#ff4081", "#ff6091"],
        red: ["#dd191d", "#e51c23", "#e84e40"],
        blue: ["#4e6cef", "#5677fc", "#738ffe"],
        lblue: ["#039be5", "#03a9f4", "#29b6f6"],
        cyan: ["#00acc1", "#00bcd4", "#26c6da"],
        teal: ["#00897b", "#009688", "#26a69a"],
        green: ["#0a8f08", "#259b24", "#2baf2b"],
        lgreen: ["#7cb342", "#8bc34a", "#9ccc65"],
        orange: ["#f4511e", "#ff5722", "#ff7043"],
        lorange: ["#fb8c00", "#ff9800", "#ffa726"],
        purple: ["#8e24aa", "#9c27b0", "#ab47bc"],
        dpurple: ["#5e35b1", "#673ab7", "#7e57c2"],
        grey: ["#546e7a", "#607d8b", "#78909c"]
    }
}.call(this),
function() {
    $.extend({
        nextTick: function(e) {
            return window.requestAnimationFrame(function() {
                return window.requestAnimationFrame(function() {
                    return window.requestAnimationFrame(function() {
                        return e()
                    })
                })
            })
        }
    }),
    $.fn.extend({
        transitionEnd: function(e) {
            return this.one("transitionend",
            function() {
                return function() {
                    return e()
                }
            } (this))
        },
        enableTransition: function(e, t) {
            if (this.css("transition", "all " + e + " ease-in-out").css("transition"), t && "function" == typeof t) return t()
        },
        disableTransition: function(e) {
            if (this.css("transition", "none").css("transition"), e && "function" == typeof e) return e()
        },
        boxShadow: function(e, t) {
            if (this.css("box-shadow", e), t && "function" == typeof t) return t()
        },
        transform: function(e, t) {
            if (this.css("transform", e), t && "function" == typeof t) return t()
        },
        translateX: function(e, t) {
            if (this.css("transform", "translateX(" + e + "px)"), t && "function" == typeof t) return t()
        },
        translateY: function(e, t) {
            if (this.css("transform", "translateY(" + e + "px)"), t && "function" == typeof t) return t()
        },
        translate: function(e, t, i) {
            if (this.css("transform", "translate(" + e + "px, " + t + "px)"), i && "function" == typeof i) return i()
        },
        zindex: function(e, t) {
            if (this.css("z-index", e), t && "function" == typeof t) return t()
        },
        onScroll: function(e) {
            var t;
            return t = !!MB.supportsPassive && {
                passive: !0
            },
            this[0].removeEventListener("scroll", e, t),
            this[0].addEventListener("scroll", e, t)
        }
    })
}.call(this),
function(e) {
    e.fn.qrcode = function(t) {
        function i(e) {
            this.mode = a,
            this.data = e
        }
        function n(e, t) {
            this.typeNumber = e,
            this.errorCorrectLevel = t,
            this.modules = null,
            this.moduleCount = 0,
            this.dataCache = null,
            this.dataList = []
        }
        function r(e, t) {
            if (void 0 == e.length) throw Error(e.length + "/" + t);
            for (var i = 0; i < e.length && 0 == e[i];) i++;
            this.num = Array(e.length - i + t);
            for (var n = 0; n < e.length - i; n++) this.num[n] = e[n + i]
        }
        function s(e, t) {
            this.totalCount = e,
            this.dataCount = t
        }
        function o() {
            this.buffer = [],
            this.length = 0
        }
        var a;
        i.prototype = {
            getLength: function() {
                return this.data.length
            },
            write: function(e) {
                for (var t = 0; t < this.data.length; t++) e.put(this.data.charCodeAt(t), 8)
            }
        },
        n.prototype = {
            addData: function(e) {
                this.dataList.push(new i(e)),
                this.dataCache = null
            },
            isDark: function(e, t) {
                if (0 > e || this.moduleCount <= e || 0 > t || this.moduleCount <= t) throw Error(e + "," + t);
                return this.modules[e][t]
            },
            getModuleCount: function() {
                return this.moduleCount
            },
            make: function() {
                if (1 > this.typeNumber) {
                    for (var e = 1,
                    e = 1; 40 > e; e++) {
                        for (var t = s.getRSBlocks(e, this.errorCorrectLevel), i = new o, n = 0, r = 0; r < t.length; r++) n += t[r].dataCount;
                        for (r = 0; r < this.dataList.length; r++) t = this.dataList[r],
                        i.put(t.mode, 4),
                        i.put(t.getLength(), l.getLengthInBits(t.mode, e)),
                        t.write(i);
                        if (i.getLengthInBits() <= 8 * n) break
                    }
                    this.typeNumber = e
                }
                this.makeImpl(!1, this.getBestMaskPattern())
            },
            makeImpl: function(e, t) {
                this.moduleCount = 4 * this.typeNumber + 17,
                this.modules = Array(this.moduleCount);
                for (var i = 0; i < this.moduleCount; i++) {
                    this.modules[i] = Array(this.moduleCount);
                    for (var r = 0; r < this.moduleCount; r++) this.modules[i][r] = null
                }
                this.setupPositionProbePattern(0, 0),
                this.setupPositionProbePattern(this.moduleCount - 7, 0),
                this.setupPositionProbePattern(0, this.moduleCount - 7),
                this.setupPositionAdjustPattern(),
                this.setupTimingPattern(),
                this.setupTypeInfo(e, t),
                7 <= this.typeNumber && this.setupTypeNumber(e),
                null == this.dataCache && (this.dataCache = n.createData(this.typeNumber, this.errorCorrectLevel, this.dataList)),
                this.mapData(this.dataCache, t)
            },
            setupPositionProbePattern: function(e, t) {
                for (var i = -1; 7 >= i; i++) if (! ( - 1 >= e + i || this.moduleCount <= e + i)) for (var n = -1; 7 >= n; n++) - 1 >= t + n || this.moduleCount <= t + n || (this.modules[e + i][t + n] = 0 <= i && 6 >= i && (0 == n || 6 == n) || 0 <= n && 6 >= n && (0 == i || 6 == i) || 2 <= i && 4 >= i && 2 <= n && 4 >= n)
            },
            getBestMaskPattern: function() {
                for (var e = 0,
                t = 0,
                i = 0; 8 > i; i++) {
                    this.makeImpl(!0, i);
                    var n = l.getLostPoint(this); (0 == i || e > n) && (e = n, t = i)
                }
                return t
            },
            createMovieClip: function(e, t, i) {
                for (e = e.createEmptyMovieClip(t, i), this.make(), t = 0; t < this.modules.length; t++) for (var i = 1 * t,
                n = 0; n < this.modules[t].length; n++) {
                    var r = 1 * n;
                    this.modules[t][n] && (e.beginFill(0, 100), e.moveTo(r, i), e.lineTo(r + 1, i), e.lineTo(r + 1, i + 1), e.lineTo(r, i + 1), e.endFill())
                }
                return e
            },
            setupTimingPattern: function() {
                for (var e = 8; e < this.moduleCount - 8; e++) null == this.modules[e][6] && (this.modules[e][6] = 0 == e % 2);
                for (e = 8; e < this.moduleCount - 8; e++) null == this.modules[6][e] && (this.modules[6][e] = 0 == e % 2)
            },
            setupPositionAdjustPattern: function() {
                for (var e = l.getPatternPosition(this.typeNumber), t = 0; t < e.length; t++) for (var i = 0; i < e.length; i++) {
                    var n = e[t],
                    r = e[i];
                    if (null == this.modules[n][r]) for (var s = -2; 2 >= s; s++) for (var o = -2; 2 >= o; o++) this.modules[n + s][r + o] = -2 == s || 2 == s || -2 == o || 2 == o || 0 == s && 0 == o
                }
            },
            setupTypeNumber: function(e) {
                for (var t = l.getBCHTypeNumber(this.typeNumber), i = 0; 18 > i; i++) {
                    var n = !e && 1 == (t >> i & 1);
                    this.modules[Math.floor(i / 3)][i % 3 + this.moduleCount - 8 - 3] = n
                }
                for (i = 0; 18 > i; i++) n = !e && 1 == (t >> i & 1),
                this.modules[i % 3 + this.moduleCount - 8 - 3][Math.floor(i / 3)] = n
            },
            setupTypeInfo: function(e, t) {
                for (var i = l.getBCHTypeInfo(this.errorCorrectLevel << 3 | t), n = 0; 15 > n; n++) {
                    var r = !e && 1 == (i >> n & 1);
                    6 > n ? this.modules[n][8] = r: 8 > n ? this.modules[n + 1][8] = r: this.modules[this.moduleCount - 15 + n][8] = r
                }
                for (n = 0; 15 > n; n++) r = !e && 1 == (i >> n & 1),
                8 > n ? this.modules[8][this.moduleCount - n - 1] = r: 9 > n ? this.modules[8][15 - n - 1 + 1] = r: this.modules[8][15 - n - 1] = r;
                this.modules[this.moduleCount - 8][8] = !e
            },
            mapData: function(e, t) {
                for (var i = -1,
                n = this.moduleCount - 1,
                r = 7,
                s = 0,
                o = this.moduleCount - 1; 0 < o; o -= 2) for (6 == o && o--;;) {
                    for (var a = 0; 2 > a; a++) if (null == this.modules[n][o - a]) {
                        var c = !1;
                        s < e.length && (c = 1 == (e[s] >>> r & 1)),
                        l.getMask(t, n, o - a) && (c = !c),
                        this.modules[n][o - a] = c,
                        r--,
                        -1 == r && (s++, r = 7)
                    }
                    if (n += i, 0 > n || this.moduleCount <= n) {
                        n -= i,
                        i = -i;
                        break
                    }
                }
            }
        },
        n.PAD0 = 236,
        n.PAD1 = 17,
        n.createData = function(e, t, i) {
            for (var t = s.getRSBlocks(e, t), r = new o, a = 0; a < i.length; a++) {
                var c = i[a];
                r.put(c.mode, 4),
                r.put(c.getLength(), l.getLengthInBits(c.mode, e)),
                c.write(r)
            }
            for (a = e = 0; a < t.length; a++) e += t[a].dataCount;
            if (r.getLengthInBits() > 8 * e) throw Error("code length overflow. (" + r.getLengthInBits() + ">" + 8 * e + ")");
            for (r.getLengthInBits() + 4 <= 8 * e && r.put(0, 4); 0 != r.getLengthInBits() % 8;) r.putBit(!1);
            for (; ! (r.getLengthInBits() >= 8 * e) && (r.put(n.PAD0, 8), !(r.getLengthInBits() >= 8 * e));) r.put(n.PAD1, 8);
            return n.createBytes(r, t)
        },
        n.createBytes = function(e, t) {
            for (var i = 0,
            n = 0,
            s = 0,
            o = Array(t.length), a = Array(t.length), c = 0; c < t.length; c++) {
                var d = t[c].dataCount,
                u = t[c].totalCount - d,
                n = Math.max(n, d),
                s = Math.max(s, u);
                o[c] = Array(d);
                for (var h = 0; h < o[c].length; h++) o[c][h] = 255 & e.buffer[h + i];
                for (i += d, h = l.getErrorCorrectPolynomial(u), d = new r(o[c], h.getLength() - 1).mod(h), a[c] = Array(h.getLength() - 1), h = 0; h < a[c].length; h++) u = h + d.getLength() - a[c].length,
                a[c][h] = 0 <= u ? d.get(u) : 0
            }
            for (h = c = 0; h < t.length; h++) c += t[h].totalCount;
            for (i = Array(c), h = d = 0; h < n; h++) for (c = 0; c < t.length; c++) h < o[c].length && (i[d++] = o[c][h]);
            for (h = 0; h < s; h++) for (c = 0; c < t.length; c++) h < a[c].length && (i[d++] = a[c][h]);
            return i
        },
        a = 4;
        for (var l = {
            PATTERN_POSITION_TABLE: [[], [6, 18], [6, 22], [6, 26], [6, 30], [6, 34], [6, 22, 38], [6, 24, 42], [6, 26, 46], [6, 28, 50], [6, 30, 54], [6, 32, 58], [6, 34, 62], [6, 26, 46, 66], [6, 26, 48, 70], [6, 26, 50, 74], [6, 30, 54, 78], [6, 30, 56, 82], [6, 30, 58, 86], [6, 34, 62, 90], [6, 28, 50, 72, 94], [6, 26, 50, 74, 98], [6, 30, 54, 78, 102], [6, 28, 54, 80, 106], [6, 32, 58, 84, 110], [6, 30, 58, 86, 114], [6, 34, 62, 90, 118], [6, 26, 50, 74, 98, 122], [6, 30, 54, 78, 102, 126], [6, 26, 52, 78, 104, 130], [6, 30, 56, 82, 108, 134], [6, 34, 60, 86, 112, 138], [6, 30, 58, 86, 114, 142], [6, 34, 62, 90, 118, 146], [6, 30, 54, 78, 102, 126, 150], [6, 24, 50, 76, 102, 128, 154], [6, 28, 54, 80, 106, 132, 158], [6, 32, 58, 84, 110, 136, 162], [6, 26, 54, 82, 110, 138, 166], [6, 30, 58, 86, 114, 142, 170]],
            G15: 1335,
            G18: 7973,
            G15_MASK: 21522,
            getBCHTypeInfo: function(e) {
                for (var t = e << 10; 0 <= l.getBCHDigit(t) - l.getBCHDigit(l.G15);) t ^= l.G15 << l.getBCHDigit(t) - l.getBCHDigit(l.G15);
                return (e << 10 | t) ^ l.G15_MASK
            },
            getBCHTypeNumber: function(e) {
                for (var t = e << 12; 0 <= l.getBCHDigit(t) - l.getBCHDigit(l.G18);) t ^= l.G18 << l.getBCHDigit(t) - l.getBCHDigit(l.G18);
                return e << 12 | t
            },
            getBCHDigit: function(e) {
                for (var t = 0; 0 != e;) t++,
                e >>>= 1;
                return t
            },
            getPatternPosition: function(e) {
                return l.PATTERN_POSITION_TABLE[e - 1]
            },
            getMask: function(e, t, i) {
                switch (e) {
                case 0:
                    return 0 == (t + i) % 2;
                case 1:
                    return 0 == t % 2;
                case 2:
                    return 0 == i % 3;
                case 3:
                    return 0 == (t + i) % 3;
                case 4:
                    return 0 == (Math.floor(t / 2) + Math.floor(i / 3)) % 2;
                case 5:
                    return 0 == t * i % 2 + t * i % 3;
                case 6:
                    return 0 == (t * i % 2 + t * i % 3) % 2;
                case 7:
                    return 0 == (t * i % 3 + (t + i) % 2) % 2;
                default:
                    throw Error("bad maskPattern:" + e)
                }
            },
            getErrorCorrectPolynomial: function(e) {
                for (var t = new r([1], 0), i = 0; i < e; i++) t = t.multiply(new r([1, c.gexp(i)], 0));
                return t
            },
            getLengthInBits: function(e, t) {
                if (1 <= t && 10 > t) switch (e) {
                case 1:
                    return 10;
                case 2:
                    return 9;
                case a:
                    return 8;
                case 8:
                    return 8;
                default:
                    throw Error("mode:" + e)
                } else if (27 > t) switch (e) {
                case 1:
                    return 12;
                case 2:
                    return 11;
                case a:
                    return 16;
                case 8:
                    return 10;
                default:
                    throw Error("mode:" + e)
                } else {
                    if (! (41 > t)) throw Error("type:" + t);
                    switch (e) {
                    case 1:
                        return 14;
                    case 2:
                        return 13;
                    case a:
                        return 16;
                    case 8:
                        return 12;
                    default:
                        throw Error("mode:" + e)
                    }
                }
            },
            getLostPoint: function(e) {
                for (var t = e.getModuleCount(), i = 0, n = 0; n < t; n++) for (var r = 0; r < t; r++) {
                    for (var s = 0,
                    o = e.isDark(n, r), a = -1; 1 >= a; a++) if (! (0 > n + a || t <= n + a)) for (var l = -1; 1 >= l; l++) 0 > r + l || t <= r + l || 0 == a && 0 == l || o == e.isDark(n + a, r + l) && s++;
                    5 < s && (i += 3 + s - 5)
                }
                for (n = 0; n < t - 1; n++) for (r = 0; r < t - 1; r++) s = 0,
                e.isDark(n, r) && s++,
                e.isDark(n + 1, r) && s++,
                e.isDark(n, r + 1) && s++,
                e.isDark(n + 1, r + 1) && s++,
                (0 == s || 4 == s) && (i += 3);
                for (n = 0; n < t; n++) for (r = 0; r < t - 6; r++) e.isDark(n, r) && !e.isDark(n, r + 1) && e.isDark(n, r + 2) && e.isDark(n, r + 3) && e.isDark(n, r + 4) && !e.isDark(n, r + 5) && e.isDark(n, r + 6) && (i += 40);
                for (r = 0; r < t; r++) for (n = 0; n < t - 6; n++) e.isDark(n, r) && !e.isDark(n + 1, r) && e.isDark(n + 2, r) && e.isDark(n + 3, r) && e.isDark(n + 4, r) && !e.isDark(n + 5, r) && e.isDark(n + 6, r) && (i += 40);
                for (r = s = 0; r < t; r++) for (n = 0; n < t; n++) e.isDark(n, r) && s++;
                return e = Math.abs(100 * s / t / t - 50) / 5,
                i + 10 * e
            }
        },
        c = {
            glog: function(e) {
                if (1 > e) throw Error("glog(" + e + ")");
                return c.LOG_TABLE[e]
            },
            gexp: function(e) {
                for (; 0 > e;) e += 255;
                for (; 256 <= e;) e -= 255;
                return c.EXP_TABLE[e]
            },
            EXP_TABLE: Array(256),
            LOG_TABLE: Array(256)
        },
        d = 0; 8 > d; d++) c.EXP_TABLE[d] = 1 << d;
        for (d = 8; 256 > d; d++) c.EXP_TABLE[d] = c.EXP_TABLE[d - 4] ^ c.EXP_TABLE[d - 5] ^ c.EXP_TABLE[d - 6] ^ c.EXP_TABLE[d - 8];
        for (d = 0; 255 > d; d++) c.LOG_TABLE[c.EXP_TABLE[d]] = d;
        return r.prototype = {
            get: function(e) {
                return this.num[e]
            },
            getLength: function() {
                return this.num.length
            },
            multiply: function(e) {
                for (var t = Array(this.getLength() + e.getLength() - 1), i = 0; i < this.getLength(); i++) for (var n = 0; n < e.getLength(); n++) t[i + n] ^= c.gexp(c.glog(this.get(i)) + c.glog(e.get(n)));
                return new r(t, 0)
            },
            mod: function(e) {
                if (0 > this.getLength() - e.getLength()) return this;
                for (var t = c.glog(this.get(0)) - c.glog(e.get(0)), i = Array(this.getLength()), n = 0; n < this.getLength(); n++) i[n] = this.get(n);
                for (n = 0; n < e.getLength(); n++) i[n] ^= c.gexp(c.glog(e.get(n)) + t);
                return new r(i, 0).mod(e)
            }
        },
        s.RS_BLOCK_TABLE = [[1, 26, 19], [1, 26, 16], [1, 26, 13], [1, 26, 9], [1, 44, 34], [1, 44, 28], [1, 44, 22], [1, 44, 16], [1, 70, 55], [1, 70, 44], [2, 35, 17], [2, 35, 13], [1, 100, 80], [2, 50, 32], [2, 50, 24], [4, 25, 9], [1, 134, 108], [2, 67, 43], [2, 33, 15, 2, 34, 16], [2, 33, 11, 2, 34, 12], [2, 86, 68], [4, 43, 27], [4, 43, 19], [4, 43, 15], [2, 98, 78], [4, 49, 31], [2, 32, 14, 4, 33, 15], [4, 39, 13, 1, 40, 14], [2, 121, 97], [2, 60, 38, 2, 61, 39], [4, 40, 18, 2, 41, 19], [4, 40, 14, 2, 41, 15], [2, 146, 116], [3, 58, 36, 2, 59, 37], [4, 36, 16, 4, 37, 17], [4, 36, 12, 4, 37, 13], [2, 86, 68, 2, 87, 69], [4, 69, 43, 1, 70, 44], [6, 43, 19, 2, 44, 20], [6, 43, 15, 2, 44, 16], [4, 101, 81], [1, 80, 50, 4, 81, 51], [4, 50, 22, 4, 51, 23], [3, 36, 12, 8, 37, 13], [2, 116, 92, 2, 117, 93], [6, 58, 36, 2, 59, 37], [4, 46, 20, 6, 47, 21], [7, 42, 14, 4, 43, 15], [4, 133, 107], [8, 59, 37, 1, 60, 38], [8, 44, 20, 4, 45, 21], [12, 33, 11, 4, 34, 12], [3, 145, 115, 1, 146, 116], [4, 64, 40, 5, 65, 41], [11, 36, 16, 5, 37, 17], [11, 36, 12, 5, 37, 13], [5, 109, 87, 1, 110, 88], [5, 65, 41, 5, 66, 42], [5, 54, 24, 7, 55, 25], [11, 36, 12], [5, 122, 98, 1, 123, 99], [7, 73, 45, 3, 74, 46], [15, 43, 19, 2, 44, 20], [3, 45, 15, 13, 46, 16], [1, 135, 107, 5, 136, 108], [10, 74, 46, 1, 75, 47], [1, 50, 22, 15, 51, 23], [2, 42, 14, 17, 43, 15], [5, 150, 120, 1, 151, 121], [9, 69, 43, 4, 70, 44], [17, 50, 22, 1, 51, 23], [2, 42, 14, 19, 43, 15], [3, 141, 113, 4, 142, 114], [3, 70, 44, 11, 71, 45], [17, 47, 21, 4, 48, 22], [9, 39, 13, 16, 40, 14], [3, 135, 107, 5, 136, 108], [3, 67, 41, 13, 68, 42], [15, 54, 24, 5, 55, 25], [15, 43, 15, 10, 44, 16], [4, 144, 116, 4, 145, 117], [17, 68, 42], [17, 50, 22, 6, 51, 23], [19, 46, 16, 6, 47, 17], [2, 139, 111, 7, 140, 112], [17, 74, 46], [7, 54, 24, 16, 55, 25], [34, 37, 13], [4, 151, 121, 5, 152, 122], [4, 75, 47, 14, 76, 48], [11, 54, 24, 14, 55, 25], [16, 45, 15, 14, 46, 16], [6, 147, 117, 4, 148, 118], [6, 73, 45, 14, 74, 46], [11, 54, 24, 16, 55, 25], [30, 46, 16, 2, 47, 17], [8, 132, 106, 4, 133, 107], [8, 75, 47, 13, 76, 48], [7, 54, 24, 22, 55, 25], [22, 45, 15, 13, 46, 16], [10, 142, 114, 2, 143, 115], [19, 74, 46, 4, 75, 47], [28, 50, 22, 6, 51, 23], [33, 46, 16, 4, 47, 17], [8, 152, 122, 4, 153, 123], [22, 73, 45, 3, 74, 46], [8, 53, 23, 26, 54, 24], [12, 45, 15, 28, 46, 16], [3, 147, 117, 10, 148, 118], [3, 73, 45, 23, 74, 46], [4, 54, 24, 31, 55, 25], [11, 45, 15, 31, 46, 16], [7, 146, 116, 7, 147, 117], [21, 73, 45, 7, 74, 46], [1, 53, 23, 37, 54, 24], [19, 45, 15, 26, 46, 16], [5, 145, 115, 10, 146, 116], [19, 75, 47, 10, 76, 48], [15, 54, 24, 25, 55, 25], [23, 45, 15, 25, 46, 16], [13, 145, 115, 3, 146, 116], [2, 74, 46, 29, 75, 47], [42, 54, 24, 1, 55, 25], [23, 45, 15, 28, 46, 16], [17, 145, 115], [10, 74, 46, 23, 75, 47], [10, 54, 24, 35, 55, 25], [19, 45, 15, 35, 46, 16], [17, 145, 115, 1, 146, 116], [14, 74, 46, 21, 75, 47], [29, 54, 24, 19, 55, 25], [11, 45, 15, 46, 46, 16], [13, 145, 115, 6, 146, 116], [14, 74, 46, 23, 75, 47], [44, 54, 24, 7, 55, 25], [59, 46, 16, 1, 47, 17], [12, 151, 121, 7, 152, 122], [12, 75, 47, 26, 76, 48], [39, 54, 24, 14, 55, 25], [22, 45, 15, 41, 46, 16], [6, 151, 121, 14, 152, 122], [6, 75, 47, 34, 76, 48], [46, 54, 24, 10, 55, 25], [2, 45, 15, 64, 46, 16], [17, 152, 122, 4, 153, 123], [29, 74, 46, 14, 75, 47], [49, 54, 24, 10, 55, 25], [24, 45, 15, 46, 46, 16], [4, 152, 122, 18, 153, 123], [13, 74, 46, 32, 75, 47], [48, 54, 24, 14, 55, 25], [42, 45, 15, 32, 46, 16], [20, 147, 117, 4, 148, 118], [40, 75, 47, 7, 76, 48], [43, 54, 24, 22, 55, 25], [10, 45, 15, 67, 46, 16], [19, 148, 118, 6, 149, 119], [18, 75, 47, 31, 76, 48], [34, 54, 24, 34, 55, 25], [20, 45, 15, 61, 46, 16]],
        s.getRSBlocks = function(e, t) {
            var i = s.getRsBlockTable(e, t);
            if (void 0 == i) throw Error("bad rs block @ typeNumber:" + e + "/errorCorrectLevel:" + t);
            for (var n = i.length / 3,
            r = [], o = 0; o < n; o++) for (var a = i[3 * o + 0], l = i[3 * o + 1], c = i[3 * o + 2], d = 0; d < a; d++) r.push(new s(l, c));
            return r
        },
        s.getRsBlockTable = function(e, t) {
            switch (t) {
            case 1:
                return s.RS_BLOCK_TABLE[4 * (e - 1) + 0];
            case 0:
                return s.RS_BLOCK_TABLE[4 * (e - 1) + 1];
            case 3:
                return s.RS_BLOCK_TABLE[4 * (e - 1) + 2];
            case 2:
                return s.RS_BLOCK_TABLE[4 * (e - 1) + 3]
            }
        },
        o.prototype = {
            get: function(e) {
                return 1 == (this.buffer[Math.floor(e / 8)] >>> 7 - e % 8 & 1)
            },
            put: function(e, t) {
                for (var i = 0; i < t; i++) this.putBit(1 == (e >>> t - i - 1 & 1))
            },
            getLengthInBits: function() {
                return this.length
            },
            putBit: function(e) {
                var t = Math.floor(this.length / 8);
                this.buffer.length <= t && this.buffer.push(0),
                e && (this.buffer[t] |= 128 >>> this.length % 8),
                this.length++
            }
        },
        "string" == typeof t && (t = {
            text: t
        }),
        t = e.extend({},
        {
            render: "canvas",
            width: 256,
            height: 256,
            typeNumber: -1,
            correctLevel: 2,
            background: "#ffffff",
            foreground: "#000000"
        },
        t),
        this.each(function() {
            var i;
            if ("canvas" == t.render) {
                i = new n(t.typeNumber, t.correctLevel),
                i.addData(t.text),
                i.make();
                var r = document.createElement("canvas");
                r.width = t.width,
                r.height = t.height;
                for (var s = r.getContext("2d"), o = t.width / i.getModuleCount(), a = t.height / i.getModuleCount(), l = 0; l < i.getModuleCount(); l++) for (var c = 0; c < i.getModuleCount(); c++) {
                    s.fillStyle = i.isDark(l, c) ? t.foreground: t.background;
                    var d = Math.ceil((c + 1) * o) - Math.floor(c * o),
                    u = Math.ceil((l + 1) * o) - Math.floor(l * o);
                    s.fillRect(Math.round(c * o), Math.round(l * a), d, u)
                }
            } else for (i = new n(t.typeNumber, t.correctLevel), i.addData(t.text), i.make(), r = e("<table></table>").css("width", t.width + "px").css("height", t.height + "px").css("border", "0px").css("border-collapse", "collapse").css("background-color", t.background), s = t.width / i.getModuleCount(), o = t.height / i.getModuleCount(), a = 0; a < i.getModuleCount(); a++) for (l = e("<tr></tr>").css("height", o + "px").appendTo(r), c = 0; c < i.getModuleCount(); c++) e("<td></td>").css("width", s + "px").css("background-color", i.isDark(a, c) ? t.foreground: t.background).appendTo(l);
            i = r,
            jQuery(i).appendTo(this)
        })
    }
} (jQuery),
function() { !
    function(e) {
        var t, i, n, r;
        return t = void 0,
        i = -1,
        r = e(),
        n = e('<div class="sortable-placeholder">'),
        e.fn.sortable = function(s, o, a) {
            var l;
            return l = void 0,
            r = r.add(n),
            e("body").on("dragstart", s,
            function(n) {
                if (!e(this).hasClass("last_child") && "false" !== e(this).attr("draggable")) return t = e(this).parent(),
                i = -1,
                l = t.index() + 1,
                n.originalEvent.dataTransfer.setData("text/plain", "Mockingbot")
            }),
            e("body").on("dragend", s,
            function(e) {
                var n, s;
                if (e.preventDefault(), e.stopPropagation(), t.show(), n = t.data("cid"), s = r.filter(":visible").closest(".sli").data("cid") || null, r.detach(), t = null, i >= 0) return a(n, i, s)
            }),
            e("body").on("dragover dragenter", s,
            function() {
                var i, s, a, l;
                if (t && o.exists(t.data("cid"))) return t.hide(),
                s = o.find(t.data("cid")),
                a = o.find(e(this).data("cid")),
                s.parent_cid ? s.parent_cid && e(this).closest(".children").length ? e(this).hasClass("last_child") ? n.parent().data("cid") === e(this).closest(".sli").data("cid") && n.index() < e(this).index() ? e(this).closest(".sli").after(n) : e(this).before(n) : (i = e(this).parent(), i[n.index() < i.index() ? "after": "before"](n)) : (l = e(this).parent(), n.index() > l.index() || n.closest(".children").length ? l.before(n) : e(this).hasClass("expanded") ? e(this).next().prepend(n) : l.after(n)) : e(this).hasClass("last_child") || a && a.parent_cid ? e(this).hasClass("last_child") ? n.parent().data("cid") === e(this).closest(".sli").data("cid") && n.index() < e(this).index() ? e(this).closest(".sli").after(n) : e(this).before(n) : (i = e(this).parent(), i[n.index() < i.index() ? "after": "before"](n)) : (l = e(this).closest(".sli"), n.index() > l.index() || n.closest(".children").length ? l.before(n) : e(this).hasClass("expanded") ? e(this).next().prepend(n) : l.after(n)),
                r.not(n).detach()
            }),
            e("body").on("dragover", ".sortable-placeholder",
            function(e) {
                return e.preventDefault(),
                e.originalEvent.dataTransfer.dropEffect = "move"
            }),
            e("body").on("drop", ".sortable-placeholder",
            function(e) {
                var n, s;
                if (e.preventDefault(), e.stopPropagation(), i = r.filter(":visible").index() + 1, s = r.filter(":visible").parent().data("cid"), n = t.parent().data("cid"), i > l && s === n) return i -= 1
            })
        }
    } (jQuery)
}.call(this),
$(function() {
    jQuery.timeago.settings.strings["zh-CN"] = {
        prefixAgo: null,
        prefixFromNow: "\u4ece\u73b0\u5728\u5f00\u59cb",
        suffixAgo: "\u4e4b\u524d",
        suffixFromNow: null,
        seconds: "\u4e0d\u5230 1 \u5206\u949f",
        minute: "\u5927\u7ea6 1 \u5206\u949f",
        minutes: "%d \u5206\u949f",
        hour: "\u5927\u7ea6 1 \u5c0f\u65f6",
        hours: "\u5927\u7ea6 %d \u5c0f\u65f6",
        day: "1 \u5929",
        days: "%d \u5929",
        month: "\u5927\u7ea6 1 \u4e2a\u6708",
        months: "%d \u6708",
        year: "\u5927\u7ea6 1 \u5e74",
        years: "%d \u5e74",
        numbers: [],
        wordSeparator: ""
    }
}),
!
function(e) {
    e.fn.niceSelect = function(t) {
        function i(t) {
            t.after(e("<div></div>").addClass("nice-select").addClass(t.attr("class") || "").addClass(t.attr("disabled") ? "disabled": "").attr("tabindex", t.attr("disabled") ? null: "0").html('<span class="current"></span><ul class="list"></ul>'));
            var i = t.next(),
            n = t.find("option"),
            r = t.find("option:selected");
            i.find(".current").html(r.data("display") || r.text()),
            n.each(function() {
                var t = e(this),
                n = t.data("display");
                i.find("ul").append(e("<li></li>").attr("data-value", t.val()).attr("data-display", n || null).addClass("option" + (t.is(":selected") ? " selected": "") + (t.is(":disabled") ? " disabled": "")).html(t.text()))
            })
        }
        if ("string" == typeof t) return "update" == t ? this.each(function() {
            var t = e(this),
            n = e(this).next(".nice-select"),
            r = n.hasClass("open");
            n.length && (n.remove(), i(t), r && t.next().trigger("click"))
        }) : "destroy" == t ? (this.each(function() {
            var t = e(this),
            i = e(this).next(".nice-select");
            i.length && (i.remove(), t.css("display", ""))
        }), 0 == e(".nice-select").length && e(document).off(".nice_select")) : console.log('Method "' + t + '" does not exist.'),
        this;
        this.hide(),
        this.each(function() {
            var t = e(this);
            t.next().hasClass("nice-select") || i(t)
        }),
        e(document).off(".nice_select"),
        e(document).on("click.nice_select", ".nice-select",
        function() {
            var t = e(this);
            e(".nice-select").not(t).removeClass("open"),
            t.toggleClass("open"),
            t.hasClass("open") ? (t.find(".option"), t.find(".focus").removeClass("focus"), t.find(".selected").addClass("focus")) : t.focus()
        }),
        e(document).on("click.nice_select",
        function(t) {
            0 === e(t.target).closest(".nice-select").length && e(".nice-select").removeClass("open").find(".option")
        }),
        e(document).on("click.nice_select", ".nice-select .option:not(.disabled)",
        function() {
            var t = e(this),
            i = t.closest(".nice-select");
            i.find(".selected").removeClass("selected"),
            t.addClass("selected");
            var n = t.data("display") || t.text();
            i.find(".current").text(n),
            i.prev("select").val(t.data("value")).trigger("change")
        }),
        e(document).on("keydown.nice_select", ".nice-select",
        function(t) {
            var i = e(this),
            n = e(i.find(".focus") || i.find(".list .option.selected"));
            if (32 == t.keyCode || 13 == t.keyCode) return i.hasClass("open") ? n.trigger("click") : i.trigger("click"),
            !1;
            if (40 == t.keyCode) {
                if (i.hasClass("open")) {
                    var r = n.nextAll(".option:not(.disabled)").first();
                    r.length > 0 && (i.find(".focus").removeClass("focus"), r.addClass("focus"))
                } else i.trigger("click");
                return ! 1
            }
            if (38 == t.keyCode) {
                if (i.hasClass("open")) {
                    var s = n.prevAll(".option:not(.disabled)").first();
                    s.length > 0 && (i.find(".focus").removeClass("focus"), s.addClass("focus"))
                } else i.trigger("click");
                return ! 1
            }
            if (27 == t.keyCode) i.hasClass("open") && i.trigger("click");
            else if (9 == t.keyCode && i.hasClass("open")) return ! 1
        });
        var n = document.createElement("a").style;
        return n.cssText = "pointer-events:auto",
        "auto" !== n.pointerEvents && e("html").addClass("no-csspointerevents"),
        this
    }
} (jQuery),
!
function(e, t, i, n) {
    "use strict";
    function r(e, t, i) {
        return setTimeout(c(e, i), t)
    }
    function s(e, t, i) {
        return !! Array.isArray(e) && (o(e, i[t], i), !0)
    }
    function o(e, t, i) {
        var r;
        if (e) if (e.forEach) e.forEach(t, i);
        else if (e.length !== n) for (r = 0; r < e.length;) t.call(i, e[r], r, e),
        r++;
        else for (r in e) e.hasOwnProperty(r) && t.call(i, e[r], r, e)
    }
    function a(t, i, n) {
        var r = "DEPRECATED METHOD: " + i + "\n" + n + " AT \n";
        return function() {
            var i = new Error("get-stack-trace"),
            n = i && i.stack ? i.stack.replace(/^[^\(]+?[\n$]/gm, "").replace(/^\s+at\s+/gm, "").replace(/^Object.<anonymous>\s*\(/gm, "{anonymous}()@") : "Unknown Stack Trace",
            s = e.console && (e.console.warn || e.console.log);
            return s && s.call(e.console, r, n),
            t.apply(this, arguments)
        }
    }
    function l(e, t, i) {
        var n, r = t.prototype;
        n = e.prototype = Object.create(r),
        n.constructor = e,
        n._super = r,
        i && ue(n, i)
    }
    function c(e, t) {
        return function() {
            return e.apply(t, arguments)
        }
    }
    function d(e, t) {
        return typeof e == fe ? e.apply(t ? t[0] || n: n, t) : e
    }
    function u(e, t) {
        return e === n ? t: e
    }
    function h(e, t, i) {
        o(m(t),
        function(t) {
            e.addEventListener(t, i, !1)
        })
    }
    function p(e, t, i) {
        o(m(t),
        function(t) {
            e.removeEventListener(t, i, !1)
        })
    }
    function f(e, t) {
        for (; e;) {
            if (e == t) return ! 0;
            e = e.parentNode
        }
        return ! 1
    }
    function g(e, t) {
        return e.indexOf(t) > -1
    }
    function m(e) {
        return e.trim().split(/\s+/g)
    }
    function v(e, t, i) {
        if (e.indexOf && !i) return e.indexOf(t);
        for (var n = 0; n < e.length;) {
            if (i && e[n][i] == t || !i && e[n] === t) return n;
            n++
        }
        return - 1
    }
    function b(e) {
        return Array.prototype.slice.call(e, 0)
    }
    function y(e, t, i) {
        for (var n = [], r = [], s = 0; s < e.length;) {
            var o = t ? e[s][t] : e[s];
            v(r, o) < 0 && n.push(e[s]),
            r[s] = o,
            s++
        }
        return i && (n = t ? n.sort(function(e, i) {
            return e[t] > i[t]
        }) : n.sort()),
        n
    }
    function _(e, t) {
        for (var i, r, s = t[0].toUpperCase() + t.slice(1), o = 0; o < he.length;) {
            if (i = he[o], r = i ? i + s: t, r in e) return r;
            o++
        }
        return n
    }
    function w() {
        return _e++
    }
    function M(t) {
        var i = t.ownerDocument || t;
        return i.defaultView || i.parentWindow || e
    }
    function x(e, t) {
        var i = this;
        this.manager = e,
        this.callback = t,
        this.element = e.element,
        this.target = e.options.inputTarget,
        this.domHandler = function(t) {
            d(e.options.enable, [e]) && i.handler(t)
        },
        this.init()
    }
    function B(e) {
        var t, i = e.options.inputClass;
        return new(t = i ? i: xe ? z: Be ? O: Me ? F: D)(e, k)
    }
    function k(e, t, i) {
        var n = i.pointers.length,
        r = i.changedPointers.length,
        s = t & Ie && n - r === 0,
        o = t & (Ne | Te) && n - r === 0;
        i.isFirst = !!s,
        i.isFinal = !!o,
        s && (e.session = {}),
        i.eventType = t,
        S(e, i),
        e.emit("hammer.input", i),
        e.recognize(i),
        e.session.prevInput = i
    }
    function S(e, t) {
        var i = e.session,
        n = t.pointers,
        r = n.length;
        i.firstInput || (i.firstInput = R(t)),
        r > 1 && !i.firstMultiple ? i.firstMultiple = R(t) : 1 === r && (i.firstMultiple = !1);
        var s = i.firstInput,
        o = i.firstMultiple,
        a = o ? o.center: s.center,
        l = t.center = I(n);
        t.timeStamp = ve(),
        t.deltaTime = t.timeStamp - s.timeStamp,
        t.angle = P(a, l),
        t.distance = T(a, l),
        E(i, t),
        t.offsetDirection = N(t.deltaX, t.deltaY);
        var c = $(t.deltaTime, t.deltaX, t.deltaY);
        t.overallVelocityX = c.x,
        t.overallVelocityY = c.y,
        t.overallVelocity = me(c.x) > me(c.y) ? c.x: c.y,
        t.scale = o ? L(o.pointers, n) : 1,
        t.rotation = o ? A(o.pointers, n) : 0,
        t.maxPointers = i.prevInput ? t.pointers.length > i.prevInput.maxPointers ? t.pointers.length: i.prevInput.maxPointers: t.pointers.length,
        C(i, t);
        var d = e.element;
        f(t.srcEvent.target, d) && (d = t.srcEvent.target),
        t.target = d
    }
    function E(e, t) {
        var i = t.center,
        n = e.offsetDelta || {},
        r = e.prevDelta || {},
        s = e.prevInput || {};
        t.eventType !== Ie && s.eventType !== Ne || (r = e.prevDelta = {
            x: s.deltaX || 0,
            y: s.deltaY || 0
        },
        n = e.offsetDelta = {
            x: i.x,
            y: i.y
        }),
        t.deltaX = r.x + (i.x - n.x),
        t.deltaY = r.y + (i.y - n.y)
    }
    function C(e, t) {
        var i, r, s, o, a = e.lastInterval || t,
        l = t.timeStamp - a.timeStamp;
        if (t.eventType != Te && (l > Re || a.velocity === n)) {
            var c = t.deltaX - a.deltaX,
            d = t.deltaY - a.deltaY,
            u = $(l, c, d);
            r = u.x,
            s = u.y,
            i = me(u.x) > me(u.y) ? u.x: u.y,
            o = N(c, d),
            e.lastInterval = t
        } else i = a.velocity,
        r = a.velocityX,
        s = a.velocityY,
        o = a.direction;
        t.velocity = i,
        t.velocityX = r,
        t.velocityY = s,
        t.direction = o
    }
    function R(e) {
        for (var t = [], i = 0; i < e.pointers.length;) t[i] = {
            clientX: ge(e.pointers[i].clientX),
            clientY: ge(e.pointers[i].clientY)
        },
        i++;
        return {
            timeStamp: ve(),
            pointers: t,
            center: I(t),
            deltaX: e.deltaX,
            deltaY: e.deltaY
        }
    }
    function I(e) {
        var t = e.length;
        if (1 === t) return {
            x: ge(e[0].clientX),
            y: ge(e[0].clientY)
        };
        for (var i = 0,
        n = 0,
        r = 0; t > r;) i += e[r].clientX,
        n += e[r].clientY,
        r++;
        return {
            x: ge(i / t),
            y: ge(n / t)
        }
    }
    function $(e, t, i) {
        return {
            x: t / e || 0,
            y: i / e || 0
        }
    }
    function N(e, t) {
        return e === t ? Pe: me(e) >= me(t) ? 0 > e ? Ae: Le: 0 > t ? De: ze
    }
    function T(e, t, i) {
        i || (i = He);
        var n = t[i[0]] - e[i[0]],
        r = t[i[1]] - e[i[1]];
        return Math.sqrt(n * n + r * r)
    }
    function P(e, t, i) {
        i || (i = He);
        var n = t[i[0]] - e[i[0]],
        r = t[i[1]] - e[i[1]];
        return 180 * Math.atan2(r, n) / Math.PI
    }
    function A(e, t) {
        return P(t[1], t[0], Fe) + P(e[1], e[0], Fe)
    }
    function L(e, t) {
        return T(t[0], t[1], Fe) / T(e[0], e[1], Fe)
    }
    function D() {
        this.evEl = Xe,
        this.evWin = Ue,
        this.pressed = !1,
        x.apply(this, arguments)
    }
    function z() {
        this.evEl = Ke,
        this.evWin = Ge,
        x.apply(this, arguments),
        this.store = this.manager.session.pointerEvents = []
    }
    function j() {
        this.evTarget = Qe,
        this.evWin = Ze,
        this.started = !1,
        x.apply(this, arguments)
    }
    function W(e, t) {
        var i = b(e.touches),
        n = b(e.changedTouches);
        return t & (Ne | Te) && (i = y(i.concat(n), "identifier", !0)),
        [i, n]
    }
    function O() {
        this.evTarget = tt,
        this.targetIds = {},
        x.apply(this, arguments)
    }
    function H(e, t) {
        var i = b(e.touches),
        n = this.targetIds;
        if (t & (Ie | $e) && 1 === i.length) return n[i[0].identifier] = !0,
        [i, i];
        var r, s, o = b(e.changedTouches),
        a = [],
        l = this.target;
        if (s = i.filter(function(e) {
            return f(e.target, l)
        }), t === Ie) for (r = 0; r < s.length;) n[s[r].identifier] = !0,
        r++;
        for (r = 0; r < o.length;) n[o[r].identifier] && a.push(o[r]),
        t & (Ne | Te) && delete n[o[r].identifier],
        r++;
        return a.length ? [y(s.concat(a), "identifier", !0), a] : void 0
    }
    function F() {
        x.apply(this, arguments);
        var e = c(this.handler, this);
        this.touch = new O(this.manager, e),
        this.mouse = new D(this.manager, e),
        this.primaryTouch = null,
        this.lastTouches = []
    }
    function Y(e, t) {
        e & Ie ? (this.primaryTouch = t.changedPointers[0].identifier, X.call(this, t)) : e & (Ne | Te) && X.call(this, t)
    }
    function X(e) {
        var t = e.changedPointers[0];
        if (t.identifier === this.primaryTouch) {
            var i = {
                x: t.clientX,
                y: t.clientY
            };
            this.lastTouches.push(i);
            var n = this.lastTouches,
            r = function() {
                var e = n.indexOf(i);
                e > -1 && n.splice(e, 1)
            };
            setTimeout(r, it)
        }
    }
    function U(e) {
        for (var t = e.srcEvent.clientX,
        i = e.srcEvent.clientY,
        n = 0; n < this.lastTouches.length; n++) {
            var r = this.lastTouches[n],
            s = Math.abs(t - r.x),
            o = Math.abs(i - r.y);
            if (nt >= s && nt >= o) return ! 0
        }
        return ! 1
    }
    function V(e, t) {
        this.manager = e,
        this.set(t)
    }
    function q(e) {
        if (g(e, ct)) return ct;
        var t = g(e, dt),
        i = g(e, ut);
        return t && i ? ct: t || i ? t ? dt: ut: g(e, lt) ? lt: at
    }
    function K() {
        if (!st) return ! 1;
        var t = {},
        i = e.CSS && e.CSS.supports;
        return ["auto", "manipulation", "pan-y", "pan-x", "pan-x pan-y", "none"].forEach(function(n) {
            t[n] = !i || e.CSS.supports("touch-action", n)
        }),
        t
    }
    function G(e) {
        this.options = ue({},
        this.defaults, e || {}),
        this.id = w(),
        this.manager = null,
        this.options.enable = u(this.options.enable, !0),
        this.state = pt,
        this.simultaneous = {},
        this.requireFail = []
    }
    function J(e) {
        return e & bt ? "cancel": e & mt ? "end": e & gt ? "move": e & ft ? "start": ""
    }
    function Q(e) {
        return e == ze ? "down": e == De ? "up": e == Ae ? "left": e == Le ? "right": ""
    }
    function Z(e, t) {
        var i = t.manager;
        return i ? i.get(e) : e
    }
    function ee() {
        G.apply(this, arguments)
    }
    function te() {
        ee.apply(this, arguments),
        this.pX = null,
        this.pY = null
    }
    function ie() {
        ee.apply(this, arguments)
    }
    function ne() {
        G.apply(this, arguments),
        this._timer = null,
        this._input = null
    }
    function re() {
        ee.apply(this, arguments)
    }
    function se() {
        ee.apply(this, arguments)
    }
    function oe() {
        G.apply(this, arguments),
        this.pTime = !1,
        this.pCenter = !1,
        this._timer = null,
        this._input = null,
        this.count = 0
    }
    function ae(e, t) {
        return t = t || {},
        t.recognizers = u(t.recognizers, ae.defaults.preset),
        new le(e, t)
    }
    function le(e, t) {
        this.options = ue({},
        ae.defaults, t || {}),
        this.options.inputTarget = this.options.inputTarget || e,
        this.handlers = {},
        this.session = {},
        this.recognizers = [],
        this.oldCssProps = {},
        this.element = e,
        this.input = B(this),
        this.touchAction = new V(this, this.options.touchAction),
        ce(this, !0),
        o(this.options.recognizers,
        function(e) {
            var t = this.add(new e[0](e[1]));
            e[2] && t.recognizeWith(e[2]),
            e[3] && t.requireFailure(e[3])
        },
        this)
    }
    function ce(e, t) {
        var i = e.element;
        if (i.style) {
            var n;
            o(e.options.cssProps,
            function(r, s) {
                n = _(i.style, s),
                t ? (e.oldCssProps[n] = i.style[n], i.style[n] = r) : i.style[n] = e.oldCssProps[n] || ""
            }),
            t || (e.oldCssProps = {})
        }
    }
    function de(e, i) {
        var n = t.createEvent("Event");
        n.initEvent(e, !0, !0),
        n.gesture = i,
        i.target.dispatchEvent(n)
    }
    var ue, he = ["", "webkit", "Moz", "MS", "ms", "o"],
    pe = t.createElement("div"),
    fe = "function",
    ge = Math.round,
    me = Math.abs,
    ve = Date.now;
    ue = "function" != typeof Object.assign ?
    function(e) {
        if (e === n || null === e) throw new TypeError("Cannot convert undefined or null to object");
        for (var t = Object(e), i = 1; i < arguments.length; i++) {
            var r = arguments[i];
            if (r !== n && null !== r) for (var s in r) r.hasOwnProperty(s) && (t[s] = r[s])
        }
        return t
    }: Object.assign;
    var be = a(function(e, t, i) {
        for (var r = Object.keys(t), s = 0; s < r.length;)(!i || i && e[r[s]] === n) && (e[r[s]] = t[r[s]]),
        s++;
        return e
    },
    "extend", "Use `assign`."),
    ye = a(function(e, t) {
        return be(e, t, !0)
    },
    "merge", "Use `assign`."),
    _e = 1,
    we = /mobile|tablet|ip(ad|hone|od)|android/i,
    Me = "ontouchstart" in e,
    xe = _(e, "PointerEvent") !== n,
    Be = Me && we.test(navigator.userAgent),
    ke = "touch",
    Se = "pen",
    Ee = "mouse",
    Ce = "kinect",
    Re = 25,
    Ie = 1,
    $e = 2,
    Ne = 4,
    Te = 8,
    Pe = 1,
    Ae = 2,
    Le = 4,
    De = 8,
    ze = 16,
    je = Ae | Le,
    We = De | ze,
    Oe = je | We,
    He = ["x", "y"],
    Fe = ["clientX", "clientY"];
    x.prototype = {
        handler: function() {},
        init: function() {
            this.evEl && h(this.element, this.evEl, this.domHandler),
            this.evTarget && h(this.target, this.evTarget, this.domHandler),
            this.evWin && h(M(this.element), this.evWin, this.domHandler)
        },
        destroy: function() {
            this.evEl && p(this.element, this.evEl, this.domHandler),
            this.evTarget && p(this.target, this.evTarget, this.domHandler),
            this.evWin && p(M(this.element), this.evWin, this.domHandler)
        }
    };
    var Ye = {
        mousedown: Ie,
        mousemove: $e,
        mouseup: Ne
    },
    Xe = "mousedown",
    Ue = "mousemove mouseup";
    l(D, x, {
        handler: function(e) {
            var t = Ye[e.type];
            t & Ie && 0 === e.button && (this.pressed = !0),
            t & $e && 1 !== e.which && (t = Ne),
            this.pressed && (t & Ne && (this.pressed = !1), this.callback(this.manager, t, {
                pointers: [e],
                changedPointers: [e],
                pointerType: Ee,
                srcEvent: e
            }))
        }
    });
    var Ve = {
        pointerdown: Ie,
        pointermove: $e,
        pointerup: Ne,
        pointercancel: Te,
        pointerout: Te
    },
    qe = {
        2 : ke,
        3 : Se,
        4 : Ee,
        5 : Ce
    },
    Ke = "pointerdown",
    Ge = "pointermove pointerup pointercancel";
    e.MSPointerEvent && !e.PointerEvent && (Ke = "MSPointerDown", Ge = "MSPointerMove MSPointerUp MSPointerCancel"),
    l(z, x, {
        handler: function(e) {
            var t = this.store,
            i = !1,
            n = e.type.toLowerCase().replace("ms", ""),
            r = Ve[n],
            s = qe[e.pointerType] || e.pointerType,
            o = s == ke,
            a = v(t, e.pointerId, "pointerId");
            r & Ie && (0 === e.button || o) ? 0 > a && (t.push(e), a = t.length - 1) : r & (Ne | Te) && (i = !0),
            0 > a || (t[a] = e, this.callback(this.manager, r, {
                pointers: t,
                changedPointers: [e],
                pointerType: s,
                srcEvent: e
            }), i && t.splice(a, 1))
        }
    });
    var Je = {
        touchstart: Ie,
        touchmove: $e,
        touchend: Ne,
        touchcancel: Te
    },
    Qe = "touchstart",
    Ze = "touchstart touchmove touchend touchcancel";
    l(j, x, {
        handler: function(e) {
            var t = Je[e.type];
            if (t === Ie && (this.started = !0), this.started) {
                var i = W.call(this, e, t);
                t & (Ne | Te) && i[0].length - i[1].length === 0 && (this.started = !1),
                this.callback(this.manager, t, {
                    pointers: i[0],
                    changedPointers: i[1],
                    pointerType: ke,
                    srcEvent: e
                })
            }
        }
    });
    var et = {
        touchstart: Ie,
        touchmove: $e,
        touchend: Ne,
        touchcancel: Te
    },
    tt = "touchstart touchmove touchend touchcancel";
    l(O, x, {
        handler: function(e) {
            var t = et[e.type],
            i = H.call(this, e, t);
            i && this.callback(this.manager, t, {
                pointers: i[0],
                changedPointers: i[1],
                pointerType: ke,
                srcEvent: e
            })
        }
    });
    var it = 2500,
    nt = 25;
    l(F, x, {
        handler: function(e, t, i) {
            var n = i.pointerType == ke,
            r = i.pointerType == Ee;
            if (! (r && i.sourceCapabilities && i.sourceCapabilities.firesTouchEvents)) {
                if (n) Y.call(this, t, i);
                else if (r && U.call(this, i)) return;
                this.callback(e, t, i)
            }
        },
        destroy: function() {
            this.touch.destroy(),
            this.mouse.destroy()
        }
    });
    var rt = _(pe.style, "touchAction"),
    st = rt !== n,
    ot = "compute",
    at = "auto",
    lt = "manipulation",
    ct = "none",
    dt = "pan-x",
    ut = "pan-y",
    ht = K();
    V.prototype = {
        set: function(e) {
            e == ot && (e = this.compute()),
            st && this.manager.element.style && ht[e] && (this.manager.element.style[rt] = e),
            this.actions = e.toLowerCase().trim()
        },
        update: function() {
            this.set(this.manager.options.touchAction)
        },
        compute: function() {
            var e = [];
            return o(this.manager.recognizers,
            function(t) {
                d(t.options.enable, [t]) && (e = e.concat(t.getTouchAction()))
            }),
            q(e.join(" "))
        },
        preventDefaults: function(e) {
            var t = e.srcEvent,
            i = e.offsetDirection;
            if (this.manager.session.prevented) return void t.preventDefault();
            var n = this.actions,
            r = g(n, ct) && !ht[ct],
            s = g(n, ut) && !ht[ut],
            o = g(n, dt) && !ht[dt];
            if (r) {
                var a = 1 === e.pointers.length,
                l = e.distance < 2,
                c = e.deltaTime < 250;
                if (a && l && c) return
            }
            return o && s ? void 0 : r || s && i & je || o && i & We ? this.preventSrc(t) : void 0
        },
        preventSrc: function(e) {
            this.manager.session.prevented = !0,
            e.preventDefault()
        }
    };
    var pt = 1,
    ft = 2,
    gt = 4,
    mt = 8,
    vt = mt,
    bt = 16,
    yt = 32;
    G.prototype = {
        defaults: {},
        set: function(e) {
            return ue(this.options, e),
            this.manager && this.manager.touchAction.update(),
            this
        },
        recognizeWith: function(e) {
            if (s(e, "recognizeWith", this)) return this;
            var t = this.simultaneous;
            return e = Z(e, this),
            t[e.id] || (t[e.id] = e, e.recognizeWith(this)),
            this
        },
        dropRecognizeWith: function(e) {
            return s(e, "dropRecognizeWith", this) ? this: (e = Z(e, this), delete this.simultaneous[e.id], this)
        },
        requireFailure: function(e) {
            if (s(e, "requireFailure", this)) return this;
            var t = this.requireFail;
            return e = Z(e, this),
            -1 === v(t, e) && (t.push(e), e.requireFailure(this)),
            this
        },
        dropRequireFailure: function(e) {
            if (s(e, "dropRequireFailure", this)) return this;
            e = Z(e, this);
            var t = v(this.requireFail, e);
            return t > -1 && this.requireFail.splice(t, 1),
            this
        },
        hasRequireFailures: function() {
            return this.requireFail.length > 0
        },
        canRecognizeWith: function(e) {
            return !! this.simultaneous[e.id]
        },
        emit: function(e) {
            function t(t) {
                i.manager.emit(t, e)
            }
            var i = this,
            n = this.state;
            mt > n && t(i.options.event + J(n)),
            t(i.options.event),
            e.additionalEvent && t(e.additionalEvent),
            n >= mt && t(i.options.event + J(n))
        },
        tryEmit: function(e) {
            return this.canEmit() ? this.emit(e) : void(this.state = yt)
        },
        canEmit: function() {
            for (var e = 0; e < this.requireFail.length;) {
                if (! (this.requireFail[e].state & (yt | pt))) return ! 1;
                e++
            }
            return ! 0
        },
        recognize: function(e) {
            var t = ue({},
            e);
            return d(this.options.enable, [this, t]) ? (this.state & (vt | bt | yt) && (this.state = pt), this.state = this.process(t), void(this.state & (ft | gt | mt | bt) && this.tryEmit(t))) : (this.reset(), void(this.state = yt))
        },
        process: function() {},
        getTouchAction: function() {},
        reset: function() {}
    },
    l(ee, G, {
        defaults: {
            pointers: 1
        },
        attrTest: function(e) {
            var t = this.options.pointers;
            return 0 === t || e.pointers.length === t
        },
        process: function(e) {
            var t = this.state,
            i = e.eventType,
            n = t & (ft | gt),
            r = this.attrTest(e);
            return n && (i & Te || !r) ? t | bt: n || r ? i & Ne ? t | mt: t & ft ? t | gt: ft: yt
        }
    }),
    l(te, ee, {
        defaults: {
            event: "pan",
            threshold: 10,
            pointers: 1,
            direction: Oe
        },
        getTouchAction: function() {
            var e = this.options.direction,
            t = [];
            return e & je && t.push(ut),
            e & We && t.push(dt),
            t
        },
        directionTest: function(e) {
            var t = this.options,
            i = !0,
            n = e.distance,
            r = e.direction,
            s = e.deltaX,
            o = e.deltaY;
            return r & t.direction || (t.direction & je ? (r = 0 === s ? Pe: 0 > s ? Ae: Le, i = s != this.pX, n = Math.abs(e.deltaX)) : (r = 0 === o ? Pe: 0 > o ? De: ze, i = o != this.pY, n = Math.abs(e.deltaY))),
            e.direction = r,
            i && n > t.threshold && r & t.direction
        },
        attrTest: function(e) {
            return ee.prototype.attrTest.call(this, e) && (this.state & ft || !(this.state & ft) && this.directionTest(e))
        },
        emit: function(e) {
            this.pX = e.deltaX,
            this.pY = e.deltaY;
            var t = Q(e.direction);
            t && (e.additionalEvent = this.options.event + t),
            this._super.emit.call(this, e)
        }
    }),
    l(ie, ee, {
        defaults: {
            event: "pinch",
            threshold: 0,
            pointers: 2
        },
        getTouchAction: function() {
            return [ct]
        },
        attrTest: function(e) {
            return this._super.attrTest.call(this, e) && (Math.abs(e.scale - 1) > this.options.threshold || this.state & ft)
        },
        emit: function(e) {
            if (1 !== e.scale) {
                var t = e.scale < 1 ? "in": "out";
                e.additionalEvent = this.options.event + t
            }
            this._super.emit.call(this, e)
        }
    }),
    l(ne, G, {
        defaults: {
            event: "press",
            pointers: 1,
            time: 251,
            threshold: 9
        },
        getTouchAction: function() {
            return [at]
        },
        process: function(e) {
            var t = this.options,
            i = e.pointers.length === t.pointers,
            n = e.distance < t.threshold,
            s = e.deltaTime > t.time;
            if (this._input = e, !n || !i || e.eventType & (Ne | Te) && !s) this.reset();
            else if (e.eventType & Ie) this.reset(),
            this._timer = r(function() {
                this.state = vt,
                this.tryEmit()
            },
            t.time, this);
            else if (e.eventType & Ne) return vt;
            return yt
        },
        reset: function() {
            clearTimeout(this._timer)
        },
        emit: function(e) {
            this.state === vt && (e && e.eventType & Ne ? this.manager.emit(this.options.event + "up", e) : (this._input.timeStamp = ve(), this.manager.emit(this.options.event, this._input)))
        }
    }),
    l(re, ee, {
        defaults: {
            event: "rotate",
            threshold: 0,
            pointers: 2
        },
        getTouchAction: function() {
            return [ct]
        },
        attrTest: function(e) {
            return this._super.attrTest.call(this, e) && (Math.abs(e.rotation) > this.options.threshold || this.state & ft)
        }
    }),
    l(se, ee, {
        defaults: {
            event: "swipe",
            threshold: 10,
            velocity: .3,
            direction: je | We,
            pointers: 1
        },
        getTouchAction: function() {
            return te.prototype.getTouchAction.call(this)
        },
        attrTest: function(e) {
            var t, i = this.options.direction;
            return i & (je | We) ? t = e.overallVelocity: i & je ? t = e.overallVelocityX: i & We && (t = e.overallVelocityY),
            this._super.attrTest.call(this, e) && i & e.offsetDirection && e.distance > this.options.threshold && e.maxPointers == this.options.pointers && me(t) > this.options.velocity && e.eventType & Ne
        },
        emit: function(e) {
            var t = Q(e.offsetDirection);
            t && this.manager.emit(this.options.event + t, e),
            this.manager.emit(this.options.event, e)
        }
    }),
    l(oe, G, {
        defaults: {
            event: "tap",
            pointers: 1,
            taps: 1,
            interval: 300,
            time: 250,
            threshold: 9,
            posThreshold: 10
        },
        getTouchAction: function() {
            return [lt]
        },
        process: function(e) {
            var t = this.options,
            i = e.pointers.length === t.pointers,
            n = e.distance < t.threshold,
            s = e.deltaTime < t.time;
            if (this.reset(), e.eventType & Ie && 0 === this.count) return this.failTimeout();
            if (n && s && i) {
                if (e.eventType != Ne) return this.failTimeout();
                var o = !this.pTime || e.timeStamp - this.pTime < t.interval,
                a = !this.pCenter || T(this.pCenter, e.center) < t.posThreshold;
                this.pTime = e.timeStamp,
                this.pCenter = e.center,
                a && o ? this.count += 1 : this.count = 1,
                this._input = e;
                var l = this.count % t.taps;
                if (0 === l) return this.hasRequireFailures() ? (this._timer = r(function() {
                    this.state = vt,
                    this.tryEmit()
                },
                t.interval, this), ft) : vt
            }
            return yt
        },
        failTimeout: function() {
            return this._timer = r(function() {
                this.state = yt
            },
            this.options.interval, this),
            yt
        },
        reset: function() {
            clearTimeout(this._timer)
        },
        emit: function() {
            this.state == vt && (this._input.tapCount = this.count, this.manager.emit(this.options.event, this._input))
        }
    }),
    ae.VERSION = "2.0.8",
    ae.defaults = {
        domEvents: !1,
        touchAction: ot,
        enable: !0,
        inputTarget: null,
        inputClass: null,
        preset: [[re, {
            enable: !1
        }], [ie, {
            enable: !1
        },
        ["rotate"]], [se, {
            direction: je
        }], [te, {
            direction: je
        },
        ["swipe"]], [oe], [oe, {
            event: "doubletap",
            taps: 2
        },
        ["tap"]], [ne]],
        cssProps: {
            userSelect: "none",
            touchSelect: "none",
            touchCallout: "none",
            contentZooming: "none",
            userDrag: "none",
            tapHighlightColor: "rgba(0,0,0,0)"
        }
    };
    var _t = 1,
    wt = 2;
    le.prototype = {
        set: function(e) {
            return ue(this.options, e),
            e.touchAction && this.touchAction.update(),
            e.inputTarget && (this.input.destroy(), this.input.target = e.inputTarget, this.input.init()),
            this
        },
        stop: function(e) {
            this.session.stopped = e ? wt: _t
        },
        recognize: function(e) {
            var t = this.session;
            if (!t.stopped) {
                this.touchAction.preventDefaults(e);
                var i, n = this.recognizers,
                r = t.curRecognizer; (!r || r && r.state & vt) && (r = t.curRecognizer = null);
                for (var s = 0; s < n.length;) i = n[s],
                t.stopped === wt || r && i != r && !i.canRecognizeWith(r) ? i.reset() : i.recognize(e),
                !r && i.state & (ft | gt | mt) && (r = t.curRecognizer = i),
                s++
            }
        },
        get: function(e) {
            if (e instanceof G) return e;
            for (var t = this.recognizers,
            i = 0; i < t.length; i++) if (t[i].options.event == e) return t[i];
            return null
        },
        add: function(e) {
            if (s(e, "add", this)) return this;
            var t = this.get(e.options.event);
            return t && this.remove(t),
            this.recognizers.push(e),
            e.manager = this,
            this.touchAction.update(),
            e
        },
        remove: function(e) {
            if (s(e, "remove", this)) return this;
            if (e = this.get(e)) {
                var t = this.recognizers,
                i = v(t, e); - 1 !== i && (t.splice(i, 1), this.touchAction.update())
            }
            return this
        },
        on: function(e, t) {
            if (e !== n && t !== n) {
                var i = this.handlers;
                return o(m(e),
                function(e) {
                    i[e] = i[e] || [],
                    i[e].push(t)
                }),
                this
            }
        },
        off: function(e, t) {
            if (e !== n) {
                var i = this.handlers;
                return o(m(e),
                function(e) {
                    t ? i[e] && i[e].splice(v(i[e], t), 1) : delete i[e]
                }),
                this
            }
        },
        emit: function(e, t) {
            this.options.domEvents && de(e, t);
            var i = this.handlers[e] && this.handlers[e].slice();
            if (i && i.length) {
                t.type = e,
                t.preventDefault = function() {
                    t.srcEvent.preventDefault()
                };
                for (var n = 0; n < i.length;) i[n](t),
                n++
            }
        },
        destroy: function() {
            this.element && ce(this, !1),
            this.handlers = {},
            this.session = {},
            this.input.destroy(),
            this.element = null
        }
    },
    ue(ae, {
        INPUT_START: Ie,
        INPUT_MOVE: $e,
        INPUT_END: Ne,
        INPUT_CANCEL: Te,
        STATE_POSSIBLE: pt,
        STATE_BEGAN: ft,
        STATE_CHANGED: gt,
        STATE_ENDED: mt,
        STATE_RECOGNIZED: vt,
        STATE_CANCELLED: bt,
        STATE_FAILED: yt,
        DIRECTION_NONE: Pe,
        DIRECTION_LEFT: Ae,
        DIRECTION_RIGHT: Le,
        DIRECTION_UP: De,
        DIRECTION_DOWN: ze,
        DIRECTION_HORIZONTAL: je,
        DIRECTION_VERTICAL: We,
        DIRECTION_ALL: Oe,
        Manager: le,
        Input: x,
        TouchAction: V,
        TouchInput: O,
        MouseInput: D,
        PointerEventInput: z,
        TouchMouseInput: F,
        SingleTouchInput: j,
        Recognizer: G,
        AttrRecognizer: ee,
        Tap: oe,
        Pan: te,
        Swipe: se,
        Pinch: ie,
        Rotate: re,
        Press: ne,
        on: h,
        off: p,
        each: o,
        merge: ye,
        extend: be,
        assign: ue,
        inherit: l,
        bindFn: c,
        prefixed: _
    });
    var Mt = "undefined" != typeof e ? e: "undefined" != typeof self ? self: {};
    Mt.Hammer = ae,
    "function" == typeof define && define.amd ? define(function() {
        return ae
    }) : "undefined" != typeof module && module.exports ? module.exports = ae: e[i] = ae
} (window, document, "Hammer"),
function(e) {
    e.widget("ui.draggable", e.ui.mouse, {
        version: "1.10.3",
        widgetEventPrefix: "drag",
        options: {
            addClasses: !0,
            appendTo: "parent",
            axis: !1,
            connectToSortable: !1,
            containment: !1,
            cursor: "auto",
            cursorAt: !1,
            grid: !1,
            handle: !1,
            helper: "original",
            iframeFix: !1,
            opacity: !1,
            refreshPositions: !1,
            revert: !1,
            revertDuration: 500,
            scope: "default",
            scroll: !0,
            scrollSensitivity: 20,
            scrollSpeed: 20,
            snap: !1,
            snapMode: "both",
            snapTolerance: 20,
            stack: !1,
            zIndex: !1,
            drag: null,
            start: null,
            stop: null
        },
        _create: function() {
            "original" !== this.options.helper || /^(?:r|a|f)/.test(this.element.css("position")) || (this.element[0].style.position = "relative"),
            this.options.addClasses && this.element.addClass("ui-draggable"),
            this.options.disabled && this.element.addClass("ui-draggable-disabled"),
            this._mouseInit()
        },
        _destroy: function() {
            this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),
            this._mouseDestroy()
        },
        _mouseCapture: function(t) {
            var i = this.options;
            return ! (this.helper || i.disabled || e(t.target).closest(".ui-resizable-handle").length > 0) && (this.handle = this._getHandle(t), !!this.handle && (e(i.iframeFix === !0 ? "iframe": i.iframeFix).each(function() {
                e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({
                    width: this.offsetWidth + "px",
                    height: this.offsetHeight + "px",
                    position: "absolute",
                    opacity: "0.001",
                    zIndex: 1e3
                }).css(e(this).offset()).appendTo("body")
            }), !0))
        },
        _mouseStart: function(t) {
            var i = this.options;
            return this.helper = this._createHelper(t),
            this.helper.addClass("ui-draggable-dragging"),
            this._cacheHelperProportions(),
            e.ui.ddmanager && (e.ui.ddmanager.current = this),
            this._cacheMargins(),
            this.cssPosition = this.helper.css("position"),
            this.scrollParent = this.helper.scrollParent(),
            this.offsetParent = this.helper.offsetParent(),
            this.offsetParentCssPosition = this.offsetParent.css("position"),
            this.offset = this.positionAbs = this.element.offset(),
            this.offset = {
                top: this.offset.top - this.margins.top,
                left: this.offset.left - this.margins.left
            },
            this.offset.scroll = !1,
            e.extend(this.offset, {
                click: {
                    left: t.pageX - this.offset.left,
                    top: t.pageY - this.offset.top
                },
                parent: this._getParentOffset(),
                relative: this._getRelativeOffset()
            }),
            this.originalPosition = this.position = this._generatePosition(t),
            this.originalPageX = t.pageX,
            this.originalPageY = t.pageY,
            i.cursorAt && this._adjustOffsetFromHelper(i.cursorAt),
            this._setContainment(),
            this._trigger("start", t) === !1 ? (this._clear(), !1) : (this._cacheHelperProportions(), e.ui.ddmanager && !i.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this._mouseDrag(t, !0), e.ui.ddmanager && e.ui.ddmanager.dragStart(this, t), !0)
        },
        _mouseDrag: function(t, i) {
            if ("fixed" === this.offsetParentCssPosition && (this.offset.parent = this._getParentOffset()), this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute"), !i) {
                var n = this._uiHash();
                if (this._trigger("drag", t, n) === !1) return this._mouseUp({}),
                !1;
                this.position = n.position
            }
            return this.options.refreshPositions && (this.options.axis && "y" === this.options.axis || (this.helper[0].style.left = this.position.left + "px"), this.options.axis && "x" === this.options.axis || (this.helper[0].style.top = this.position.top + "px")),
            e.ui.ddmanager && e.ui.ddmanager.drag(this, t),
            !1
        },
        _mouseStop: function(t) {
            var i = this,
            n = !1;
            return e.ui.ddmanager && !this.options.dropBehaviour && (n = e.ui.ddmanager.drop(this, t)),
            this.dropped && (n = this.dropped, this.dropped = !1),
            !("original" === this.options.helper && !e.contains(this.element[0].ownerDocument, this.element[0])) && ("invalid" === this.options.revert && !n || "valid" === this.options.revert && n || this.options.revert === !0 || e.isFunction(this.options.revert) && this.options.revert.call(this.element, n) ? e(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10),
            function() {
                i._trigger("stop", t) !== !1 && i._clear()
            }) : this._trigger("stop", t) !== !1 && this._clear(), !1)
        },
        _mouseUp: function(t) {
            return e("div.ui-draggable-iframeFix").each(function() {
                this.parentNode.removeChild(this)
            }),
            e.ui.ddmanager && e.ui.ddmanager.dragStop(this, t),
            e.ui.mouse.prototype._mouseUp.call(this, t)
        },
        cancel: function() {
            return this.helper.is(".ui-draggable-dragging") ? this._mouseUp({}) : this._clear(),
            this
        },
        _getHandle: function(t) {
            return ! this.options.handle || !!e(t.target).closest(this.element.find(this.options.handle)).length
        },
        _createHelper: function(t) {
            var i = this.options,
            n = e.isFunction(i.helper) ? e(i.helper.apply(this.element[0], [t])) : "clone" === i.helper ? this.element.clone().removeAttr("id") : this.element;
            return n.parents("body").length || n.appendTo("parent" === i.appendTo ? this.element[0].parentNode: i.appendTo),
            n[0] === this.element[0] || /(fixed|absolute)/.test(n.css("position")) || n.css("position", "absolute"),
            n
        },
        _adjustOffsetFromHelper: function(t) {
            "string" == typeof t && (t = t.split(" ")),
            e.isArray(t) && (t = {
                left: +t[0],
                top: +t[1] || 0
            }),
            "left" in t && (this.offset.click.left = t.left + this.margins.left),
            "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left),
            "top" in t && (this.offset.click.top = t.top + this.margins.top),
            "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top)
        },
        _getParentOffset: function() {
            var t = this.offsetParent.offset();
            return "absolute" === this.cssPosition && this.scrollParent[0] !== document && e.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop()),
            (this.offsetParent[0] === document.body || this.offsetParent[0].tagName && "html" === this.offsetParent[0].tagName.toLowerCase() && e.ui.ie) && (t = {
                top: 0,
                left: 0
            }),
            {
                top: t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),
                left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)
            }
        },
        _getRelativeOffset: function() {
            if ("relative" === this.cssPosition) {
                var e = this.element.position();
                return {
                    top: e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),
                    left: e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()
                }
            }
            return {
                top: 0,
                left: 0
            }
        },
        _cacheMargins: function() {
            this.margins = {
                left: parseInt(this.element.css("marginLeft"), 10) || 0,
                top: parseInt(this.element.css("marginTop"), 10) || 0,
                right: parseInt(this.element.css("marginRight"), 10) || 0,
                bottom: parseInt(this.element.css("marginBottom"), 10) || 0
            }
        },
        _cacheHelperProportions: function() {
            this.helperProportions = {
                width: this.helper.outerWidth(),
                height: this.helper.outerHeight()
            }
        },
        _setContainment: function() {
            var t, i, n, r = this.options;
            return r.containment ? "window" === r.containment ? void(this.containment = [e(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left, e(window).scrollTop() - this.offset.relative.top - this.offset.parent.top, e(window).scrollLeft() + e(window).width() - this.helperProportions.width - this.margins.left, e(window).scrollTop() + (e(window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]) : "document" === r.containment ? void(this.containment = [0, 0, e(document).width() - this.helperProportions.width - this.margins.left, (e(document).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]) : r.containment.constructor === Array ? void(this.containment = r.containment) : ("parent" === r.containment && (r.containment = this.helper[0].parentNode), i = e(r.containment), n = i[0], void(n && (t = "hidden" !== i.css("overflow"), this.containment = [(parseInt(i.css("borderLeftWidth"), 10) || 0) + (parseInt(i.css("paddingLeft"), 10) || 0), (parseInt(i.css("borderTopWidth"), 10) || 0) + (parseInt(i.css("paddingTop"), 10) || 0), (t ? Math.max(n.scrollWidth, n.offsetWidth) : n.offsetWidth) - (parseInt(i.css("borderRightWidth"), 10) || 0) - (parseInt(i.css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, (t ? Math.max(n.scrollHeight, n.offsetHeight) : n.offsetHeight) - (parseInt(i.css("borderBottomWidth"), 10) || 0) - (parseInt(i.css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom], this.relative_container = i))) : void(this.containment = null)
        },
        _convertPositionTo: function(t, i) {
            i || (i = this.position);
            var n = "absolute" === t ? 1 : -1,
            r = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent: this.offsetParent;
            return this.offset.scroll || (this.offset.scroll = {
                top: r.scrollTop(),
                left: r.scrollLeft()
            }),
            {
                top: i.top + this.offset.relative.top * n + this.offset.parent.top * n - ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : this.offset.scroll.top) * n,
                left: i.left + this.offset.relative.left * n + this.offset.parent.left * n - ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : this.offset.scroll.left) * n
            }
        },
        _generatePosition: function(t) {
            var i, n, r, s, o = this.options,
            a = "absolute" !== this.cssPosition || this.scrollParent[0] !== document && e.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent: this.offsetParent,
            l = t.pageX,
            c = t.pageY;
            return this.offset.scroll || (this.offset.scroll = {
                top: a.scrollTop(),
                left: a.scrollLeft()
            }),
            this.originalPosition && (this.containment && (this.relative_container ? (n = this.relative_container.offset(), i = [this.containment[0] + n.left, this.containment[1] + n.top, this.containment[2] + n.left, this.containment[3] + n.top]) : i = this.containment, t.pageX - this.offset.click.left < i[0] && (l = i[0] + this.offset.click.left), t.pageY - this.offset.click.top < i[1] && (c = i[1] + this.offset.click.top), t.pageX - this.offset.click.left > i[2] && (l = i[2] + this.offset.click.left), t.pageY - this.offset.click.top > i[3] && (c = i[3] + this.offset.click.top)), o.grid && (r = o.grid[1] ? this.originalPageY + Math.round((c - this.originalPageY) / o.grid[1]) * o.grid[1] : this.originalPageY, c = i ? r - this.offset.click.top >= i[1] || r - this.offset.click.top > i[3] ? r: r - this.offset.click.top >= i[1] ? r - o.grid[1] : r + o.grid[1] : r, s = o.grid[0] ? this.originalPageX + Math.round((l - this.originalPageX) / o.grid[0]) * o.grid[0] : this.originalPageX, l = i ? s - this.offset.click.left >= i[0] || s - this.offset.click.left > i[2] ? s: s - this.offset.click.left >= i[0] ? s - o.grid[0] : s + o.grid[0] : s)),
            {
                top: c - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + ("fixed" === this.cssPosition ? -this.scrollParent.scrollTop() : this.offset.scroll.top),
                left: l - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + ("fixed" === this.cssPosition ? -this.scrollParent.scrollLeft() : this.offset.scroll.left)
            }
        },
        _clear: function() {
            this.helper.removeClass("ui-draggable-dragging"),
            this.helper[0] === this.element[0] || this.cancelHelperRemoval || this.helper.remove(),
            this.helper = null,
            this.cancelHelperRemoval = !1
        },
        _trigger: function(t, i, n) {
            return n = n || this._uiHash(),
            e.ui.plugin.call(this, t, [i, n]),
            "drag" === t && (this.positionAbs = this._convertPositionTo("absolute")),
            e.Widget.prototype._trigger.call(this, t, i, n)
        },
        plugins: {},
        _uiHash: function() {
            return {
                helper: this.helper,
                position: this.position,
                originalPosition: this.originalPosition,
                offset: this.positionAbs
            }
        }
    }),
    e.ui.plugin.add("draggable", "connectToSortable", {
        start: function(t, i) {
            var n = e(this).data("ui-draggable"),
            r = n.options,
            s = e.extend({},
            i, {
                item: n.element
            });
            n.sortables = [],
            e(r.connectToSortable).each(function() {
                var i = e.data(this, "ui-sortable");
                i && !i.options.disabled && (n.sortables.push({
                    instance: i,
                    shouldRevert: i.options.revert
                }), i.refreshPositions(), i._trigger("activate", t, s))
            })
        },
        stop: function(t, i) {
            var n = e(this).data("ui-draggable"),
            r = e.extend({},
            i, {
                item: n.element
            });
            e.each(n.sortables,
            function() {
                this.instance.isOver ? (this.instance.isOver = 0, n.cancelHelperRemoval = !0, this.instance.cancelHelperRemoval = !1, this.shouldRevert && (this.instance.options.revert = this.shouldRevert), this.instance._mouseStop(t), this.instance.options.helper = this.instance.options._helper, "original" === n.options.helper && this.instance.currentItem.css({
                    top: "auto",
                    left: "auto"
                })) : (this.instance.cancelHelperRemoval = !1, this.instance._trigger("deactivate", t, r))
            })
        },
        drag: function(t, i) {
            var n = e(this).data("ui-draggable"),
            r = this;
            e.each(n.sortables,
            function() {
                var s = !1,
                o = this;
                this.instance.positionAbs = n.positionAbs,
                this.instance.helperProportions = n.helperProportions,
                this.instance.offset.click = n.offset.click,
                this.instance._intersectsWith(this.instance.containerCache) && (s = !0, e.each(n.sortables,
                function() {
                    return this.instance.positionAbs = n.positionAbs,
                    this.instance.helperProportions = n.helperProportions,
                    this.instance.offset.click = n.offset.click,
                    this !== o && this.instance._intersectsWith(this.instance.containerCache) && e.contains(o.instance.element[0], this.instance.element[0]) && (s = !1),
                    s
                })),
                s ? (this.instance.isOver || (this.instance.isOver = 1, this.instance.currentItem = e(r).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item", !0), this.instance.options._helper = this.instance.options.helper, this.instance.options.helper = function() {
                    return i.helper[0]
                },
                t.target = this.instance.currentItem[0], this.instance._mouseCapture(t, !0), this.instance._mouseStart(t, !0, !0), this.instance.offset.click.top = n.offset.click.top, this.instance.offset.click.left = n.offset.click.left, this.instance.offset.parent.left -= n.offset.parent.left - this.instance.offset.parent.left, this.instance.offset.parent.top -= n.offset.parent.top - this.instance.offset.parent.top, n._trigger("toSortable", t), n.dropped = this.instance.element, n.currentItem = n.element, this.instance.fromOutside = n), this.instance.currentItem && this.instance._mouseDrag(t)) : this.instance.isOver && (this.instance.isOver = 0, this.instance.cancelHelperRemoval = !0, this.instance.options.revert = !1, this.instance._trigger("out", t, this.instance._uiHash(this.instance)), this.instance._mouseStop(t, !0), this.instance.options.helper = this.instance.options._helper, this.instance.currentItem.remove(), this.instance.placeholder && this.instance.placeholder.remove(), n._trigger("fromSortable", t), n.dropped = !1)
            })
        }
    }),
    e.ui.plugin.add("draggable", "cursor", {
        start: function() {
            var t = e("body"),
            i = e(this).data("ui-draggable").options;
            t.css("cursor") && (i._cursor = t.css("cursor")),
            t.css("cursor", i.cursor)
        },
        stop: function() {
            var t = e(this).data("ui-draggable").options;
            t._cursor && e("body").css("cursor", t._cursor)
        }
    }),
    e.ui.plugin.add("draggable", "opacity", {
        start: function(t, i) {
            var n = e(i.helper),
            r = e(this).data("ui-draggable").options;
            n.css("opacity") && (r._opacity = n.css("opacity")),
            n.css("opacity", r.opacity)
        },
        stop: function(t, i) {
            var n = e(this).data("ui-draggable").options;
            n._opacity && e(i.helper).css("opacity", n._opacity)
        }
    }),
    e.ui.plugin.add("draggable", "scroll", {
        start: function() {
            var t = e(this).data("ui-draggable");
            t.scrollParent[0] !== document && "HTML" !== t.scrollParent[0].tagName && (t.overflowOffset = t.scrollParent.offset())
        },
        drag: function(t) {
            var i = e(this).data("ui-draggable"),
            n = i.options,
            r = !1;
            i.scrollParent[0] !== document && "HTML" !== i.scrollParent[0].tagName ? (n.axis && "x" === n.axis || (i.overflowOffset.top + i.scrollParent[0].offsetHeight - t.pageY < n.scrollSensitivity ? i.scrollParent[0].scrollTop = r = i.scrollParent[0].scrollTop + n.scrollSpeed: t.pageY - i.overflowOffset.top < n.scrollSensitivity && (i.scrollParent[0].scrollTop = r = i.scrollParent[0].scrollTop - n.scrollSpeed)), n.axis && "y" === n.axis || (i.overflowOffset.left + i.scrollParent[0].offsetWidth - t.pageX < n.scrollSensitivity ? i.scrollParent[0].scrollLeft = r = i.scrollParent[0].scrollLeft + n.scrollSpeed: t.pageX - i.overflowOffset.left < n.scrollSensitivity && (i.scrollParent[0].scrollLeft = r = i.scrollParent[0].scrollLeft - n.scrollSpeed))) : (n.axis && "x" === n.axis || (t.pageY - e(document).scrollTop() < n.scrollSensitivity ? r = e(document).scrollTop(e(document).scrollTop() - n.scrollSpeed) : e(window).height() - (t.pageY - e(document).scrollTop()) < n.scrollSensitivity && (r = e(document).scrollTop(e(document).scrollTop() + n.scrollSpeed))), n.axis && "y" === n.axis || (t.pageX - e(document).scrollLeft() < n.scrollSensitivity ? r = e(document).scrollLeft(e(document).scrollLeft() - n.scrollSpeed) : e(window).width() - (t.pageX - e(document).scrollLeft()) < n.scrollSensitivity && (r = e(document).scrollLeft(e(document).scrollLeft() + n.scrollSpeed)))),
            r !== !1 && e.ui.ddmanager && !n.dropBehaviour && e.ui.ddmanager.prepareOffsets(i, t)
        }
    }),
    e.ui.plugin.add("draggable", "snap", {
        start: function() {
            var t = e(this).data("ui-draggable"),
            i = t.options;
            t.snapElements = [],
            e(i.snap.constructor !== String ? i.snap.items || ":data(ui-draggable)": i.snap).each(function() {
                var i = e(this),
                n = i.offset();
                this !== t.element[0] && t.snapElements.push({
                    item: this,
                    width: i.outerWidth(),
                    height: i.outerHeight(),
                    top: n.top,
                    left: n.left
                })
            })
        },
        drag: function(t, i) {
            var n, r, s, o, a, l, c, d, u, h, p = e(this).data("ui-draggable"),
            f = p.options,
            g = f.snapTolerance,
            m = i.offset.left,
            v = m + p.helperProportions.width,
            b = i.offset.top,
            y = b + p.helperProportions.height;
            for (u = p.snapElements.length - 1; u >= 0; u--) a = p.snapElements[u].left,
            l = a + p.snapElements[u].width,
            c = p.snapElements[u].top,
            d = c + p.snapElements[u].height,
            v < a - g || m > l + g || y < c - g || b > d + g || !e.contains(p.snapElements[u].item.ownerDocument, p.snapElements[u].item) ? (p.snapElements[u].snapping && p.options.snap.release && p.options.snap.release.call(p.element, t, e.extend(p._uiHash(), {
                snapItem: p.snapElements[u].item
            })), p.snapElements[u].snapping = !1) : ("inner" !== f.snapMode && (n = Math.abs(c - y) <= g, r = Math.abs(d - b) <= g, s = Math.abs(a - v) <= g, o = Math.abs(l - m) <= g, n && (i.position.top = p._convertPositionTo("relative", {
                top: c - p.helperProportions.height,
                left: 0
            }).top - p.margins.top), r && (i.position.top = p._convertPositionTo("relative", {
                top: d,
                left: 0
            }).top - p.margins.top), s && (i.position.left = p._convertPositionTo("relative", {
                top: 0,
                left: a - p.helperProportions.width
            }).left - p.margins.left), o && (i.position.left = p._convertPositionTo("relative", {
                top: 0,
                left: l
            }).left - p.margins.left)), h = n || r || s || o, "outer" !== f.snapMode && (n = Math.abs(c - b) <= g, r = Math.abs(d - y) <= g, s = Math.abs(a - m) <= g, o = Math.abs(l - v) <= g, n && (i.position.top = p._convertPositionTo("relative", {
                top: c,
                left: 0
            }).top - p.margins.top), r && (i.position.top = p._convertPositionTo("relative", {
                top: d - p.helperProportions.height,
                left: 0
            }).top - p.margins.top), s && (i.position.left = p._convertPositionTo("relative", {
                top: 0,
                left: a
            }).left - p.margins.left), o && (i.position.left = p._convertPositionTo("relative", {
                top: 0,
                left: l - p.helperProportions.width
            }).left - p.margins.left)), !p.snapElements[u].snapping && (n || r || s || o || h) && p.options.snap.snap && p.options.snap.snap.call(p.element, t, e.extend(p._uiHash(), {
                snapItem: p.snapElements[u].item
            })), p.snapElements[u].snapping = n || r || s || o || h)
        }
    }),
    e.ui.plugin.add("draggable", "stack", {
        start: function() {
            var t, i = this.data("ui-draggable").options,
            n = e.makeArray(e(i.stack)).sort(function(t, i) {
                return (parseInt(e(t).css("zIndex"), 10) || 0) - (parseInt(e(i).css("zIndex"), 10) || 0)
            });
            n.length && (t = parseInt(e(n[0]).css("zIndex"), 10) || 0, e(n).each(function(i) {
                e(this).css("zIndex", t + i)
            }), this.css("zIndex", t + n.length))
        }
    }),
    e.ui.plugin.add("draggable", "zIndex", {
        start: function(t, i) {
            var n = e(i.helper),
            r = e(this).data("ui-draggable").options;
            n.css("zIndex") && (r._zIndex = n.css("zIndex")),
            n.css("zIndex", r.zIndex)
        },
        stop: function(t, i) {
            var n = e(this).data("ui-draggable").options;
            n._zIndex && e(i.helper).css("zIndex", n._zIndex)
        }
    })
} (jQuery),
function(e, t) {
    e.widget("ui.rotatable", e.ui.mouse, {
        options: {
            angle: !1,
            start: null,
            rotate: null,
            stop: null
        },
        angle: function(e) {
            return e === t ? this.options.angle: (this.options.angle = e, this.elementCurrentAngle = e, void this.performRotation(this.options.angle))
        },
        _create: function() {
            var t;
            t = e("<div><i class='fa fa-rotate-right'></i></div>"),
            t.addClass("ui-rotatable-handle"),
            this.listeners = {
                rotateElement: e.proxy(this.rotateElement, this),
                startRotate: e.proxy(this.startRotate, this),
                stopRotate: e.proxy(this.stopRotate, this)
            },
            t.draggable({
                helper: "clone",
                start: this.dragStart,
                handle: t
            }),
            t.bind("mousedown", this.listeners.startRotate),
            t.appendTo(this.element),
            0 != this.options.angle ? (this.elementCurrentAngle = this.options.angle, this.performRotation(this.elementCurrentAngle)) : this.elementCurrentAngle = 0
        },
        _destroy: function() {
            this.element.removeClass("ui-rotatable"),
            this.element.find(".ui-rotatable-handle").remove()
        },
        performRotation: function(e) {
            this.element.css("transform", "rotate(" + e + "rad)"),
            this.element.css("-webkit-transform", "rotate(" + e + "rad)")
        },
        getElementOffset: function() {
            this.performRotation(0);
            var e = this.element.offset();
            return this.performRotation(this.elementCurrentAngle),
            e
        },
        getElementCenter: function() {
            var e = this.getElementOffset(),
            t = e.left + this.element.width() / 2,
            i = e.top + this.element.height() / 2;
            return Array(t, i)
        },
        dragStart: function() {
            if (this.element) return ! 1
        },
        startRotate: function(t) {
            var i = this.getElementCenter(),
            n = t.pageX - i[0],
            r = t.pageY - i[1];
            return this.mouseStartAngle = Math.atan2(r, n),
            this.elementStartAngle = this.elementCurrentAngle,
            this.hasRotated = !1,
            this._propagate("start", t),
            e(document).bind("mousemove", this.listeners.rotateElement),
            e(document).bind("mouseup", this.listeners.stopRotate),
            !1
        },
        rotateElement: function(e) {
            if (!this.element || this.element.disabled) return ! 1;
            var t = this.getElementCenter(),
            i = e.pageX - t[0],
            n = e.pageY - t[1],
            r = Math.atan2(n, i),
            s = r - this.mouseStartAngle + this.elementStartAngle;
            if (e.shiftKey) {
                var o = 15 / 180 * Math.PI;
                s < 0 && (o *= -1),
                s -= (s + o / 2) % o - o / 2
            }
            this.performRotation(s);
            var a = this.elementCurrentAngle;
            return this.elementCurrentAngle = s,
            this._propagate("rotate", e),
            a != s && (this._trigger("rotate", e, this.ui()), this.hasRotated = !0),
            !1
        },
        stopRotate: function(t) {
            if (this.element && !this.element.disabled) return e(document).unbind("mousemove", this.listeners.rotateElement),
            e(document).unbind("mouseup", this.listeners.stopRotate),
            this.elementStopAngle = this.elementCurrentAngle,
            this.hasRotated && this._propagate("stop", t),
            setTimeout(function() {
                this.element = !1
            },
            10),
            !1
        },
        _propagate: function(t, i) {
            e.ui.plugin.call(this, t, [i, this.ui()]),
            "rotate" !== t && this._trigger(t, i, this.ui())
        },
        plugins: {},
        ui: function() {
            return {
                element: this.element,
                angle: {
                    start: this.elementStartAngle,
                    current: this.elementCurrentAngle,
                    stop: this.elementStopAngle
                }
            }
        }
    })
} (jQuery),
function(e) {
    function t(e, t) {
        for (var i = e.length; i--;) if (e[i] === t) return i;
        return - 1
    }
    function i(e, t) {
        if (e.length != t.length) return ! 1;
        for (var i = 0; i < e.length; i++) if (e[i] !== t[i]) return ! 1;
        return ! 0
    }
    function n(e) {
        for (y in w) w[y] = e[E[y]]
    }
    function r(e) {
        var i, r, s, o, l, c;
        if (i = e.keyCode, t(S, i) == -1 && S.push(i), 93 != i && 224 != i || (i = 91), i in w) {
            w[i] = !0;
            for (s in x) x[s] == i && (a[s] = !0)
        } else if (n(e), a.filter.call(this, e) && i in _) for (c = p(), o = 0; o < _[i].length; o++) if (r = _[i][o], r.scope == c || "all" == r.scope) {
            l = r.mods.length > 0;
            for (s in w)(!w[s] && t(r.mods, +s) > -1 || w[s] && t(r.mods, +s) == -1) && (l = !1); (0 != r.mods.length || w[16] || w[18] || w[17] || w[91]) && !l || r.method(e, r) === !1 && (e.preventDefault ? e.preventDefault() : e.returnValue = !1, e.stopPropagation && e.stopPropagation(), e.cancelBubble && (e.cancelBubble = !0))
        }
    }
    function s(e) {
        var i, n = e.keyCode,
        r = t(S, n);
        if (r >= 0 && S.splice(r, 1), 93 != n && 224 != n || (n = 91), n in w) {
            w[n] = !1;
            for (i in x) x[i] == n && (a[i] = !1)
        }
    }
    function o() {
        for (y in w) w[y] = !1;
        for (y in x) a[y] = !1
    }
    function a(e, t, i) {
        var n, r;
        n = g(e),
        void 0 === i && (i = t, t = "all");
        for (var s = 0; s < n.length; s++) r = [],
        e = n[s].split("+"),
        e.length > 1 && (r = m(e), e = [e[e.length - 1]]),
        e = e[0],
        e = k(e),
        e in _ || (_[e] = []),
        _[e].push({
            shortcut: n[s],
            scope: t,
            method: i,
            key: n[s],
            mods: r
        })
    }
    function l(e, t) {
        var n, r, s, o, a, l = [];
        for (n = g(e), o = 0; o < n.length; o++) {
            if (r = n[o].split("+"), r.length > 1 && (l = m(r)), e = r[r.length - 1], e = k(e), void 0 === t && (t = p()), !_[e]) return;
            for (s = 0; s < _[e].length; s++) a = _[e][s],
            a.scope === t && i(a.mods, l) && (_[e][s] = {})
        }
    }
    function c(e) {
        return "string" == typeof e && (e = k(e)),
        t(S, e) != -1
    }
    function d() {
        return S.slice(0)
    }
    function u(e) {
        var t = (e.target || e.srcElement).tagName;
        return ! ("INPUT" == t || "SELECT" == t || "TEXTAREA" == t)
    }
    function h(e) {
        M = e || "all"
    }
    function p() {
        return M || "all"
    }
    function f(e) {
        var t, i, n;
        for (t in _) for (i = _[t], n = 0; n < i.length;) i[n].scope === e ? i.splice(n, 1) : n++
    }
    function g(e) {
        var t;
        return e = e.replace(/\s/g, ""),
        t = e.split(","),
        "" == t[t.length - 1] && (t[t.length - 2] += ","),
        t
    }
    function m(e) {
        for (var t = e.slice(0, e.length - 1), i = 0; i < t.length; i++) t[i] = x[t[i]];
        return t
    }
    function v(e, t, i) {
        e.addEventListener ? e.addEventListener(t, i, !1) : e.attachEvent && e.attachEvent("on" + t,
        function() {
            i(window.event)
        })
    }
    function b() {
        var t = e.key;
        return e.key = C,
        t
    }
    var y, _ = {},
    w = {
        16 : !1,
        18 : !1,
        17 : !1,
        91 : !1
    },
    M = "all",
    x = {
        "\u21e7": 16,
        shift: 16,
        "\u2325": 18,
        alt: 18,
        option: 18,
        "\u2303": 17,
        ctrl: 17,
        control: 17,
        "\u2318": 91,
        command: 91
    },
    B = {
        backspace: 8,
        tab: 9,
        clear: 12,
        enter: 13,
        "return": 13,
        esc: 27,
        escape: 27,
        space: 32,
        left: 37,
        up: 38,
        right: 39,
        down: 40,
        del: 46,
        "delete": 46,
        home: 36,
        end: 35,
        pageup: 33,
        pagedown: 34,
        ",": 188,
        ".": 190,
        "/": 191,
        "`": 192,
        "-": 189,
        "=": 187,
        ";": 186,
        "'": 222,
        "[": 219,
        "]": 221,
        "\\": 220
    },
    k = function(e) {
        return B[e] || e.toUpperCase().charCodeAt(0)
    },
    S = [];
    for (y = 1; y < 20; y++) B["f" + y] = 111 + y;
    var E = {
        16 : "shiftKey",
        18 : "altKey",
        17 : "ctrlKey",
        91 : "metaKey"
    };
    for (y in x) a[y] = !1;
    v(document, "keydown",
    function(e) {
        r(e)
    }),
    v(document, "keyup", s),
    v(window, "focus", o);
    var C = e.key;
    e.key = a,
    e.key.setScope = h,
    e.key.getScope = p,
    e.key.deleteScope = f,
    e.key.filter = u,
    e.key.isPressed = c,
    e.key.getPressedKeyCodes = d,
    e.key.noConflict = b,
    e.key.unbind = l,
    "undefined" != typeof module && (module.exports = a)
} (this),
function() {
    var e = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");
    Math.uuid = function(t, i) {
        var n, r = e,
        s = [];
        if (i = i || r.length, t) for (n = 0; n < t; n++) s[n] = r[0 | Math.random() * i];
        else {
            var o;
            for (s[8] = s[13] = s[18] = s[23] = "-", s[14] = "4", n = 0; n < 36; n++) s[n] || (o = 0 | 16 * Math.random(), s[n] = r[19 == n ? 3 & o | 8 : o])
        }
        return s.join("")
    },
    Math.uuidFast = function() {
        for (var t, i = e,
        n = new Array(36), r = 0, s = 0; s < 36; s++) 8 == s || 13 == s || 18 == s || 23 == s ? n[s] = "-": 14 == s ? n[s] = "4": (r <= 2 && (r = 33554432 + 16777216 * Math.random() | 0), t = 15 & r, r >>= 4, n[s] = i[19 == s ? 3 & t | 8 : t]);
        return n.join("")
    },
    Math.uuidCompact = function() {
        return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,
        function(e) {
            var t = 16 * Math.random() | 0,
            i = "x" == e ? t: 3 & t | 8;
            return i.toString(16)
        })
    }
} (),
!
function(e) {
    "use strict";
    function t(e, t) {
        var i = (65535 & e) + (65535 & t),
        n = (e >> 16) + (t >> 16) + (i >> 16);
        return n << 16 | 65535 & i
    }
    function i(e, t) {
        return e << t | e >>> 32 - t
    }
    function n(e, n, r, s, o, a) {
        return t(i(t(t(n, e), t(s, a)), o), r)
    }
    function r(e, t, i, r, s, o, a) {
        return n(t & i | ~t & r, e, t, s, o, a)
    }
    function s(e, t, i, r, s, o, a) {
        return n(t & r | i & ~r, e, t, s, o, a)
    }
    function o(e, t, i, r, s, o, a) {
        return n(t ^ i ^ r, e, t, s, o, a)
    }
    function a(e, t, i, r, s, o, a) {
        return n(i ^ (t | ~r), e, t, s, o, a)
    }
    function l(e, i) {
        e[i >> 5] |= 128 << i % 32,
        e[(i + 64 >>> 9 << 4) + 14] = i;
        var n, l, c, d, u, h = 1732584193,
        p = -271733879,
        f = -1732584194,
        g = 271733878;
        for (n = 0; n < e.length; n += 16) l = h,
        c = p,
        d = f,
        u = g,
        h = r(h, p, f, g, e[n], 7, -680876936),
        g = r(g, h, p, f, e[n + 1], 12, -389564586),
        f = r(f, g, h, p, e[n + 2], 17, 606105819),
        p = r(p, f, g, h, e[n + 3], 22, -1044525330),
        h = r(h, p, f, g, e[n + 4], 7, -176418897),
        g = r(g, h, p, f, e[n + 5], 12, 1200080426),
        f = r(f, g, h, p, e[n + 6], 17, -1473231341),
        p = r(p, f, g, h, e[n + 7], 22, -45705983),
        h = r(h, p, f, g, e[n + 8], 7, 1770035416),
        g = r(g, h, p, f, e[n + 9], 12, -1958414417),
        f = r(f, g, h, p, e[n + 10], 17, -42063),
        p = r(p, f, g, h, e[n + 11], 22, -1990404162),
        h = r(h, p, f, g, e[n + 12], 7, 1804603682),
        g = r(g, h, p, f, e[n + 13], 12, -40341101),
        f = r(f, g, h, p, e[n + 14], 17, -1502002290),
        p = r(p, f, g, h, e[n + 15], 22, 1236535329),
        h = s(h, p, f, g, e[n + 1], 5, -165796510),
        g = s(g, h, p, f, e[n + 6], 9, -1069501632),
        f = s(f, g, h, p, e[n + 11], 14, 643717713),
        p = s(p, f, g, h, e[n], 20, -373897302),
        h = s(h, p, f, g, e[n + 5], 5, -701558691),
        g = s(g, h, p, f, e[n + 10], 9, 38016083),
        f = s(f, g, h, p, e[n + 15], 14, -660478335),
        p = s(p, f, g, h, e[n + 4], 20, -405537848),
        h = s(h, p, f, g, e[n + 9], 5, 568446438),
        g = s(g, h, p, f, e[n + 14], 9, -1019803690),
        f = s(f, g, h, p, e[n + 3], 14, -187363961),
        p = s(p, f, g, h, e[n + 8], 20, 1163531501),
        h = s(h, p, f, g, e[n + 13], 5, -1444681467),
        g = s(g, h, p, f, e[n + 2], 9, -51403784),
        f = s(f, g, h, p, e[n + 7], 14, 1735328473),
        p = s(p, f, g, h, e[n + 12], 20, -1926607734),
        h = o(h, p, f, g, e[n + 5], 4, -378558),
        g = o(g, h, p, f, e[n + 8], 11, -2022574463),
        f = o(f, g, h, p, e[n + 11], 16, 1839030562),
        p = o(p, f, g, h, e[n + 14], 23, -35309556),
        h = o(h, p, f, g, e[n + 1], 4, -1530992060),
        g = o(g, h, p, f, e[n + 4], 11, 1272893353),
        f = o(f, g, h, p, e[n + 7], 16, -155497632),
        p = o(p, f, g, h, e[n + 10], 23, -1094730640),
        h = o(h, p, f, g, e[n + 13], 4, 681279174),
        g = o(g, h, p, f, e[n], 11, -358537222),
        f = o(f, g, h, p, e[n + 3], 16, -722521979),
        p = o(p, f, g, h, e[n + 6], 23, 76029189),
        h = o(h, p, f, g, e[n + 9], 4, -640364487),
        g = o(g, h, p, f, e[n + 12], 11, -421815835),
        f = o(f, g, h, p, e[n + 15], 16, 530742520),
        p = o(p, f, g, h, e[n + 2], 23, -995338651),
        h = a(h, p, f, g, e[n], 6, -198630844),
        g = a(g, h, p, f, e[n + 7], 10, 1126891415),
        f = a(f, g, h, p, e[n + 14], 15, -1416354905),
        p = a(p, f, g, h, e[n + 5], 21, -57434055),
        h = a(h, p, f, g, e[n + 12], 6, 1700485571),
        g = a(g, h, p, f, e[n + 3], 10, -1894986606),
        f = a(f, g, h, p, e[n + 10], 15, -1051523),
        p = a(p, f, g, h, e[n + 1], 21, -2054922799),
        h = a(h, p, f, g, e[n + 8], 6, 1873313359),
        g = a(g, h, p, f, e[n + 15], 10, -30611744),
        f = a(f, g, h, p, e[n + 6], 15, -1560198380),
        p = a(p, f, g, h, e[n + 13], 21, 1309151649),
        h = a(h, p, f, g, e[n + 4], 6, -145523070),
        g = a(g, h, p, f, e[n + 11], 10, -1120210379),
        f = a(f, g, h, p, e[n + 2], 15, 718787259),
        p = a(p, f, g, h, e[n + 9], 21, -343485551),
        h = t(h, l),
        p = t(p, c),
        f = t(f, d),
        g = t(g, u);
        return [h, p, f, g]
    }
    function c(e) {
        var t, i = "";
        for (t = 0; t < 32 * e.length; t += 8) i += String.fromCharCode(e[t >> 5] >>> t % 32 & 255);
        return i
    }
    function d(e) {
        var t, i = [];
        for (i[(e.length >> 2) - 1] = void 0, t = 0; t < i.length; t += 1) i[t] = 0;
        for (t = 0; t < 8 * e.length; t += 8) i[t >> 5] |= (255 & e.charCodeAt(t / 8)) << t % 32;
        return i
    }
    function u(e) {
        return c(l(d(e), 8 * e.length))
    }
    function h(e, t) {
        var i, n, r = d(e),
        s = [],
        o = [];
        for (s[15] = o[15] = void 0, r.length > 16 && (r = l(r, 8 * e.length)), i = 0; 16 > i; i += 1) s[i] = 909522486 ^ r[i],
        o[i] = 1549556828 ^ r[i];
        return n = l(s.concat(d(t)), 512 + 8 * t.length),
        c(l(o.concat(n), 640))
    }
    function p(e) {
        var t, i, n = "0123456789abcdef",
        r = "";
        for (i = 0; i < e.length; i += 1) t = e.charCodeAt(i),
        r += n.charAt(t >>> 4 & 15) + n.charAt(15 & t);
        return r
    }
    function f(e) {
        return unescape(encodeURIComponent(e))
    }
    function g(e) {
        return u(f(e))
    }
    function m(e) {
        return p(g(e))
    }
    function v(e, t) {
        return h(f(e), f(t))
    }
    function b(e, t) {
        return p(v(e, t))
    }
    function y(e, t, i) {
        return t ? i ? v(t, e) : b(t, e) : i ? g(e) : m(e)
    }
    "function" == typeof define && define.amd ? define(function() {
        return y
    }) : e.md5 = y
} (this),
$(document).ready(function() {
    function e(e) {
        return parseInt(e, 10) || 0
    }
    function t(e) {
        var t = window.getComputedStyle(e, null),
        i = t.getPropertyValue("-webkit-transform") || t.getPropertyValue("-moz-transform") || t.getPropertyValue("-ms-transform") || t.getPropertyValue("-o-transform") || t.getPropertyValue("transform") || null;
        if (i && "none" != i) {
            var n = i.split("(")[1];
            n = n.split(")")[0],
            n = n.split(",");
            for (var r = n[0], s = n[1], o = Math.round(Math.atan2(s, r) * (180 / Math.PI)); o >= 360;) o = 360 - o;
            for (; o < 0;) o = 360 + o;
            return o
        }
        return 0
    }
    function i(e) {
        return isNaN(parseFloat(e)) ? 0 : parseFloat(e)
    }
    function n(e) {
        return Math.round(100 * (e + 1e-5)) / 100
    }
    $.getCorrection = function(e, t, i, n, r) {
        var r = r * Math.PI / 180,
        s = -e / 2,
        o = t / 2,
        a = o * Math.sin(r) + s * Math.cos(r),
        l = o * Math.cos(r) - s * Math.sin(r),
        c = {
            left: a - s,
            top: l - o
        },
        d = e + i,
        u = t + n,
        s = -d / 2,
        o = u / 2,
        a = o * Math.sin(r) + s * Math.cos(r),
        l = o * Math.cos(r) - s * Math.sin(r),
        h = {
            left: a - s,
            top: l - o
        },
        p = {
            left: h.left - c.left,
            top: h.top - c.top
        };
        return p
    },
    $.ui.resizable.prototype._mouseStart = function(t) {
        var i, n, r, s = this.options,
        o = this.element;
        return this.resizing = !0,
        this._renderProxy(),
        i = e(this.helper.css("left")),
        n = e(this.helper.css("top")),
        s.containment && (i += $(s.containment).scrollLeft() || 0, n += $(s.containment).scrollTop() || 0),
        this.offset = this.helper.offset(),
        this.position = {
            left: i,
            top: n
        },
        this.size = this._helper ? {
            width: this.helper.width(),
            height: this.helper.height()
        }: {
            width: o.width(),
            height: o.height()
        },
        this.originalSize = this._helper ? {
            width: o.outerWidth(),
            height: o.outerHeight()
        }: {
            width: o.width(),
            height: o.height()
        },
        this.sizeDiff = {
            width: o.outerWidth() - o.width(),
            height: o.outerHeight() - o.height()
        },
        this.originalPosition = {
            left: i,
            top: n
        },
        this.originalMousePosition = {
            left: t.pageX,
            top: t.pageY
        },
        this.lastData = this.originalPosition,
        this.aspectRatio = "number" == typeof s.aspectRatio ? s.aspectRatio: this.originalSize.width / this.originalSize.height || 1,
        r = $(".ui-resizable-" + this.axis).css("cursor"),
        $("body").css("cursor", "auto" === r ? this.axis + "-resize": r),
        o.addClass("ui-resizable-resizing"),
        this._propagate("start", t),
        !0
    },
    $.ui.resizable.prototype._oldMouseDrag = $.ui.resizable.prototype._mouseDrag,
    $.ui.resizable.prototype._mouseDrag = function(e) {
        var r, s = t(this.element[0]),
        o = s * Math.PI / 180,
        a = this.helper,
        l = {},
        c = this.originalMousePosition,
        d = this.axis,
        u = this.position.top,
        h = this.position.left,
        p = this.size.width,
        f = this.size.height,
        g = e.pageX - c.left || 0,
        m = e.pageY - c.top || 0,
        v = this._change[d],
        b = this.size.width,
        y = this.size.height;
        if (0 == s) return this._oldMouseDrag(e);
        if (!v) return ! 1;
        var _ = Math.cos(o),
        w = Math.sin(o);
        ndx = g * _ + m * w,
        ndy = m * _ - g * w,
        g = ndx,
        m = ndy,
        r = v.apply(this, [e, g, m]),
        this._updateVirtualBoundaries(e.shiftKey),
        (this._aspectRatio || e.shiftKey) && (r = this._updateRatio(r, e)),
        r = this._respectSize(r, e);
        var M = {
            left: this.position.left,
            top: this.position.top
        };
        this._updateCache(r),
        this.position = {
            left: M.left,
            top: M.top
        };
        var x = {
            left: i(r.left || this.lastData.left) - i(this.lastData.left),
            top: i(r.top || this.lastData.top) - i(this.lastData.top)
        },
        B = {};
        B.left = x.left * _ - x.top * w,
        B.top = x.top * _ + x.left * w,
        B.left = n(B.left),
        B.top = n(B.top),
        this.position.left += B.left,
        this.position.top += B.top,
        this.lastData = {
            left: i(r.left || this.lastData.left),
            top: i(r.top || this.lastData.top)
        },
        this._propagate("resize", e);
        var k = b - this.size.width,
        S = y - this.size.height,
        E = $.getCorrection(b, y, k, S, s);
        return this.position.left += E.left,
        this.position.top -= E.top,
        this.position.top !== u && (l.top = this.position.top + "px"),
        this.position.left !== h && (l.left = this.position.left + "px"),
        this.size.width !== p && (l.width = this.size.width + "px"),
        this.size.height !== f && (l.height = this.size.height + "px"),
        a.css(l),
        !this._helper && this._proportionallyResizeElements.length && this._proportionallyResize(),
        $.isEmptyObject(l) || this._trigger("resize", e, this.ui()),
        !1
    }
}),
function(e) {
    var t = function() {
        var t = '<div class="colpick"><div class="colpick_color"><div class="colpick_color_overlay1"><div class="colpick_color_overlay2"><div class="colpick_selector_outer"><div class="colpick_selector_inner"></div></div></div></div></div><div class="colpick_hue"><div class="colpick_hue_arrs"><div class="colpick_hue_larr"></div><div class="colpick_hue_rarr"></div></div></div><div class="colpick_new_color"></div><div class="colpick_current_color"></div><div class="colpick_hex_field"><div class="colpick_field_letter">#</div><input type="text" maxlength="6" size="6" /></div><div class="colpick_system_picker"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABDlBMVEUAAACVpLdqbG9PUFJxfYR1dnmIiYz1cCtwfINKS0wtLi9QUVS7vMNub3EfICHadTmWorCUY0mUV0KcbThrdXxlZWdISUuif3iIfnWKm6+9xcqIiYwlJSb/UB+MjZDTfz6QnqZyc3b/VyC6ZCoFBQVzdHeMnbH/LQDg5Oqyu8Hx8/Xm6exub3J1dnjn6u7Z3uXY3eS1t7mnqKuTlZf/u3L/sWNaXF7/mQDo6Onk5OXZ3+Xw4NfGytDs4M7FyMrs28CusLLm0K+oqayho6Wio6Sam5yNjpDUsov/voeBg4X3s4N6fH3cqXfmlW9qa25gYmPpnFv/uVHsk0pFRUb/k0U9PkD/YjH/Tij3YiX3kgoIyPj/AAAAKHRSTlMAnzDzrfEwz62hoUAa8e/Lv7m5ua+vr62tn4BgYFJQTUBAQDIwIBUFpJb6YgAAAKVJREFUKM+dzcUWgmAQhuExEBG7uwMVUNru7o77vxH3/LPyXT7fOTNAVmEYKyA5PN2OziJOyZMt78JcUnjBNKQiBWomKQJvMz3Jyss55gD+xX6FeUIcnPUT6Raxx42ed5bwRotr1sPeKOp2KKdxJ++0/3An6eJwOkY81r8axjdEePW40R6fIBC5b6p6CQAy7A7rOCDV3sk8YGVeRUCjNRofcr4Soj+kkRf7vV9SJAAAAABJRU5ErkJggg=="/></div><div class="colpick_transparent">Transparent</div><div class="colpick_rgb_r colpick_field"><div class="colpick_field_letter">R</div><input type="number" maxlength="3" size="3" /></div><div class="colpick_rgb_g colpick_field"><div class="colpick_field_letter">G</div><input type="number" maxlength="3" size="3" /></div><div class="colpick_rgb_b colpick_field"><div class="colpick_field_letter">B</div><input type="number" maxlength="3" size="3" /></div><div class="colpick_hsb_h colpick_field"><div class="colpick_field_letter">H</div><input type="number" maxlength="3" size="3" /></div><div class="colpick_hsb_s colpick_field"><div class="colpick_field_letter">S</div><input type="number" maxlength="3" size="3" /></div><div class="colpick_hsb_b colpick_field"><div class="colpick_field_letter">B</div><input type="number" maxlength="3" size="3" /></div><div class="colpick_submit"></div><div class="colpick_prev1 colpick_prev"></div><div class="colpick_prev2 colpick_prev"></div><div class="colpick_prev3 colpick_prev"></div><div class="colpick_prev4 colpick_prev"></div><div class="colpick_prev5 colpick_prev"></div><div class="colpick_prev6 colpick_prev"></div></div>',
        i = {
            showEvent: "click",
            onShow: function() {},
            onBeforeShow: function() {},
            onHide: function() {},
            onChange: function() {},
            onSubmit: function() {},
            colorScheme: "light",
            color: "3289c7",
            livePreview: !0,
            flat: !1,
            layout: "full",
            submit: 1,
            submitText: "OK",
            height: 156
        },
        o = function(t, i) {
            var n = s(t);
            e(i).data("colpick").fields.eq(1).val(n.r).end().eq(2).val(n.g).end().eq(3).val(n.b).end()
        },
        l = function(t, i) {
            e(i).data("colpick").fields.eq(4).val(Math.round(t.h)).end().eq(5).val(Math.round(t.s)).end().eq(6).val(Math.round(t.b)).end()
        },
        c = function(t, i) {
            e(i).data("colpick").fields.eq(0).val(a(t))
        },
        d = function(t, i) {
            e(i).data("colpick").selector.css("backgroundColor", "#" + a({
                h: t.h,
                s: 100,
                b: 100
            })),
            e(i).data("colpick").selectorIndic.css({
                left: parseInt(e(i).data("colpick").height * t.s / 100, 10),
                top: parseInt(e(i).data("colpick").height * (100 - t.b) / 100, 10)
            })
        },
        u = function(t, i) {
            e(i).data("colpick").hue.css("top", parseInt(e(i).data("colpick").height - e(i).data("colpick").height * t.h / 360, 10))
        },
        h = function(t, i) {
            e(i).data("colpick").currentColor.css("backgroundColor", "#" + a(t))
        },
        p = function(t, i) {
            e(i).data("colpick").newColor.css("backgroundColor", "#" + a(t))
        },
        f = function() {
            var t, i = e(this).parent().parent();
            this.parentNode.className.indexOf("_hex") > 0 ? (i.data("colpick").color = t = n(N(this.value)), o(t, i.get(0)), l(t, i.get(0))) : this.parentNode.className.indexOf("_hsb") > 0 ? (i.data("colpick").color = t = I({
                h: parseInt(i.data("colpick").fields.eq(4).val(), 10),
                s: parseInt(i.data("colpick").fields.eq(5).val(), 10),
                b: parseInt(i.data("colpick").fields.eq(6).val(), 10)
            }), o(t, i.get(0)), c(t, i.get(0))) : (i.data("colpick").color = t = r($({
                r: parseInt(i.data("colpick").fields.eq(1).val(), 10),
                g: parseInt(i.data("colpick").fields.eq(2).val(), 10),
                b: parseInt(i.data("colpick").fields.eq(3).val(), 10)
            })), c(t, i.get(0)), l(t, i.get(0))),
            d(t, i.get(0)),
            u(t, i.get(0)),
            p(t, i.get(0)),
            i.data("colpick").onChange.apply(i.parent(), [t, a(t), s(t), i.data("colpick").el, 0])
        },
        g = function() {
            e(this).parent().removeClass("colpick_focus")
        },
        m = function() {
            e(this).parent().parent().data("colpick").fields.parent().removeClass("colpick_focus"),
            e(this).parent().addClass("colpick_focus")
        },
        v = function(t) {
            t.preventDefault ? t.preventDefault() : t.returnValue = !1;
            var i = e(this).parent().find("input").focus(),
            n = {
                el: e(this).parent().addClass("colpick_slider"),
                max: this.parentNode.className.indexOf("_hsb_h") > 0 ? 360 : this.parentNode.className.indexOf("_hsb") > 0 ? 100 : 255,
                y: t.pageY,
                field: i,
                val: parseInt(i.val(), 10),
                preview: e(this).parent().parent().data("colpick").livePreview
            };
            e(document).mouseup(n, y),
            e(document).mousemove(n, b)
        },
        b = function(e) {
            return e.data.field.val(Math.max(0, Math.min(e.data.max, parseInt(e.data.val - e.pageY + e.data.y, 10)))),
            e.data.preview && f.apply(e.data.field.get(0), [!0]),
            !1
        },
        y = function(t) {
            return f.apply(t.data.field.get(0), [!0]),
            t.data.el.removeClass("colpick_slider").find("input").focus(),
            e(document).off("mouseup", y),
            e(document).off("mousemove", b),
            !1
        },
        _ = function(t) {
            t.preventDefault ? t.preventDefault() : t.returnValue = !1;
            var i = {
                cal: e(this).parent(),
                y: e(this).offset().top
            };
            e(document).on("mouseup touchend", i, M),
            e(document).on("mousemove touchmove", i, w);
            var n = "touchstart" == t.type ? t.originalEvent.changedTouches[0].pageY: t.pageY;
            return f.apply(i.cal.data("colpick").fields.eq(4).val(parseInt(360 * (i.cal.data("colpick").height - (n - i.y)) / i.cal.data("colpick").height, 10)).get(0), [i.cal.data("colpick").livePreview]),
            !1
        },
        w = function(e) {
            var t = "touchmove" == e.type ? e.originalEvent.changedTouches[0].pageY: e.pageY;
            return f.apply(e.data.cal.data("colpick").fields.eq(4).val(parseInt(360 * (e.data.cal.data("colpick").height - Math.max(0, Math.min(e.data.cal.data("colpick").height, t - e.data.y))) / e.data.cal.data("colpick").height, 10)).get(0), [e.data.preview]),
            !1
        },
        M = function(t) {
            return o(t.data.cal.data("colpick").color, t.data.cal.get(0)),
            c(t.data.cal.data("colpick").color, t.data.cal.get(0)),
            e(document).off("mouseup touchend", M),
            e(document).off("mousemove touchmove", w),
            !1
        },
        x = function(t) {
            t.preventDefault ? t.preventDefault() : t.returnValue = !1;
            var i = {
                cal: e(this).parent(),
                pos: e(this).offset()
            };
            i.preview = i.cal.data("colpick").livePreview,
            e(document).on("mouseup touchend", i, k),
            e(document).on("mousemove touchmove", i, B);
            var n;
            return "touchstart" == t.type ? (pageX = t.originalEvent.changedTouches[0].pageX, n = t.originalEvent.changedTouches[0].pageY) : (pageX = t.pageX, n = t.pageY),
            f.apply(i.cal.data("colpick").fields.eq(6).val(parseInt(100 * (i.cal.data("colpick").height - (n - i.pos.top)) / i.cal.data("colpick").height, 10)).end().eq(5).val(parseInt(100 * (pageX - i.pos.left) / i.cal.data("colpick").height, 10)).get(0), [i.preview]),
            !1
        },
        B = function(e) {
            var t;
            return "touchmove" == e.type ? (pageX = e.originalEvent.changedTouches[0].pageX, t = e.originalEvent.changedTouches[0].pageY) : (pageX = e.pageX, t = e.pageY),
            f.apply(e.data.cal.data("colpick").fields.eq(6).val(parseInt(100 * (e.data.cal.data("colpick").height - Math.max(0, Math.min(e.data.cal.data("colpick").height, t - e.data.pos.top))) / e.data.cal.data("colpick").height, 10)).end().eq(5).val(parseInt(100 * Math.max(0, Math.min(e.data.cal.data("colpick").height, pageX - e.data.pos.left)) / e.data.cal.data("colpick").height, 10)).get(0), [e.data.preview]),
            !1
        },
        k = function(t) {
            return o(t.data.cal.data("colpick").color, t.data.cal.get(0)),
            c(t.data.cal.data("colpick").color, t.data.cal.get(0)),
            e(document).off("mouseup touchend", k),
            e(document).off("mousemove touchmove", B),
            !1
        },
        S = function() {
            var t = e(this).parent(),
            i = t.data("colpick").color;
            t.data("colpick").origColor = i,
            h(i, t.get(0)),
            t.data("colpick").onSubmit(i, a(i), s(i), t.data("colpick").el)
        },
        E = function(t) {
            t.stopPropagation();
            var i = e("#" + e(this).data("colpickId"));
            i.data("colpick").onBeforeShow.apply(this, [i.get(0)]);
            var n = e(this).offset(),
            r = n.top + this.offsetHeight,
            s = n.left,
            o = R(),
            a = i.width();
            s + a > o.l + o.w && (s -= a),
            i.css({
                left: s + "px",
                top: r + "px"
            }),
            0 != i.data("colpick").onShow.apply(this, [i.get(0)]) && i.show(),
            e("html").mousedown({
                cal: i
            },
            C),
            i.mousedown(function(e) {
                e.stopPropagation()
            })
        },
        C = function(t) {
            0 != t.data.cal.data("colpick").onHide.apply(this, [t.data.cal.get(0)]) && t.data.cal.hide(),
            e("html").off("mousedown", C)
        },
        R = function() {
            var e = "CSS1Compat" == document.compatMode;
            return {
                l: window.pageXOffset || (e ? document.documentElement.scrollLeft: document.body.scrollLeft),
                w: window.innerWidth || (e ? document.documentElement.clientWidth: document.body.clientWidth)
            }
        },
        I = function(e) {
            return {
                h: Math.min(360, Math.max(0, e.h)),
                s: Math.min(100, Math.max(0, e.s)),
                b: Math.min(100, Math.max(0, e.b))
            }
        },
        $ = function(e) {
            return {
                r: Math.min(255, Math.max(0, e.r)),
                g: Math.min(255, Math.max(0, e.g)),
                b: Math.min(255, Math.max(0, e.b))
            }
        },
        N = function(e) {
            var t = 6 - e.length;
            if (t > 0) {
                for (var i = [], n = 0; n < t; n++) i.push("0");
                i.push(e),
                e = i.join("")
            }
            return e
        },
        T = function() {
            var t = e(this).parent(),
            i = t.data("colpick").origColor;
            t.data("colpick").color = i,
            o(i, t.get(0)),
            c(i, t.get(0)),
            l(i, t.get(0)),
            d(i, t.get(0)),
            u(i, t.get(0)),
            p(i, t.get(0))
        };
        return {
            init: function(s) {
                if (s = e.extend({},
                i, s || {}), "string" == typeof s.color) s.color = n(s.color);
                else if (void 0 != s.color.r && void 0 != s.color.g && void 0 != s.color.b) s.color = r(s.color);
                else {
                    if (void 0 == s.color.h || void 0 == s.color.s || void 0 == s.color.b) return this;
                    s.color = I(s.color)
                }
                return this.each(function() {
                    if (!e(this).data("colpickId")) {
                        var i = e.extend({},
                        s);
                        i.origColor = s.color;
                        var n = "collorpicker_" + parseInt(1e3 * Math.random());
                        e(this).data("colpickId", n);
                        var r = e(t).attr("id", n);
                        r.addClass("colpick_" + i.layout + (i.submit ? "": " colpick_" + i.layout + "_ns")),
                        "light" != i.colorScheme && r.addClass("colpick_" + i.colorScheme),
                        r.find("div.colpick_submit").html(i.submitText).click(S),
                        i.fields = r.find("input").change(f).blur(g).focus(m),
                        r.find("div.colpick_field_arrs").mousedown(v).end().find("div.colpick_current_color").click(T),
                        i.selector = r.find("div.colpick_color").on("mousedown touchstart", x),
                        i.selectorIndic = i.selector.find("div.colpick_selector_outer"),
                        i.el = this,
                        i.hue = r.find("div.colpick_hue_arrs"),
                        huebar = i.hue.parent();
                        var a = navigator.userAgent.toLowerCase(),
                        b = "Microsoft Internet Explorer" === navigator.appName,
                        y = b ? parseFloat(a.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]) : 0,
                        w = b && y < 10,
                        M = ["#ff0000", "#ff0080", "#ff00ff", "#8000ff", "#0000ff", "#0080ff", "#00ffff", "#00ff80", "#00ff00", "#80ff00", "#ffff00", "#ff8000", "#ff0000"];
                        if (w) {
                            var B, k;
                            for (B = 0; B <= 11; B++) k = e("<div></div>").attr("style", "height:8.333333%; filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=" + M[B] + ", endColorstr=" + M[B + 1] + '); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=' + M[B] + ", endColorstr=" + M[B + 1] + ')";'),
                            huebar.append(k)
                        } else stopList = M.join(","),
                        huebar.attr("style", "background:-webkit-linear-gradient(top," + stopList + "); background: -o-linear-gradient(top," + stopList + "); background: -ms-linear-gradient(top," + stopList + "); background:-moz-linear-gradient(top," + stopList + "); -webkit-linear-gradient(top," + stopList + "); background:linear-gradient(to bottom," + stopList + "); ");
                        r.find("div.colpick_hue").on("mousedown touchstart", _),
                        i.newColor = r.find("div.colpick_new_color"),
                        i.currentColor = r.find("div.colpick_current_color"),
                        r.data("colpick", i),
                        o(i.color, r.get(0)),
                        l(i.color, r.get(0)),
                        c(i.color, r.get(0)),
                        u(i.color, r.get(0)),
                        d(i.color, r.get(0)),
                        h(i.color, r.get(0)),
                        p(i.color, r.get(0)),
                        i.flat ? (r.appendTo(this).show(), r.css({
                            position: "relative",
                            display: "block"
                        })) : (r.appendTo(document.body), e(this).on(i.showEvent, E), r.css({
                            position: "absolute"
                        }))
                    }
                })
            },
            showPicker: function() {
                return this.each(function() {
                    e(this).data("colpickId") && E.apply(this)
                })
            },
            hidePicker: function() {
                return this.each(function() {
                    e(this).data("colpickId") && e("#" + e(this).data("colpickId")).hide()
                })
            },
            setColor: function(t, i) {
                if (i = "undefined" == typeof i ? 1 : i, "string" == typeof t) t = n(t);
                else if (void 0 != t.r && void 0 != t.g && void 0 != t.b) t = r(t);
                else {
                    if (void 0 == t.h || void 0 == t.s || void 0 == t.b) return this;
                    t = I(t)
                }
                return this.each(function() {
                    if (e(this).data("colpickId")) {
                        var n = e("#" + e(this).data("colpickId"));
                        n.data("colpick").color = t,
                        n.data("colpick").origColor = t,
                        o(t, n.get(0)),
                        l(t, n.get(0)),
                        c(t, n.get(0)),
                        u(t, n.get(0)),
                        d(t, n.get(0)),
                        p(t, n.get(0)),
                        n.data("colpick").onChange.apply(n.parent(), [t, a(t), s(t), n.data("colpick").el, 1]),
                        i && h(t, n.get(0))
                    }
                })
            }
        }
    } (),
    i = function(e) {
        var e = parseInt(e.indexOf("#") > -1 ? e.substring(1) : e, 16);
        return {
            r: e >> 16,
            g: (65280 & e) >> 8,
            b: 255 & e
        }
    },
    n = function(e) {
        return r(i(e))
    },
    r = function(e) {
        var t = {
            h: 0,
            s: 0,
            b: 0
        },
        i = Math.min(e.r, e.g, e.b),
        n = Math.max(e.r, e.g, e.b),
        r = n - i;
        return t.b = n,
        t.s = 0 != n ? 255 * r / n: 0,
        0 != t.s ? e.r == n ? t.h = (e.g - e.b) / r: e.g == n ? t.h = 2 + (e.b - e.r) / r: t.h = 4 + (e.r - e.g) / r: t.h = -1,
        t.h *= 60,
        t.h < 0 && (t.h += 360),
        t.s *= 100 / 255,
        t.b *= 100 / 255,
        t
    },
    s = function(e) {
        var t = {},
        i = e.h,
        n = 255 * e.s / 100,
        r = 255 * e.b / 100;
        if (0 == n) t.r = t.g = t.b = r;
        else {
            var s = r,
            o = (255 - n) * r / 255,
            a = (s - o) * (i % 60) / 60;
            360 == i && (i = 0),
            i < 60 ? (t.r = s, t.b = o, t.g = o + a) : i < 120 ? (t.g = s, t.b = o, t.r = s - a) : i < 180 ? (t.g = s, t.r = o, t.b = o + a) : i < 240 ? (t.b = s, t.r = o, t.g = s - a) : i < 300 ? (t.b = s, t.g = o, t.r = o + a) : i < 360 ? (t.r = s, t.g = o, t.b = s - a) : (t.r = 0, t.g = 0, t.b = 0)
        }
        return {
            r: Math.round(t.r),
            g: Math.round(t.g),
            b: Math.round(t.b)
        }
    },
    o = function(t) {
        var i = [t.r.toString(16), t.g.toString(16), t.b.toString(16)];
        return e.each(i,
        function(e, t) {
            1 == t.length && (i[e] = "0" + t)
        }),
        i.join("")
    },
    a = function(e) {
        return o(s(e))
    };
    e.fn.extend({
        colpick: t.init,
        colpickHide: t.hidePicker,
        colpickShow: t.showPicker,
        colpickSetColor: t.setColor
    }),
    e.extend({
        colpick: {
            rgbToHex: o,
            rgbToHsb: r,
            hsbToHex: a,
            hsbToRgb: s,
            hexToHsb: n,
            hexToRgb: i
        }
    })
} (jQuery),
function e(t, i, n) {
    function r(o, a) {
        if (!i[o]) {
            if (!t[o]) {
                var l = "function" == typeof require && require;
                if (!a && l) return l(o, !0);
                if (s) return s(o, !0);
                var c = new Error("Cannot find module '" + o + "'");
                throw c.code = "MODULE_NOT_FOUND",
                c
            }
            var d = i[o] = {
                exports: {}
            };
            t[o][0].call(d.exports,
            function(e) {
                var i = t[o][1][e];
                return r(i ? i: e)
            },
            d, d.exports, e, t, i, n)
        }
        return i[o].exports
    }
    for (var s = "function" == typeof require && require,
    o = 0; o < n.length; o++) r(n[o]);
    return r
} ({
    1 : [function(e, t) {
        "use strict";
        function i(e) {
            e.fn.perfectScrollbar = function(e) {
                return this.each(function() {
                    if ("object" == typeof e || "undefined" == typeof e) {
                        var t = e;
                        r.get(this) || n.initialize(this, t)
                    } else {
                        var i = e;
                        "update" === i ? n.update(this) : "destroy" === i && n.destroy(this)
                    }
                })
            }
        }
        var n = e("../main"),
        r = e("../plugin/instances");
        if ("function" == typeof define && define.amd) define(["jquery"], i);
        else {
            var s = window.jQuery ? window.jQuery: window.$;
            "undefined" != typeof s && i(s)
        }
        t.exports = i
    },
    {
        "../main": 7,
        "../plugin/instances": 18
    }],
    2 : [function(e, t, i) {
        "use strict";
        function n(e, t) {
            var i = e.className.split(" ");
            i.indexOf(t) < 0 && i.push(t),
            e.className = i.join(" ")
        }
        function r(e, t) {
            var i = e.className.split(" "),
            n = i.indexOf(t);
            n >= 0 && i.splice(n, 1),
            e.className = i.join(" ")
        }
        i.add = function(e, t) {
            e.classList ? e.classList.add(t) : n(e, t)
        },
        i.remove = function(e, t) {
            e.classList ? e.classList.remove(t) : r(e, t)
        },
        i.list = function(e) {
            return e.classList ? Array.prototype.slice.apply(e.classList) : e.className.split(" ")
        }
    },
    {}],
    3 : [function(e, t) {
        "use strict";
        function i(e, t) {
            return window.getComputedStyle(e)[t]
        }
        function n(e, t, i) {
            return "number" == typeof i && (i = i.toString() + "px"),
            e.style[t] = i,
            e
        }
        function r(e, t) {
            for (var i in t) {
                var n = t[i];
                "number" == typeof n && (n = n.toString() + "px"),
                e.style[i] = n
            }
            return e
        }
        var s = {};
        s.e = function(e, t) {
            var i = document.createElement(e);
            return i.className = t,
            i
        },
        s.appendTo = function(e, t) {
            return t.appendChild(e),
            e
        },
        s.css = function(e, t, s) {
            return "object" == typeof t ? r(e, t) : "undefined" == typeof s ? i(e, t) : n(e, t, s)
        },
        s.matches = function(e, t) {
            return "undefined" != typeof e.matches ? e.matches(t) : "undefined" != typeof e.matchesSelector ? e.matchesSelector(t) : "undefined" != typeof e.webkitMatchesSelector ? e.webkitMatchesSelector(t) : "undefined" != typeof e.mozMatchesSelector ? e.mozMatchesSelector(t) : "undefined" != typeof e.msMatchesSelector ? e.msMatchesSelector(t) : void 0
        },
        s.remove = function(e) {
            "undefined" != typeof e.remove ? e.remove() : e.parentNode && e.parentNode.removeChild(e)
        },
        s.queryChildren = function(e, t) {
            return Array.prototype.filter.call(e.childNodes,
            function(e) {
                return s.matches(e, t)
            })
        },
        t.exports = s
    },
    {}],
    4 : [function(e, t) {
        "use strict";
        var i = function(e) {
            this.element = e,
            this.events = {}
        };
        i.prototype.bind = function(e, t) {
            "undefined" == typeof this.events[e] && (this.events[e] = []),
            this.events[e].push(t),
            this.element.addEventListener(e, t, !1)
        },
        i.prototype.unbind = function(e, t) {
            var i = "undefined" != typeof t;
            this.events[e] = this.events[e].filter(function(n) {
                return ! (!i || n === t) || (this.element.removeEventListener(e, n, !1), !1)
            },
            this)
        },
        i.prototype.unbindAll = function() {
            for (var e in this.events) this.unbind(e)
        };
        var n = function() {
            this.eventElements = []
        };
        n.prototype.eventElement = function(e) {
            var t = this.eventElements.filter(function(t) {
                return t.element === e
            })[0];
            return "undefined" == typeof t && (t = new i(e), this.eventElements.push(t)),
            t
        },
        n.prototype.bind = function(e, t, i) {
            this.eventElement(e).bind(t, i)
        },
        n.prototype.unbind = function(e, t, i) {
            this.eventElement(e).unbind(t, i)
        },
        n.prototype.unbindAll = function() {
            for (var e = 0; e < this.eventElements.length; e++) this.eventElements[e].unbindAll()
        },
        n.prototype.once = function(e, t, i) {
            var n = this.eventElement(e),
            r = function(e) {
                n.unbind(t, r),
                i(e)
            };
            n.bind(t, r)
        },
        t.exports = n
    },
    {}],
    5 : [function(e, t) {
        "use strict";
        t.exports = function() {
            function e() {
                return Math.floor(65536 * (1 + Math.random())).toString(16).substring(1)
            }
            return function() {
                return e() + e() + "-" + e() + "-" + e() + "-" + e() + "-" + e() + e() + e()
            }
        } ()
    },
    {}],
    6 : [function(e, t, i) {
        "use strict";
        var n = e("./class"),
        r = e("./dom"),
        s = i.toInt = function(e) {
            return parseInt(e, 10) || 0
        },
        o = i.clone = function(e) {
            if (null === e) return null;
            if (e.constructor === Array) return e.map(o);
            if ("object" == typeof e) {
                var t = {};
                for (var i in e) t[i] = o(e[i]);
                return t
            }
            return e
        };
        i.extend = function(e, t) {
            var i = o(e);
            for (var n in t) i[n] = o(t[n]);
            return i
        },
        i.isEditable = function(e) {
            return r.matches(e, "input,[contenteditable]") || r.matches(e, "select,[contenteditable]") || r.matches(e, "textarea,[contenteditable]") || r.matches(e, "button,[contenteditable]")
        },
        i.removePsClasses = function(e) {
            for (var t = n.list(e), i = 0; i < t.length; i++) {
                var r = t[i];
                0 === r.indexOf("ps-") && n.remove(e, r)
            }
        },
        i.outerWidth = function(e) {
            return s(r.css(e, "width")) + s(r.css(e, "paddingLeft")) + s(r.css(e, "paddingRight")) + s(r.css(e, "borderLeftWidth")) + s(r.css(e, "borderRightWidth"))
        },
        i.startScrolling = function(e, t) {
            n.add(e, "ps-in-scrolling"),
            "undefined" != typeof t ? n.add(e, "ps-" + t) : (n.add(e, "ps-x"), n.add(e, "ps-y"))
        },
        i.stopScrolling = function(e, t) {
            n.remove(e, "ps-in-scrolling"),
            "undefined" != typeof t ? n.remove(e, "ps-" + t) : (n.remove(e, "ps-x"), n.remove(e, "ps-y"))
        },
        i.env = {
            isWebKit: "WebkitAppearance" in document.documentElement.style,
            supportsTouch: "ontouchstart" in window || window.DocumentTouch && document instanceof window.DocumentTouch,
            supportsIePointer: null !== window.navigator.msMaxTouchPoints
        }
    },
    {
        "./class": 2,
        "./dom": 3
    }],
    7 : [function(e, t) {
        "use strict";
        var i = e("./plugin/destroy"),
        n = e("./plugin/initialize"),
        r = e("./plugin/update");
        t.exports = {
            initialize: n,
            update: r,
            destroy: i
        }
    },
    {
        "./plugin/destroy": 9,
        "./plugin/initialize": 17,
        "./plugin/update": 21
    }],
    8 : [function(e, t) {
        "use strict";
        t.exports = {
            handlers: ["click-rail", "drag-scrollbar", "keyboard", "wheel", "touch"],
            maxScrollbarLength: null,
            minScrollbarLength: null,
            scrollXMarginOffset: 0,
            scrollYMarginOffset: 0,
            stopPropagationOnClick: !0,
            suppressScrollX: !1,
            suppressScrollY: !1,
            swipePropagation: !0,
            useBothWheelAxes: !1,
            wheelPropagation: !1,
            wheelSpeed: 1,
            theme: "default"
        }
    },
    {}],
    9 : [function(e, t) {
        "use strict";
        var i = e("../lib/helper"),
        n = e("../lib/dom"),
        r = e("./instances");
        t.exports = function(e) {
            var t = r.get(e);
            t && (t.event.unbindAll(), n.remove(t.scrollbarX), n.remove(t.scrollbarY), n.remove(t.scrollbarXRail), n.remove(t.scrollbarYRail), i.removePsClasses(e), r.remove(e))
        }
    },
    {
        "../lib/dom": 3,
        "../lib/helper": 6,
        "./instances": 18
    }],
    10 : [function(e, t) {
        "use strict";
        function i(e, t) {
            function i(e) {
                return e.getBoundingClientRect()
            }
            var r = function(e) {
                e.stopPropagation()
            };
            t.settings.stopPropagationOnClick && t.event.bind(t.scrollbarY, "click", r),
            t.event.bind(t.scrollbarYRail, "click",
            function(r) {
                var a = n.toInt(t.scrollbarYHeight / 2),
                l = t.railYRatio * (r.pageY - window.pageYOffset - i(t.scrollbarYRail).top - a),
                c = t.railYRatio * (t.railYHeight - t.scrollbarYHeight),
                d = l / c;
                d < 0 ? d = 0 : d > 1 && (d = 1),
                o(e, "top", (t.contentHeight - t.containerHeight) * d),
                s(e),
                r.stopPropagation()
            }),
            t.settings.stopPropagationOnClick && t.event.bind(t.scrollbarX, "click", r),
            t.event.bind(t.scrollbarXRail, "click",
            function(r) {
                var a = n.toInt(t.scrollbarXWidth / 2),
                l = t.railXRatio * (r.pageX - window.pageXOffset - i(t.scrollbarXRail).left - a),
                c = t.railXRatio * (t.railXWidth - t.scrollbarXWidth),
                d = l / c;
                d < 0 ? d = 0 : d > 1 && (d = 1),
                o(e, "left", (t.contentWidth - t.containerWidth) * d - t.negativeScrollAdjustment),
                s(e),
                r.stopPropagation()
            })
        }
        var n = e("../../lib/helper"),
        r = e("../instances"),
        s = e("../update-geometry"),
        o = e("../update-scroll");
        t.exports = function(e) {
            var t = r.get(e);
            i(e, t)
        }
    },
    {
        "../../lib/helper": 6,
        "../instances": 18,
        "../update-geometry": 19,
        "../update-scroll": 20
    }],
    11 : [function(e, t) {
        "use strict";
        function i(e, t) {
            function i(i) {
                var s = n + i * t.railXRatio,
                o = Math.max(0, t.scrollbarXRail.getBoundingClientRect().left) + t.railXRatio * (t.railXWidth - t.scrollbarXWidth);
                s < 0 ? t.scrollbarXLeft = 0 : s > o ? t.scrollbarXLeft = o: t.scrollbarXLeft = s;
                var a = r.toInt(t.scrollbarXLeft * (t.contentWidth - t.containerWidth) / (t.containerWidth - t.railXRatio * t.scrollbarXWidth)) - t.negativeScrollAdjustment;
                l(e, "left", a)
            }
            var n = null,
            o = null,
            c = function(t) {
                i(t.pageX - o),
                a(e),
                t.stopPropagation(),
                t.preventDefault()
            },
            d = function() {
                r.stopScrolling(e, "x"),
                t.event.unbind(t.ownerDocument, "mousemove", c)
            };
            t.event.bind(t.scrollbarX, "mousedown",
            function(i) {
                o = i.pageX,
                n = r.toInt(s.css(t.scrollbarX, "left")) * t.railXRatio,
                r.startScrolling(e, "x"),
                t.event.bind(t.ownerDocument, "mousemove", c),
                t.event.once(t.ownerDocument, "mouseup", d),
                i.stopPropagation(),
                i.preventDefault()
            })
        }
        function n(e, t) {
            function i(i) {
                var s = n + i * t.railYRatio,
                o = Math.max(0, t.scrollbarYRail.getBoundingClientRect().top) + t.railYRatio * (t.railYHeight - t.scrollbarYHeight);
                s < 0 ? t.scrollbarYTop = 0 : s > o ? t.scrollbarYTop = o: t.scrollbarYTop = s;
                var a = r.toInt(t.scrollbarYTop * (t.contentHeight - t.containerHeight) / (t.containerHeight - t.railYRatio * t.scrollbarYHeight));
                l(e, "top", a)
            }
            var n = null,
            o = null,
            c = function(t) {
                i(t.pageY - o),
                a(e),
                t.stopPropagation(),
                t.preventDefault()
            },
            d = function() {
                r.stopScrolling(e, "y"),
                t.event.unbind(t.ownerDocument, "mousemove", c)
            };
            t.event.bind(t.scrollbarY, "mousedown",
            function(i) {
                o = i.pageY,
                n = r.toInt(s.css(t.scrollbarY, "top")) * t.railYRatio,
                r.startScrolling(e, "y"),
                t.event.bind(t.ownerDocument, "mousemove", c),
                t.event.once(t.ownerDocument, "mouseup", d),
                i.stopPropagation(),
                i.preventDefault()
            })
        }
        var r = e("../../lib/helper"),
        s = e("../../lib/dom"),
        o = e("../instances"),
        a = e("../update-geometry"),
        l = e("../update-scroll");
        t.exports = function(e) {
            var t = o.get(e);
            i(e, t),
            n(e, t)
        }
    },
    {
        "../../lib/dom": 3,
        "../../lib/helper": 6,
        "../instances": 18,
        "../update-geometry": 19,
        "../update-scroll": 20
    }],
    12 : [function(e, t) {
        "use strict";
        function i(e, t) {
            function i(i, n) {
                var r = e.scrollTop;
                if (0 === i) {
                    if (!t.scrollbarYActive) return ! 1;
                    if (0 === r && n > 0 || r >= t.contentHeight - t.containerHeight && n < 0) return ! t.settings.wheelPropagation
                }
                var s = e.scrollLeft;
                if (0 === n) {
                    if (!t.scrollbarXActive) return ! 1;
                    if (0 === s && i < 0 || s >= t.contentWidth - t.containerWidth && i > 0) return ! t.settings.wheelPropagation
                }
                return ! 0
            }
            var s = !1;
            t.event.bind(e, "mouseenter",
            function() {
                s = !0
            }),
            t.event.bind(e, "mouseleave",
            function() {
                s = !1
            });
            var l = !1;
            t.event.bind(t.ownerDocument, "keydown",
            function(c) {
                if (!c.isDefaultPrevented || !c.isDefaultPrevented()) {
                    var d = r.matches(t.scrollbarX, ":focus") || r.matches(t.scrollbarY, ":focus");
                    if (s || d) {
                        var u = document.activeElement ? document.activeElement: t.ownerDocument.activeElement;
                        if (u) {
                            if ("IFRAME" === u.tagName) u = u.contentDocument.activeElement;
                            else for (; u.shadowRoot;) u = u.shadowRoot.activeElement;
                            if (n.isEditable(u)) return
                        }
                        var h = 0,
                        p = 0;
                        switch (c.which) {
                        case 37:
                            h = -30;
                            break;
                        case 38:
                            p = 30;
                            break;
                        case 39:
                            h = 30;
                            break;
                        case 40:
                            p = -30;
                            break;
                        case 33:
                            p = 90;
                            break;
                        case 32:
                            p = c.shiftKey ? 90 : -90;
                            break;
                        case 34:
                            p = -90;
                            break;
                        case 35:
                            p = c.ctrlKey ? -t.contentHeight: -t.containerHeight;
                            break;
                        case 36:
                            p = c.ctrlKey ? e.scrollTop: t.containerHeight;
                            break;
                        default:
                            return
                        }
                        a(e, "top", e.scrollTop - p),
                        a(e, "left", e.scrollLeft + h),
                        o(e),
                        l = i(h, p),
                        l && c.preventDefault()
                    }
                }
            })
        }
        var n = e("../../lib/helper"),
        r = e("../../lib/dom"),
        s = e("../instances"),
        o = e("../update-geometry"),
        a = e("../update-scroll");
        t.exports = function(e) {
            var t = s.get(e);
            i(e, t)
        }
    },
    {
        "../../lib/dom": 3,
        "../../lib/helper": 6,
        "../instances": 18,
        "../update-geometry": 19,
        "../update-scroll": 20
    }],
    13 : [function(e, t) {
        "use strict";
        function i(e, t) {
            function i(i, n) {
                var r = e.scrollTop;
                if (0 === i) {
                    if (!t.scrollbarYActive) return ! 1;
                    if (0 === r && n > 0 || r >= t.contentHeight - t.containerHeight && n < 0) return ! t.settings.wheelPropagation
                }
                var s = e.scrollLeft;
                if (0 === n) {
                    if (!t.scrollbarXActive) return ! 1;
                    if (0 === s && i < 0 || s >= t.contentWidth - t.containerWidth && i > 0) return ! t.settings.wheelPropagation
                }
                return ! 0
            }
            function n(e) {
                var t = e.deltaX,
                i = -1 * e.deltaY;
                return "undefined" != typeof t && "undefined" != typeof i || (t = -1 * e.wheelDeltaX / 6, i = e.wheelDeltaY / 6),
                e.deltaMode && 1 === e.deltaMode && (t *= 10, i *= 10),
                t !== t && i !== i && (t = 0, i = e.wheelDelta),
                [t, i]
            }
            function o(t, i) {
                var n = e.querySelector("textarea:hover, .ps-child:hover");
                if (n) {
                    if ("TEXTAREA" !== n.tagName && !window.getComputedStyle(n).overflow.match(/(scroll|auto)/)) return ! 1;
                    var r = n.scrollHeight - n.clientHeight;
                    if (r > 0 && !(0 === n.scrollTop && i > 0 || n.scrollTop === r && i < 0)) return ! 0;
                    var s = n.scrollLeft - n.clientWidth;
                    if (s > 0 && !(0 === n.scrollLeft && t < 0 || n.scrollLeft === s && t > 0)) return ! 0
                }
                return ! 1
            }
            function a(a) {
                var c = n(a),
                d = c[0],
                u = c[1];
                o(d, u) || (l = !1, t.settings.useBothWheelAxes ? t.scrollbarYActive && !t.scrollbarXActive ? (u ? s(e, "top", e.scrollTop - u * t.settings.wheelSpeed) : s(e, "top", e.scrollTop + d * t.settings.wheelSpeed), l = !0) : t.scrollbarXActive && !t.scrollbarYActive && (d ? s(e, "left", e.scrollLeft + d * t.settings.wheelSpeed) : s(e, "left", e.scrollLeft - u * t.settings.wheelSpeed), l = !0) : (s(e, "top", e.scrollTop - u * t.settings.wheelSpeed), s(e, "left", e.scrollLeft + d * t.settings.wheelSpeed)), r(e), l = l || i(d, u), l && (a.stopPropagation(), a.preventDefault()))
            }
            var l = !1;
            "undefined" != typeof window.onwheel ? t.event.bind(e, "wheel", a) : "undefined" != typeof window.onmousewheel && t.event.bind(e, "mousewheel", a)
        }
        var n = e("../instances"),
        r = e("../update-geometry"),
        s = e("../update-scroll");
        t.exports = function(e) {
            var t = n.get(e);
            i(e, t)
        }
    },
    {
        "../instances": 18,
        "../update-geometry": 19,
        "../update-scroll": 20
    }],
    14 : [function(e, t) {
        "use strict";
        function i(e, t) {
            t.event.bind(e, "scroll",
            function() {
                r(e)
            })
        }
        var n = e("../instances"),
        r = e("../update-geometry");
        t.exports = function(e) {
            var t = n.get(e);
            i(e, t)
        }
    },
    {
        "../instances": 18,
        "../update-geometry": 19
    }],
    15 : [function(e, t) {
        "use strict";
        function i(e, t) {
            function i() {
                var e = window.getSelection ? window.getSelection() : document.getSelection ? document.getSelection() : "";
                return 0 === e.toString().length ? null: e.getRangeAt(0).commonAncestorContainer
            }
            function a() {
                c || (c = setInterval(function() {
                    return r.get(e) ? (o(e, "top", e.scrollTop + d.top), o(e, "left", e.scrollLeft + d.left), void s(e)) : void clearInterval(c)
                },
                50))
            }
            function l() {
                c && (clearInterval(c), c = null),
                n.stopScrolling(e)
            }
            var c = null,
            d = {
                top: 0,
                left: 0
            },
            u = !1;
            t.event.bind(t.ownerDocument, "selectionchange",
            function() {
                e.contains(i()) ? u = !0 : (u = !1, l())
            }),
            t.event.bind(window, "mouseup",
            function() {
                u && (u = !1, l())
            }),
            t.event.bind(window, "mousemove",
            function(t) {
                if (u) {
                    var i = {
                        x: t.pageX,
                        y: t.pageY
                    },
                    r = {
                        left: e.offsetLeft,
                        right: e.offsetLeft + e.offsetWidth,
                        top: e.offsetTop,
                        bottom: e.offsetTop + e.offsetHeight
                    };
                    i.x < r.left + 3 ? (d.left = -5, n.startScrolling(e, "x")) : i.x > r.right - 3 ? (d.left = 5, n.startScrolling(e, "x")) : d.left = 0,
                    i.y < r.top + 3 ? (r.top + 3 - i.y < 5 ? d.top = -5 : d.top = -20, n.startScrolling(e, "y")) : i.y > r.bottom - 3 ? (i.y - r.bottom + 3 < 5 ? d.top = 5 : d.top = 20, n.startScrolling(e, "y")) : d.top = 0,
                    0 === d.top && 0 === d.left ? l() : a()
                }
            })
        }
        var n = e("../../lib/helper"),
        r = e("../instances"),
        s = e("../update-geometry"),
        o = e("../update-scroll");
        t.exports = function(e) {
            var t = r.get(e);
            i(e, t)
        }
    },
    {
        "../../lib/helper": 6,
        "../instances": 18,
        "../update-geometry": 19,
        "../update-scroll": 20
    }],
    16 : [function(e, t) {
        "use strict";
        function i(e, t, i, n) {
            function a(i, n) {
                var r = e.scrollTop,
                s = e.scrollLeft,
                o = Math.abs(i),
                a = Math.abs(n);
                if (a > o) {
                    if (n < 0 && r === t.contentHeight - t.containerHeight || n > 0 && 0 === r) return ! t.settings.swipePropagation
                } else if (o > a && (i < 0 && s === t.contentWidth - t.containerWidth || i > 0 && 0 === s)) return ! t.settings.swipePropagation;
                return ! 0
            }
            function l(t, i) {
                o(e, "top", e.scrollTop - i),
                o(e, "left", e.scrollLeft - t),
                s(e)
            }
            function c() {
                _ = !0
            }
            function d() {
                _ = !1
            }
            function u(e) {
                return e.targetTouches ? e.targetTouches[0] : e
            }
            function h(e) {
                return ! (!e.targetTouches || 1 !== e.targetTouches.length) || !(!e.pointerType || "mouse" === e.pointerType || e.pointerType === e.MSPOINTER_TYPE_MOUSE)
            }
            function p(e) {
                if (h(e)) {
                    w = !0;
                    var t = u(e);
                    m.pageX = t.pageX,
                    m.pageY = t.pageY,
                    v = (new Date).getTime(),
                    null !== y && clearInterval(y),
                    e.stopPropagation()
                }
            }
            function f(e) {
                if (!w && t.settings.swipePropagation && p(e), !_ && w && h(e)) {
                    var i = u(e),
                    n = {
                        pageX: i.pageX,
                        pageY: i.pageY
                    },
                    r = n.pageX - m.pageX,
                    s = n.pageY - m.pageY;
                    l(r, s),
                    m = n;
                    var o = (new Date).getTime(),
                    c = o - v;
                    c > 0 && (b.x = r / c, b.y = s / c, v = o),
                    a(r, s) && (e.stopPropagation(), e.preventDefault())
                }
            }
            function g() { ! _ && w && (w = !1, clearInterval(y), y = setInterval(function() {
                    return r.get(e) ? Math.abs(b.x) < .01 && Math.abs(b.y) < .01 ? void clearInterval(y) : (l(30 * b.x, 30 * b.y), b.x *= .8, void(b.y *= .8)) : void clearInterval(y)
                },
                10))
            }
            var m = {},
            v = 0,
            b = {},
            y = null,
            _ = !1,
            w = !1;
            i && (t.event.bind(window, "touchstart", c), t.event.bind(window, "touchend", d), t.event.bind(e, "touchstart", p), t.event.bind(e, "touchmove", f), t.event.bind(e, "touchend", g)),
            n && (window.PointerEvent ? (t.event.bind(window, "pointerdown", c), t.event.bind(window, "pointerup", d), t.event.bind(e, "pointerdown", p), t.event.bind(e, "pointermove", f), t.event.bind(e, "pointerup", g)) : window.MSPointerEvent && (t.event.bind(window, "MSPointerDown", c), t.event.bind(window, "MSPointerUp", d), t.event.bind(e, "MSPointerDown", p), t.event.bind(e, "MSPointerMove", f), t.event.bind(e, "MSPointerUp", g)))
        }
        var n = e("../../lib/helper"),
        r = e("../instances"),
        s = e("../update-geometry"),
        o = e("../update-scroll");
        t.exports = function(e) {
            if (n.env.supportsTouch || n.env.supportsIePointer) {
                var t = r.get(e);
                i(e, t, n.env.supportsTouch, n.env.supportsIePointer)
            }
        }
    },
    {
        "../../lib/helper": 6,
        "../instances": 18,
        "../update-geometry": 19,
        "../update-scroll": 20
    }],
    17 : [function(e, t) {
        "use strict";
        var i = e("../lib/helper"),
        n = e("../lib/class"),
        r = e("./instances"),
        s = e("./update-geometry"),
        o = {
            "click-rail": e("./handler/click-rail"),
            "drag-scrollbar": e("./handler/drag-scrollbar"),
            keyboard: e("./handler/keyboard"),
            wheel: e("./handler/mouse-wheel"),
            touch: e("./handler/touch"),
            selection: e("./handler/selection")
        },
        a = e("./handler/native-scroll");
        t.exports = function(e, t) {
            t = "object" == typeof t ? t: {},
            n.add(e, "ps-container");
            var l = r.add(e);
            l.settings = i.extend(l.settings, t),
            n.add(e, "ps-theme-" + l.settings.theme),
            l.settings.handlers.forEach(function(t) {
                o[t](e)
            }),
            a(e),
            s(e)
        }
    },
    {
        "../lib/class": 2,
        "../lib/helper": 6,
        "./handler/click-rail": 10,
        "./handler/drag-scrollbar": 11,
        "./handler/keyboard": 12,
        "./handler/mouse-wheel": 13,
        "./handler/native-scroll": 14,
        "./handler/selection": 15,
        "./handler/touch": 16,
        "./instances": 18,
        "./update-geometry": 19
    }],
    18 : [function(e, t, i) {
        "use strict";
        function n(e) {
            function t() {
                l.add(e, "ps-focus")
            }
            function i() {
                l.remove(e, "ps-focus")
            }
            var n = this;
            n.settings = a.clone(c),
            n.containerWidth = null,
            n.containerHeight = null,
            n.contentWidth = null,
            n.contentHeight = null,
            n.isRtl = "rtl" === d.css(e, "direction"),
            n.isNegativeScroll = function() {
                var t = e.scrollLeft,
                i = null;
                return e.scrollLeft = -1,
                i = e.scrollLeft < 0,
                e.scrollLeft = t,
                i
            } (),
            n.negativeScrollAdjustment = n.isNegativeScroll ? e.scrollWidth - e.clientWidth: 0,
            n.event = new u,
            n.ownerDocument = e.ownerDocument || document,
            n.scrollbarXRail = d.appendTo(d.e("div", "ps-scrollbar-x-rail"), e),
            n.scrollbarX = d.appendTo(d.e("div", "ps-scrollbar-x"), n.scrollbarXRail),
            n.scrollbarX.setAttribute("tabindex", 0),
            n.event.bind(n.scrollbarX, "focus", t),
            n.event.bind(n.scrollbarX, "blur", i),
            n.scrollbarXActive = null,
            n.scrollbarXWidth = null,
            n.scrollbarXLeft = null,
            n.scrollbarXBottom = a.toInt(d.css(n.scrollbarXRail, "bottom")),
            n.isScrollbarXUsingBottom = n.scrollbarXBottom === n.scrollbarXBottom,
            n.scrollbarXTop = n.isScrollbarXUsingBottom ? null: a.toInt(d.css(n.scrollbarXRail, "top")),
            n.railBorderXWidth = a.toInt(d.css(n.scrollbarXRail, "borderLeftWidth")) + a.toInt(d.css(n.scrollbarXRail, "borderRightWidth")),
            d.css(n.scrollbarXRail, "display", "block"),
            n.railXMarginWidth = a.toInt(d.css(n.scrollbarXRail, "marginLeft")) + a.toInt(d.css(n.scrollbarXRail, "marginRight")),
            d.css(n.scrollbarXRail, "display", ""),
            n.railXWidth = null,
            n.railXRatio = null,
            n.scrollbarYRail = d.appendTo(d.e("div", "ps-scrollbar-y-rail"), e),
            n.scrollbarY = d.appendTo(d.e("div", "ps-scrollbar-y"), n.scrollbarYRail),
            n.scrollbarY.setAttribute("tabindex", 0),
            n.event.bind(n.scrollbarY, "focus", t),
            n.event.bind(n.scrollbarY, "blur", i),
            n.scrollbarYActive = null,
            n.scrollbarYHeight = null,
            n.scrollbarYTop = null,
            n.scrollbarYRight = a.toInt(d.css(n.scrollbarYRail, "right")),
            n.isScrollbarYUsingRight = n.scrollbarYRight === n.scrollbarYRight,
            n.scrollbarYLeft = n.isScrollbarYUsingRight ? null: a.toInt(d.css(n.scrollbarYRail, "left")),
            n.scrollbarYOuterWidth = n.isRtl ? a.outerWidth(n.scrollbarY) : null,
            n.railBorderYWidth = a.toInt(d.css(n.scrollbarYRail, "borderTopWidth")) + a.toInt(d.css(n.scrollbarYRail, "borderBottomWidth")),
            d.css(n.scrollbarYRail, "display", "block"),
            n.railYMarginHeight = a.toInt(d.css(n.scrollbarYRail, "marginTop")) + a.toInt(d.css(n.scrollbarYRail, "marginBottom")),
            d.css(n.scrollbarYRail, "display", ""),
            n.railYHeight = null,
            n.railYRatio = null
        }
        function r(e) {
            return e.getAttribute("data-ps-id")
        }
        function s(e, t) {
            e.setAttribute("data-ps-id", t)
        }
        function o(e) {
            e.removeAttribute("data-ps-id")
        }
        var a = e("../lib/helper"),
        l = e("../lib/class"),
        c = e("./default-setting"),
        d = e("../lib/dom"),
        u = e("../lib/event-manager"),
        h = e("../lib/guid"),
        p = {};
        i.add = function(e) {
            var t = h();
            return s(e, t),
            p[t] = new n(e),
            p[t]
        },
        i.remove = function(e) {
            delete p[r(e)],
            o(e)
        },
        i.get = function(e) {
            return p[r(e)]
        }
    },
    {
        "../lib/class": 2,
        "../lib/dom": 3,
        "../lib/event-manager": 4,
        "../lib/guid": 5,
        "../lib/helper": 6,
        "./default-setting": 8
    }],
    19 : [function(e, t) {
        "use strict";
        function i(e, t) {
            return e.settings.minScrollbarLength && (t = Math.max(t, e.settings.minScrollbarLength)),
            e.settings.maxScrollbarLength && (t = Math.min(t, e.settings.maxScrollbarLength)),
            t
        }
        function n(e, t) {
            var i = {
                width: t.railXWidth
            };
            t.isRtl ? i.left = t.negativeScrollAdjustment + e.scrollLeft + t.containerWidth - t.contentWidth: i.left = e.scrollLeft,
            t.isScrollbarXUsingBottom ? i.bottom = t.scrollbarXBottom - e.scrollTop: i.top = t.scrollbarXTop + e.scrollTop,
            o.css(t.scrollbarXRail, i);
            var n = {
                top: e.scrollTop,
                height: t.railYHeight
            };
            t.isScrollbarYUsingRight ? t.isRtl ? n.right = t.contentWidth - (t.negativeScrollAdjustment + e.scrollLeft) - t.scrollbarYRight - t.scrollbarYOuterWidth: n.right = t.scrollbarYRight - e.scrollLeft: t.isRtl ? n.left = t.negativeScrollAdjustment + e.scrollLeft + 2 * t.containerWidth - t.contentWidth - t.scrollbarYLeft - t.scrollbarYOuterWidth: n.left = t.scrollbarYLeft + e.scrollLeft,
            o.css(t.scrollbarYRail, n),
            o.css(t.scrollbarX, {
                left: t.scrollbarXLeft,
                width: t.scrollbarXWidth - t.railBorderXWidth
            }),
            o.css(t.scrollbarY, {
                top: t.scrollbarYTop,
                height: t.scrollbarYHeight - t.railBorderYWidth
            })
        }
        var r = e("../lib/helper"),
        s = e("../lib/class"),
        o = e("../lib/dom"),
        a = e("./instances"),
        l = e("./update-scroll");
        t.exports = function(e) {
            var t = a.get(e);
            t.containerWidth = e.clientWidth,
            t.containerHeight = e.clientHeight,
            t.contentWidth = e.scrollWidth,
            t.contentHeight = e.scrollHeight;
            var c;
            e.contains(t.scrollbarXRail) || (c = o.queryChildren(e, ".ps-scrollbar-x-rail"), c.length > 0 && c.forEach(function(e) {
                o.remove(e)
            }), o.appendTo(t.scrollbarXRail, e)),
            e.contains(t.scrollbarYRail) || (c = o.queryChildren(e, ".ps-scrollbar-y-rail"), c.length > 0 && c.forEach(function(e) {
                o.remove(e)
            }), o.appendTo(t.scrollbarYRail, e)),
            !t.settings.suppressScrollX && t.containerWidth + t.settings.scrollXMarginOffset < t.contentWidth ? (t.scrollbarXActive = !0, t.railXWidth = t.containerWidth - t.railXMarginWidth, t.railXRatio = t.containerWidth / t.railXWidth, t.scrollbarXWidth = i(t, r.toInt(t.railXWidth * t.containerWidth / t.contentWidth)), t.scrollbarXLeft = r.toInt((t.negativeScrollAdjustment + e.scrollLeft) * (t.railXWidth - t.scrollbarXWidth) / (t.contentWidth - t.containerWidth))) : t.scrollbarXActive = !1,
            !t.settings.suppressScrollY && t.containerHeight + t.settings.scrollYMarginOffset < t.contentHeight ? (t.scrollbarYActive = !0, t.railYHeight = t.containerHeight - t.railYMarginHeight, t.railYRatio = t.containerHeight / t.railYHeight, t.scrollbarYHeight = i(t, r.toInt(t.railYHeight * t.containerHeight / t.contentHeight)), t.scrollbarYTop = r.toInt(e.scrollTop * (t.railYHeight - t.scrollbarYHeight) / (t.contentHeight - t.containerHeight))) : t.scrollbarYActive = !1,
            t.scrollbarXLeft >= t.railXWidth - t.scrollbarXWidth && (t.scrollbarXLeft = t.railXWidth - t.scrollbarXWidth),
            t.scrollbarYTop >= t.railYHeight - t.scrollbarYHeight && (t.scrollbarYTop = t.railYHeight - t.scrollbarYHeight),
            n(e, t),
            t.scrollbarXActive ? s.add(e, "ps-active-x") : (s.remove(e, "ps-active-x"), t.scrollbarXWidth = 0, t.scrollbarXLeft = 0, l(e, "left", 0)),
            t.scrollbarYActive ? s.add(e, "ps-active-y") : (s.remove(e, "ps-active-y"), t.scrollbarYHeight = 0, t.scrollbarYTop = 0, l(e, "top", 0))
        }
    },
    {
        "../lib/class": 2,
        "../lib/dom": 3,
        "../lib/helper": 6,
        "./instances": 18,
        "./update-scroll": 20
    }],
    20 : [function(e, t) {
        "use strict";
        var i, n, r = e("./instances"),
        s = document.createEvent("Event"),
        o = document.createEvent("Event"),
        a = document.createEvent("Event"),
        l = document.createEvent("Event"),
        c = document.createEvent("Event"),
        d = document.createEvent("Event"),
        u = document.createEvent("Event"),
        h = document.createEvent("Event"),
        p = document.createEvent("Event"),
        f = document.createEvent("Event");
        s.initEvent("ps-scroll-up", !0, !0),
        o.initEvent("ps-scroll-down", !0, !0),
        a.initEvent("ps-scroll-left", !0, !0),
        l.initEvent("ps-scroll-right", !0, !0),
        c.initEvent("ps-scroll-y", !0, !0),
        d.initEvent("ps-scroll-x", !0, !0),
        u.initEvent("ps-x-reach-start", !0, !0),
        h.initEvent("ps-x-reach-end", !0, !0),
        p.initEvent("ps-y-reach-start", !0, !0),
        f.initEvent("ps-y-reach-end", !0, !0),
        t.exports = function(e, t, g) {
            if ("undefined" == typeof e) throw "You must provide an element to the update-scroll function";
            if ("undefined" == typeof t) throw "You must provide an axis to the update-scroll function";
            if ("undefined" == typeof g) throw "You must provide a value to the update-scroll function";
            "top" === t && g <= 0 && (e.scrollTop = g = 0, e.dispatchEvent(p)),
            "left" === t && g <= 0 && (e.scrollLeft = g = 0, e.dispatchEvent(u));
            var m = r.get(e);
            "top" === t && g >= m.contentHeight - m.containerHeight && (g = m.contentHeight - m.containerHeight, g - e.scrollTop <= 1 ? g = e.scrollTop: e.scrollTop = g, e.dispatchEvent(f)),
            "left" === t && g >= m.contentWidth - m.containerWidth && (g = m.contentWidth - m.containerWidth, g - e.scrollLeft <= 1 ? g = e.scrollLeft: e.scrollLeft = g, e.dispatchEvent(h)),
            i || (i = e.scrollTop),
            n || (n = e.scrollLeft),
            "top" === t && g < i && e.dispatchEvent(s),
            "top" === t && g > i && e.dispatchEvent(o),
            "left" === t && g < n && e.dispatchEvent(a),
            "left" === t && g > n && e.dispatchEvent(l),
            "top" === t && (e.scrollTop = i = g, e.dispatchEvent(c)),
            "left" === t && (e.scrollLeft = n = g, e.dispatchEvent(d))
        }
    },
    {
        "./instances": 18
    }],
    21 : [function(e, t) {
        "use strict";
        var i = e("../lib/helper"),
        n = e("../lib/dom"),
        r = e("./instances"),
        s = e("./update-geometry"),
        o = e("./update-scroll");
        t.exports = function(e) {
            var t = r.get(e);
            t && (t.negativeScrollAdjustment = t.isNegativeScroll ? e.scrollWidth - e.clientWidth: 0, n.css(t.scrollbarXRail, "display", "block"), n.css(t.scrollbarYRail, "display", "block"), t.railXMarginWidth = i.toInt(n.css(t.scrollbarXRail, "marginLeft")) + i.toInt(n.css(t.scrollbarXRail, "marginRight")), t.railYMarginHeight = i.toInt(n.css(t.scrollbarYRail, "marginTop")) + i.toInt(n.css(t.scrollbarYRail, "marginBottom")), n.css(t.scrollbarXRail, "display", "none"), n.css(t.scrollbarYRail, "display", "none"), s(e), o(e, "top", e.scrollTop), o(e, "left", e.scrollLeft), n.css(t.scrollbarXRail, "display", ""), n.css(t.scrollbarYRail, "display", ""))
        }
    },
    {
        "../lib/dom": 3,
        "../lib/helper": 6,
        "./instances": 18,
        "./update-geometry": 19,
        "./update-scroll": 20
    }]
},
{},
[1]),
void
function(e) {
    var t = "2.0.4",
    i = e.AV || {};
    e.AV = i,
    "function" == typeof define && define.amd && define("AV", [],
    function() {
        return i
    });
    var n = {
        heartbeatsTime: 3e4
    },
    r = {},
    s = {},
    o = {
        open: "open",
        close: "close",
        message: "message",
        reuse: "reuse",
        error: "error"
    },
    a = function() {
        var t = {
            options: void 0,
            ws: void 0,
            heartbeatsTimer: void 0,
            ec: void 0,
            closeFlag: !1,
            reuseTimer: void 0
        },
        i = function() {
            r.log("WebSocket opened."),
            s.loginPush(t.options),
            s.heartbeats(),
            s.guard(),
            t.ec.emit(o.open)
        },
        a = function() {
            r.log("WebSocket closed."),
            t.ec.emit(o.close)
        },
        l = function(e) {
            var i = JSON.parse(e.data);
            if ("data" === i.cmd) {
                s.ackPush(i.ids);
                var n, r = i.msg.length;
                for (n = 0; n < r; n++) t.ec.emit(o.message, i.msg[n])
            }
        },
        c = function(e) {
            throw e
        },
        d = function(e) {
            t.ws.send(JSON.stringify(e))
        },
        u = function(e, t, i) {
            var n = [];
            "string" == typeof e ? n.push(e) : n = e,
            s.channels(n, t, i)
        };
        return s.getId = function(e) {
            var t = "AV/" + e.appId + "/installationId",
            i = r.storage(t);
            return i ? i: (id = r.getId(), e.id = id, s.sendId(e,
            function() {
                r.storage(t, id)
            }), id)
        },
        s.sendId = function(e, i) {
            r.ajax({
                url: "https://" + t.options.host + "/1.1/installations",
                method: "post",
                appId: e.appId,
                appKey: e.appKey,
                data: {
                    deviceType: e.deviceType,
                    installationId: e.id,
                    channels: e.channels
                }
            },
            function(n) {
                n ? i && (i(n), t.ec.emit("leancloud-send-id-ok")) : setTimeout(function() {
                    s.sendId(e)
                },
                5e3)
            })
        },
        s.sendPush = function(e, i) {
            r.ajax({
                url: "https://" + t.options.host + "/1.1/push",
                method: "post",
                appId: e.appId,
                appKey: e.appKey,
                data: e
            },
            function(t, n) {
                if (t) i && i(t);
                else {
                    if (403 === n.code || 404 === n.code) throw n.error;
                    setTimeout(function() {
                        s.sendPush(e, i)
                    },
                    5e3)
                }
            })
        },
        s.channels = function(e, i, n) {
            var s = {
                installationId: t.options.id,
                deviceType: t.options.deviceType
            };
            n ? s.channels = {
                __op: "Remove",
                objects: e
            }: s.channels = e,
            r.ajax({
                url: "https://" + t.options.host + "/1.1/installations",
                method: "post",
                appId: t.options.appId,
                appKey: t.options.appKey,
                data: s
            },
            function(e) {
                i && i(e)
            })
        },
        s.createSocket = function(e) {
            var n = new WebSocket(e);
            t.ws = n,
            n.addEventListener("open", i),
            n.addEventListener("close", a),
            n.addEventListener("message", l),
            n.addEventListener("error", c)
        },
        s.heartbeats = function() {
            d({}),
            t.ws.addEventListener("message",
            function() {
                t.heartbeatsTimer && clearTimeout(t.heartbeatsTimer),
                t.heartbeatsTimer = setTimeout(function() {
                    d({})
                },
                n.heartbeatsTime)
            })
        },
        s.guard = function() {
            t.ec.on(o.close,
            function() {
                t.closeFlag || t.ec.emit(o.reuse)
            })
        },
        s.connect = function(e) {
            var i = e.server;
            if (! (i && r.now() < i.expires)) throw t.ec.emit(o.error),
            "WebSocket connet failed.";
            s.createSocket(i.server)
        },
        s.ackPush = function(e) {
            d({
                cmd: "ack",
                appId: t.options.appId,
                installationId: t.options.id,
                ids: e
            })
        },
        s.loginPush = function(e) {
            d({
                cmd: "login",
                appId: e.appId,
                installationId: e.id
            })
        },
        s.getServer = function(i, n) {
            var s = i.appId,
            a = i.secure,
            l = "",
            c = "http://";
            e && "https:" === e.location.protocol && (c = "https://");
            var d = "";
            switch (i.region) {
            case "cn":
                d = "g0";
                break;
            case "us":
                d = "a0";
                break;
            default:
                throw "There is no this region."
            }
            l = c + "router-" + d + "-push.leancloud.cn/v1/route?appId=" + s,
            a && (l += "&secure=1"),
            r.ajax({
                url: l
            },
            function(e, i) {
                if (e) e.expires = r.now() + 1e3 * e.ttl,
                t.server = e,
                n(e);
                else {
                    if (403 === i.code || 404 === i.code) throw i.error;
                    t.ec.emit(o.error)
                }
            })
        },
        {
            installationId: "",
            cache: t,
            open: function(e) {
                var i = this;
                return s.getServer(t.options,
                function(e) {
                    e && s.connect({
                        server: t.server
                    })
                }),
                e && t.ec.on(o.open, e),
                t.ec.once(o.reuse + " " + o.error,
                function() {
                    t.reuseTimer && clearTimeout(t.reuseTimer),
                    t.reuseTimer = setTimeout(function() {
                        i.open()
                    },
                    5e3)
                }),
                this
            },
            close: function() {
                return t.closeFlag = !0,
                t.ws.close(),
                this
            },
            on: function(e, i) {
                return t.ec.on(e, i),
                this
            },
            once: function(e, i) {
                return t.ec.once(e, i),
                this
            },
            off: function(e, i) {
                return t.ec.off(e, i),
                this
            },
            emit: function(e, i) {
                return t.ec.emit(e, i),
                this
            },
            send: function(e, i) {
                var n = {
                    appId: t.options.appId,
                    appKey: t.options.appKey
                };
                if (e.channels || e.where || e.expiration_time || e.expiration_interval || e.push_time || e.prod) {
                    for (var r in e) n[r] = e[r];
                    s.sendPush(n, i)
                } else n.data = e,
                s.sendPush(n, i);
                return this
            },
            subscribe: function(e, t) {
                return u(e, t),
                this
            },
            unsubscribe: function(e, t) {
                return u(e, t, !0),
                this
            },
            receive: function(e) {
                if (!e) throw "Receive must hava callback.";
                return t.ec.on(o.message,
                function(t) {
                    e(t)
                }),
                this
            }
        }
    };
    i.push = function(t) {
        if ("object" != typeof t) throw "AV.push need a argument at least.";
        if (t.appId) {
            if (t.appKey) {
                var i = !e.WebSocket.loadFlashPolicyFile;
                switch (t = {
                    appId: t.appId,
                    appKey: t.appKey,
                    peerId: t.clientId,
                    secure: "undefined" == typeof t.secure ? i: t.secure,
                    region: t.region || "cn",
                    channels: t.channels || [],
                    deviceType: "web"
                },
                t.region) {
                case "cn":
                    t.host = "leancloud.cn";
                    break;
                case "us":
                    t.host = "us-api.leancloud.cn"
                }
                var n = a();
                return n.cache.options = t,
                t.id = s.getId(t),
                n.installationId = t.id,
                n.cache.ec = r.eventCenter(),
                n
            }
            throw "Options must have appKey."
        }
        throw "Options must have appId."
    },
    i.push.version = t,
    i.push._tool = r,
    i.push._engine = s,
    r.noop = function() {},
    r.getId = function() {
        var e = function() {
            return Date.now().toString(36) + Math.random().toString(36).substring(2, 3)
        };
        return "AV-" + e() + "-" + e() + "-" + e()
    },
    r.log = function(e) {
        console.log(e)
    },
    r.ajax = function(e, t) {
        var i = e.url,
        n = e.method || "get",
        r = new XMLHttpRequest;
        r.open(n, i),
        "post" !== n && "put" !== n || r.setRequestHeader("Content-Type", "application/json"),
        e.appId && r.setRequestHeader("X-AVOSCloud-Application-Id", e.appId),
        e.appKey && r.setRequestHeader("X-AVOSCloud-Application-Key", e.appKey),
        r.onprogress = function() {},
        r.ontimeout = function() {},
        r.timeout = 0,
        r.onload = function() {
            r.status >= 200 && r.status < 300 ? t(JSON.parse(r.responseText)) : t(null, JSON.parse(r.responseText))
        },
        r.onerror = function(e) {
            throw t(null, e),
            "Network error."
        },
        r.send(JSON.stringify(e.data))
    },
    r.now = function() {
        return Date.now()
    },
    r.storage = function(t, i) {
        if (!i) {
            var n = e.localStorage.getItem(t);
            return /^[\{|\[]/.test(n) && /[\}|\]]$/.test(n) && (n = JSON.parse(n)),
            n
        }
        "object" == typeof i && (i = JSON.stringify(i)),
        e.localStorage.setItem(t, i)
    },
    r.eventCenter = function() {
        function e(e) {
            var t = [],
            i = 0,
            n = e.length;
            if (n) {
                for (; i < n; i++) e[i] && t.push(e[i]);
                return t
            }
            return null
        }
        var t = {},
        i = {},
        n = function(e, n, r) {
            if (!e) throw "No event name.";
            if (!n) throw "No callback function.";
            var s, o = e.split(/\s+/);
            s = r ? i: t;
            for (var a = 0,
            l = o.length; a < l; a++) o[a] && (s[o[a]] || (s[o[a]] = []), s[o[a]].push(n))
        },
        r = function(e, n, r) {
            var s;
            if (s = r ? i: t, s[e]) for (var o = 0,
            a = s[e].length; o < a; o++) if (s[e][o] === n) return void(s[e][o] = null)
        };
        return {
            on: function(e, t) {
                return n(e, t),
                this
            },
            once: function(e, t) {
                return n(e, t, !0),
                this
            },
            emit: function(n, s) {
                if (!n) throw "No emit event name.";
                var o = 0,
                a = 0;
                if (t[n]) {
                    for (o = 0, a = t[n].length; o < a; o++) t[n][o] && t[n][o].call(this, s);
                    t[n] = e(t[n])
                }
                if (i[n]) {
                    for (o = 0, a = i[n].length; o < a; o++) i[n][o] && (i[n][o].call(this, s), r(n, i[n][o], !0));
                    i[n] = e(i[n])
                }
                return this
            },
            off: function(e, t) {
                return r(e, t),
                this
            }
        }
    }
} (window),
function(e, t) {
    "function" == typeof define && define.amd ? define(function() {
        return t(e, e.document)
    }) : "undefined" != typeof module && module.exports ? module.exports = t(e, e.document) : e.Shake = t(e, e.document)
} ("undefined" != typeof window ? window: this,
function(e, t) {
    "use strict";
    function i(i) {
        if (this.hasDeviceMotion = "ondevicemotion" in e, this.options = {
            threshold: 15,
            timeout: 1e3
        },
        "object" == typeof i) for (var n in i) i.hasOwnProperty(n) && (this.options[n] = i[n]);
        if (this.lastTime = new Date, this.lastX = null, this.lastY = null, this.lastZ = null, "function" == typeof t.CustomEvent) this.event = new t.CustomEvent("shake", {
            bubbles: !0,
            cancelable: !0
        });
        else {
            if ("function" != typeof t.createEvent) return ! 1;
            this.event = t.createEvent("Event"),
            this.event.initEvent("shake", !0, !0)
        }
    }
    return i.prototype.reset = function() {
        this.lastTime = new Date,
        this.lastX = null,
        this.lastY = null,
        this.lastZ = null
    },
    i.prototype.start = function() {
        this.reset(),
        this.hasDeviceMotion && e.addEventListener("devicemotion", this, !1)
    },
    i.prototype.stop = function() {
        this.hasDeviceMotion && e.removeEventListener("devicemotion", this, !1),
        this.reset()
    },
    i.prototype.devicemotion = function(t) {
        var i, n, r = t.accelerationIncludingGravity,
        s = 0,
        o = 0,
        a = 0;
        return null === this.lastX && null === this.lastY && null === this.lastZ ? (this.lastX = r.x, this.lastY = r.y, void(this.lastZ = r.z)) : (s = Math.abs(this.lastX - r.x), o = Math.abs(this.lastY - r.y), a = Math.abs(this.lastZ - r.z), (s > this.options.threshold && o > this.options.threshold || s > this.options.threshold && a > this.options.threshold || o > this.options.threshold && a > this.options.threshold) && (i = new Date, n = i.getTime() - this.lastTime.getTime(), n > this.options.timeout && (e.dispatchEvent(this.event), this.lastTime = new Date)), this.lastX = r.x, this.lastY = r.y, void(this.lastZ = r.z))
    },
    i.prototype.handleEvent = function(e) {
        if ("function" == typeof this[e.type]) return this[e.type](e)
    },
    i
}),
function(e) {
    e.fn.getRuler = function(e) {
        var t = this,
        i = t.data("ruler") ? t.data("ruler") : new n(t, e);
        return i
    };
    var t = function() {
        var e = document.createElement("canvas").getContext("2d"),
        t = e.backingStorePixelRatio || e.webkitBackingStorePixelRatio || e.mozBackingStorePixelRatio || e.msBackingStorePixelRatio || e.oBackingStorePixelRatio || e.backingStorePixelRatio || 1;
        return (window.devicePixelRatio || 1) / t
    },
    i = function(t) {
        var i = t.ratio,
        n = t.thick,
        r = t.width,
        s = t.height,
        o = t.fgColor,
        a = t.bgColor,
        l = t.font,
        c = t.lineColor;
        return {
            getCorner: function() {
                var t = e("<span></span>");
                return t.css({
                    position: "absolute",
                    width: n - 1,
                    height: n - 1,
                    borderBottom: "1px solid " + o,
                    borderRight: "1px solid " + o,
                    zIndex: 9999,
                    backgroundColor: a
                }),
                t
            },
            getHorRuler: function() {
                var t = e("<canvas></canvas>");
                t.css({
                    position: "fixed",
                    marginLeft: n,
                    width: r,
                    height: n - 1,
                    borderBottom: "1px solid " + o,
                    zIndex: 9999
                });
                var s = t.get(0);
                s.width = r * i,
                s.height = n * i;
                var a = s.getContext("2d");
                return a.font = l,
                a.lineWidth = i,
                a.strokeStyle = o,
                a.textBaseline = "middle",
                t
            },
            getVerRuler: function() {
                var t = e("<canvas></canvas>");
                t.css({
                    position: "fixed",
                    marginTop: n,
                    width: n - 1,
                    height: s,
                    borderRight: "1px solid " + o,
                    "z-index": 9999
                });
                var r = t.get(0);
                r.width = n * i,
                r.height = s * i;
                var a = r.getContext("2d");
                return a.font = l,
                a.lineWidth = i,
                a.strokeStyle = o,
                a.textBaseline = "middle",
                t
            },
            getHorLine: function() {
                var t = e("<div></div>");
                t.css({
                    position: "fixed",
                    height: s + n,
                    borderLeft: "1px solid " + c,
                    width: 8,
                    cursor: "ew-resize"
                });
                var i = e("<p></p>");
                i.css({
                    position: "absolute",
                    left: 5,
                    top: n + 3,
                    pointerEvents: "none"
                }),
                t.append(i);
                var r = e("<span>\xd7</span>");
                return r.css({
                    position: "absolute",
                    display: "none",
                    lineHeight: 1,
                    fontSize: 14,
                    right: "100%",
                    padding: "0 5px 5px 5px",
                    top: n + 3,
                    cursor: "pointer"
                }),
                t.append(r),
                t.on("mouseover",
                function(e) {
                    e.preventDefault();
                    var t = e.offsetY;
                    t > n && r.show()
                }),
                t.on("mouseleave",
                function(e) {
                    e.preventDefault(),
                    r.hide()
                }),
                t
            },
            getVerLine: function() {
                var t = e("<div></div>");
                t.css({
                    position: "fixed",
                    width: r + n,
                    borderTop: "1px solid " + c,
                    height: 8,
                    zIndex: 1e4,
                    cursor: "ns-resize"
                });
                var i = e("<p></p>");
                i.css({
                    position: "absolute",
                    top: 5,
                    left: n + 3,
                    pointerEvents: "none"
                }),
                t.append(i);
                var s = e("<span>\xd7</span>");
                return s.css({
                    position: "absolute",
                    display: "none",
                    bottom: "100%",
                    padding: 5,
                    left: n + 3,
                    lineHeight: 1,
                    fontSize: 14,
                    cursor: "pointer"
                }),
                t.append(s),
                t.on("mouseover",
                function(e) {
                    e.preventDefault();
                    var t = e.offsetX;
                    t > n && s.show()
                }),
                t.on("mouseleave",
                function(e) {
                    e.preventDefault(),
                    s.hide()
                }),
                t
            },
            getHorCur: function() {
                var t = e("<div></div>");
                t.css({
                    position: "fixed",
                    height: n,
                    outline: "none",
                    borderRight: "1px solid " + c,
                    display: "none",
                    pointerEvents: "none"
                });
                var i = e("<div></div>");
                i.css({
                    position: "absolute",
                    top: "100%",
                    borderRight: "1px dotted " + c,
                    height: s
                }),
                t.append(i);
                var r = e("<p></p>");
                return r.css({
                    position: "absolute",
                    bottom: "66%",
                    transform: "translateY(50%)",
                    backgroundColor: a,
                    marginLeft: 4
                }),
                t.append(r),
                t
            },
            getVerCur: function() {
                var t = e("<div></div>");
                t.css({
                    position: "fixed",
                    width: n,
                    outline: "none",
                    borderBottom: "1px solid " + c,
                    display: "none",
                    pointerEvents: "none"
                });
                var i = e("<div></div>");
                i.css({
                    position: "absolute",
                    left: "100%",
                    borderBottom: "1px dotted " + c,
                    width: r
                }),
                t.append(i);
                var s = e("<p></p>");
                return s.css({
                    position: "absolute",
                    left: "33%",
                    bottom: 0,
                    backgroundColor: a,
                    marginBottom: 4,
                    transformOrigin: "0% 50%",
                    transform: "translateY(50%) rotate(-90deg)"
                }),
                t.append(s),
                t
            }
        }
    },
    n = function(e, t) {
        this.elem = e,
        this._init(t)
    };
    n.prototype = {
        _init: function(e) {
            e = e || {},
            this.ratio = isNaN(e.ratio) ? t() : e.ratio,
            this.originX = isNaN(e.startX) ? -240 : e.startX,
            this.originY = isNaN(e.startY) ? -100 : e.startY,
            this.thick = isNaN(e.thick) ? 30 * this.ratio: e.thick * this.ratio,
            this.perWidth = e.perWidth ? parseFloat(e.perWidth) : 10,
            this.scale = this.perWidth / 10,
            this.bgColor = e.bgColor || "#F5F5F5",
            this.fgColor = e.fgColor || "#999",
            this.shadowColor = e.shadowColor || "#CCC",
            this.font = e.font || 12 * this.ratio + 'px -apple-system, ".SFNSText-Regular", "SF UI Text", "Helvetica Neue", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Zen Hei", sans-serif',
            this.fontColor = e.fontColor || "#000",
            this.lineColor = e.lineColor || "red",
            this.width = this.elem.width() * this.ratio - this.thick,
            this.height = this.elem.height() * this.ratio - this.thick,
            this.factory = new i({
                ratio: this.ratio,
                thick: this.thick / this.ratio,
                width: this.width / this.ratio,
                height: this.height / this.ratio,
                fgColor: this.fgColor,
                bgColor: this.bgColor,
                font: this.font,
                lineColor: this.lineColor
            }),
            this._addRuler(),
            this.startX = this.originX + this.elem.scrollLeft(),
            this.startY = this.originY + this.elem.scrollTop(),
            this._drawRuler(),
            this.horLineValue = e.horLineValue || [],
            this.verLineValue = e.verLineValue || [],
            this.horLine = [],
            this.verLine = [],
            this._addAlignLine(),
            this.elem.data("ruler", this)
        },
        _addRuler: function() {
            var t = this.elem,
            i = this.factory,
            n = e("<div></div>");
            n.css({
                position: "fixed"
            }),
            this.rulerBox = n;
            var r = i.getCorner();
            n.prepend(r);
            var s = i.getHorRuler();
            n.prepend(s),
            this.horCtx = s.get(0).getContext("2d");
            var o = e("<div></div>");
            o.css({
                position: "fixed",
                marginLeft: this.thick / this.ratio,
                zIndex: 1e4,
                userSelect: "none",
                font: '12px -apple-system, ".SFNSText-Regular", "SF UI Text", "Helvetica Neue", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Zen Hei", sans-serif'
            }),
            n.prepend(o),
            this.horDiv = o;
            var a = e("<div></div>");
            a.css({
                position: "fixed",
                marginTop: this.thick / this.ratio,
                zIndex: 1e4,
                userSelect: "none",
                font: '12px -apple-system, ".SFNSText-Regular", "SF UI Text", "Helvetica Neue", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Zen Hei", sans-serif'
            }),
            n.prepend(a),
            this.verDiv = a,
            s.on("click",
            function(t) {
                t.preventDefault();
                var i = this.horCurrentValue;
                this.horLineValue.push(i),
                this._addHorLine(i),
                e(document.body).trigger("setAlignLine", {
                    horValue: this.horLineValue,
                    verValue: this.verLineValue
                })
            }.bind(this));
            var l = i.getVerRuler();
            n.prepend(l),
            t.prepend(n),
            this.verCtx = l.get(0).getContext("2d"),
            l.on("click",
            function(t) {
                t.preventDefault();
                var i = this.verCurrentValue;
                this.verLineValue.push(i),
                this._addVerLine(i),
                e(document.body).trigger("setAlignLine", {
                    horValue: this.horLineValue,
                    verValue: this.verLineValue
                })
            }.bind(this)),
            this.horRuler = s,
            this.verRuler = l,
            this.corner = r,
            this._addCurrentValue()
        },
        _addCurrentValue: function() {
            this._addHorCurrentValue(),
            this._addVerCurrentValue()
        },
        _addHorCurrentValue: function() {
            var e = this.factory,
            t = e.getHorCur(),
            i = t.find("p"),
            n = this.horRuler;
            this.horDiv.prepend(t),
            n.on("mouseenter",
            function(e) {
                e.preventDefault(),
                this.horDiv.css("pointerEvents", "none"),
                t.css({
                    display: "block"
                })
            }.bind(this)),
            n.on("mousemove",
            function(e) {
                e.preventDefault();
                var n = this.startX + e.offsetX,
                r = this.scale;
                n = n / r >> 0,
                n != this.horCurrentValue && (this.horCurrentValue = n, t.css({
                    marginLeft: e.offsetX
                }), i.html(n))
            }.bind(this)),
            n.on("mouseout",
            function(e) {
                e.preventDefault(),
                this.horDiv.css("pointerEvents", "auto"),
                t.css({
                    display: "none"
                })
            }.bind(this))
        },
        _addVerCurrentValue: function() {
            var e = this.factory,
            t = e.getVerCur(),
            i = t.find("p"),
            n = this.verRuler;
            this.verDiv.prepend(t),
            n.on("mouseenter",
            function(e) {
                e.preventDefault(),
                this.verDiv.css("pointerEvents", "none"),
                t.css({
                    display: "block"
                })
            }.bind(this)),
            n.on("mousemove",
            function(e) {
                e.preventDefault();
                var n = this.startY + e.offsetY,
                r = this.scale;
                n = n / r >> 0,
                n != this.verCurrentValue && (this.verCurrentValue = n, t.css({
                    marginTop: e.offsetY
                }), i.html(n))
            }.bind(this)),
            n.on("mouseout",
            function(e) {
                e.preventDefault(),
                this.verDiv.css("pointerEvents", "auto"),
                t.css({
                    display: "none"
                })
            }.bind(this))
        },
        _drawAlignLine: function() {
            this._drawHorLine(),
            this._drawVerLine()
        },
        _addAlignLine: function() {
            e.each(this.horLineValue,
            function(e, t) {
                this._addHorLine(t)
            }.bind(this)),
            e.each(this.verLineValue,
            function(e, t) {
                this._addVerLine(t)
            }.bind(this))
        },
        _addHorLine: function(t) {
            var i = this.factory.getHorLine(),
            n = t * this.scale - this.startX;
            i.css("marginLeft", n),
            i.find("p").html(t),
            this.horDiv.append(i),
            this.horLine.push(i),
            i.find("span").one("click",
            function() {
                i.off("mouseenter"),
                i.off("mouseleave");
                var t = this.horLine.indexOf(i);
                this.horLine.splice(t, 1),
                this.horLineValue.splice(t, 1),
                i.remove(),
                e(document.body).trigger("setAlignLine", {
                    horValue: this.horLineValue,
                    verValue: this.verLineValue
                })
            }.bind(this)),
            i.on("mousedown",
            function(t) {
                t.preventDefault();
                var n = t.clientX;
                e(document).on("mousemove",
                function(e) {
                    e.preventDefault();
                    var t = e.clientX - n;
                    n = e.clientX;
                    var r = parseInt(i.css("marginLeft")) + t;
                    i.css("marginLeft", r);
                    var s = (this.startX + r) / this.scale >> 0;
                    i.find("p").html(s)
                }.bind(this)),
                e(document).one("mouseup",
                function(t) {
                    t.preventDefault();
                    var n = this.horLine.indexOf(i),
                    r = i.find("p").html() >> 0;
                    if (this.horLineValue[n] != r) {
                        if (r < this.startX || r > this.startX + this.width / this.ratio) {
                            var n = this.horLine.indexOf(i);
                            this.horLine.splice(n, 1),
                            this.horLineValue.splice(n, 1),
                            i.remove()
                        } else this.horLineValue[n] = r;
                        e(document.body).trigger("setAlignLine", {
                            horValue: this.horLineValue,
                            verValue: this.verLineValue
                        })
                    }
                    e(document).off("mousemove")
                }.bind(this))
            }.bind(this))
        },
        _addVerLine: function(t) {
            var i = this.factory.getVerLine(),
            n = t * this.scale - this.startY;
            i.css("marginTop", n),
            i.find("p").html(t),
            this.verDiv.append(i),
            this.verLine.push(i),
            i.find("span").one("click",
            function() {
                i.off("mouseenter"),
                i.off("mouseleave");
                var t = this.verLine.indexOf(i);
                this.verLine.splice(t, 1),
                this.verLineValue.splice(t, 1),
                i.remove(),
                e(document.body).trigger("setAlignLine", {
                    horValue: this.horLineValue,
                    verValue: this.verLineValue
                })
            }.bind(this)),
            i.on("mousedown",
            function(t) {
                t.preventDefault();
                var n = t.clientY;
                e(document).on("mousemove",
                function(e) {
                    e.preventDefault();
                    var t = e.clientY - n;
                    n = e.clientY;
                    var r = parseInt(i.css("marginTop")) + t;
                    i.css("marginTop", r);
                    var s = (this.startY + r) / this.scale >> 0;
                    i.find("p").html(s)
                }.bind(this)),
                e(document).one("mouseup",
                function(t) {
                    t.preventDefault();
                    var n = this.verLine.indexOf(i),
                    r = i.find("p").html() >> 0;
                    if (this.verLineValue[n] != r) {
                        if (r < this.startY || r > this.startY + this.height / this.ratio) {
                            var n = this.verLine.indexOf(i);
                            this.verLine.splice(n, 1),
                            this.verLineValue.splice(n, 1),
                            i.remove()
                        } else this.verLineValue[n] = r;
                        e(document.body).trigger("setAlignLine", {
                            horValue: this.horLineValue,
                            verValue: this.verLineValue
                        })
                    }
                    e(document).off("mousemove")
                }.bind(this))
            }.bind(this))
        },
        _drawHorLine: function() {
            e.each(this.horLineValue,
            function(e, t) {
                var i = this.horLine[e],
                n = t * this.scale - this.startX;
                n < 0 || n > this.width / this.ratio ? i.css({
                    display: "none"
                }) : (i.css({
                    display: "block",
                    marginLeft: n
                }), i.find("p").html(t))
            }.bind(this))
        },
        _drawVerLine: function() {
            e.each(this.verLineValue,
            function(e, t) {
                var i = this.verLine[e],
                n = t * this.scale - this.startY;
                n < 0 || n > this.height / this.ratio ? i.css({
                    display: "none"
                }) : (i.css({
                    display: "block",
                    marginTop: n
                }), i.find("p").html(t))
            }.bind(this))
        },
        _setPosition: function(e, t) {
            this.startX != e && (this.startX = e, this._drawHorRuler()),
            this.startY != t && (this.startY = t, this._drawVerRuler())
        },
        _drawRuler: function() {
            this._drawHorRuler(),
            this._drawVerRuler()
        },
        _drawHorRuler: function() {
            var e = this.startX,
            t = this.horCtx;
            if (t.fillStyle = this.bgColor, t.fillRect(0, 0, this.width, this.thick), this.shadow) {
                var i = (this.shadow.x * this.scale - e) * this.ratio,
                n = this.shadow.width * this.ratio * this.scale;
                t.fillStyle = this.shadowColor,
                t.fillRect(i, 0, n, this.thick)
            }
            t.translate( - e * this.ratio, 0),
            t.beginPath(),
            t.fillStyle = this.fontColor;
            for (var r = this.perWidth,
            s = this.scale,
            o = e - e % r,
            a = o; a < o + this.width / this.ratio; a += r) {
                var l = ((a >> 0) + .5) * this.ratio;
                t.moveTo(l, this.thick),
                a % (10 * r) === 0 ? (t.fillText(a / s, (a + 4) * this.ratio, this.thick / 3), t.lineTo(l, 0)) : t.lineTo(l, 2 * this.thick / 3),
                t.stroke()
            }
            t.closePath(),
            t.translate(e * this.ratio, 0)
        },
        _drawVerRuler: function() {
            var e = this.startY,
            t = this.verCtx;
            if (t.fillStyle = this.bgColor, t.fillRect(0, 0, this.thick, this.height), this.shadow) {
                var i = (this.shadow.y * this.scale - e) * this.ratio,
                n = this.shadow.height * this.ratio * this.scale;
                t.fillStyle = this.shadowColor,
                t.fillRect(0, i, this.thick, n)
            }
            t.translate(0, -e * this.ratio),
            t.beginPath(),
            t.fillStyle = this.fontColor;
            for (var r = this.perWidth,
            s = this.scale,
            o = e - e % r,
            a = o; a < o + this.height / this.ratio; a += r) {
                var l = ((a >> 0) + .5) * this.ratio;
                t.moveTo(this.thick, l),
                a % (10 * r) === 0 ? (t.save(), t.translate(this.thick, (a - 2) * this.ratio), t.rotate( - Math.PI / 2), t.fillText(a / s, 2 * this.ratio, -this.thick / 3 * 2), t.restore(), t.lineTo(0, l)) : t.lineTo(2 * this.thick / 3, l),
                t.stroke()
            }
            t.closePath(),
            t.translate(0, e * this.ratio)
        },
        setSelect: function(e, t, i, n) {
            this.shadow = {
                x: e,
                y: t,
                width: i,
                height: n
            },
            this._drawRuler()
        },
        clearShadow: function() {
            this.shadow = null,
            this._drawRuler()
        },
        update: function() {
            var e = this.elem,
            t = e.scrollTop(),
            i = e.scrollLeft();
            this._setPosition(this.originX + i, this.originY + t),
            this._drawAlignLine()
        },
        destroy: function() {
            this.horRuler.off("click"),
            this.verRuler.off("click"),
            this.horRuler.off("mousemove"),
            this.verRuler.off("mousemove"),
            this.rulerBox.remove(),
            this._destroyHorLine(),
            this._destroyVerLine(),
            this.elem.removeData("ruler")
        },
        _destroyHorLine: function() {
            e.each(this.horLine,
            function(e, t) {
                t.find("span").off("click"),
                t.off("mouseover"),
                t.off("mouseleave")
            }),
            this.horDiv.remove()
        },
        _destroyVerLine: function() {
            e.each(this.verLine,
            function(e, t) {
                t.find("span").off("click"),
                t.off("mouseover"),
                t.off("mouseleave")
            }),
            this.verDiv.remove()
        }
    }
} (jQuery),
function(e) {
    "use strict";
    function t() {
        var e = !1,
        t = function() {
            return "Notification" in window
        },
        i = function() {
            Notification.requestPermission(function(t) {
                "granted" === t && (e = !0)
            })
        };
        return {
            init: function() {
                return t() ? "granted" === Notification.permission ? (e = !0, 1) : "denied" !== Notification.permission ? 2 : void 0 : 0
            },
            requestPermission: i,
            notify: function(i, n, r, s, o, a) {
                var l;
                if (t()) {
                    if (!e) return void a();
                    l = new Notification(i, n),
                    setTimeout(l.close.bind(l), r || 3e3),
                    l.onclick = s,
                    l.onerror = o
                } else "function" == typeof a && a();
                return l
            }
        }
    }
    e.Notifier = t
} (this),
function() {
    var e;
    e = React.createClass({
        displayName: "AppModal",
        handleDeviceUpdate: function(e) {
            return this.props.app.device = e.target.value,
            this.props.app.model = MB.DEVICES["default"][e.target.value],
            MB.renderAppModal(this.props.app)
        },
        handleModelUpdate: function(e) {
            var t;
            return t = this.props.app,
            t.model = e.target.value,
            ["ipad_3_4", "ipad_pro"].indexOf(t.model) !== -1 ? (t.device = "ipad", t.exists() || (t.scale = 75)) : "android" !== t.device && (t.device = "iphone", t.exists() || (t.scale = 100)),
            setTimeout(function() {
                return MB.renderAppModal(t)
            })
        },
        handleKeyUp: function(e) {
            if ("Enter" === e.key) return this.handleSave()
        },
        handleUpdate: function(e) {
            var t;
            return t = e.target.attributes.name.value,
            this.props.app[t] = e.target.value,
            this.forceUpdate()
        },
        handleSizeUpdate: function(e, t) {
            var i, n;
            if (i = this.props.app, "customize" === i.model || "web" === i.device) return n = MB.DEVICES[i.device][i.model],
            n[e] = parseInt(t.target.value) || "",
            this.forceUpdate()
        },
        handleUpload: function(e) {
            var t, i;
            if (t = e.target.attributes.name.value, i = e.target.files[0]) return /^image\/png/.test(i.type) ? MB.readDataURL(i,
            function(e) {
                return function(i) {
                    return $(".upload-" + t + " img").attr("src", i),
                    e.props.app[t] = $(".upload-" + t + " img").attr("src")
                }
            } (this)) : void alert(I18N.png_only)
        },
        handleClone: function(e) {
            var t;
            return t = "/app/" + e.base + "/duplicate.json",
            MB.safeLoading(I18N.load_project),
            $("#app-modal").modal("hide"),
            $.ajax({
                url: t,
                type: "post",
                data: "name=" + e.name + "&team_cid=" + (e.team_cid || ""),
                success: function(t) {
                    var i;
                    return i = new Project,
                    i.load(t),
                    e.icon && (i.icon = e.icon),
                    e.splash && (i.splash = e.splash),
                    i.access = "private",
                    i.archived = !1,
                    i.lsave(),
                    MB.triggerProgress(function() {
                        return MB.mp("\u5b8c\u6210\u4e86\u9879\u76ee\u521b\u5efa"),
                        MB.pusher.subscribe(i.cid),
                        MB.webpackInterface.replace("/workspace/apps/" + i.cid)
                    })
                }
            })
        },
        handleSave: function() {
            var e, t, i, n, r, s;
            return e = this.props.app,
            e.base ? this.handleClone(e) : (n = MB.DEVICES[e.device][e.model], t = "ipad_3_4" === (r = e.model) || "ipad_pro" === r ? "ipad": e.device, e.setDevice(t), s = n.width, i = n.height, e.exists() ? (e.setResolution(s, i), e.lsave(), MB.webpackInterface.refreshProject(), $("#app-modal").modal("hide")) : (e.width = e.height = null, e.setResolution(s, i), e.lsave(), e.setup(), MB.safeLoading(I18N.load_project), $("#app-modal").modal("hide"), MB.mp("\u5b8c\u6210\u4e86\u9879\u76ee\u521b\u5efa"), MB.pusher.subscribe(e.cid), $.getJSON("/templates.json",
            function(t) {
                return function(i) {
                    return Template.refresh(i.templates),
                    Combo.refresh(i.combos),
                    Screen.refresh(i.screens),
                    Widget.refresh(i.widgets),
                    Link.refresh(i.links),
                    t.setupNewApp(e)
                }
            } (this))))
        },
        setupNewApp: function(e) {
            var t, i, n, r;
            return "customize" === e.model && e.width > e.height ? (r = e.width, e.width = e.height, e.height = r, e.lsave(), i = "landscape") : i = "portrait",
            n = new Screen({
                name: I18N.screen + " 2",
                project_cid: e.cid,
                cid: "s" + Math.uuid(10, 16) + (new Date).valueOf(),
                orientation: i,
                position: 2
            }),
            n.lsave(),
            n.setup(null),
            t = new Screen({
                name: I18N.home,
                project_cid: e.cid,
                cid: "s" + Math.uuid(10, 16) + (new Date).valueOf(),
                orientation: i,
                position: 1
            }),
            t.lsave(),
            t.setup(e.name),
            MB.triggerProgress(function() {
                return $("#safemode").hide(),
                MB.webpackInterface.replace("/workspace/apps/" + e.cid)
            })
        },
        triggerSplashUpload: function() {
            return this.refs.splash.click()
        },
        triggerIconUpload: function() {
            return this.refs.icon.click()
        },
        componentDidMount: function() {
            return $(this.refs.select).niceSelect(),
            $(this.refs.select).on("change", this.handleModelUpdate)
        },
        render: function() {
            var e, t, i, n, r, s, o, a, l, c, d, u, h, p, f, g, m, v, b;
            return e = this.props.app,
            s = e.icon_size() || "192x192",
            g = e.splash_width(),
            h = e.splash_height(),
            r = h / g * 100 + "%",
            f = 2 * g + "x" + 2 * h,
            p = 130 / g,
            o = "customize" === e.model,
            a = "web" === e.device,
            t = !!e.base,
            i = MB.DEVICES[e.device],
            c = i[e.model],
            d = function() {
                var e;
                e = [];
                for (l in i) i[l].hide || e.push({
                    id: l,
                    name: i[l].name
                });
                return e
            } (),
            b = c.width,
            n = c.height,
            v = e.exists() ? I18N.setting: I18N.new_app,
            m = e.exists() ? I18N.update: I18N.create,
            u = (o || a) && !e.base,
            React.createElement("div", {
                className: "form-horizontal"
            },
            React.createElement("div", {
                className: "modal-dialog"
            },
            React.createElement("div", {
                className: "modal-content"
            },
            React.createElement(MB.ModalHeader, {
                title: v
            }), React.createElement("div", {
                className: "modal-body"
            },
            React.createElement("div", {
                className: "form-group"
            },
            React.createElement("label", {
                className: "control-label col-sm-3"
            },
            I18N.app_name), React.createElement("div", {
                className: "col-sm-9"
            },
            React.createElement("input", {
                type: "text",
                name: "name",
                className: "form-control",
                value: e.name || "",
                onKeyUp: this.handleKeyUp,
                onChange: this.handleUpdate
            }))), React.createElement("div", {
                className: "form-group",
                style: {
                    display: MB.shouldDisplay(!a && !e.base && e.exists())
                }
            },
            React.createElement("label", {
                className: "control-label col-sm-3"
            },
            I18N.app_type), React.createElement("div", {
                className: "col-sm-6 form-height"
            },
            React.createElement("div", {
                className: "col-sm-6"
            },
            React.createElement("label", {
                className: "radio-inline"
            },
            React.createElement("input", {
                type: "radio",
                className: "mb-radio",
                id: "iphone",
                name: "device",
                disabled: t,
                value: "iphone",
                checked: "iphone" == e.device || "ipad" == e.device,
                onChange: this.handleDeviceUpdate
            }), React.createElement("label", {
                htmlFor: "iphone"
            }), React.createElement("span", null, "iOS"))), React.createElement("div", {
                className: "col-sm-6"
            },
            React.createElement("label", {
                className: "radio-inline"
            },
            React.createElement("input", {
                type: "radio",
                className: "mb-radio",
                id: "android",
                name: "device",
                disabled: t,
                value: "android",
                checked: "android" == e.device,
                onChange: this.handleDeviceUpdate
            }), React.createElement("label", {
                htmlFor: "android"
            }), React.createElement("span", null, "Android"))))), React.createElement("div", {
                className: "form-group",
                style: {
                    display: MB.shouldDisplay(!a)
                }
            },
            React.createElement("label", {
                className: "control-label col-sm-3"
            },
            I18N.app_device), React.createElement("div", {
                className: "col-sm-6"
            },
            React.createElement("select", {
                ref: "select",
                name: "model",
                className: "form-control",
                disabled: t,
                value: e.model,
                onChange: this.handleModelUpdate
            },
            d.map(function(e) {
                return React.createElement("option", {
                    value: e.id,
                    key: e.id
                },
                e.name)
            })))), React.createElement("div", {
                className: "form-group"
            },
            React.createElement("label", {
                className: "control-label col-sm-3"
            },
            I18N.size), React.createElement("div", {
                className: "col-sm-6"
            },
            React.createElement("input", {
                type: "text",
                name: "width",
                className: "form-control col-sm-5",
                value: b,
                onChange: this.handleSizeUpdate.bind(this, "width"),
                readOnly: !u
            }), React.createElement("label", {
                className: "control-label col-sm-2"
            },
            "\xd7"), React.createElement("input", {
                type: "text",
                name: "height",
                className: "form-control col-sm-5",
                value: n,
                onChange: this.handleSizeUpdate.bind(this, "height"),
                readOnly: !u
            }))), React.createElement(MB.HR, {
                value: I18N.icon_and_splash
            }), React.createElement("div", {
                className: "icon_splash"
            },
            React.createElement("div", {
                className: "upload-box upload-icon"
            },
            React.createElement("input", {
                ref: "icon",
                type: "file",
                name: "icon",
                onChange: this.handleUpload,
                accept: "image/png"
            }), React.createElement("div", {
                className: "icon_preview",
                onClick: this.triggerIconUpload
            },
            React.createElement("img", {
                src: e.icon || "/images/icon_normal.png"
            })), React.createElement("div", {
                className: "icon_detail"
            },
            React.createElement("p", null, I18N.icon), React.createElement("p", {
                className: "splash-size"
            },
            I18N.icon, React.createElement("span", null, I18N.size + " " + s)), React.createElement("a", {
                className: "upload-link",
                onClick: this.triggerIconUpload
            },
            I18N.upload_icon))), React.createElement("div", {
                className: "upload-box upload-splash"
            },
            React.createElement("input", {
                ref: "splash",
                type: "file",
                name: "splash",
                onChange: this.handleUpload,
                accept: "image/png"
            }), React.createElement("div", {
                className: "icon_preview",
                onClick: this.triggerSplashUpload
            },
            React.createElement("img", {
                src: e.splash || "/images/splashes/retina.png"
            }), React.createElement("span", {
                style: {
                    marginBottom: r
                }
            })), React.createElement("div", {
                className: "icon_detail"
            },
            React.createElement("p", null, I18N.splash), React.createElement("p", {
                className: "splash-size"
            },
            I18N.splash, React.createElement("span", null, f)), React.createElement("a", {
                className: "upload-link",
                onClick: this.triggerSplashUpload
            },
            I18N.upload_splash))))), React.createElement("div", {
                className: "modal-footer"
            },
            React.createElement("button", {
                type: "submit",
                className: "btn btn-primary",
                disabled: !(e.name && e.name.trim()),
                onClick: this.handleSave
            },
            m)))))
        }
    }),
    MB.HR = React.createClass({
        displayName: "HR",
        getDefaultProps: function() {
            return {
                color: "#FFF"
            }
        },
        render: function() {
            var e, t;
            return e = this.props.color,
            t = this.props.value,
            React.createElement("div", {
                className: "mb-hr"
            },
            React.createElement("h5", {
                style: {
                    background: e
                }
            },
            t))
        }
    }),
    MB.renderAppModal = function(t) {
        return $("#app-modal").html(""),
        ReactDOM.render(React.createElement(e, {
            app: t
        }), $("#app-modal")[0])
    }
}.call(this),
function() {
    var e, t, i, n;
    n = [[[50, 0], [0, 100], [100, 100]], [[20, 0], [80, 0], [100, 100], [0, 100]], [[25, 0], [100, 0], [75, 100], [0, 100]], [[50, 0], [100, 50], [50, 100], [0, 50]], [[50, 0], [100, 38], [82, 100], [18, 100], [0, 38]], [[50, 0], [100, 25], [100, 75], [50, 100], [0, 75], [0, 25]], [[50, 0], [90, 20], [100, 60], [75, 100], [25, 100], [0, 60], [10, 20]], [[30, 0], [70, 0], [100, 30], [100, 70], [70, 100], [30, 100], [0, 70], [0, 30]], [[50, 0], [83, 12], [100, 43], [94, 78], [68, 100], [32, 100], [6, 78], [0, 43], [17, 12]], [[20, 0], [80, 0], [100, 20], [100, 80], [80, 100], [20, 100], [0, 80], [0, 20]], [[0, 15], [15, 15], [15, 0], [85, 0], [85, 15], [100, 15], [100, 85], [85, 85], [85, 100], [15, 100], [15, 85], [0, 85]], [[40, 0], [40, 20], [100, 20], [100, 80], [40, 80], [40, 100], [0, 50]], [[0, 20], [60, 20], [60, 0], [100, 50], [60, 100], [60, 80], [0, 80]], [[25, 0], [100, 1], [100, 100], [25, 100], [0, 50]], [[0, 0], [75, 0], [100, 50], [75, 100], [0, 100]], [[100, 0], [75, 50], [100, 100], [25, 100], [0, 50], [25, 0]], [[75, 0], [100, 50], [75, 100], [0, 100], [25, 50], [0, 0]], [[50, 0], [63, 38], [100, 38], [69, 59], [82, 100], [50, 75], [18, 100], [31, 59], [0, 38], [37, 38]], [[10, 25], [35, 25], [35, 0], [65, 0], [65, 25], [90, 25], [90, 50], [65, 50], [65, 100], [35, 100], [35, 50], [10, 50]], [[0, 0], [100, 0], [100, 75], [75, 75], [75, 100], [50, 75], [0, 75]], [[20, 0], [0, 20], [30, 50], [0, 80], [20, 100], [50, 70], [80, 100], [100, 80], [70, 50], [100, 20], [80, 0], [50, 30]], [[0, 0], [0, 100], [25, 100], [25, 25], [75, 25], [75, 75], [25, 75], [25, 100], [100, 100], [100, 0]]],
    t = [{
        name: I18N.inspector.blur,
        propName: "blur",
        step: 1,
        max: 100,
        postfix: "px"
    },
    {
        name: I18N.inspector.brightness,
        propName: "brightness",
        step: .1,
        max: 10,
        postfix: "",
        defaultValue: 1
    },
    {
        name: I18N.inspector.contrast,
        propName: "contrast",
        step: .1,
        max: 10,
        postfix: "",
        defaultValue: 1
    },
    {
        name: I18N.inspector.saturate,
        propName: "saturate",
        step: .1,
        max: 10,
        postfix: "",
        defaultValue: 1
    },
    {
        name: I18N.inspector.grayscale,
        propName: "grayscale",
        step: .1,
        max: 1,
        postfix: ""
    },
    {
        name: I18N.inspector.sepia,
        propName: "sepia",
        step: .1,
        max: 1,
        postfix: ""
    },
    {
        name: I18N.inspector.hue_rotate,
        propName: "hue-rotate",
        step: 30,
        max: 360,
        postfix: "deg"
    },
    {
        name: I18N.inspector.invert,
        propName: "invert",
        step: .1,
        max: 1,
        postfix: ""
    }],
    i = React.createClass({
        displayName: "Slider",
        getInitialState: function() {
            return {
                value: null != this.props.value ? this.props.value: (this.props.defaultValue || 0) + ""
            }
        },
        componentWillMount: function() {
            return this.defaultV = (this.props.defaultValue || 0) + "",
            this.currentV = this.defaultV,
            this.pattern = new RegExp(this.props.propName + "\\(([\\w.]+)\\)")
        },
        componentWillReceiveProps: function(e) {
            var t;
            if (t = null != e.value ? e.value: this.defaultV, t !== this.state.value) return this.setState({
                value: t
            })
        },
        handleFilter: function(e, t) {
            var i, n, r, s, o;
            if (this.lastFilter = null != this.lastFilter ? this.lastFilter: MB.selection.getAttr("filter") || "", "none" === e ? this.lastFilter = this.lastFilter.replace(this.pattern, "") : this.lastFilter.indexOf(this.props.propName) === -1 ? this.lastFilter = this.lastFilter + (" " + this.props.propName + "(" + e + this.props.postfix + ")") : this.lastFilter = this.lastFilter.replace(this.pattern, this.props.propName + "(" + e + this.props.postfix + ")"), t) return MB.selection.setAttr("filter", this.lastFilter, !0, !0),
            this.lastFilter = null;
            for (s = MB.selection.groupedItems.items(), o = [], n = 0, r = s.length; n < r; n++) i = s[n],
            $("#widget" + i.cid + " img").css("filter", this.lastFilter.trim()),
            o.push($("#widget" + i.cid + " img").css("-webkit-filter", this.lastFilter.trim()));
            return o
        },
        handleMouseDown: function() {
            return $(".selection-item").hide()
        },
        changeValue: function(e, t) {
            var i;
            if (i = t.target.value, (e || this.currentV !== i) && (i === this.defaultV ? this.handleFilter("none", e) : this.handleFilter(i, e), this.currentV = i, this.setState({
                value: i
            })), e) return $(".selection-item").show()
        },
        render: function() {
            var e;
            return e = this.state.value,
            React.createElement("div", {
                className: "col",
                style: {
                    marginTop: 10
                }
            },
            React.createElement("label", null, this.props.name + ": " + e), React.createElement("input", {
                className: "slider",
                type: "range",
                min: "0",
                max: this.props.max,
                value: e,
                step: this.props.step,
                onChange: this.changeValue.bind(this, !1),
                onMouseUp: this.changeValue.bind(this, !0),
                onMouseDown: this.handleMouseDown
            }))
        }
    }),
    e = React.createClass({
        displayName: "AssetUploader",
        getInitialState: function() {
            return {
                active: !1,
                tabIndex: 0,
                borderColor: "#ccc"
            }
        },
        handleClose: function(e) {
            return e.stopPropagation(),
            this.setState({
                active: !1
            })
        },
        handleToggle: function() {
            return this.setState({
                active: !this.state.active
            })
        },
        handleClick: function() {
            return MB.toolboxes.handleClick("icons"),
            MB.renderAssetUploader()
        },
        handleAssets: function(e) {
            return e.stopPropagation(),
            MB.selection.groupedItems.canSetImage() ? MB.renderAssetsManager(MB.selection) : MB.renderAssetsManager()
        },
        handleProportion: function(e) {
            return MB.selection.setAttr("p", e.target.checked)
        },
        handleFileChoose: function() {
            return $("#asset-uploader input[type=file]").click()
        },
        handleFileChange: function(e) {
            var t;
            return t = e.target.files[0],
            $("#asset-uploader input[type=file]").val(""),
            this.handleUpload(t)
        },
        handleDragLeave: function() {
            return this.setState({
                borderColor: "#ccc"
            })
        },
        handleDragOver: function(e) {
            return e.stopPropagation(),
            e.preventDefault(),
            this.setState({
                borderColor: "#f60"
            }),
            e.nativeEvent.dataTransfer.dropEffect = "copy"
        },
        handleDrop: function(e) {
            var t;
            return e.stopPropagation(),
            e.preventDefault(),
            this.setState({
                borderColor: "#ccc"
            }),
            t = e.nativeEvent.dataTransfer.files[0],
            this.handleUpload(t)
        },
        handleUpload: function(e) {
            return Asset.createFromFiles([e],
            function(e) {
                return MB.selection.setImage(e)
            })
        },
        handleClipPath: function(e) {
            return MB.selection.setAttr("clip", e),
            MB.renderSelections()
        },
        analyzeFilter: function(e) {
            var t, i;
            return e = e && e.trim() || "",
            i = [],
            e ? (t = e.split(" "), t.forEach(function(e) {
                var t, n, r;
                if (e.trim()) return n = e.trim().split("("),
                t = n[0],
                r = n[1].replace(/[a-zA-Z]*\)$/, ""),
                i[t] = r
            }), i) : i
        },
        resetFilter: function() {
            return MB.selection.setAttr("filter", "", !0, !0)
        },
        handleChangeTab: function(e) {
            return this.setState({
                tabIndex: e
            })
        },
        render: function() {
            var e, r, s, o, a, l, c, d, u, h, p, f, g, m, v, b;
            for (d = MB.selection.groupedItems, s = this.state.active ? "toolbox active": "toolbox", e = "#f7f7f7", m = "#e3e8ea", f = d.getAttr("p"), o = d.getAttr("clip"), v = this.state.tabIndex, c = this.analyzeFilter(d.getAttr("filter")), g = {},
            b = MB.preference().at, h = MB.preference().al, b && b > 36 && b < $(window).height() - 200 && (g.top = b + "px"), h && h > 0 && h < $(window).width() - 230 && (g.left = h + "px"), g.zIndex = "assets" === MB.config.topToolBox ? 102 : 101, a = ["inset(10% 10% 10% 10%)", "circle(45% at 50% 50%)", "ellipse(30% 45% at 50% 50%)"], u = 0, p = n.length; u < p; u++) l = n[u],
            a.push("polygon(" +
            function() {
                var e, t, i;
                for (i = [], e = 0, t = l.length; e < t; e++) r = l[e],
                i.push(r[0] + "% " + r[1] + "%");
                return i
            } ().join(",") + ")");
            return React.createElement("div", {
                id: "asset-uploader",
                className: s,
                style: g,
                onClick: this.handleClick
            },
            React.createElement("div", {
                className: "header tabs"
            },
            React.createElement("b", {
                style: {
                    backgroundColor: 0 == v ? e: m
                },
                onClick: this.handleChangeTab.bind(this, 0)
            },
            React.createElement("i", {
                className: "fa fa-image"
            })), React.createElement("b", {
                style: {
                    backgroundColor: 1 == v ? e: m
                },
                onClick: this.handleChangeTab.bind(this, 1)
            },
            React.createElement("i", {
                className: "fa fa-sliders"
            })), React.createElement("div", {
                className: "close",
                onClick: this.handleClose
            },
            React.createElement("i", {
                className: "fa fa-close"
            }))), React.createElement("div", {
                className: "body"
            },
            0 == this.state.tabIndex ? React.createElement("div", {
                className: "group"
            },
            React.createElement("div", {
                className: "col",
                style: {
                    marginTop: 10
                }
            },
            React.createElement("label", {
                className: "checkbox-inline"
            },
            React.createElement("input", {
                checked: f,
                type: "checkbox",
                name: "p",
                onChange: this.handleProportion
            }), I18N.inspector.p)), React.createElement("div", {
                className: "col shapes",
                style: {
                    display: MB.shouldDisplay(!MB.isFirefox())
                }
            },
            a.map(function(e, t) {
                return React.createElement("div", {
                    key: t,
                    className: "shape",
                    style: {
                        clipPath: e,
                        WebkitClipPath: e
                    },
                    onClick: this.handleClipPath.bind(this, e)
                })
            },
            this), React.createElement("div", {
                className: "gradient"
            })), React.createElement("div", {
                className: "col",
                style: {
                    display: MB.shouldDisplay(o)
                }
            },
            React.createElement("p", null, React.createElement("a", {
                className: "btn",
                onClick: this.handleClipPath.bind(this, null)
            },
            I18N.remove_clip))), React.createElement("div", {
                className: "uploader",
                style: {
                    borderColor: this.state.borderColor
                },
                onClick: this.handleFileChoose,
                onDragLeave: this.handleDragLeave,
                onDragOver: this.handleDragOver,
                onDrop: this.handleDrop
            },
            React.createElement("input", {
                type: "file",
                onChange: this.handleFileChange,
                multiple: !0,
                accept: "image/*"
            }), React.createElement("p", null, React.createElement("i", {
                className: "fa fa-cloud-upload fa-2x"
            })), React.createElement("p", null, I18N.inspector.drop_image, React.createElement("br", null), I18N.inspector.click_to_upload), React.createElement("p", null, React.createElement("a", {
                className: "btn primary",
                onClick: this.handleAssets
            },
            I18N.assets_manager)))) : null, 1 == this.state.tabIndex ? React.createElement("div", {
                className: "group"
            },
            t.map(function(e, t) {
                return value = c[e.propName],
                React.createElement(i, {
                    key: t,
                    value: value,
                    name: e.name,
                    propName: e.propName,
                    defaultValue: e.defaultValue,
                    step: e.step,
                    max: e.max,
                    postfix: e.postfix
                })
            }), React.createElement("div", {
                className: "col",
                style: {
                    paddingBottom: 10
                }
            },
            React.createElement("a", {
                className: "btn",
                type: "button",
                onClick: this.resetFilter
            },
            I18N.inspector.reset))) : null))
        }
    }),
    MB.renderAssetUploader = function() {
        return MB.assetUploader ? MB.assetUploader.setState({
            active: !0
        }) : MB.assetUploader = ReactDOM.render(React.createElement(e, null), $("#asset_uploader")[0])
    }
}.call(this),
function() {
    var e, t, i, n, r, s, o, a, l;
    a = React.createClass({
        displayName: "ImageView",
        handleRemove: function(e, t) {
            return t.stopPropagation(),
            MB.assetsManager.handleRemove(e),
            Projectasset.each(function(t) {
                if (t.asset_id === e.sid || t.asset_id === e.cid) return t.destroy()
            })
        },
        pickImage: function(e) {
            return MB.assetsManager.handleSelect(e)
        },
        render: function() {
            var e, t, i, n, r;
            return e = this.props.asset,
            r = this.props.selected && this.props.selected.cid === e.cid,
            t = r ? "thumb selected": "thumb",
            n = e.thumbHeight() < 94 || /svg$/.test(e.image) ? e.image: e.thumb,
            e.user_id === MB.user.id && (i = React.createElement("a", {
                className: "remove",
                onClick: this.handleRemove.bind(this, e)
            },
            React.createElement("i", {
                className: "fa fa-times-circle"
            }))),
            React.createElement("div", {
                key: e.cid,
                id: "asset" + e.cid,
                className: t,
                onClick: this.pickImage.bind(this, e)
            },
            i, React.createElement("img", {
                src: n
            }), React.createElement("div", {
                className: "asset-name"
            },
            e.name), React.createElement("div", {
                className: "checked"
            },
            React.createElement("i", {
                className: "fa fa-check-circle"
            })))
        }
    }),
    l = React.createClass({
        displayName: "TagModal",
        getInitialState: function() {
            return {
                tagName: ""
            }
        },
        handleUpdate: function(e) {
            return this.setState({
                tagName: e.target.value
            })
        },
        handleSave: function() {
            var e, t;
            if (t = this.state.tagName, t.replace(/\s/g, "")) return e = new Assettag({
                tag: t,
                asset_cids: this.props.asset.cid
            }),
            e.lsave(),
            MB.renderAssetsManager(this.props.target),
            $("#tag-modal").modal("hide")
        },
        render: function() {
            return React.createElement("div", {
                className: "modal-dialog"
            },
            React.createElement("div", {
                className: "modal-content"
            },
            React.createElement(MB.ModalHeader, {
                title: I18N.create_tag
            }), React.createElement("div", {
                className: "modal-body"
            },
            React.createElement("div", {
                className: "form-group"
            },
            React.createElement("input", {
                type: "text",
                name: "name",
                className: "form-control",
                value: this.state.tagName,
                onChange: this.handleUpdate
            }))), React.createElement("div", {
                className: "modal-footer"
            },
            React.createElement("a", {
                type: "submit",
                className: "btn",
                onClick: this.handleSave
            },
            I18N.create))))
        }
    }),
    e = React.createClass({
        displayName: "AssetDetail",
        handleAssetName: function(e) {
            var t;
            return t = this.props.asset,
            t.name = e.target.value,
            t.lsave(),
            MB.renderAssetsManager(this.props.target)
        },
        handleRemove: function(e) {
            return e.removeAsset(this.props.asset.cid),
            MB.renderAssetsManager(this.props.target)
        },
        handleNewTag: function(e) {
            var t, i, n;
            return t = this.props.asset,
            n = e.target.value,
            "new" === n ? (ReactDOM.render(React.createElement(l, {
                asset: t,
                target: this.props.target
            }), $("#tag-modal")[0]), $("#tag-modal").modal()) : (i = Assettag.findByAttribute("tag", n), i && i.asset_cids.indexOf(t.cid) === -1 && i.addAsset(t.cid), MB.renderAssetsManager(this.props.target))
        },
        handleInsert: function() {
            var e, t, i;
            return e = this.props.asset,
            t = MB.currentScreen,
            i = WidgetManager.newImageView(e, 0, t.headerHeight(), t),
            $("body").trigger("undoStack:add", [null, [i.dup()]]),
            $("body").trigger("selection:select", [[i]])
        },
        handleReplace: function() {
            return MB.assetsManager.refs.uploader.setState({
                replace: !0
            }),
            $("#assets input[type=file]").click()
        },
        render: function() {
            var e, t, i, n, r, s, o, a, l, c;
            for (e = this.props.asset, c = this.props.target, a = [], l = [], o = Assettag.all(), n = 0, r = o.length; n < r; n++) t = o[n],
            t.asset_cids.indexOf(e.cid) === -1 ? l.push(t) : a.push(t);
            return i = e.thumbHeight() < 94 || /svg$/.test(e.image) ? e.image: e.thumb,
            "function" != typeof c.getAttr && (s = React.createElement("div", null, React.createElement("p", null, React.createElement("a", {
                className: "btn",
                onClick: this.handleInsert
            },
            I18N.insert_to_current)))),
            React.createElement("div", {
                className: "info details"
            },
            React.createElement("div", {
                className: "thumb"
            },
            React.createElement("img", {
                src: i
            })), React.createElement("div", {
                className: "group"
            },
            React.createElement("label", null, I18N.name), React.createElement("input", {
                type: "text",
                value: e.name,
                onChange: this.handleAssetName
            })), React.createElement("div", {
                className: "group"
            },
            s, React.createElement("p", null, React.createElement("a", {
                className: "btn",
                onClick: this.handleReplace
            },
            I18N.replace_image))), React.createElement("div", {
                className: "group"
            },
            React.createElement("label", null, I18N.tags), React.createElement("select", {
                onChange: this.handleNewTag,
                value: ""
            },
            React.createElement("option", {
                value: ""
            },
            I18N.choose_tag), l.map(function(e) {
                return React.createElement("option", {
                    key: e.cid
                },
                e.tag)
            }), React.createElement("option", {
                value: "new"
            },
            I18N.create_tag))), React.createElement("div", {
                className: "group"
            },
            React.createElement("ul", null, a.map(function(e) {
                return React.createElement("li", {
                    key: e.cid
                },
                React.createElement("span", null, e.tag), React.createElement("span", {
                    className: "count",
                    onClick: this.handleRemove.bind(this, e)
                },
                React.createElement("i", {
                    className: "fa fa-times"
                })))
            },
            this))))
        }
    }),
    r = React.createClass({
        displayName: "AssetTags",
        handleTag: function(e) {
            return MB.assetsManager.setState({
                tag: e,
                filter: ""
            })
        },
        handleRemove: function(e, t) {
            if (t.stopPropagation(), confirm(I18N.are_you_sure)) return e.ldestroy(),
            this.props.active && e.cid === this.props.active.cid ? MB.assetsManager.setState({
                tag: null,
                filter: "all"
            }) : MB.assetsManager.setState({
                tag: null
            })
        },
        render: function() {
            var e, t, i;
            return i = Assettag.all(),
            e = this.props.active ? this.props.active.tag: null,
            t = i.length ? React.createElement("ul", null, i.map(function(t) {
                return React.createElement("li", {
                    key: t.cid,
                    className: t.tag == e ? "active": null,
                    onClick: this.handleTag.bind(this, t)
                },
                React.createElement("span", null, t.tag), React.createElement("span", {
                    className: "del",
                    onClick: this.handleRemove.bind(this, t)
                },
                React.createElement("i", {
                    className: "fa fa-times"
                })), React.createElement("span", {
                    className: "count"
                },
                t.assets_count))
            },
            this)) : React.createElement("p", {
                className: "placeholder"
            },
            React.createElement("span", null, I18N.tags_placeholder)),
            React.createElement("div", {
                className: "tags"
            },
            React.createElement("h3", null, I18N.tags), t)
        }
    }),
    s = React.createClass({
        displayName: "AssetUploader",
        getInitialState: function() {
            return {
                replace: !1
            }
        },
        handleUpload: function() {
            return this.setState({
                replace: !1
            }),
            $("#assets input[type=file]").click()
        },
        handleFileChange: function(e) {
            return $("#asset input[type=file]").val(""),
            this.state.replace ? this.handleReplace(e) : Asset.createFromFiles(e.target.files)
        },
        handleReplace: function(e) {
            var t, i;
            if (t = this.props.selected) return i = e.target.files[0],
            MB.readDataURL(i,
            function(e, n, r) {
                var s;
                return s = t.image,
                t.raw = t.thumb = e,
                t.width = n,
                t.height = r,
                t.name = i.name,
                t.image = null,
                t.lsave(),
                Widget.each(function(e) {
                    if (e.image === s || e.image === t.cid) return e.image = t.cid,
                    e.lsave(!1),
                    WidgetManager.update(e)
                }),
                Widgetstate.each(function(e) {
                    if (e.image === s || e.image === t.cid) return e.image = t.cid,
                    e.lsave(!1)
                }),
                MB.assetsManager.forceUpdate()
            })
        },
        handleDragLeave: function() {
            return $("#assets .uploader").removeClass("hover")
        },
        handleDragOver: function(e) {
            return e.stopPropagation(),
            e.preventDefault(),
            $("#assets .uploader").addClass("hover"),
            e.nativeEvent.dataTransfer.dropEffect = "copy"
        },
        handleDrop: function(e) {
            return e.stopPropagation(),
            e.preventDefault(),
            $("#assets .uploader").removeClass("hover"),
            Asset.createFromFiles(e.nativeEvent.dataTransfer.files)
        },
        render: function() {
            return React.createElement("div", null, React.createElement("input", {
                type: "file",
                onChange: this.handleFileChange,
                multiple: !0,
                accept: "image/*"
            }), React.createElement("div", {
                className: "uploader",
                onClick: this.handleUpload,
                onDragLeave: this.handleDragLeave,
                onDragOver: this.handleDragOver,
                onDrop: this.handleDrop
            },
            I18N.inspector.drop_image, "\xa0", I18N.inspector.click_to_upload))
        }
    }),
    t = React.createClass({
        displayName: "AssetFilters",
        handleFilter: function(e) {
            return MB.assetsManager.setState({
                filter: e,
                tag: null
            })
        },
        handleFilterSelect: function(e) {
            return MB.assetsManager.setState({
                filter: e.target.value,
                tag: null
            })
        },
        render: function() {
            var e, t, i, n, r, s, o, a, l, c, d, u, h, p, f, g, m, v, b, y, _, w;
            for (e = this.props.active, o = this.props.filters, r = MB.project().cid, t = [], i = [], n = {},
            _ = {},
            c = 0, d = 0, o.all !== o.mine && (u = React.createElement("li", {
                onClick: this.handleFilter.bind(this, "mine"),
                className: "mine" == e ? "active": null
            },
            React.createElement("span", null, I18N.my_assets), React.createElement("span", {
                className: "count"
            },
            o.mine))), v = Project.all(), a = 0, l = v.length; a < l; a++) f = v[a],
            o[f.cid] && (s = {
                name: f.name,
                cid: f.cid,
                count: o[f.cid]
            },
            f.team_cid ? (b = f.cteam(), b && (_[p = b.cid] || (_[p] = {
                name: b.name,
                apps: []
            }), _[b.cid].apps.push(s)), d < s.count && (d = s.count), f.cid === e && (y = s.count)) : (f.owner_id === MB.user.id ? f.archived ? i.push(s) : t.push(s) : (n[h = f.owner_id] || (n[h] = {
                name: f.owner_name,
                apps: []
            }), n[f.owner_id].apps.push(s)), c < s.count && (c = s.count), f.cid === e && (g = s.count)));
            return c > 0 && (m = React.createElement("li", {
                className: g && r != e ? "active select": "select"
            },
            React.createElement("select", {
                onChange: this.handleFilterSelect,
                value: e
            },
            React.createElement("option", null, I18N.my_apps), React.createElement("optgroup", {
                label: I18N.all_apps
            },
            t.map(function(e) {
                return React.createElement("option", {
                    key: e.cid,
                    value: e.cid
                },
                e.name, "(", e.count, ")")
            },
            this)), React.createElement("optgroup", {
                label: I18N.archived
            },
            i.map(function(e) {
                return React.createElement("option", {
                    key: e.cid,
                    value: e.cid
                },
                e.name, "(", e.count, ")")
            },
            this)), Object.keys(n).map(function(e) {
                return React.createElement("optgroup", {
                    label: n[e].name,
                    key: e
                },
                n[e].apps.map(function(e) {
                    return React.createElement("option", {
                        key: e.cid,
                        value: e.cid
                    },
                    e.name, "(", e.count, ")")
                }))
            })), React.createElement("span", {
                className: "count"
            },
            g || c))),
            d > 0 && (w = React.createElement("li", {
                className: y && r != e ? "active select": "select"
            },
            React.createElement("select", {
                onChange: this.handleFilterSelect,
                value: e
            },
            React.createElement("option", null, I18N.team_apps), Object.keys(_).map(function(e) {
                return React.createElement("optgroup", {
                    label: _[e].name,
                    key: e
                },
                _[e].apps.map(function(e) {
                    return React.createElement("option", {
                        key: e.cid,
                        value: e.cid
                    },
                    e.name, "(", e.count, ")")
                }))
            })), React.createElement("span", {
                className: "count"
            },
            y || d))),
            React.createElement("div", null, React.createElement("ul", null, React.createElement("li", {
                onClick: this.handleFilter.bind(this, "all"),
                className: "all" == e ? "active": null
            },
            React.createElement("span", null, I18N.all_assets), React.createElement("span", {
                className: "count"
            },
            o.all)), u, React.createElement("li", {
                onClick: this.handleFilter.bind(this, r),
                className: e == r ? "active": null
            },
            React.createElement("span", null, I18N.current_assets), React.createElement("span", {
                className: "count"
            },
            o[r] || 0)), m, w))
        }
    }),
    i = React.createClass({
        displayName: "AssetPagination",
        getPages: function() {
            return Math.ceil(this.props.items / this.props.itemsOnPage)
        },
        getInterval: function() {
            return {
                start: Math.ceil(this.props.currentIndex > this.props.displayedPages / 2 ? Math.max(Math.min(this.props.currentIndex - this.props.displayedPages / 2, this.getPages() - this.props.displayedPages), 0) : 0),
                end: Math.ceil(this.props.currentIndex > this.props.displayedPages / 2 ? Math.min(this.props.currentIndex + this.props.displayedPages / 2, this.getPages()) : Math.min(this.props.displayedPages, this.getPages()))
            }
        },
        genStartEdges: function() {
            var e, t, i, n, r, s;
            if (e = [], n = this.getInterval(), n.start > 0 && this.props.edges > 0) {
                for (t = Math.min(this.props.edges, n.start), i = r = 0, s = t; 0 <= s ? r < s: r > s; i = 0 <= s ? ++r: --r) e.push(i);
                this.props.edges < n.start && n.start - this.props.edges !== 1 ? e.push("...") : n.start - this.props.edges === 1 && e.push(this.props.edges)
            }
            return e
        },
        genIntervalLink: function() {
            var e, t, i;
            return e = this.getInterval(),
            function() {
                i = [];
                for (var n = t = e.start,
                r = e.end; t <= r ? n < r: n > r; t <= r ? n++:n--) i.push(n);
                return i
            }.apply(this).map(function(e) {
                return e
            })
        },
        genEndEdges: function() {
            var e, t, i, n, r, s, o;
            if (t = [], n = this.getInterval(), n.end < this.getPages() && this.props.edges > 0) for (this.getPages() - this.props.edges > n.end && this.getPages() - this.props.edges - n.end !== 1 ? t.push("...") : this.getPages() - this.props.edges - n.end === 1 && t.push(n.end++), e = Math.max(this.getPages() - this.props.edges, n.end), i = r = s = e, o = this.getPages(); s <= o ? r < o: r > o; i = s <= o ? ++r: --r) t.push(i);
            return t
        },
        render: function() {
            var e, t, i;
            return t = [].concat(this.genStartEdges(), this.genIntervalLink(), this.genEndEdges()),
            i = this.props.onPaginationItemClick,
            e = this.props.currentIndex,
            React.createElement("nav", null, React.createElement("ul", {
                className: "pagination"
            },
            t.map(function(t, r) {
                return React.createElement(n, {
                    key: r,
                    onPaginationItemClick: i,
                    currentIndex: e,
                    content: t
                })
            })))
        }
    }),
    n = React.createClass({
        displayName: "AssetPaginationItem",
        onClick: function(e) {
            if (e.preventDefault(), "..." !== this.props.content) return this.props.onPaginationItemClick(this.props.content)
        },
        render: function() {
            var e;
            return e = this.props.content,
            React.createElement("li", {
                className: e == this.props.currentIndex ? "active": null
            },
            React.createElement("a", {
                href: "#",
                onClick: this.onClick
            },
            "..." == e ? "...": e + 1))
        }
    }),
    o = React.createClass({
        displayName: "AssetsManager",
        itemsOnPage: 50,
        displayedPages: 3,
        edges: 1,
        getInitialState: function() {
            return {
                filter: "all",
                keyword: "",
                current: MB.project().cid,
                tag: null,
                currentIndex: 0
            }
        },
        handleRemove: function(e) {
            var t, i, n, r;
            if (confirm(I18N.are_you_sure)) {
                for (e = Asset.find(e.cid), e.deleted = !0, e.lsave(), MB.user.assets -= e.size, r = Assettag.all(), i = 0, n = r.length; i < n; i++) t = r[i],
                t.asset_cids.indexOf(e.cid) !== -1 && t.removeAsset(e.cid);
                return MB.renderAssetsManager(this.props.target)
            }
        },
        handleSelect: function(e) {
            var t;
            return t = this.props.target,
            t.setImage(e),
            MB.renderAssetsManager(t)
        },
        filterAsset: function(e) {
            return this.setState({
                filter: e,
                tag: ""
            })
        },
        searchAsset: function(e) {
            var t;
            return t = e.target.value.toLowerCase(),
            this.setState({
                keyword: t
            })
        },
        handleClose: function() {
            return $("#assets_manager").hide()
        },
        matchKeyword: function(e) {
            return ! this.state.keyword || e.name.toLowerCase().indexOf(this.state.keyword.toLowerCase()) !== -1
        },
        matchTag: function(e) {
            return ! this.state.tag || this.state.tag.asset_cids.indexOf(e.cid) !== -1
        },
        matchFilter: function(e, t) {
            var i;
            return ! this.state.filter || (i = this.state.filter, "all" === i || "mine" === i && e.user_id === MB.user.id || t[e.sid] === i || t[e.cid] === i)
        },
        onPaginationItemClick: function(e) {
            return this.setState({
                currentIndex: e
            })
        },
        render: function() {
            var n, o, l, c, d, u, h, p, f;
            return l = {
                all: 0,
                mine: 0
            },
            u = Projectasset.all().reduce(function(e, t) {
                var i;
                return e[t.asset_id] || (l[i = t.project_cid] || (l[i] = 0), l[t.project_cid] += 1, e[t.asset_id] = t.project_cid),
                e
            },
            {}),
            o = Asset.select(function(e) {
                return function(t) {
                    return ! t.deleted && (l.all += 1, t.user_id === MB.user.id && (l.mine += 1), e.matchKeyword(t) && e.matchFilter(t, u) && e.matchTag(t))
                }
            } (this)),
            o = o.sort(function(e, t) {
                return t.timestamp - e.timestamp
            }),
            f = this.props.target,
            c = f.getImage(),
            n = "",
            p = Math.floor(MB.user.assets / 1048576),
            p > 1024 ? p = Math.floor(p / 1024) + "GB": p += "MB",
            d = MB.user.expired ? "100MB": "enterprise" === MB.user.plan ? "1000GB": "10GB",
            c && (h = Asset.find(c) || Asset.findByAttribute("image", c), h && (n = React.createElement(e, {
                asset: h,
                target: f
            }))),
            React.createElement("div", {
                id: "assets",
                className: "toolbox active"
            },
            React.createElement("div", {
                className: "header"
            },
            React.createElement("div", {
                className: "storage"
            },
            I18N.storage, ": ", p, "/", d), React.createElement(i, {
                currentIndex: this.state.currentIndex,
                items: o.length,
                itemsOnPage: this.itemsOnPage,
                displayedPages: this.displayedPages,
                edges: this.edges,
                onPaginationItemClick: this.onPaginationItemClick
            }), React.createElement("div", {
                className: "close",
                onClick: this.handleClose
            },
            React.createElement("i", {
                className: "fa fa-close"
            }))), React.createElement("div", {
                className: "filters"
            },
            React.createElement("input", {
                id: "asset_search",
                type: "text",
                placeholder: I18N.inspector.asset_search,
                onChange: this.searchAsset
            }), React.createElement(t, {
                filters: l,
                active: this.state.filter,
                target: f
            }), React.createElement(r, {
                active: this.state.tag
            })), React.createElement("div", {
                className: "assets"
            },
            o.slice(this.state.currentIndex * this.itemsOnPage, (this.state.currentIndex + 1) * this.itemsOnPage).map(function(e, t) {
                return React.createElement(a, {
                    asset: e,
                    i: t,
                    key: e.cid,
                    selected: h
                })
            },
            this), React.createElement("div", {
                className: "clearfix"
            })), React.createElement(s, {
                ref: "uploader",
                selected: h
            }), n)
        }
    }),
    MB.renderAssetsManager = function(e) {
        return e || (e = {
            setImage: function(e) {
                return this._image = e.cid
            },
            getImage: function() {
                return this._image
            }
        }),
        $("#assets_manager").show(),
        MB.assetsManager = ReactDOM.render(React.createElement(o, {
            target: e
        }), $("#assets_manager")[0])
    }
}.call(this),
function() {
    var e, t, i;
    e = React.createClass({
        displayName: "CoWorkerView",
        render: function() {
            var e;
            return e = this.props.coWorker,
            React.createElement("div", {
                className: "coworker",
                key: e.id
            },
            React.createElement("img", {
                className: "avatar",
                src: e.avatar
            }), React.createElement("span", {
                className: "name"
            },
            e.name))
        }
    }),
    i = React.createClass({
        displayName: "ScreenCoWorkers",
        render: function() {
            var t, i, n;
            return i = this.props.s,
            $("#sli" + i.cid).length ? (n = $("#sli" + i.cid).offset().top, t = CoWorker.select(function(e) {
                return e.screen_cid === i.cid
            }), React.createElement("div", {
                className: "screen-coworkers",
                style: {
                    top: n
                }
            },
            t.map(function(t) {
                return React.createElement(e, {
                    coWorker: t,
                    key: t.id
                })
            }))) : React.createElement("div", null)
        }
    }),
    t = React.createClass({
        displayName: "CoWorkers",
        render: function() {
            var e;
            return e = MB.project().cscreens(),
            React.createElement("div", null, e.map(function(e) {
                return React.createElement(i, {
                    s: e,
                    key: e.cid
                })
            }))
        }
    }),
    MB.refreshCoWorkers = function() {
        var e, t, i, n;
        if (CoWorker.count()) {
            for (n = CoWorker.all(), t = 0, i = n.length; t < i; t++) e = n[t],
            e.last_seen < new Date - 6e4 && e.destroy();
            return MB.renderCoWorkers()
        }
    },
    MB.renderCoWorkers = function() {
        if (MB.project() && $("#coworkers")[0]) return ReactDOM.render(React.createElement(t, null), $("#coworkers")[0])
    }
}.call(this),
function() {
    var e, t, i, n, r, s, o, a;
    o = /^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i,
    s = {
        user: 0,
        owner: 1,
        admin: 2,
        editor: 3,
        viewer: 4
    },
    a = function(e, t) {
        var i, n;
        return i = s[e.user_id === MB.user.id ? "user": e.role],
        n = s[t.user_id === MB.user.id ? "user": t.role],
        i !== n ? i - n: e.name && t.name ? e.name.localeCompare(t.name) : !e.name && t.name ? 1 : e.name && !t.name ? -1 : e.email.localeCompare(t.email)
    },
    i = React.createClass({
        displayName: "CollaboratorPromptItem",
        render: function() {
            var e, t;
            return e = this.props.collaborator,
            t = this.props.handleClick,
            React.createElement("li", {
                ref: "li",
                onMouseDown: t
            },
            React.createElement("img", {
                className: "avatar",
                src: e.avatar
            }), React.createElement("span", {
                className: "name"
            },
            e.name ? e.name: e.email + "(" + I18N.pending + ")"), e.name && React.createElement("span", {
                className: "email"
            },
            e.email))
        }
    }),
    t = React.createClass({
        displayName: "CollaboratorModalEdit",
        handleUpdate: function(e) {
            return this.props.handleUpdate(this.props.collaborator, e.target.value)
        },
        handleRemove: function() {
            return this.props.handleRemove(this.props.collaborator)
        },
        render: function() {
            var e, t, i, n, r, s, o, a;
            return s = this.props,
            i = s.collaborator,
            a = s.userRole,
            n = s.host,
            r = n.isTeam(),
            MB.PermissionCheck(r && "team", "collaborator-update", i.role, a) ? (o = ["viewer", "editor"], r && MB.PermissionCheck("team-collaborator-update", "admin", a) && o.push("admin"), t = React.createElement("div", {
                className: "actions",
                onClick: this.handleRemove
            },
            I18N["delete"]), e = React.createElement("div", {
                className: "access"
            },
            React.createElement("select", {
                name: "access",
                onChange: this.handleUpdate,
                value: i.role
            },
            o.map(function(e) {
                return React.createElement("option", {
                    value: e,
                    key: e
                },
                I18N.roles[e], " - ", I18N.roles[e + "_desc"])
            })))) : (t = React.createElement("div", {
                className: "actions"
            },
            "\xa0"), e = React.createElement("div", {
                className: "access"
            },
            I18N.roles[i.role])),
            React.createElement("div", {
                className: "collaborator"
            },
            t, e, React.createElement("div", {
                className: "profile"
            },
            React.createElement("img", {
                className: "avatar",
                src: i.avatar
            }), React.createElement("span", {
                className: "name"
            },
            i.name || i.email + "(" + I18N.pending + ")")))
        }
    }),
    e = React.createClass({
        displayName: "CollaboratorModalCreate",
        getInitialState: function() {
            return {
                email: "",
                role: "viewer",
                promptCollaborator: [],
                promptDisplay: "none"
            }
        },
        updateRole: function(e) {
            return this.setState({
                role: e.target.value
            })
        },
        updateEmail: function(e) {
            var t;
            if (t = e.target.value.trim().toLowerCase(), t !== this.state.email) return this.updatePrompt(t)
        },
        updatePrompt: function(e) {
            var t, i, n, r, s, o, a;
            for (e && (a = new RegExp(e, "i")), i = this.props.host.collaborators().reduce(function(e, t) {
                return e[t.email] = !0,
                e
            },
            {}), s = [], o = Collaborator.all(), n = 0, r = o.length; n < r && (t = o[n], !(s.length >= 10)); n++) t.email && !i[t.email] && (!a || a.test(t.name) || a.test(t.email)) && t.user_id !== MB.user.id && (i[t.email] = !0, s.push(t));
            return this.setState({
                email: e,
                promptCollaborator: s,
                promptDisplay: ""
            })
        },
        handleInvite: function(e) {
            var t, i, n, r, s, a, l;
            for (e.preventDefault(), r = this.props.host, n = r.collaborators(), s = 0, l = n.length; s < l; s++) t = n[s],
            t.email === this.state.email && (a = t);
            if (this.state.email && o.test(this.state.email) ? this.state.email === MB.user.email ? i = {
                message: I18N.cant_invite_yourself
            }: a ? i = {
                message: I18N.already_invited
            }: n.length > r.limitation.collaborators ? (i = {
                message: I18N.exceed_collaborator_limit
            },
            MB.mp("\u63d0\u793a\u4ed8\u8d39: \u8d85\u51fa\u534f\u4f5c\u4eba\u6570")) : (i = null, this.props.handleCreate(this.state.email, this.state.role), MB.mp("\u5b8c\u6210\u4e86\u534f\u4f5c\u9080\u8bf7")) : i = {
                message: I18N.invalid_email
            },
            this.setState({
                email: "",
                role: "viewer"
            }), i) return MB.renderCollaboratorsModal(this.props.host, i.message),
            $("#collaborators-modal input[type=email]").focus()
        },
        renderPromptCollaborator: function(e) {
            var t;
            return 0 === this.state.promptCollaborator.length ? null: (t = function(e) {
                return function(t) {
                    return function() {
                        return e.setState({
                            email: t,
                            promptCollaborator: []
                        })
                    }
                }
            } (this), React.createElement("div", {
                className: "prompt-list",
                style: {
                    display: e
                }
            },
            React.createElement("ul", null, this.state.promptCollaborator.map(function(e) {
                return React.createElement(i, {
                    collaborator: e,
                    handleClick: t(e.email),
                    key: e.email
                })
            }))))
        },
        render: function() {
            var e, t, i, n, r, s;
            return i = this.props,
            t = i.host,
            s = i.userRole,
            n = ["viewer", "editor"],
            t.isTeam() && MB.PermissionCheck("team-collaborator-create", "admin", s) && n.push("admin"),
            r = function(e) {
                return function() {
                    return e.updatePrompt(e.state.email)
                }
            } (this),
            e = function(e) {
                return function() {
                    return setTimeout(function() {
                        return e.setState({
                            promptDisplay: "none"
                        })
                    },
                    100)
                }
            } (this),
            React.createElement("div", {
                className: "collaborator"
            },
            React.createElement("div", {
                className: "actions",
                style: {
                    cursor: "pointer"
                },
                onClick: this.handleInvite
            },
            I18N.invite), React.createElement("div", {
                className: "access"
            },
            React.createElement("select", {
                name: "access",
                onChange: this.updateRole,
                value: this.state.role
            },
            n.map(function(e) {
                return React.createElement("option", {
                    value: e,
                    key: e
                },
                I18N.roles[e], " - ", I18N.roles[e + "_desc"])
            }))), React.createElement("div", {
                className: "profile"
            },
            React.createElement("input", {
                name: "email",
                type: "email",
                className: "form-control",
                value: this.state.email,
                placeholder: "Email",
                autoComplete: "off",
                onChange: this.updateEmail,
                onClick: r,
                onBlur: e
            }), this.renderPromptCollaborator(this.state.promptDisplay)))
        }
    }),
    r = React.createClass({
        displayName: "CollaboratorsModal",
        propTypes: {
            host: React.PropTypes.object,
            error: React.PropTypes.string,
            userRole: React.PropTypes.string,
            onChange: React.PropTypes.func
        },
        updateRender: function() {
            return MB.renderCollaboratorsModal(this.props.host),
            MB.webpackInterface.refreshTeam(),
            MB.webpackInterface.refreshProject(),
            $("body").trigger("queue:save")
        },
        handleCreate: function(e, t) {
            var i;
            if (MB.PermissionCheck(this.props.host.isTeam() && "team", "collaborator-create", t, this.props.userRole)) return i = new Collaborator({
                email: e,
                role: t,
                cid: "co" + Math.uuid(10, 16) + (new Date).valueOf(),
                avatar: "/images/avatar.png"
            }),
            this.props.host.isTeam() ? i.team_cid = this.props.host.cid: i.project_cid = this.props.host.cid,
            i.lsave(),
            i.updateHostChannel("update"),
            this.updateRender()
        },
        handleUpdate: function(e, t) {
            if (MB.PermissionCheck(this.props.host.isTeam() && "team", "collaborator-update", [e.role, t], this.props.userRole)) return e.role = t,
            e.lsave(),
            e.updateHostChannel("update"),
            this.updateRender()
        },
        handleRemove: function(e) {
            if (MB.PermissionCheck(this.props.host.isTeam() && "team", "collaborator-delete", e.role, this.props.userRole)) return e.updateHostChannel("destroy"),
            e.ldestroy(),
            this.updateRender()
        },
        render: function() {
            var i, n, r, s, o, l;
            return o = this.props,
            r = o.host,
            n = o.error,
            l = o.userRole,
            i = r.collaborators().sort(a),
            MB.PermissionCheck(r.isTeam() && "team", "collaborator-create", "viewer", l) ? s = React.createElement(e, {
                host: r,
                userRole: l,
                handleCreate: this.handleCreate
            }) : n = I18N.owner_only,
            React.createElement("div", {
                className: "modal-dialog"
            },
            React.createElement("div", {
                className: "modal-content"
            },
            React.createElement(MB.ModalHeader, {
                title: I18N.manage_collaborators
            }), React.createElement("div", {
                className: "modal-body"
            },
            React.createElement("div", {
                className: "upgrading"
            },
            React.createElement("div", {
                className: "alert alert-danger",
                style: {
                    display: MB.shouldDisplay(n)
                }
            },
            n)), s, i.map(function(e) {
                return React.createElement(t, {
                    userRole: l,
                    host: r,
                    collaborator: e,
                    handleUpdate: this.handleUpdate,
                    handleRemove: this.handleRemove,
                    key: e.cid
                })
            },
            this)), React.createElement("div", {
                className: "modal-footer"
            })))
        }
    }),
    n = React.createClass({
        displayName: "CollaboratorView",
        render: function() {
            var e;
            return e = this.props.avatar,
            React.createElement("div", {
                className: "collaborator"
            },
            React.createElement("img", {
                className: "avatar",
                src: e
            }))
        }
    }),
    MB.Collaborators = React.createClass({
        displayName: "Collaborators",
        propTypes: {
            host: React.PropTypes.object,
            fill: React.PropTypes.any
        },
        getInitialState: function() {
            return {
                fill: "9FA4AA"
            }
        },
        handleTeamManagement: function() {
            var e;
            if (e = this.props.host, !e.team_cid) return MB.renderCollaboratorsModal(e),
            $("#collaborators-modal").modal()
        },
        handleBlur: function() {
            return this.setState({
                fill: "9FA4AA"
            })
        },
        handleHover: function() {
            return this.setState({
                fill: "FF403B"
            })
        },
        render: function() {
            var e, t, i;
            return t = this.props.host,
            e = this.state.fill,
            i = "data:image/svg+xml;utf8,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='14' height='14' viewBox='0 0 24 24' fill='%23" + e + "'%3E %3Cpath d='M15.984 12.984c2.344 0 7.031 1.172 7.031 3.516v2.484h-6v-2.484c0-1.5-0.797-2.625-1.969-3.469 0.328-0.047 0.656-0.047 0.938-0.047zM8.016 12.984c2.344 0 6.984 1.172 6.984 3.516v2.484h-14.016v-2.484c0-2.344 4.688-3.516 7.031-3.516zM8.016 11.016c-1.641 0-3-1.359-3-3s1.359-3 3-3 2.953 1.359 2.953 3-1.313 3-2.953 3zM15.984 11.016c-1.641 0-3-1.359-3-3s1.359-3 3-3 3 1.359 3 3-1.359 3-3 3z'%3E%3C/path%3E%3C/svg%3E",
            React.createElement("div", {
                className: "collaborators",
                onClick: this.handleTeamManagement,
                onMouseEnter: this.handleHover,
                onMouseLeave: this.handleBlur
            },
            React.createElement("img", {
                src: i
            }), React.createElement("span", {
                style: {
                    color: "#" + e
                }
            },
            t.collaborators().length))
        }
    }),
    MB.renderCollaboratorsModal = function(e, t) {
        return ReactDOM.render(React.createElement(r, {
            host: e,
            error: t,
            userRole: e.owner_id === MB.user.id ? "owner": e.roleByUid(MB.user.id)
        }), $("#collaborators-modal")[0])
    }
}.call(this),
function() {
    var e;
    e = function() {
        return '<div id="drag_area"></div>\n<div id="components"></div>\n<div id="toolbar" class="toolbar"></div>\n<div id="screens" class="screens" data-selectable=\'true\'></div>\n<div id="selection"></div>\n<div id="right_nav"></div>\n<div id="context-menu"></div>\n\n<div id="coworkers"></div>\n<div id="toolboxes"></div>\n<div id="assets_manager"></div>\n<div id="asset_uploader"></div>\n<div id="links">\n  <div class="link_list"></div>\n</div>'
    },
    MB.renderDesigner = function() {
        return $("#design").html(e(MB.currentProject)),
        $("#design").show(),
        $("#design").css("overflow", "hidden"),
        $("#screens").perfectScrollbar({
            handlers: ["click-rail", "drag-scrollbar", "wheel", "touch"]
        })
    }
}.call(this),
function() {
    var e, t;
    t = function(e) {
        var t;
        return t = e.duplicate(),
        t.lsave(!1),
        MB.EditableSpan.expecting = t.cid,
        ScreenManager.activate(t),
        ScreenManager.sort(t.cid, t.position, t.parent_cid)
    },
    e = React.createClass({
        displayName: "DupModal",
        handleCancel: function() {
            return $("#dup-modal").modal("hide")
        },
        handleDupParent: function() {
            return $("#dup-modal").modal("hide"),
            t(this.props.s)
        },
        handleDupAll: function() {
            var e, t;
            return $("#dup-modal").modal("hide"),
            t = this.props.s,
            e = t.position,
            MB.safeLoading(I18N.in_progress),
            MB.triggerProgress(function() {
                var e, i, n;
                return e = MB.project(),
                n = "/app/" + e.access_token + "/duplicate.json?screen_cid=" + t.cid,
                i = $.getJSON(n,
                function(t) {
                    return MB.checkDupProgress(t.jid,
                    function() {
                        return Template.deleteAll(),
                        Screen.deleteAll(),
                        Widget.deleteAll(),
                        Link.deleteAll(),
                        Panel.deleteAll(),
                        Screenstate.deleteAll(),
                        Widgetstate.deleteAll(),
                        Panelstate.deleteAll(),
                        MB.pusher.subscribed = [],
                        e.download(function() {
                            return MB.renderRightNav(),
                            MB.renderLinks(),
                            $("#safemode").hide()
                        })
                    })
                })
            })
        },
        render: function() {
            return React.createElement("div", null, React.createElement("div", {
                className: "modal-dialog"
            },
            React.createElement("div", {
                className: "modal-content"
            },
            React.createElement(MB.ModalHeader, {
                title: I18N.are_you_sure
            }), React.createElement("div", {
                className: "modal-body"
            },
            React.createElement("p", null, I18N.dc_confirm)), React.createElement("div", {
                className: "modal-footer"
            },
            React.createElement("a", {
                type: "submit",
                className: "btn btn-default",
                onClick: this.handleDupParent
            },
            I18N.duplicate_parent_only), React.createElement("a", {
                type: "submit",
                className: "btn btn-primary",
                onClick: this.handleDupAll
            },
            I18N.duplicate_all)))))
        }
    }),
    MB.renderDupModal = function(i) {
        return i.children().length ? (ReactDOM.render(React.createElement(e, {
            s: i
        }), $("#dup-modal")[0]), $("#dup-modal").modal()) : t(i)
    }
}.call(this),
function() {
    var e, t;
    e = React.createClass({
        displayName: "ColorInput",
        getInitialState: function() {
            return {
                color: null
            }
        },
        handleChange: function(e) {
            return this.setState({
                color: e.target.value
            })
        },
        handleKeyUp: function(e) {
            if (13 === e.nativeEvent.which) return $(e.target).blur()
        },
        handleBlur: function(e) {
            var t;
            t = $("<div>").css("color", e.target.value).css("color"),
            (!t || "transparent" === t && "transparent" !== e.target.value) && (t = this.defaultColor());
            try {
                t = MB.rgb2hex(t)
            } catch(e) {
                t = this.defaultColor()
            }
            return t !== this.defaultColor() && this.setColor(t),
            this.setState({
                color: null
            })
        },
        triggerColorPicker: function() {
            var e;
            return e = this.defaultColor(),
            $("#colorpicker .body").colpickSetColor(e.replace("#", "")),
            MB.toolboxes.setState({
                pickColorFor: this.props.attr
            })
        },
        setColor: function(e) {
            return MB.selection.setAttr(this.props.attr, e)
        },
        defaultColor: function() {
            return this.props.groupedItems[this.props.attr]()
        },
        currentColor: function() {
            return null === this.state.color ? this.defaultColor() : this.state.color
        },
        render: function() {
            var e, t;
            return e = this.props.color || this.currentColor(),
            t = this.props.groupedItems.attributes().indexOf(this.props.attr) === -1 ? {
                display: "none"
            }: {},
            React.createElement("div", {
                className: "col inline",
                style: t
            },
            React.createElement("label", null, this.props.label), React.createElement("div", {
                className: "input-group color"
            },
            React.createElement("input", {
                type: "text",
                value: e,
                onFocus: this.triggerColorPicker,
                onChange: this.handleChange,
                onBlur: this.handleBlur,
                onKeyUp: this.handleKeyUp
            }), React.createElement("button", {
                className: "input-group-addon",
                style: {
                    backgroundColor: e
                },
                onClick: this.triggerColorPicker
            })), React.createElement("div", {
                className: "clearfix"
            }))
        }
    }),
    t = React.createClass({
        displayName: "ColorSets",
        componentDidMount: function() {
            return [0, 1, 2, 3, 4, 5, 6, 7, 8, 9].map(function(e) {
                return key.unbind("shift+" + e),
                key("shift+" + e,
                function() {
                    var t;
                    if (t = Colorset.find(e || 10), t && MB.selection) return MB.selection.setColorSet(t)
                })
            })
        },
        handleClick: function(e) {
            var t;
            if (MB.toolboxes.setState({
                activeColorset: e
            }), t = Colorset.find(e)) return MB.selection.setColorSet(t)
        },
        handleUpdate: function() {
            var e, t, i, n, r, s, o;
            for (i = this.props.groupedItems, n = i.first(), t = Colorset.find(this.active) || new Colorset({
                cid: this.active
            }), o = Colorset.attrs, r = 0, s = o.length; r < s; r++) e = o[r],
            t[e] = i.getAttr(e);
            return t.br = Math.round(100 * n.br / Math.min(n.width, n.height)),
            t.tc = WidgetManager.tc(n, $("#widget" + n.cid)),
            t.bg = WidgetManager.bg(n, $("#widget" + n.cid)),
            t.bc = WidgetManager.bc(n, $("#widget" + n.cid)),
            t.lsave(),
            this.forceUpdate()
        },
        cs2style: function(e) {
            if (e) return {
                backgroundColor: e.bg,
                color: e.tc,
                borderColor: e.bs ? e.bc: "transparent",
                borderStyle: ["solid", "dotted", "dashed"][e.ls],
                borderWidth: 1,
                borderRadius: Math.round(24 * e.br / 100),
                opacity: (e.o || 100) / 100,
                borderRadius: e.br,
                transform: "rotate(" + e.ro + "deg)",
                fontSize: e.fs > 22 ? 22 : e.fs || 12,
                fontStyle: !e.i || "italic",
                fontWeight: !e.bo || "bold",
                textDecoration: "normal" === e.td ? null: e.td,
                textShadow: "0 0 " + e.ts + "px " + e.tsc,
                WebkitClipPath: e.clip,
                clipPath: e.clip
            }
        },
        render: function() {
            var e, t, i, n;
            return t = this.props.groupedItems,
            this.active = this.props.active,
            n = t.canSetAttr("th"),
            e = function() {
                var e, t;
                for (t = [], i = e = 1; e <= 10; i = ++e) t.push(Colorset.find(i));
                return t
            } (),
            React.createElement("div", {
                className: "col",
                style: {
                    display: MB.shouldDisplay(n)
                }
            },
            React.createElement("label", null, I18N.custom_theme), React.createElement("div", {
                className: "colorsets"
            },
            e.map(function(e, t) {
                return React.createElement("div", {
                    className: "colorset " + (t + 1 == this.active ? "active": ""),
                    key: t + 1,
                    style: this.cs2style(e),
                    onClick: this.handleClick.bind(this, t + 1)
                },
                React.createElement("span", null, (t + 1) % 10))
            },
            this), React.createElement("div", {
                className: "clearfix"
            })), React.createElement("a", {
                className: "btn primary",
                onClick: this.handleUpdate,
                style: {
                    display: MB.shouldDisplay(this.active)
                }
            },
            Colorset.find(this.active) ? I18N.update_colorset: I18N.new_colorset), React.createElement("p", {
                className: "tips"
            },
            I18N.colorset_tips.replace("NUM", null == this.active ? "NUM": this.active % 10)))
        }
    }),
    MB.General = React.createClass({
        displayName: "General",
        toggleColor: function() {
            return MB.toolboxes.setState({
                showText: !1
            })
        },
        toggleText: function() {
            return MB.toolboxes.setState({
                showText: !0
            })
        },
        handleClose: function(e) {
            return e.stopPropagation(),
            MB.config.showGeneral = !MB.config.showGeneral,
            this.forceUpdate()
        },
        handleClick: function() {
            return MB.toolboxes.handleClick("general")
        },
        setTheme: function(e) {
            return MB.selection.setTheme(e)
        },
        handleBold: function() {
            return MB.selection.editing && MB.selection.editing.richedit ? MB.selection.editing.bo ? void 0 : document.execCommand("bold") : MB.selection.setAttr("bo", !this.props.groupedItems.getAttr("bo"))
        },
        handleItalic: function() {
            return MB.selection.editing && MB.selection.editing.richedit ? MB.selection.editing.i ? void 0 : document.execCommand("italic") : MB.selection.setAttr("i", !this.props.groupedItems.getAttr("i"))
        },
        handleDecoration: function(e, t) {
            return MB.selection.editing && MB.selection.editing.richedit ? ("line-through" === e && (e = "strikeThrough"), document.execCommand(e)) : ($(t.target).hasClass("active") && (e = ""), MB.selection.setAttr("td", e))
        },
        handleHA: function(e) {
            return MB.selection.setAttr("ha", e)
        },
        handleVA: function(e) {
            return MB.selection.setAttr("va", e)
        },
        editableContent: function(e) {
            var t, i, n;
            return t = this.props.groupedItems.first(),
            n = t.richedit ? $(e.target).html() : "mselect" === t.name ?
            function() {
                var t, n, r, s;
                for (r = $(e.target).find("p"), s = [], t = 0, n = r.length; t < n; t++) i = r[t],
                s.push(i.innerText);
                return s
            } ().join("\n") : $(e.target).text()
        },
        handleEditableFocus: function() {
            return MB.f.editing = !0,
            this.changed = !1
        },
        handleEditableBlur: function() {
            if (MB.f.editing = !1, this.changed) return MB.selection.undoableSave(!0)
        },
        handleEditableKeyDown: function(e) {
            var t;
            if (t = this.props.groupedItems.first(), 13 === e.which && !t.multiline) return e.preventDefault()
        },
        handleEditableKeyUp: function(e) {
            return MB.selection.setAttr("text", this.editableContent(e), !0, !1),
            MB.renderSelections(),
            MB.toolboxes.updatePosition(),
            this.changed = !0
        },
        isActive: function() {
            return MB.config.showGeneral && this.props.groupedItems.canSetTheme() && !MB.activePanel()
        },
        getSelectionAttributes: function() {
            var e, t, i, n, r;
            if (r = document.getSelection(), !(r.rangeCount > 0)) return {};
            for (n = r.getRangeAt(0), e = {},
            i = n.commonAncestorContainer, t = 0; i && "P" !== i.nodeType && t < 7;) {
                if (1 === i.nodeType) switch (i.nodeName) {
                case "I":
                    e.italic = !0;
                    break;
                case "B":
                    e.bold = !0;
                    break;
                case "U":
                    e.underline = !0;
                    break;
                case "STRIKE":
                    e.lineThrough = !0;
                    break;
                case "FONT":
                    e.color = i.color;
                    break;
                case "SPAN":
                    e.bg = MB.rgb2hex(i.style.backgroundColor)
                }
                i = i.parentNode,
                t += 1
            }
            return e
        },
        render: function() {
            var i, n, r, s, o, a, l, c, d, u, h, p, f, g, m, v, b, y, _, w, M, x, B, k, S, E, C, R, I, N, T, P, A, L, D, z, j, W, O;
            for (u = this.props.groupedItems, f = [], y = u.items(), g = 0, v = y.length; g < v; g++) p = y[g],
            f.indexOf(p.name) === -1 && f.push(p.name);
            return d = 1 === f.length,
            _ = MB.selection.editing && MB.selection.editing.richedit,
            w = _ ? this.getSelectionAttributes() : {},
            i = this.isActive() ? "toolbox active": "toolbox",
            n = this.props.showText ? "": "#F7F7F7",
            r = _ ? "none": "inline-block",
            k = this.props.showText ? "#F7F7F7": "",
            L = u.canSetText() ? "inline-block": "none",
            s = !this.props.showText,
            l = MB.shouldDisplay(this.props.showText && u.canSetText()),
            a = u.canSetAttr("bo") ? null: "none",
            c = u.canSetAttr("va") ? null: "none",
            o = u.canSetAttr("ha") ? null: "none",
            B = MB.v.multiline(u.getAttr("text")),
            S = u.getAttr("bo") || w.bold ? "active": "",
            I = u.getAttr("i") || w.italic ? "active": "",
            x = u.getAttr("td"),
            z = "underline" === x || w.underline ? "active": "",
            T = "line-through" === x || w.lineThrough ? "active": "",
            h = u.getAttr("ha"),
            N = "left" === h ? "active": "",
            C = "center" === h ? "active": "",
            A = "right" === h ? "active": "",
            O = u.getAttr("va"),
            D = "top" === O ? "active": "",
            P = "middle" === O ? "active": "",
            E = "bottom" === O ? "active": "",
            M = {},
            W = MB.preference().gt,
            m = MB.preference().gl,
            W && W > 36 && W < $(window).height() - 200 && (M.top = W + "px"),
            m && m > 0 && m < $(window).width() - 230 && (M.left = m + "px"),
            M.zIndex = "general" === MB.config.topToolBox ? 102 : 101,
            b = [["0", "_____________"], ["1", "......................"], ["2", "----------------"]],
            R = d && !_ ? React.createElement("div", {
                contentEditable: !0,
                dangerouslySetInnerHTML: {
                    __html: B
                },
                className: "editable",
                onMouseDown: this.handleEditableFocus,
                onBlur: this.handleEditableBlur,
                onKeyDown: this.handleEditableKeyDown,
                onKeyUp: this.handleEditableKeyUp
            }) : null,
            j = ["light", "dark", "indigo", "pink", "red", "blue", "lblue", "cyan", "teal", "green", "lgreen", "orange", "lorange", "purple", "dpurple", "grey"],
            React.createElement("div", {
                id: "general",
                className: i,
                style: M,
                onClick: this.handleClick
            },
            React.createElement("div", {
                className: "header tabs"
            },
            React.createElement("b", {
                style: {
                    backgroundColor: n,
                    display: r
                },
                onClick: this.toggleColor
            },
            React.createElement("i", {
                className: "fa fa-adjust"
            })), React.createElement("b", {
                style: {
                    display: L,
                    backgroundColor: k,
                    fontFamily: "times",
                    lineHeight: "29px"
                },
                onClick: this.toggleText
            },
            "T"), React.createElement("div", {
                className: "close",
                onClick: this.handleClose
            },
            React.createElement("i", {
                className: "fa fa-close"
            }))), React.createElement("div", {
                className: "body"
            },
            React.createElement("div", {
                className: "group"
            },
            React.createElement("div", {
                className: "col"
            },
            React.createElement("label", null, I18N.builtin_theme), React.createElement("div", {
                className: "themes"
            },
            j.map(function(e) {
                return React.createElement("button", {
                    key: e,
                    className: "theme " + e,
                    onClick: this.setTheme.bind(this, e)
                })
            },
            this), React.createElement("div", {
                className: "clearfix"
            }))), React.createElement("div", {
                style: {
                    display: MB.shouldDisplay(!_ && !this.props.showText)
                }
            },
            React.createElement(t, {
                groupedItems: u,
                active: this.props.activeColorset
            }))), React.createElement("div", {
                style: {
                    display: MB.shouldDisplay(s)
                }
            },
            React.createElement("div", {
                className: "group"
            },
            React.createElement(e, {
                label: I18N.inspector.bg,
                attr: "bg",
                groupedItems: u
            }), React.createElement(e, {
                label: I18N.inspector.tc,
                attr: "tc",
                groupedItems: u
            }), React.createElement(MB.FullInput, {
                label: I18N.inspector.bs,
                attr: "bs",
                groupedItems: u,
                min: 0
            }), React.createElement(MB.SelectInput, {
                label: I18N.inspector.ls,
                attr: "ls",
                groupedItems: u,
                options: b
            }), React.createElement(e, {
                label: I18N.inspector.bc,
                attr: "bc",
                groupedItems: u
            }), React.createElement(MB.FullInput, {
                label: I18N.inspector.ds,
                attr: "ds",
                groupedItems: u,
                min: 0
            }), React.createElement(e, {
                label: I18N.inspector.sc,
                attr: "sc",
                groupedItems: u
            }), React.createElement(MB.FullInput, {
                label: I18N.inspector.o,
                attr: "o",
                min: 0,
                max: 100,
                groupedItems: u
            }))), React.createElement("div", {
                style: {
                    display: l
                }
            },
            React.createElement("div", {
                className: "group"
            },
            React.createElement("div", {
                className: "col attr td",
                style: {
                    display: a
                }
            },
            React.createElement("div", {
                className: "btn-group style"
            },
            React.createElement("button", {
                className: "btn " + S,
                type: "button",
                style: {
                    fontWeight: "bold"
                },
                onClick: this.handleBold
            },
            "B"), React.createElement("button", {
                className: "btn " + I,
                type: "button",
                style: {
                    fontStyle: "italic"
                },
                onClick: this.handleItalic
            },
            "I"), React.createElement("button", {
                className: "btn " + z,
                type: "button",
                style: {
                    textDecoration: "underline"
                },
                onClick: this.handleDecoration.bind(this, "underline")
            },
            "U"), React.createElement("button", {
                className: "btn " + T,
                type: "button",
                style: {
                    textDecoration: "line-through"
                },
                onClick: this.handleDecoration.bind(this, "line-through")
            },
            "U")), React.createElement("div", {
                className: "clearfix"
            })), R, React.createElement(e, {
                label: I18N.inspector.bg,
                attr: "bg",
                color: w.bg,
                groupedItems: u
            }), React.createElement(e, {
                label: I18N.text_color,
                attr: "tc",
                color: w.color,
                groupedItems: u
            }), React.createElement("div", {
                style: {
                    display: MB.shouldDisplay(!_)
                }
            },
            React.createElement(MB.FullInput, {
                label: I18N.inspector.font_size,
                attr: "fs",
                groupedItems: u,
                min: 0
            }), React.createElement(MB.FullInput, {
                label: I18N.inspector.line_height,
                attr: "lh",
                groupedItems: u,
                min: 0
            }), React.createElement(MB.FullInput, {
                label: I18N.inspector.padding,
                attr: "padding",
                groupedItems: u,
                min: 0
            }), React.createElement(e, {
                label: I18N.inspector.tsc,
                attr: "tsc",
                groupedItems: u
            }), React.createElement(MB.FullInput, {
                label: I18N.inspector.ts,
                attr: "ts",
                groupedItems: u,
                min: 0
            }), React.createElement("div", {
                className: "col attr",
                style: {
                    display: o
                }
            },
            React.createElement("div", {
                className: "btn-group"
            },
            React.createElement("button", {
                className: "btn " + N,
                type: "button",
                onClick: this.handleHA.bind(this, "left")
            },
            React.createElement("i", {
                className: "fa fa-align-left"
            })), React.createElement("button", {
                className: "btn " + C,
                type: "button",
                onClick: this.handleHA.bind(this, "center")
            },
            React.createElement("i", {
                className: "fa fa-align-center"
            })), React.createElement("button", {
                className: "btn " + A,
                type: "button",
                onClick: this.handleHA.bind(this, "right")
            },
            React.createElement("i", {
                className: "fa fa-align-right"
            }))), React.createElement("div", {
                className: "clearfix"
            })), React.createElement("div", {
                className: "col attr",
                style: {
                    display: c
                }
            },
            React.createElement("div", {
                className: "btn-group vertical"
            },
            React.createElement("button", {
                className: "btn " + D,
                type: "button",
                onClick: this.handleVA.bind(this, "top")
            },
            React.createElement("i", {
                className: "fa fa-align-left"
            })), React.createElement("button", {
                className: "btn " + P,
                type: "button",
                onClick: this.handleVA.bind(this, "middle")
            },
            React.createElement("i", {
                className: "fa fa-align-center"
            })), React.createElement("button", {
                className: "btn " + E,
                type: "button",
                onClick: this.handleVA.bind(this, "bottom")
            },
            React.createElement("i", {
                className: "fa fa-align-right"
            }))), React.createElement("div", {
                className: "clearfix"
            })))))))
        }
    })
}.call(this),
function() {
    MB.NumberInput = React.createClass({
        displayName: "NumberInput",
        getInitialState: function() {
            return {
                value: null
            }
        },
        handleChange: function(e) {
            var t, i, n, r, s;
            if (r = parseInt(e.target.value), (!r && 0 !== r || r < this.min() || r > this.max()) && (r = 0), this.setValue(r, !1), this.setState({
                value: r
            }), ["left", "top", "width", "height"].indexOf(this.props.attr) !== -1) {
                for (s = MB.selection.groupedItems.links(), t = 0, n = s.length; t < n; t++) i = s[t],
                i.reload();
                return MB.renderLinks()
            }
        },
        handleKeyUp: function(e) {
            if (13 === e.nativeEvent.which && $(e.target).blur(), 38 === e.nativeEvent.which && this.handleIncrease(), 40 === e.nativeEvent.which) return this.handleDecrease()
        },
        handleBlur: function() {
            return MB.selection.saveAndUpdate(!0),
            this.setState({
                value: null
            })
        },
        handleDecrease: function() {
            var e, t, i, n, r, s;
            if (r = this.currentValue(), n = parseInt(r) - 1, n < this.min() && (n = this.min()), this.setValue(n), ["left", "top", "width", "height"].indexOf(this.props.attr) !== -1) {
                for (s = MB.selection.groupedItems.links(), e = 0, i = s.length; e < i; e++) t = s[e],
                t.reload();
                return MB.renderLinks()
            }
        },
        handleIncrease: function() {
            var e, t, i, n, r, s;
            if (r = this.currentValue(), n = parseInt(r) + 1, n > this.max() && (n = this.max()), this.setValue(n), ["left", "top", "width", "height"].indexOf(this.props.attr) !== -1) {
                for (s = MB.selection.groupedItems.links(), e = 0, i = s.length; e < i; e++) t = s[e],
                t.reload();
                return MB.renderLinks()
            }
        },
        min: function() {
            return null !== this.props.min ? this.props.min: -65535
        },
        max: function() {
            return null !== this.props.max ? this.props.max: -65535
        },
        setValue: function(e, t) {
            var i;
            if (i = this.props.attr, MB.selection.setAttr(i, e, !0, t), !t) return MB.renderSelections(),
            MB.toolboxes.updatePosition()
        },
        defaultValue: function() {
            return this.props.groupedItems.getAttr(this.props.attr)
        },
        currentValue: function() {
            return null === this.state.value ? this.defaultValue() : this.state.value
        },
        render: function() {
            var e;
            return e = Math.round(this.currentValue()),
            React.createElement("div", {
                className: "input-group"
            },
            React.createElement("span", {
                className: "input-group-addon",
                onClick: this.handleDecrease
            },
            React.createElement("i", {
                className: "fa fa-minus"
            })), React.createElement("input", {
                type: "text",
                ref: "input",
                value: e,
                onChange: this.handleChange,
                onBlur: this.handleBlur,
                onKeyUp: this.handleKeyUp
            }), React.createElement("span", {
                className: "input-group-addon",
                onClick: this.handleIncrease
            },
            React.createElement("i", {
                className: "fa fa-plus"
            })))
        }
    }),
    MB.FullInput = React.createClass({
        displayName: "FullInput",
        render: function() {
            var e;
            return e = this.props.groupedItems.attributes().indexOf(this.props.attr) === -1 ? {
                display: "none"
            }: {},
            React.createElement("div", {
                className: "col inline",
                style: e
            },
            React.createElement("label", null, this.props.label), React.createElement(MB.NumberInput, this.props), React.createElement("div", {
                className: "clearfix"
            }))
        }
    }),
    MB.SelectInput = React.createClass({
        displayName: "SelectInput",
        handleChange: function(e) {
            return $(e.target).blur(),
            MB.selection.setAttr(this.props.attr, e.target.value)
        },
        render: function() {
            var e, t, i;
            return t = this.props.groupedItems.attributes().indexOf(this.props.attr) === -1 ? {
                display: "none"
            }: {},
            i = this.props.groupedItems.getAttr(this.props.attr),
            e = this.props.disabled,
            React.createElement("div", {
                className: "col inline",
                style: t
            },
            React.createElement("label", null, this.props.label), React.createElement("div", {
                className: "input-group"
            },
            React.createElement("select", {
                value: i,
                onChange: this.handleChange,
                disabled: e
            },
            this.props.options.map(function(e) {
                return React.createElement("option", {
                    value: e[0],
                    key: e[0]
                },
                e[1])
            }))), React.createElement("div", {
                className: "clearfix"
            }))
        }
    }),
    MB.ModalHeader = React.createClass({
        displayName: "ModalHeader",
        render: function() {
            var e;
            return e = this.props.title,
            React.createElement("div", {
                className: "modal-header"
            },
            React.createElement("a", {
                className: "close",
                href: "#",
                "data-dismiss": "modal"
            },
            "\xd7"), React.createElement("h4", null, e))
        }
    }),
    MB.EditableSpan = React.createClass({
        displayName: "EditableSpan",
        getInitialState: function() {
            return {
                isEditing: !1,
                value: ""
            }
        },
        componentDidMount: function() {
            if (this.props.initEditing) return this.handleEditStart()
        },
        handleEditStart: function() {
            return this.setState({
                isEditing: !0,
                value: this.props.getValue()
            }),
            setTimeout(function() {
                return $("#editable-span-textarea").select().focus()
            },
            0)
        },
        handleEditUpdate: function(e) {
            return this.setState({
                value: e.target.value
            })
        },
        handleEditKey: function(e) {
            if (13 === e.which) return this.handleEditFinish()
        },
        handleEditFinish: function() {
            return this.setState({
                isEditing: !1
            }),
            this.props.onValueChange(this.state.value.trim())
        },
        render: function() {
            var e;
            return e = this.props.isMultiLine,
            this.state.isEditing === !1 ? React.createElement("span", {
                onDoubleClick: this.handleEditStart
            },
            this.props.getValue() || I18N.untitled_editable) : React.createElement("textarea", {
                id: "editable-span-textarea",
                value: this.state.value,
                onBlur: this.handleEditFinish,
                onChange: this.handleEditUpdate,
                onKeyDown: e ? null: this.handleEditKey,
                onDragStart: function(e) {
                    e.preventDefault(),
                    e.stopPropagation()
                }
            })
        }
    })
}.call(this),
function() {
    var e, t, i, n, r, s, o, a, l, c;
    a = function() {
        var e, t, i, n;
        for (i = ["none", "leftmenu", "rightmenu", "slideleft", "slideright", "slidetop", "slidebottom", "slideright2", "slideleft2", "topin", "popin", "rightout", "leftout", "topout", "popout", "leftdrawer", "rightdrawer"], n = [], e = 0, t = i.length; e < t; e++) c = i[e],
        n.push({
            id: c,
            name: I18N.tr[c]
        });
        return n
    } (),
    e = ["tap", "left", "right", "up", "down", "hold", "dtap", "timer"],
    s = ["tap", "left", "right", "up", "down", "hold", "dtap", "shake", "timer"],
    o = [.1, .2, .3, .4, .5, .75, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
    l = React.createClass({
        displayName: "TransitionView",
        updateTransition: function() {
            var e;
            return e = this.props.l,
            e.transition = this.props.t.id,
            e.lsave(),
            MB.renderLinks()
        },
        render: function() {
            var e;
            return c = this.props.t,
            e = c.id === this.props.l.transition ? " current": "",
            React.createElement("div", {
                className: "transition " + c.id + e,
                onClick: this.updateTransition
            },
            React.createElement("div", {
                className: "page1"
            },
            React.createElement("span", null, c.name)), React.createElement("div", {
                className: "page2"
            },
            I18N.target))
        }
    }),
    i = React.createClass({
        displayName: "LinkSettings",
        componentDidMount: function() {
            return $(".link .settings .gesture").tooltip({
                container: "body",
                trigger: "hover focus click"
            })
        },
        handleGesture: function(e) {
            var t, i, n, r, s;
            for (i = this.props.l, r = i.cwidgets(), t = 0, n = r.length; t < n; t++) s = r[t],
            "pg" === s.name && (s.icon = e, s.lsave(), $("#widget" + s.cid + " i")[0].className = "fa fa-" + e);
            return i.gesture = e,
            i.lsave(),
            this.forceUpdate()
        },
        handleUpdate: function(e, t) {
            return this.props.l[e] = t,
            this.props.l.lsave(),
            this.forceUpdate()
        },
        handleClose: function() {
            return this.props.handleClose()
        },
        handleDuration: function(e) {
            return this.handleUpdate("ani_duration", e.target.value)
        },
        handleDelay: function(e) {
            return this.handleUpdate("ani_delay", e.target.value)
        },
        handleTimer: function(e) {
            return this.handleUpdate("timer", e.target.value)
        },
        handleReset: function(e) {
            return this.handleUpdate("reset", e.target.checked)
        },
        handleMenuOffset: function(e) {
            var t, i;
            return t = this.props.l,
            i = parseInt(e.target.value),
            t.menu_offset = Math.max(1, Math.min(i, 99)),
            t.lsave()
        },
        render: function() {
            var t, i, n, r, c, d, u, h, p, f, g, m;
            return u = this.props.l,
            t = this.props.centerPointX,
            i = this.props.centerPointY,
            n = u.cwidgets(),
            d = "pg" === u.cwidgets()[0].name,
            r = d ? s: e,
            c = 1 === n.length && n[0].gestureable ? null: "none",
            g = {
                left: t - 290,
                top: 100 - u.top - MB.canvasTop()
            },
            m = !!u.targetstate_cid,
            h = "leftmenu" === (p = u.transition) || "rightmenu" === p || "leftdrawer" === p || "rightdrawer" === p,
            f = !h && !m,
            React.createElement("div", {
                className: "settings",
                style: g
            },
            React.createElement("div", {
                className: "close",
                onClick: this.handleClose
            },
            "x"), React.createElement("div", {
                className: "gestures"
            },
            r.map(function(e) {
                return React.createElement("div", {
                    key: e,
                    className: "gesture " + e + " " + (e == u.gesture ? "current": ""),
                    onClick: this.handleGesture.bind(this, e),
                    title: I18N.g[e]
                })
            },
            this), React.createElement("div", {
                className: "clearfix"
            })), React.createElement("div", {
                className: "group"
            },
            React.createElement("label", null, I18N.timer), React.createElement("select", {
                value: u.timer,
                onChange: this.handleTimer
            },
            React.createElement("option", {
                value: "0"
            },
            I18N.no_timer), o.map(function(e) {
                return React.createElement("option", {
                    value: e,
                    key: e
                },
                e, "s")
            }))), React.createElement("div", {
                className: "group transitions",
                style: {
                    display: MB.shouldDisplay(!m)
                }
            },
            a.map(function(e) {
                return e.id.indexOf("drawer") == -1 && e.id.indexOf("menu") == -1 || !MB.currentProject.template ? React.createElement(l, {
                    t: e,
                    key: e.id,
                    l: u
                }) : null
            }), React.createElement("div", {
                className: "clearfix"
            })), React.createElement("div", {
                className: "group"
            },
            React.createElement("label", null, I18N.ani_duration), React.createElement("select", {
                value: u.ani_duration,
                onChange: this.handleDuration
            },
            o.map(function(e) {
                return React.createElement("option", {
                    value: e + "s",
                    key: e
                },
                e, "s")
            }))), React.createElement("div", {
                className: "group",
                style: {
                    display: MB.shouldDisplay(m)
                }
            },
            React.createElement("label", null, I18N.ani_delay), React.createElement("select", {
                value: u.ani_delay,
                onChange: this.handleDelay
            },
            React.createElement("option", {
                value: ""
            },
            "None"), o.map(function(e) {
                return React.createElement("option", {
                    value: e + "s",
                    key: e
                },
                e, "s")
            }))), React.createElement("div", {
                className: "group",
                style: {
                    display: MB.shouldDisplay(h)
                }
            },
            React.createElement("label", null, I18N.menu_offset), React.createElement("input", {
                defaultValue: u.menu_offset,
                onBlur: this.handleMenuOffset
            })), React.createElement("div", {
                style: {
                    display: MB.shouldDisplay(f)
                }
            },
            React.createElement("label", {
                className: "checkbox-inline"
            },
            React.createElement("input", {
                type: "checkbox",
                defaultChecked: u.reset,
                onChange: this.handleReset
            }), I18N.reset_target_screen)))
        }
    }),
    n = React.createClass({
        displayName: "LinkView",
        getInitialState: function() {
            return {
                settings: this.props.l.timestamp && (new Date).valueOf() - this.props.l.timestamp < 1e3
            }
        },
        selectByHandler: function() {
            var e, t, i;
            return e = this.props.l,
            e.panel_cid && !MB.activePanel() ? (t = Panel.find(e.panel_cid), PanelManager.activate(t, t.mainState().cid)) : !e.panel_cid && MB.activePanel() && (t = Panel.find($(".panel.selected").data("cid")), PanelManager.deactivate(t, t.mainState().cid)),
            i = MB.selection.groupedItems.groupLinkCid(),
            e.cid === i ? this.setState({
                settings: !this.state.settings
            }) : (this.state.settings = !0, setTimeout(function() {
                return MB.selection.clear(),
                MB.selection.select(e.cwidgets())
            },
            0)),
            this.state.settings ? $(".toolbox, .x-toolbox").css("display", "") : $(".toolbox, .x-toolbox").hide()
        },
        handleRemove: function() {
            var e, t, i, n, r, s;
            for (i = this.props.l, i.widget_cids || (i.widget_cids = function() {
                var e, t, n, s;
                for (n = i.cwidgets(), s = [], e = 0, t = n.length; e < t; e++) r = n[e],
                s.push(r.cid);
                return s
            } ().join(",")), MB.trigger("undoStack:add", [[i.dup()], null]), e = new GroupedItems, e.setItems(i.cwidgets()), e.removeShadow(), s = i.cwidgets(), t = 0, n = s.length; t < n; t++) r = s[t],
            r.gid = null,
            r.lsave();
            return i.ldestroy(),
            MB.selection.select(s)
        },
        render: function() {
            var e, t, n, r, s, o, a, l, c, d, u, h, p, f, g, m, v, b, y, _, w, M, x, B, k, S;
            if (d = this.props.l, r = d.cwidgets(), !r.length) return null;
            for (l = new GroupedItems(d.panel_cid), c = 0, u = r.length; c < u; c++) a = r[c],
            l._iv(a).length && l.push(a);
            if (0 !== d.left && (d.left || (d.left = l.realR() - MB.canvasLeft())), 0 !== d.top && (d.top || (d.top = l.realT() + l.realH() / 2 - MB.canvasTop())), d.lsave(!1), (d.top + MB.canvasTop() < 0 || d.top + MB.canvasTop() > $(window).height()) && !d.state_cid) return null;
            if (d.left + MB.canvasLeft() < 180 || d.left + MB.canvasLeft() > $(window).width() - 238) return null;
            for (m = $("#panel" + d.panel_cid), m.length ? (f = d.left + m.position().left + MB.canvasLeft(), g = d.top + m.position().top + MB.canvasTop()) : (f = d.left + MB.canvasLeft(), g = d.top + MB.canvasTop(), d.lsave(!1)), MB.activePanel() && (f -= $(".panel.selected").position().left, g -= $(".panel.selected").position().top), S = $("#sli" + d.target_cid); ! S.is(":visible") && S.length;) S = S.closest(".children").prev(".item");
            return S.length || (S = $("#ssli" + d.targetstate_cid)),
            S.length ? (l.renderShadow(), x = d.target_cid && "prev" !== d.target_cid ? $("#screen_list").offset().left: S.offset().left, k = S.offset().top + 24, S.closest(".children").length && (k -= 7), t = (x - f) / 2, n = (k - g) / 2, p = Math.sqrt(Math.pow(x - f, 2) + Math.pow(k - g, 2)), w = t - p / 2, M = n - 1, e = 180 * Math.atan2(0 - n, 0 - t) / Math.PI, h = {
                transform: "rotate(" + e + "deg)",
                WebkitTransform: "rotate(" + e + "deg)",
                left: w,
                top: M,
                width: p
            },
            o = {
                left: t,
                top: n
            },
            B = {
                left: x - f - 5,
                top: k - g - 5
            },
            s = parseInt(d.timer) ? "timer": d.gesture, b = MB.selection.groupedItems.groupLinkCid(), v = MB.activePanel() ? d.cid === b && d.panel_cid === $(".panel.selected").data("cid") : d.cid === b, _ = this.state.settings && v, y = _ ? React.createElement(i, {
                l: d,
                centerPointX: t,
                centerPointY: n,
                handleClose: this.selectByHandler
            }) : "", _ && $(".toolbox, .x-toolbox").hide(), React.createElement("div", {
                id: "link" + d.cid + d.panel_cid,
                className: "link " + (v ? "selected": ""),
                style: {
                    left: f,
                    top: g
                }
            },
            React.createElement("div", {
                className: "line",
                style: h
            },
            React.createElement("div", {
                className: "cut",
                onClick: this.handleRemove
            },
            React.createElement("i", {
                className: "fa fa-cut"
            }))), React.createElement("div", {
                className: "target",
                style: B
            }), React.createElement("div", {
                className: "handler",
                style: o,
                onClick: this.selectByHandler
            },
            React.createElement("div", {
                className: "gesture " + s
            })), y)) : (MB.ga("send", "event", "bug", "\u627e\u4e0d\u5230\u94fe\u63a5\u76ee\u6807\u9875\uff1a" + d.cid), d.ldestroy(!1), null)
        }
    }),
    t = React.createClass({
        displayName: "LinkDesign",
        getInitialState: function() {
            return {
                style: {
                    left: 0,
                    top: 0,
                    transform: "rotate(0deg)",
                    WebkitTransform: "rotate(0deg)",
                    width: 46
                },
                handlerStyle: {
                    top: 0,
                    left: 46
                }
            }
        },
        componentDidMount: function() {
            return $(".link.design .handler").draggable({
                refreshPositions: !0,
                start: function(e) {
                    return function() {
                        var t, i, n, r, s, o, a, l;
                        for ($(".toolbox, .x-toolbox").hide(), e._targets = [], o = $(".linkable"), a = [], i = 0, n = o.length; i < n; i++) r = o[i],
                        t = $(r),
                        t.hasClass("active") && !MB.activePanel() || MB.activePanel() && t.hasClass("state") || (l = t.hasClass("state") && !$("#screenstate_list").hasClass("active") || t.hasClass("sortable") && !$("#screen_list").hasClass("active") ? 30 : t.outerWidth(), s = {
                            top: t.offset().top,
                            left: t.offset().left,
                            width: l,
                            height: t.outerHeight()
                        },
                        a.push(e._targets.push({
                            linkable: t,
                            rect: s
                        })));
                        return a
                    }
                } (this),
                drag: function(e) {
                    return function(t, i) {
                        var n, r, s, o, a, l, c, d, u, h, p, f, g, m, v;
                        for (o = i.position.left, a = i.position.top, r = o / 2, s = a / 2, g = Math.sqrt(Math.pow(o, 2) + Math.pow(a, 2)), d = r - g / 2, f = s - 1, n = 180 * Math.atan2(0 - s, 0 - r) / Math.PI, e.setState({
                            style: {
                                left: d,
                                top: f,
                                width: g,
                                transform: "rotate(" + n + "deg)",
                                WebkitTransform: "rotate(" + n + "deg)"
                            },
                            handlerStyle: {
                                left: i.position.left,
                                top: i.position.top
                            }
                        }), m = o + $(".link.design").position().left, v = a + $(".link.design").position().top, h = e._targets, c = 0, u = h.length; c < u; c++) p = h[c],
                        MB.pointInRect(m, v, p.rect) && (p.linkable.hasClass("linking") || ($(".linking").removeClass("linking"), p.linkable.addClass("linking")), l = !0);
                        if (!l) return $(".linking").removeClass("linking")
                    }
                } (this),
                stop: function(e) {
                    return function() {
                        var t, i, n, r, s, o, a, l, c, d, u, h, p, f, g, m;
                        if ($(".toolbox, .x-toolbox").css("display", ""), e.setState(e.getInitialState()), p = MB.currentScreen, $(".linking").length) {
                            if ($(".linking").hasClass("state") ? (m = $(".linking").data("cid"), f = p.state_cid) : g = $(".linking").data("cid"), $(".linking").removeClass("linking"), m === (f || "default")) return;
                            if (m && $("#ssliglobal").hasClass("active")) return alert(I18N.global_state_link_error);
                            if (n = MB.selection.groupedItems.items(), u = new Link({
                                screen_cid: p.cid,
                                target_cid: g,
                                transition: "prev" === g ? "slideright": "none",
                                gesture: "tap",
                                cid: "l" + Math.uuid(10, 16) + (new Date).valueOf(),
                                timer: 0,
                                timestamp: (new Date).valueOf(),
                                reset: !0,
                                targetstate_cid: m,
                                sourcestate_cid: f
                            }), MB.activePanel()) for (u.state_cid = n[0].screen_cid, u.widget_cids = function() {
                                var e, i, r;
                                for (r = [], e = 0, i = n.length; e < i; e++) t = n[e],
                                r.push(t.cid);
                                return r
                            } ().sort().join(","), h = Link.findAllByAttribute("state_cid", u.state_cid), r = 0, o = h.length; r < o; r++) for (s = h[r], c = 0, a = n.length; c < a; c++) t = n[c],
                            s.widget_cids.indexOf(t.cid) !== -1 && (i = new GroupedItems, i.setItems(s.cwidgets()), i.removeShadow(), s.ldestroy());
                            else for (d = 0, l = n.length; d < l; d++) t = n[d],
                            s = Link.find(t.gid),
                            s && ("default" === t.screenstate_cid || t.getState(t.screenstate_cid).exists()) && (i = new GroupedItems, i.setItems(s.cwidgets()), i.removeShadow(), s.ldestroy()),
                            t.gid = u.cid,
                            t.lsave();
                            return u.lsave(),
                            MB.selection.select(u.cwidgets()),
                            MB.trigger("undoStack:add", [null, [u.dup()]])
                        }
                    }
                } (this)
            })
        },
        render: function() {
            var e, t, i, n, r, s, o, a, l, c;
            return l = Link.find(MB.selection.groupedItems.groupLinkCid()),
            t = Link.count() < 7 && 1 === Project.count() ? "block": "none",
            a = MB.currentScreen,
            i = MB.selection.groupedItems,
            i.items().length && (!l || l.targetstate_cid && l.sourcestate_cid !== a.state_cid) ? (o = i.realT() - MB.canvasTop(), s = i.realR() - MB.canvasLeft(), r = i.realH(), n = MB.canvasLeft() + s, c = MB.canvasTop() + o + r / 2 - 1) : (n = -9999, c = -9999),
            e = {
                left: this.state.handlerLeft,
                top: this.state.handlerTop
            },
            React.createElement("div", {
                className: "link design",
                style: {
                    left: n,
                    top: c
                }
            },
            React.createElement("div", {
                className: "helper",
                style: {
                    display: t
                }
            },
            React.createElement("span", null, I18N.drag_to_link_screen)), React.createElement("div", {
                className: "line",
                style: this.state.style
            }), React.createElement("div", {
                className: "handler",
                style: this.state.handlerStyle
            },
            React.createElement("i", {
                className: "fa fa-link"
            })))
        }
    }),
    r = React.createClass({
        displayName: "Links",
        render: function() {
            var e, i, r, s, o, a, l, d, u, h, p, f, g, m, v;
            for (l = [], v = this.props.s, m = this.props.reload, p = v.clinks(), i = 0, s = p.length; i < s; i++) r = p[i],
            r.targetstate_cid && r.sourcestate_cid !== v.state_cid || MB.activePanel() && !r.state_cid || (m && r.reload(), ("prev" !== r.target_cid || $(".prev").is(":visible")) && l.push(r));
            for (f = v.cpanels(), d = 0, o = f.length; d < o; d++) for (h = f[d], e = $("#panel" + h.cid).find(".state.active").data("cid"), g = Link.findAllByAttribute("state_cid", e), u = 0, a = g.length; u < a; u++) r = g[u],
            c = Screen.find(r.target_cid),
            ("prev" === r.target_cid || c && c.project_cid === MB.project().cid) && (m && r.reload(), r.panel_cid = h.cid, ("prev" !== r.target_cid || $(".prev").is(":visible")) && l.push(r));
            return React.createElement("div", null, l.map(function(e) {
                return React.createElement(n, {
                    l: e,
                    key: e.cid + e.panel_cid
                })
            }), React.createElement(t, null))
        }
    }),
    MB.renderLinks = function(e) {
        var t;
        if (null == e && (e = !1), t = MB.currentScreen, t && $("#links .link_list")[0]) return $(".widget .shadow").remove(),
        $(".panel  .shadow").remove(),
        ReactDOM.render(React.createElement(r, {
            s: t,
            reload: e
        }), $("#links .link_list")[0])
    }
}.call(this),
function() {
    var e, t;
    t = React.createClass({
        displayName: "HalfInput",
        render: function() {
            var e;
            return e = this.props.groupedItems.attributes().indexOf(this.props.attr) === -1 ? {
                display: "none"
            }: {},
            React.createElement("div", {
                className: "half attr",
                style: e
            },
            React.createElement(MB.NumberInput, this.props), React.createElement("label", {
                className: "center"
            },
            this.props.label))
        }
    }),
    e = React.createClass({
        displayName: "AnimationPanel",
        canSetAttr: function(e) {
            return this.props.groupedItems.attributes().indexOf(e) !== -1
        },
        handleAniDelay: function(e) {
            return MB.selection.setAttr("ani_delay", e.target.value)
        },
        handleAniCount: function(e) {
            return MB.selection.setAttr("ani_count", e.target.value)
        },
        handleAniDuration: function(e) {
            return MB.selection.setAttr("ani_duration", e.target.value)
        },
        animateSandbox: function(e) {
            var t;
            return $("#ruler .sandbox").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",
            function() {
                return setTimeout(function() {
                    return $("#ruler .sandbox")[0].className = "col sandbox"
                },
                500)
            }),
            t = this.props.groupedItems.getAttr("ani_duration"),
            "0" !== t ? ($("#ruler .sandbox").css("animation-duration", t), $("#ruler .sandbox").css("-webkit-animation-duration", t)) : ($("#ruler .sandbox").css("animation-duration", ""), $("#ruler .sandbox").css("-webkit-animation-duration", "")),
            $("#ruler .sandbox")[0].className = "col sandbox animated " + e.target.value,
            MB.selection.setAttr("ani_name", e.target.value)
        },
        render: function() {
            var e, t, i, n, r, s;
            return s = this.props.groupedItems,
            n = this.canSetAttr("ani_name") && s.getAttr("ani_name"),
            t = this.canSetAttr("ani_name") && s.getAttr("ani_delay"),
            e = this.canSetAttr("ani_name") && s.getAttr("ani_count"),
            i = this.canSetAttr("ani_duration") && s.getAttr("ani_duration"),
            r = {
                attention_seekers: ["bounce", "fadeIn", "fadeOut", "flash", "pulse", "rubberBand", "shake", "swing", "tada", "wobble", "jello"],
                bouncing_entrances: ["bounceIn", "bounceInDown", "bounceInLeft", "bounceInRight", "bounceInUp"],
                flippers: ["flipInX", "flipInY"],
                rotating_entrances: ["spinning", "spinning-reverse", "rotateIn", "rotateInDownLeft", "rotateInDownRight", "rotateInUpLeft", "rotateInUpRight"],
                sliding_entrances: ["slideInDown", "slideInLeft", "slideInRight", "slideInUp"],
                zoom_entrances: ["zoomIn", "zoomInDown", "zoomInLeft", "zoomInRight", "zoomInUp"],
                specials: ["rollIn", "lightSpeedIn"]
            },
            this.canSetAttr("ani_name") ? React.createElement("div", {
                className: "group animate"
            },
            React.createElement("div", {
                className: "col sandbox"
            },
            I18N.animate), React.createElement("div", {
                className: "col inline"
            },
            React.createElement("label", null, I18N.ani_name), React.createElement("div", {
                className: "input-group"
            },
            React.createElement("select", {
                onChange: this.animateSandbox,
                value: n
            },
            React.createElement("option", {
                value: "none"
            },
            I18N.none), Object.keys(r).map(function(e) {
                return React.createElement("optgroup", {
                    label: I18N.ani[e],
                    key: e
                },
                r[e].map(function(e) {
                    return React.createElement("option", {
                        value: e,
                        key: e
                    },
                    I18N.ani[e])
                }))
            }))), React.createElement("div", {
                className: "clearfix"
            })), React.createElement("div", {
                className: "col inline"
            },
            React.createElement("label", null, I18N.ani_delay), React.createElement("div", {
                className: "input-group"
            },
            React.createElement("select", {
                onChange: this.handleAniDelay,
                value: t
            },
            React.createElement("option", {
                value: "0"
            },
            I18N.none), React.createElement("option", {
                value: ".1s"
            },
            "100ms"), React.createElement("option", {
                value: ".2s"
            },
            "200ms"), React.createElement("option", {
                value: ".3s"
            },
            "300ms"), React.createElement("option", {
                value: ".5s"
            },
            "500ms"), React.createElement("option", {
                value: "1s"
            },
            "1s"), React.createElement("option", {
                value: "2s"
            },
            "2s"), React.createElement("option", {
                value: "3s"
            },
            "3s"), React.createElement("option", {
                value: "4s"
            },
            "4s"), React.createElement("option", {
                value: "5s"
            },
            "5s"), React.createElement("option", {
                value: "6s"
            },
            "6s"), React.createElement("option", {
                value: "7s"
            },
            "7s"), React.createElement("option", {
                value: "8s"
            },
            "8s"), React.createElement("option", {
                value: "9s"
            },
            "9s"), React.createElement("option", {
                value: "10s"
            },
            "10s"))), React.createElement("div", {
                className: "clearfix"
            })), React.createElement("div", {
                className: "col inline"
            },
            React.createElement("label", null, I18N.ani_duration), React.createElement("div", {
                className: "input-group"
            },
            React.createElement("select", {
                onChange: this.handleAniDuration,
                value: i
            },
            React.createElement("option", {
                value: "0"
            },
            I18N["default"]), React.createElement("option", {
                value: ".25s"
            },
            "250ms"), React.createElement("option", {
                value: ".5s"
            },
            "500ms"), React.createElement("option", {
                value: ".75s"
            },
            "750ms"), React.createElement("option", {
                value: "1s"
            },
            "1s"), React.createElement("option", {
                value: "2s"
            },
            "2s"), React.createElement("option", {
                value: "3s"
            },
            "3s"), React.createElement("option", {
                value: "4s"
            },
            "4s"), React.createElement("option", {
                value: "5s"
            },
            "5s"))), React.createElement("div", {
                className: "clearfix"
            })), React.createElement("div", {
                className: "col inline"
            },
            React.createElement("label", null, I18N.ani_count), React.createElement("div", {
                className: "input-group"
            },
            React.createElement("select", {
                onChange: this.handleAniCount,
                value: e
            },
            React.createElement("option", {
                value: "1"
            },
            "1"), React.createElement("option", {
                value: "infinite"
            },
            I18N.infinite), React.createElement("option", {
                value: "2"
            },
            "2"), React.createElement("option", {
                value: "3"
            },
            "3"), React.createElement("option", {
                value: "4"
            },
            "4"), React.createElement("option", {
                value: "5"
            },
            "5"), React.createElement("option", {
                value: "6"
            },
            "6"), React.createElement("option", {
                value: "7"
            },
            "7"), React.createElement("option", {
                value: "8"
            },
            "8"), React.createElement("option", {
                value: "9"
            },
            "9"), React.createElement("option", {
                value: "10"
            },
            "10"))), React.createElement("div", {
                className: "clearfix"
            }))) : React.createElement("div", null)
        }
    }),
    MB.Ruler = React.createClass({
        displayName: "Ruler",
        handleClose: function(e) {
            return e.stopPropagation(),
            MB.config.showRuler = !MB.config.showRuler,
            this.forceUpdate()
        },
        handleClick: function() {
            return MB.toolboxes.handleClick("ruler")
        },
        squareize: function() {
            return MB.selection.squareize()
        },
        circularize: function() {
            return MB.selection.circularize()
        },
        handleMainState: function(e) {
            var t, i;
            return MB.selection.setAttr("main_state_cid", e.target.value),
            i = this.props.groupedItems.first(),
            $("#panel" + i.cid + " .state.active").removeClass("active"),
            t = document.getElementById("state" + i.cid + e.target.value),
            t.className += " active"
        },
        handleUpdate: function(e) {
            var t, i, n;
            if ($(e.target).blur(), t = e.target.attributes.name.value, i = e.target.attributes.type.value, n = function() {
                switch (i) {
                case "checkbox":
                    return e.target.checked;
                default:
                    return e.target.value
                }
            } (), MB.selection.setAttr(t, n), "v" === t) return MB.renderRightNav()
        },
        canSetAttr: function(e) {
            return this.props.groupedItems.canSetAttr(e)
        },
        render: function() {
            var i, n, r, s, o, a, l, c, d, u, h, p, f, g, m, v, b, y, _, w, M, x, B, k, S;
            return u = this.props.groupedItems,
            _ = MB.selection.editing && MB.selection.editing.richedit,
            i = MB.config.showRuler && u.canSetPosition() && !MB.activePanel() && !_,
            o = i ? "toolbox active": "toolbox",
            x = {},
            k = MB.preference().rt,
            f = MB.preference().rl,
            k && k > 36 && k < $(window).height() - 200 && (x.top = k + "px"),
            f && f > 0 && f < $(window).width() - 230 && (x.left = f + "px"),
            x.zIndex = "ruler" === MB.config.topToolBox ? 102 : 101,
            s = u.getAttr("checked"),
            m = u.getAttr("numeric"),
            c = u.getAttr("fixed"),
            d = u.getAttr("fixed_type") || 1,
            p = u.getAttr("input_type"),
            S = u.getAttr("v"),
            y = u.getAttr("tt_placement"),
            a = u.first() && "default" !== u.first().cs().state_cid && !$("#ssliglobal").hasClass("active"),
            l = this.canSetAttr("br") && !this.canSetAttr("tt_placement"),
            ["top", "bottom"].indexOf(y) !== -1 ? (v = u.getAttr("width") - u.getAttr("tt_arrow_size"), n = Math.floor(u.getAttr("width") / 2)) : (v = u.getAttr("height") - 2 * u.getAttr("tt_arrow_size"), n = Math.floor(u.getAttr("height") / 2)),
            1 === u.items().length && "panel" === u.first().name ? (r = !0, b = u.first(), B = b.ct(), g = b.mainState().cid, M = function() {
                var e, t, i, n;
                for (i = B.cscreens(), n = [], e = 0, t = i.length; e < t; e++) w = i[e],
                n.push({
                    name: w.name,
                    cid: w.cid
                });
                return n
            } ()) : (r = !1, M = [], g = ""),
            h = [["text", I18N.input_types.text], ["password", I18N.input_types.password], ["tel", I18N.input_types.number], ["email", "Email"], ["date", I18N.input_types.date], ["time", I18N.input_types.time], ["datetime-local", I18N.input_types.datetime]],
            React.createElement("div", {
                id: "ruler",
                className: o,
                style: x,
                onClick: this.handleClick
            },
            React.createElement("div", {
                className: "header tabs"
            },
            React.createElement("b", {
                style: {
                    backgroundColor: "#f7f7f7"
                }
            },
            React.createElement("i", {
                className: "fa fa-wrench"
            })), React.createElement("div", {
                className: "close",
                onClick: this.handleClose
            },
            React.createElement("i", {
                className: "fa fa-close"
            }))), React.createElement("div", {
                className: "body"
            },
            React.createElement("div", {
                className: "group"
            },
            React.createElement(t, {
                label: "X",
                attr: "left",
                groupedItems: u
            }), React.createElement(t, {
                label: "Y",
                attr: "top",
                groupedItems: u
            }), React.createElement(t, {
                label: I18N.inspector.width,
                attr: "width",
                groupedItems: u
            }), React.createElement(t, {
                label: I18N.inspector.height,
                attr: "height",
                groupedItems: u
            }), React.createElement("div", {
                className: "clearfix"
            }), React.createElement(MB.FullInput, {
                label: I18N.inspector.ro,
                attr: "ro",
                min: 0,
                max: 360,
                groupedItems: u
            }), React.createElement(MB.FullInput, {
                label: I18N.inspector.radius,
                attr: "br",
                min: 0,
                max: 2048,
                groupedItems: u
            }), React.createElement(MB.SelectInput, {
                label: I18N.inspector.input_type,
                attr: "input_type",
                groupedItems: u,
                options: h,
                disabled: a
            }), React.createElement("div", {
                className: "col",
                style: {
                    display: MB.shouldDisplay(l)
                }
            },
            React.createElement("a", {
                className: "btn",
                onClick: this.circularize
            },
            I18N.inspector.circularize), React.createElement("a", {
                className: "btn",
                onClick: this.squareize
            },
            I18N.inspector.squareize)), React.createElement("div", {
                className: "col",
                style: {
                    display: MB.shouldDisplay(this.canSetAttr("fixed"))
                }
            },
            React.createElement("label", {
                className: "checkbox-inline"
            },
            React.createElement("input", {
                checked: c,
                type: "checkbox",
                name: "fixed",
                onChange: this.handleUpdate
            }), I18N.inspector.fixed)), React.createElement("div", {
                className: "col",
                style: {
                    display: MB.shouldDisplay(this.canSetAttr("fixed"))
                }
            },
            c && React.createElement("select", {
                name: "fixed_type",
                type: "select",
                value: d,
                onChange: this.handleUpdate
            },
            React.createElement("option", {
                value: Widget.FIX_TYPE.auto
            },
            I18N.inspector.fixed_auto), React.createElement("option", {
                value: Widget.FIX_TYPE.top
            },
            I18N.inspector.fixed_top), React.createElement("option", {
                value: Widget.FIX_TYPE.bottom
            },
            I18N.inspector.fixed_bottom))), React.createElement("div", {
                className: "col"
            },
            React.createElement("label", {
                className: "checkbox-inline"
            },
            React.createElement("input", {
                checked: S,
                type: "checkbox",
                name: "v",
                onChange: this.handleUpdate
            }), I18N.inspector.visible)), React.createElement("div", {
                className: "col inline",
                style: {
                    display: MB.shouldDisplay(r)
                }
            },
            React.createElement("label", null, I18N.main_state), React.createElement("div", {
                className: "input-group"
            },
            React.createElement("select", {
                value: g,
                name: "main_state_cid",
                onChange: this.handleMainState
            },
            M.map(function(e) {
                return React.createElement("option", {
                    value: e.cid,
                    key: e.cid
                },
                e.name)
            }))), React.createElement("div", {
                className: "clearfix"
            })), React.createElement("div", {
                className: "col",
                style: {
                    display: MB.shouldDisplay(this.canSetAttr("checked"))
                }
            },
            React.createElement("label", {
                className: "checkbox-inline"
            },
            React.createElement("input", {
                checked: s,
                type: "checkbox",
                name: "checked",
                onChange: this.handleUpdate
            }), I18N.inspector.checked)), React.createElement("div", {
                className: "col",
                style: {
                    display: MB.shouldDisplay(this.canSetAttr("numeric"))
                }
            },
            React.createElement("label", {
                className: "checkbox-inline"
            },
            React.createElement("input", {
                checked: m,
                type: "checkbox",
                name: "numeric",
                onChange: this.handleUpdate
            }), I18N.inspector.numeric)), React.createElement("div", {
                className: "group",
                style: {
                    display: MB.shouldDisplay(this.canSetAttr("tt_placement"))
                }
            },
            React.createElement("div", {
                className: "col inline"
            },
            React.createElement("label", null, I18N.inspector.placement), React.createElement("div", {
                className: "input-group"
            },
            React.createElement("select", {
                value: y,
                name: "tt_placement",
                type: "select",
                onChange: this.handleUpdate
            },
            React.createElement("option", {
                value: "left"
            },
            I18N.left), React.createElement("option", {
                value: "top"
            },
            I18N.top), React.createElement("option", {
                value: "right"
            },
            I18N.right), React.createElement("option", {
                value: "bottom"
            },
            I18N.down))), React.createElement("div", {
                className: "clearfix"
            })), React.createElement(MB.FullInput, {
                label: I18N.inspector.offset,
                attr: "tt_offset",
                min: 0,
                max: v,
                groupedItems: u
            }), React.createElement(MB.FullInput, {
                label: I18N.inspector.arrow_size,
                attr: "tt_arrow_size",
                min: 0,
                max: n,
                groupedItems: u
            })), React.createElement(e, {
                groupedItems: u
            }))))
        }
    })
}.call(this),
function() {
    MB.Screen = function(e) {
        return "<div id='screen' class=\"screen " + e.orient() + " " + e.device() + " x" + e.scale() + "\" data-selectable='true' data-cid=\"" + e.cid + '">\n  <div id=\'canvas\' class="canvas" data-selectable=\'true\'></div>\n  <div class="actions">\n    <div class="resizer_y resizer">\n      <span class="enlarge">\n        <i class="fa fa-chevron-down"></i>\n      </span>\n      <span class="tip">\n        ' + I18N.drag_to_resize + '\n      </span>\n      <span class="reduce">\n        <i class="fa fa-chevron-up"></i>\n      </span>\n    </div>\n    <a class="sbgcolor" title="' + I18N.screen_bgcolor + '" data-placement="bottom"></a>\n    <a class="sbgimage" title="' + I18N.screen_bgimage + '" data-placement="bottom">\n      <i class="fa fa-image"></i>\n    </a>\n  </div>\n  <div class="resizer_x resizer">\n    <i class="fa fa-chevron-right"></i>\n  </div>\n  <div class="slider" data-selectable="true">\n    <a class="tip" href=\'#slider_modal\' data-toggle=\'modal\'>\n      <i class="fa fa-question-circle"></i>\n    </a>\n    <div class="hh">\n      <div class="triangle"></div>\n      <div class="counter"></div>\n    </div>\n    <div class="fh">\n      <div class="triangle"></div>\n      <div class="counter"></div>\n    </div>\n  </div>\n</div>'
    },
    MB.renderScreen = function() {
        var e;
        return e = "<div class=\"screen_container\" data-selectable='true'>\n  " + MB.Screen(MB.currentScreen) + "\n</div>",
        $("#screens").html(e)
    }
}.call(this),
function() {
    var e, t, i, n, r, s, o, a, l, c;
    t = {},
    t.Inset = React.createClass({
        displayName: "Inset",
        render: function() {
            var t, i, n, r;
            return r = this.props.i,
            n = r.clipInsetPoints(),
            t = Math.abs(100 - n[3] - n[1]) / 2 + n[3],
            i = Math.abs(100 - n[0] - n[2]) / 2 + n[0],
            React.createElement("div", null, React.createElement(e, {
                pt: "linset",
                axis: "x",
                item: r,
                top: i + "%",
                left: n[3] + "%"
            }), React.createElement(e, {
                pt: "rinset",
                axis: "x",
                item: r,
                top: i + "%",
                left: 100 - n[1] + "%"
            }), React.createElement(e, {
                pt: "tinset",
                axis: "y",
                item: r,
                top: n[0] + "%",
                left: t + "%"
            }), React.createElement(e, {
                pt: "binset",
                axis: "y",
                item: r,
                top: 100 - n[2] + "%",
                left: t + "%"
            }), React.createElement(e, {
                pt: "cinset",
                item: r,
                top: i + "%",
                left: t + "%"
            }))
        }
    }),
    t.Ellipse = React.createClass({
        displayName: "Ellipse",
        render: function() {
            var t, i, n, r, s;
            return i = this.props.i,
            t = i.clipCenter(),
            n = {
                x: i.clipXRadius(),
                y: i.clipYRadius()
            },
            r = t.x + n.x,
            s = t.y + n.y,
            t.x > 50 && (r -= 2 * n.x),
            t.y > 50 && (s -= 2 * n.y),
            React.createElement("div", null, React.createElement(e, {
                pt: "xradius",
                axis: "x",
                item: i,
                top: t.y + "%",
                left: r + "%"
            }), React.createElement(e, {
                pt: "yradius",
                axis: "y",
                item: i,
                top: s + "%",
                left: t.x + "%"
            }), React.createElement(e, {
                pt: "ecenter",
                item: i,
                top: t.y + "%",
                left: t.x + "%"
            }))
        }
    }),
    e = React.createClass({
        displayName: "ClipPoint",
        position2Percent: function(e, t) {
            var i, n;
            return n = Math.round(100 * e.top / t.h()),
            i = Math.round(100 * e.left / t.w()),
            n < 0 && (n = 0),
            n > 100 && (n = 100),
            n < 0 && (i = 0),
            i > 100 && (i = 100),
            {
                top: n,
                left: i
            }
        },
        componentDidMount: function() {
            return $(this.refs.point).draggable({
                refreshPositions: !0,
                axis: this.props.axis,
                drag: function(e) {
                    return function(t, i) {
                        var n;
                        return n = e.position2Percent(i.position, e.props.item),
                        e.props.item.setClipPoint($(t.target).data("pt"), n, i),
                        WidgetManager.updateClipPath(e.props.item),
                        MB.renderSelections()
                    }
                } (this),
                stop: function() {
                    return MB.selection.undoableSave(!0)
                }
            })
        },
        render: function() {
            return React.createElement("div", {
                ref: "point",
                className: "clip-point",
                "data-pt": this.props.pt,
                style: {
                    top: this.props.top,
                    left: this.props.left
                }
            })
        }
    }),
    t.Circle = React.createClass({
        displayName: "Circle",
        render: function() {
            var t, i, n, r, s, o, a, l, c;
            return s = this.props.i,
            i = s.clipCenter(),
            o = s.clipCRadius(),
            n = s.w() * i.x / 100,
            r = s.h() * i.y / 100,
            a = (s.w() + s.h()) * o / 200,
            t = Math.atan2(s.h() / 2 - r, s.w() / 2 - n),
            t || (t = Math.atan2( - 10, 10)),
            l = Math.cos(t) * a + n,
            c = Math.sin(t) * a + r,
            React.createElement("div", null, React.createElement(e, {
                pt: "cradius",
                item: s,
                top: c,
                left: l
            }), React.createElement(e, {
                pt: "ccenter",
                item: s,
                top: i.y + "%",
                left: i.x + "%"
            }))
        }
    }),
    t.Polygon = React.createClass({
        displayName: "Polygon",
        render: function() {
            var t, i;
            return t = this.props.i,
            i = t.clipPolygonPoints(),
            React.createElement("div", null, i.map(function(i, n) {
                return React.createElement(e, {
                    key: n,
                    pt: n,
                    item: t,
                    top: i.split(" ")[1],
                    left: i.split(" ")[0]
                })
            }))
        }
    }),
    r = React.createClass({
        displayName: "SingleSelection",
        componentDidMount: function() {
            if (this.alignLines = new AlignLines, !MB.activePanel()) return setTimeout(function(e) {
                return function() {
                    if (e.alignLines) return e.alignLines.init(e.props.groupedItems.items())
                }
            } (this), 10),
            this.initResizing(),
            this.initRotating()
        },
        componentWillUnmount: function() {
            try {
                $("#single-selection").resizable("destroy")
            } catch(e) {}
            try {
                $("#single-selection").rotatable("destroy")
            } catch(e) {}
            return delete this.alignLines
        },
        initResizing: function() {
            var e, t, i, n, r, s, a;
            if (" " !== this.item.zoomable) {
                for ($("#single-selection").resizable({
                    handles: this.item.zoomable,
                    start: function(e) {
                        return function(t) {
                            var i, n, r, s, o;
                            for (i = t.originalEvent.target.className, e.offset_l = e.offset_t = e.offset_r = e.offset_b = !1, /resizable-.{0,1}w/.test(i) && (e.offset_l = !0), /resizable-n/.test(i) && (e.offset_t = !0), /resizable-.{0,1}e/.test(i) && (e.offset_r = !0), /resizable-s/.test(i) && (e.offset_b = !0), e.minWidthS = e.item.minWidthS(), e.autoHeight = e.item.autoHeight && e.item.height === e.item.minHeight(), s = MB.selection.groupedItems.items(), n = 0, r = s.length; n < r; n++) o = s[n],
                            o.moveable && (o.initialWidth = o.width, o.initialHeight = o.height);
                            return MB.selection.flagBucket.selectingMoved = !0
                        }
                    } (this),
                    resize: function(e) {
                        return function(t, i) {
                            var n, r, s, a, l, c, d, u, h, p;
                            for (l = i.position.left, h = i.position.top, p = i.size.width, r = i.size.height, 0 === e.item.ro && (n = e.alignLines.smart(l, h, p, r), e.offset_l ? (Math.abs(n.left_offset) < 5 ? (l += n.left_offset, p -= n.left_offset) : Math.abs(n.hcenter_offset) < 2.5 && (l += 2 * n.hcenter_offset, p -= 2 * n.hcenter_offset), p < e.minWidthS && (l -= e.minWidthS - p)) : e.offset_r && (Math.abs(n.right_offset) < 5 ? p += n.right_offset: Math.abs(n.hcenter_offset) < 2.5 && (p += 2 * n.hcenter_offset)), p < e.minWidthS && (p = e.minWidthS)), e.item.setW(p), 0 === e.item.ro && (d = e.item.minHeightS(), e.offset_t ? (Math.abs(n.top_offset) < 5 ? (h += n.top_offset, r -= n.top_offset) : Math.abs(n.vcenter_offset) < 2.5 && (h += 2 * n.vcenter_offset, r -= 2 * n.vcenter_offset), (e.autoHeight || r < d) && (h -= d - r, r = d)) : e.offset_b ? (Math.abs(n.bottom_offset) < 5 ? r += n.bottom_offset: Math.abs(n.vcenter_offset) < 2.5 && (r += 2 * n.vcenter_offset), r < d && (r = d)) : (e.autoHeight || r < d) && (r = d)), e.item.setH(r), e.item.moveable && e.item.setL(l), e.item.moveable && e.item.setT(h), e.item.lsave(!1), MB.selection.design(e.item), 0 === e.item.ro && e.alignLines.update(l, h, e.item.w(), e.item.h()), $("#single-selection").width(e.item.w()), $("#single-selection").height(e.item.h()), e.item.moveable && $("#single-selection").css("left", l + "px"), e.item.moveable && $("#single-selection").css("top", h + "px"), o(e.props.groupedItems), MB.toolboxes.updatePosition(), u = MB.selection.groupedItems.links(), s = 0, c = u.length; s < c; s++) a = u[s],
                            a.reload();
                            return MB.renderLinks()
                        }
                    } (this),
                    stop: function(e) {
                        return function() {
                            return MB.selection.undoableSave(!1),
                            e.alignLines.hide(),
                            MB.renderSelections(),
                            ["navigation_bar", "tab_bar"].indexOf(e.item.name) !== -1 && (MB.COMPONENTS[e.item.name].height = e.item.height, $("#design").trigger("slider:update")),
                            "panel" === e.item.name && e.item.cs().detectConflict(),
                            setTimeout(function() {
                                return MB.selection.flagBucket.selectingMoved = !1
                            },
                            500)
                        }
                    } (this)
                }), s = Math.floor((this.item.ro + 22) % 360 / 45), t = ["nw", "n", "ne", "e", "se", "s", "sw", "w"], a = [], i = n = 0, r = t.length; n < r; i = ++n) e = t[i],
                a.push($(".ui-resizable-" + e).css("cursor", t[(i + s) % 8] + "-resize"));
                return a
            }
        },
        initRotating: function() {
            var e;
            if (this.item.inspectables().indexOf("ro") !== -1) return e = $("#single-selection"),
            e.rotatable({
                angle: 6.2831853 * this.item.ro / 360,
                rotate: function(t) {
                    return function(i, n) {
                        var r, s, o, a, l, c, d, u, h, p, f, g;
                        for (r = (Math.round(360 * n.angle.current / 6.2831853) + 360) % 360, (r + 3) % 90 < 7 && (r = 90 * Math.round(r / 90)), 360 === r && (r = 0), t.item.ro = r, t.item.lsave(!1), MB.selection.design(t.item), p = Math.floor((r + 22) % 360 / 45), o = ["nw", "n", "ne", "e", "se", "s", "sw", "w"], a = l = 0, u = o.length; l < u; a = ++l) s = o[a],
                        $("#selection .ui-resizable-" + s).css("cursor", o[(a + p) % 8] + "-resize");
                        for (g = e.data().uiRotatable, g && g.angle(6.2831853 * r / 360), MB.selection.flagBucket.selectingMoved = !0, MB.toolboxes.setState({
                            groupedItems: t.props.groupedItems
                        }), MB.renderSelections(), f = MB.selection.groupedItems.links(), c = 0, h = f.length; c < h; c++) d = f[c],
                        d.reload();
                        return MB.renderLinks()
                    }
                } (this),
                stop: function() {
                    return function() {
                        return MB.selection.undoableSave(),
                        setTimeout(function() {
                            return MB.selection.flagBucket.selectingMoved = !1
                        },
                        500)
                    }
                } (this)
            })
        },
        render: function() {
            var e, i, n, r;
            return this.item = i = this.props.groupedItems.items(!0)[0],
            r = " " === this.item.zoomable || MB.activePanel() ? [] : this.item.zoomable.split(","),
            n = {
                left: i.l() + "px",
                top: i.t() + "px",
                borderRadius: i.bR(),
                width: i.w() + "px",
                height: i.h() + "px",
                transform: "rotate(" + i.ro + "deg)",
                WebkitTransform: "rotate(" + i.ro + "deg)"
            },
            "panel" !== i.name && i.clipType() && (e = React.createElement(t[i.clipType()], {
                i: i
            })),
            React.createElement("div", {
                className: "selection-item",
                id: "single-selection",
                style: n,
                "data-cid": i.cid
            },
            r.map(function(e) {
                return React.createElement("div", {
                    key: e,
                    className: e + " handler"
                })
            }), e)
        }
    }),
    n = React.createClass({
        displayName: "GroupItem",
        render: function() {
            var e, t;
            return e = this.props.item,
            t = {
                left: e.l() + "px",
                top: e.t() + "px",
                borderRadius: e.bR(),
                width: e.w() + "px",
                height: e.h() + "px",
                transform: "rotate(" + e.ro + "deg)",
                WebkitTransform: "rotate(" + e.ro + "deg)"
            },
            React.createElement("div", {
                className: "selection-item",
                style: t,
                "data-cid": e.cid
            })
        }
    }),
    i = React.createClass({
        displayName: "GroupFrame",
        render: function() {
            var e, t, i, n, r, s;
            return t = this.props.groupedItems,
            e = $(".panel.selected"),
            i = {
                left: parseInt(e.css("left")) || 0,
                top: parseInt(e.css("top")) || 0
            },
            n = t.realL() - MB.canvasLeft() + i.left,
            r = t.realT() - MB.canvasTop() + i.top,
            s = {
                left: n,
                top: r,
                width: t.realW(),
                height: t.realH()
            },
            React.createElement("div", {
                className: "selection-frame-item",
                style: s
            })
        }
    }),
    o = function(e) {
        var t, n, r, s, o, a, l, c, d;
        for (s = e.groupByGid(), c = [], a = 0, l = s.length; a < l; a++) r = s[a],
        o = r.first(),
        d = r.maxZ(),
        n = "selection-frame" + o.cid,
        t = document.getElementById(n),
        t || (t = document.createElement("div"), t.className = "selection-frame", t.id = n, t.style.zIndex = d, $("#canvas").append(t)),
        (o.ro || 0) % 90 !== 0 || r.items().length > 1 || r.getAttr("locked") ? c.push(ReactDOM.render(React.createElement(i, {
            groupedItems: r
        }), t)) : c.push(void 0);
        return c
    },
    a = function(e) {
        var t, i, s, o, a, l, c, d, u, h;
        if (l = e.getAttr("locked"), $("#toolboxes, #asset_uploader").toggle(!l), l === !0) return $(".selection").remove();
        for (i = e.groupByGid(), d = [], o = 0, a = i.length; o < a; o++) t = i[o],
        d.push(function() {
            var i, o, a, l;
            for (a = t.items(!0), l = [], i = 0, o = a.length; i < o; i++) s = a[i],
            h = "selection-item" + s.cid,
            u = document.getElementById(h),
            u || (u = document.createElement("div"), u.className = "selection", u.id = h, "panel" === s.name ? $("#panel" + s.cid).after(u) : MB.activePanel() ? (c = $(".panel.selected").data("cid"), $("#widget" + s.cid + c).after(u)) : $("#widget" + s.cid).after(u)),
            u.style.zIndex = s.fixed ? Widget.MAXZ + s.z: s.z,
            e.items(!0).length > 1 ? l.push(ReactDOM.render(React.createElement(n, {
                item: s
            }), u)) : l.push(ReactDOM.render(React.createElement(r, {
                groupedItems: e
            }), u));
            return l
        } ());
        return d
    },
    MB.renderSelections = function() {
        var e, t, i, n, r, s, d, u, h, p;
        for (t = MB.selection.groupedItems, i = t.items(!0), u = $(".selection-frame"), n = 0, s = u.length; n < s; n++) e = u[n],
        ReactDOM.render(React.createElement("div", null), e);
        if (i.length) return o(t),
        a(t),
        document.addEventListener("keydown", c),
        document.addEventListener("keyup", l);
        for (document.removeEventListener("keydown", c), document.removeEventListener("keyup", l), $("#canvas > .widget, #canvas > .panel").off("mousemove mouseleave"), $("#selection-distance").remove(), h = $(".selection"), r = 0, d = h.length; r < d; r++) p = h[r],
        ReactDOM.render(React.createElement("div", null), p);
        return $(".selection-frame").remove(),
        $(".selection").remove()
    },
    s = void 0,
    c = function(e) {
        var t, i, n, r, o, a, l, c;
        if (18 === e.keyCode) {
            for (s = !1, n = new GroupedItems, l = MB.selection.groupedItems.items(!0), o = 0, a = l.length; o < a; o++) r = l[o],
            n.push(r);
            return c = n.realRect(),
            $(".selection-item .ui-rotatable-handle").hide(),
            $(".selection-item .handler").hide(),
            $(".link").hide(),
            $(".toolbox, .x-toolbox").hide(),
            i = document.getElementById("selection-distance"),
            i || ($("#canvas").append("<div id='selection-distance'></div>"), i = document.getElementById("selection-distance")),
            t = {
                left: 0,
                top: 0,
                width: MB.currentScreen.w(),
                height: MB.currentScreen.h()
            },
            MB.renderOptionDistance(c, t, i),
            $("#canvas > .widget, #canvas > .panel").on("mousemove",
            function(e) {
                var t, r, o;
                if (!s) return s = !0,
                t = $(e.target).closest(".widget").attr("data-cid") || $(e.target).closest(".panel").attr("data-cid"),
                o = Widget.find(t) || Panel.find(t),
                n = new GroupedItems,
                n.push(o),
                r = n.realRect(),
                MB.renderOptionDistance(c, r, i)
            }),
            $("#design .canvas > .widget").on("mouseleave",
            function() {
                return s = !1,
                MB.renderOptionDistance(c, t, i)
            })
        }
    },
    l = function(e) {
        if (18 === e.keyCode) return $(".selection-item .ui-rotatable-handle").css("display", ""),
        $(".selection-item .handler").css("display", ""),
        $(".link").css("display", ""),
        $(".toolbox, .x-toolbox").css("display", ""),
        $("#canvas > .widget, #canvas > .panel").off("mousemove mouseleave"),
        $("#selection-distance").remove()
    }
}.call(this),
function() {
    var e;
    e = 50,
    MB.renderSimulator = function(t, i) {
        var n, r, s, o, a, l, c;
        return r = MB.isMobile() || MB.isEmbedded() || MB.isPhantom() ? "": "width:auto;right:" + e + "px;",
        l = 200 === t.scale ? "disabled": "",
        c = 50 === t.scale ? "disabled": "",
        a = t.splash ? '<img src="' + t.splash + '">': "",
        o = !window.MBData,
        n = o ? "": "none",
        s = '<div id="actions" class="mhide">\n  <a class="design" data-toggle="tooltip" data-placement="left" title="' + I18N.back + '">\n    <i class="fa fa-times"></i>\n  </a>\n  <a id="switch-sharing" data-toggle="tooltip" data-placement="left" title="' + I18N.sharing + '">\n    <i class="fa fa-share-alt"></i>\n  </a>\n  <a id="switch-screen" data-toggle="tooltip" data-placement="left" title="' + I18N.screen_list + '">\n    <i class="fa fa-navicon"></i>\n  </a>\n  <a id="switch-mode" data-toggle="tooltip" data-placement="left" title="' + I18N.text_mode + "/" + I18N.link_mode + '">\n    <i class="fa fa-font"></i>\n  </a>\n  <a id="back_prev" class="disabled" data-toggle="tooltip" data-placement="left" title="' + I18N.link_back + '">\n    <i class="fa fa-reply"></i>\n  </a>\n  <a id="zoomin" class="' + l + '" data-toggle="tooltip" data-placement="left" title="' + I18N.zoomin + '">\n    <i class="fa fa-search-plus"></i>\n  </a>\n  <a id="zoomout" class="' + c + '" data-toggle="tooltip" data-placement="left" title="' + I18N.zoomout + '">\n    <i class="fa fa-search-minus"></i>\n  </a>\n  <a id="switch-comment" style="display:' + n + ';" data-toggle="tooltip" data-placement="left" title="' + I18N.preview.comment["switch"] + '">\n    <i class="fa fa-commenting-o"></i>\n    <div id="switch-comment-switch" class="switch-vertical">\n      <div class="thumb"></div>\n    </div>\n  </a>\n</div>\n<div id="ui-screen-panel" class="mhide"></div>\n<div id="ui-comment-panel" class="mhide"></div>\n<div id="simulator-container" style="' + r + '">\n  <div id="simulator-wrapper">\n    <div id="simulator" class="' + t.shell().device + " " + t.orientation + " " + t.device + '">\n      <div class="splash">\n        ' + a + '\n        <div class="loading">\n          <div class="spinner"></div>\n        </div>\n      </div>\n      <div id="app" class="screens">\n        <div id="gs"></div>\n        <div id="gh" class="fixed ' + t.device + '"></div>\n        <div id="gf" class="fixed"></div>\n      </div>\n      <div id="sticky-container">\n        <div id="stickies"></div>\n        <div id="ui-comment-marker-panel"></div>\n      </div>\n    </div>\n  </div>\n  <div id="ui-comment-tip" class="hide">\n    <span></span>\n  </div>\n</div>',
        i.html(s),
        $("#actions a").tooltip({
            container: "body",
            trigger: "hover focus click"
        })
    }
}.call(this),
function() {
    var e;
    e = React.createClass({
        displayName: "TransferModal",
        getInitialState: function() {
            return {
                app_cid: null
            }
        },
        handleAppChange: function(e) {
            return this.setState({
                app_cid: e.target.value
            })
        },
        handleTransfer: function() {
            var e, t, i, n, r, s, o, a, l, c, d, u;
            if (a = this.props.s, e = Project.find(this.state.app_cid), MB.exceedWidgetLimit(e)) return void $("#transfer-modal").modal("hide");
            for (a.project_cid = e.cid, l = e.sheight(a.orientation), a.width = e.swidth(a.orientation), a.height < l && (a.height = l), a.parent_cid = null, a.lsave(), e.screens_count += 1, u = [a], d = function(e, t) {
                var i, n, r, s, o;
                for (s = e.children(), o = [], n = 0, r = s.length; n < r; n++) i = s[n],
                i.project_cid = t.cid,
                i.width = t.swidth(i.orient()),
                i.lsave(),
                t.screens_count += 1,
                u.push(i),
                o.push(d(i, t));
                return o
            },
            d(a, e), e.lsave(!1), MB.renderRightNav(), MB.currentScreen.reload().project_cid !== MB.currentProject.cid && ScreenManager.activate(MB.project().homeScreen()), t = 0, r = u.length; t < r; t++) for (a = u[t], o = a.clinks(), i = 0, s = o.length; i < s; i++) n = o[i],
            c = Screen.find(n.target_cid),
            c && c.project_cid !== e.cid && n.ldestroy();
            return $("body").trigger("queue:save"),
            $("#transfer-modal").modal("hide")
        },
        render: function() {
            var e, t, i, n, r, s, o, a, l;
            for (e = {
                actives: {
                    name: I18N.all_apps,
                    apps: []
                },
                archived: {
                    name: I18N.archived,
                    apps: []
                }
            },
            a = Project.all(), i = 0, n = a.length; i < n; i++) o = a[i],
            !o.deleted && o.cid !== MB.project().cid && (o.owner_id === MB.user.id || o.canEdit()) && o.screens_count > 0 && (t = {
                name: o.name,
                cid: o.cid
            },
            o.team_cid ? (l = o.cteam(), l && (e[s = l.cid] || (e[s] = {
                name: l.name,
                apps: []
            }), e[l.cid].apps.push(t))) : o.owner_id === MB.user.id ? o.archived ? e.archived.apps.push(t) : e.actives.apps.push(t) : (e[r = o.owner_id] || (e[r] = {
                name: o.owner_name,
                apps: []
            }), e[o.owner_id].apps.push(t)));
            return React.createElement("div", null, React.createElement("div", {
                className: "modal-dialog"
            },
            React.createElement("div", {
                className: "modal-content"
            },
            React.createElement(MB.ModalHeader, {
                title: I18N.transfer_screen
            }), React.createElement("div", {
                className: "modal-body"
            },
            React.createElement("div", {
                className: "form-group"
            },
            React.createElement("select", {
                className: "form-control",
                value: this.state.app_cid || "",
                onChange: this.handleAppChange
            },
            React.createElement("option", null, I18N.choose_app), Object.keys(e).map(function(t) {
                return React.createElement("optgroup", {
                    label: e[t].name,
                    key: t
                },
                e[t].apps.map(function(e) {
                    return React.createElement("option", {
                        key: e.cid,
                        value: e.cid
                    },
                    e.name)
                }))
            })))), React.createElement("div", {
                className: "modal-footer"
            },
            React.createElement("a", {
                type: "submit",
                className: "btn btn-primary",
                onClick: this.handleTransfer
            },
            I18N.transfer)))))
        }
    }),
    MB.renderTransferModal = function(t) {
        return ReactDOM.render(React.createElement(e, {
            s: t
        }), document.getElementById("transfer-modal")),
        $("#transfer-modal").modal()
    }
}.call(this),
function() {
    var e, t, i;
    e = React.createClass({
        displayName: "ScreenLink",
        getInitialState: function() {
            return {
                expand: !1
            }
        },
        handleCheck: function(e) {
            var t;
            return t = this.props.screen,
            this.checkScreen(t, e.target.checked),
            this.forceUpdate()
        },
        checkScreen: function(e, t) {
            var i, n, r, s, o;
            for (e.checked = t, s = e.children, o = [], n = 0, r = s.length; n < r; n++) i = s[n],
            o.push(this.checkScreen(i, t));
            return o
        },
        handleExpand: function() {
            return this.setState({
                expand: !this.state.expand
            })
        },
        render: function() {
            var t, i, n, r;
            return r = this.props.screen,
            n = this.props.root,
            t = r.children,
            i = !r.children.length || this.state.expand ? "minus-square-o": "plus-square-o",
            React.createElement("div", {
                className: "screen-item" + (n ? " root": "") + (this.state.expand ? " expand": "")
            },
            React.createElement("div", {
                className: "item-ctrl"
            },
            React.createElement("input", {
                className: "checker mb-checkbox",
                type: "checkbox",
                checked: r.checked,
                onChange: this.handleCheck,
                id: r.cid
            }), React.createElement("label", {
                htmlFor: r.cid
            }), React.createElement("a", {
                className: "expander",
                onClick: this.handleExpand
            },
            React.createElement("i", {
                className: "fa fa-" + i
            })), React.createElement("span", null, r.name), n ? React.createElement("div", {
                className: "info"
            },
            React.createElement("span", null, r.deleter_name), React.createElement("time", null, new Date(r.deleted_at).toLocaleString())) : null), t.length > 0 && this.state.expand ? React.createElement("div", {
                ref: "children",
                id: "children" + r.cid,
                className: "children"
            },
            t.map(function(i, n) {
                return React.createElement(e, {
                    screen: i,
                    key: i.cid,
                    last: n == t.length - 1,
                    checked: i.checked
                })
            })) : null)
        }
    }),
    t = React.createClass({
        displayName: "TrashModal",
        getInitialState: function() {
            return {
                loading: !1
            }
        },
        handleRecover: function() {
            var e, t, i, n, r;
            for (r = this.props.screens, e = [], t = 0, i = r.length; t < i; t++) n = r[t],
            n.checked === !0 && e.push(n.cid);
            if (0 !== e.length) return this.setState({
                loading: !0
            }),
            $.post({
                url: "/screens/batch_recover.json",
                data: {
                    screen_ids: e.join(",")
                },
                success: function(e) {
                    return function(t) {
                        var i, r, s, o, a;
                        if (e.setState({
                            loading: !1
                        }), i = t.result) {
                            for (a = MB.currentProject.rootScreens().length, s = 0, o = i.length; s < o; s++) r = i[s],
                            n = r.screen,
                            n.parent_cid || (n.position = ++a),
                            Screen.refresh(r.screen),
                            Panel.refresh(r.panels),
                            Widget.refresh(r.widgets),
                            Link.refresh(r.links),
                            ScreenAlign.refresh(r.screen_aligns),
                            Screenstate.refresh(r.screenstates),
                            Widgetstate.refresh(r.widgetstates),
                            Panelstate.refresh(r.panelstates);
                            return MB.renderRightNav(),
                            MB.renderLinks(),
                            $("#trash-modal").modal("hide")
                        }
                    }
                } (this)
            })
        },
        render: function() {
            var t;
            return t = this.props.rootScreens,
            0 === t.length ? React.createElement("div", {
                className: "modal-dialog"
            },
            React.createElement("div", {
                className: "modal-content"
            },
            React.createElement(MB.ModalHeader, {
                title: I18N.screen_transh_can
            }), React.createElement("div", {
                className: "modal-body",
                style: {
                    overflow: "hidden"
                }
            },
            React.createElement("p", null, I18N.no_deleted_screens)), React.createElement("div", {
                className: "modal-footer"
            },
            React.createElement("a", {
                type: "button",
                "data-dismiss": "modal",
                className: "btn btn-default"
            },
            I18N.got_it)))) : React.createElement("div", {
                className: "modal-dialog"
            },
            React.createElement("div", {
                className: "modal-content"
            },
            React.createElement(MB.ModalHeader, {
                title: I18N.screen_transh_can
            }), React.createElement("div", {
                className: "modal-body"
            },
            this.state.loading ? React.createElement("span", {
                className: "loading"
            }) : null, t.map(function(t) {
                return React.createElement(e, {
                    key: t.cid,
                    screen: t,
                    root: !0
                })
            },
            this)), React.createElement("div", {
                className: "modal-footer"
            },
            React.createElement("a", {
                type: "submit",
                className: "btn btn-primary",
                disabled: this.state.loading,
                onClick: this.handleRecover
            },
            I18N.recover))))
        }
    }),
    i = function(e) {
        var t, i, n, r, s, o, a, l;
        for (o = [], i = 0, r = e.length; i < r; i++) {
            for (a = e[i], a.children = [], a.checked = !1, t = !0, n = 0, s = e.length; n < s; n++) l = e[n],
            l.parent_cid === a.cid ? a.children.push(l) : t && a.parent_cid === l.cid && (t = !1);
            a.parent_cid && !t || o.push(a)
        }
        return o
    },
    MB.renderTrashModal = function() {
        var e;
        return e = MB.currentProject,
        $.get({
            url: "/projects/" + e.access_token + "/trashed_screens.json",
            success: function(e) {
                var n, r;
                return r = e.screens,
                n = i(r),
                ReactDOM.render(React.createElement(t, {
                    rootScreens: n,
                    screens: r
                }), document.getElementById("trash-modal")),
                $("#trash-modal").modal()
            }
        })
    }
}.call(this),
function() {
    var e;
    e = React.createClass({
        displayName: "WarningModal",
        handleClick: function() {
            return $("#warning-modal").modal("hide")
        },
        render: function() {
            var e, t;
            return t = this.props.attrs.title || "",
            e = this.props.attrs.message,
            React.createElement("div", null, React.createElement("div", {
                className: "modal-dialog"
            },
            React.createElement("div", {
                className: "modal-content"
            },
            React.createElement(MB.ModalHeader, {
                title: t
            }), React.createElement("div", {
                className: "modal-body"
            },
            React.createElement("p", {
                dangerouslySetInnerHTML: {
                    __html: e
                }
            })), React.createElement("div", {
                className: "modal-footer"
            },
            React.createElement("a", {
                className: "btn btn-default",
                onClick: this.handleClick
            },
            I18N.got_it)))))
        }
    }),
    MB.renderWarningModal = function(t) {
        return ReactDOM.render(React.createElement(e, {
            attrs: t
        }), $("#warning-modal")[0]),
        $("#warning-modal").modal()
    }
}.call(this),
function() {
    var e, t;
    e = {},
    MB.v.multiline = function(e) {
        var t, i, n, r, s;
        if (/^\<p\>/.test(e)) return t = e;
        for (t = "", r = e.split(/\n/), i = 0, n = r.length; i < n; i++) s = r[i],
        s || (s = "&nbsp;"),
        t += "<p>" + s + "</p>";
        return t
    },
    e.text_field = e.navigation_bar = function(e) {
        return '<span class="text">' + e.text + "</span>"
    },
    e.mtext_input = function(e, t) {
        var i;
        return i = /p$/.test(t) ? "": 'readonly="readonly"',
        '<input type="' + e.input_type + '" placeholder="' + e.text + '" ' + i + "></input>"
    },
    e.mtextarea = function(e, t) {
        var i, n, r, s;
        return i = /p$/.test(t) ? "": 'readonly="readonly"',
        n = Math.round(e.padding * MB.scale() / 100),
        s = Math.round(n - (e.lh - e.fs) / 2),
        s < 0 && (s = 0),
        r = "padding:" + s + "px " + n + "px;",
        '<textarea style="' + r + '" placeholder="' + e.text + '" ' + i + "></textarea>"
    },
    e.mcheckbox2 = function(e) {
        var t;
        return t = e.checked ? "checked": "",
        '<input type="checkbox" ' + t + "></input>"
    },
    e.mfile_input = function(e, t) {
        var i;
        return i = /p$/.test(t) ? "onclick='MB.config.fileSelecting = true;'": "",
        '<input type="file" ' + i + "></input>"
    },
    e.mradiobutton = function(e) {
        var t;
        return t = e.checked ? "checked": "",
        '<input type="radio" name="' + e.gid + '" ' + t + "></input>"
    },
    e.mselect = function(e) {
        var t, i;
        return i = function() {
            var i, n, r, s;
            for (r = e.text.split(/\n/), s = [], i = 0, n = r.length; i < n; i++) t = r[i],
            s.push("<option>" + t + "</option>");
            return s
        } ().join(""),
        "<select>" + i + "</select>"
    },
    e.button = function(t, i) {
        return "<p>\n  " + (t.icon ? e.icon_button(t, i) : "") + '\n  <span class="text">' + t.text + "</span>\n</p>"
    },
    e.hr = function(e) {
        var t;
        return t = e.h() - 10 * MB.scale() / 100,
        t < 1 && (t = 1),
        '<span style="border-top-width: ' + t + 'px;"></span>'
    },
    e.ve = function(e) {
        var t;
        return t = e.w() - 10 * MB.scale() / 100,
        t < 1 && (t = 1),
        '<span style="border-left-width: ' + t + 'px;"></span>'
    },
    e.triangleb = function(e) {
        var t;
        return t = "border-left-width:" + e.w() / 2 + "px;border-right-width:" + e.w() / 2 + "px;border-bottom-width:" + e.h() + "px;border-bottom-color:" + (e.tc || "#666") + ";",
        '<span style="' + t + '"></span>'
    },
    e.triangletl = function(e) {
        var t;
        return t = "border-top-width:" + e.h() + "px;border-right-width:" + e.w() + "px;border-top-color:" + (e.tc || "#666") + ";",
        '<span style="' + t + '"></span>'
    },
    e.lr = e.tab_bar = e.rectangle = function() {
        return "<span></span>"
    },
    e.image_view = function(e) {
        var t, i, n, r, s, o;
        return n = e.p ? "auto": "100%",
        s = "",
        e.image && ("i" === e.image[0] && e.image.indexOf("images") === -1 ? (t = Asset.find(e.image), t && (t.raw || t.image) && (s = "src='" + (t.image || t.raw) + "'")) : s = "src='" + e.image + "'"),
        s ? (r = "none", i = "block") : (i = "none", r = "flex"),
        o = "height:" + n + ";display:" + i + ";",
        e.filter.trim() && (o += "filter:" + e.filter.trim() + ";-webkit-filter:" + e.filter.trim() + ";"),
        '<span style="background-color:' + e.bg + ";display:" + r + ';"><i class="fa fa-picture-o"></i></span>\n<div class="wrapper"><img ' + s + ' style="' + o + '"></div>'
    },
    e.webpage = function(e) {
        return '<span class="text">' + e.text + '</span>\n<p class="notice">' + I18N.https_only + '</p>\n<object class="iframe" type="text/html"></object>'
    },
    e.video_view = function() {
        return '<span><i class="fa fa-play-circle-o"></i></span>'
    },
    e.keyboard = function(e) {
        var t, i, n, r;
        return t = MB.project().device,
        r = e.numeric ? "n": "r",
        i = e.cs().orientation,
        n = "/images/keyboards/" + t + "_" + r + "_" + i + ".png",
        "<img src='" + n + '\' class="keyboard-img" alt="keyboard">'
    },
    e.map_view = function() {
        return '<div class="image design">\n  <img src="' + MB.staticMap() + '">\n</div>'
    },
    e.search_bar = function(e, t) {
        var i, n;
        return n = e.th && "light" !== e.th ? "style='background-color:" + MB.themes[e.th][2] + ";'": "",
        i = /p$/.test(t) ? "": 'readonly="readonly"',
        '<div class="text_edit" ' + n + '>\n  <input type="text" ' + i + ' placeholder="' + e.text + '"></input>\n</div>\n<i class="fa fa-search"></i>'
    },
    e.status_bar = function(e) {
        var t, i;
        return e.tc ? (i = "background-color:" + e.tc + ";", t = "border-color:" + e.tc + ";") : i = t = "",
        '<div class="signal">\n  <div class="ball" style="' + i + '"></div>\n  <div class="ball" style="' + i + '"></div>\n  <div class="ball" style="' + i + '"></div>\n  <div class="ball" style="' + i + '"></div>\n  <div class="ball" style="' + i + '"></div>\n</div>\n<div class="carrier">\n  <span class="text">' + e.text + '</span>\n</div>\n<div class="time">\n  12:00<span class="meridian"> AM</span>\n</div>\n<div class="battery">\n  <div class="body" style="' + t + '">\n    <div class="inner" style="' + i + '"></div>\n  </div>\n  <div class="head" style="' + i + '"></div>\n</div>\n<div class="border"></div>'
    },
    e["switch"] = function() {
        return '<div class="wrapper"></div>\n<div class="circle"></div>'
    },
    e.tab_item = function(t, i) {
        return '<div class="wrapper">\n  <div class="wrapper2">\n    <p class="icon">' + e.icon_button(t, i) + '</p>\n    <p class="tab">\n      <span class="text">' + t.text + "</span>\n    </p>\n  </div>\n</div>"
    },
    e.pg = function(e) {
        var t, i;
        return i = Link.find(e.gid),
        t = i ? i.gesture: "tap",
        '<i class="fa fa-' + t + '"></i>'
    },
    e.icon_button = function(e, t) {
        var i, n, r, s;
        return r = "font-size:" + e.iS() + "px;",
        n = e.iconClassesAndText(t),
        i = n[0],
        s = n[1],
        '<i class="' + i + '" style="' + r + '">' + s + "</i>"
    },
    e.label = function(e) {
        var t;
        return t = e.text,
        /<p>/.test(e.text) || (t = "<p>" + t + "</p>"),
        t
    },
    e.circle_rect = e.rounded_rect = e.text_view = function(e) {
        var t;
        return t = "padding: " + e.paddingS() + "px;",
        e.text && "middle" === e.va && (t += "margin-top: " + (0 - e.textHeightS() / 2) + "px;"),
        '<div class="text" style="' + t + '">' + MB.v.multiline(e.text) + "</div>"
    },
    e.sticky = function(e) {
        return '<div class="text">' + MB.v.multiline(e.text) + '</div>\n<div class="sideline">\n  <div class="box"></div>\n  <div class="line"><div class="arrow"></div></div>\n</div>'
    },
    e.mtooltip = function(e) {
        var t, i, n, r;
        return t = {
            top: "border-bottom-color",
            bottom: "border-top-color",
            left: "border-right-color",
            right: "border-left-color"
        },
        i = t[e.tt_placement],
        n = "top" === e.tt_placement || "bottom" === e.tt_placement ? "left:" + e.ttOffset() + "px": "top:" + e.ttOffset() + "px",
        r = "padding: " + e.paddingS() + "px;",
        e.text && "middle" === e.va && (r += "margin-top: " + (0 - e.textHeightS() / 2) + "px;"),
        '<div class="arrow1 arrow ' + e.tt_placement + '" style="border-width:' + e.arrowSize() + "px;" + e.tt_placement + ":" + (0 - e.arrowSize()) + "px;" + i + ":" + (e.bc || "#aaa") + ";" + n + ';"></div>\n<div class="arrow2 arrow ' + e.tt_placement + '" style="border-width:' + e.arrowSize() + "px;" + e.tt_placement + ":" + (0 - e.arrowSize() + e.bS()) + "px;" + i + ":" + (e.bg || "white") + ";" + n + ';"></div>\n<div class="text" style="' + r + '">' + MB.v.multiline(e.text) + "</div>"
    },
    MB.l.getMaterialShadow = function(e, t) {
        var i, n, r;
        return i = e > 15 ? (15 + e) / 100 : (12 + 3 * e) / 100,
        n = (23 + e) / 100,
        r = "0 " + e + "px " + 2 * e + "px rgba(" + t.r + "," + t.g + "," + t.b + "," + i + "), 0 " + 2 * e + "px " + 2 * e + "px rgba(" + t.r + "," + t.g + "," + t.b + "," + n + ")"
    },
    MB.widgetStyle = function(e, t) {
        var i, n, r, s, o, a, l, c, d, u, h, p;
        return null == t && (t = ""),
        n = e.inspectables(),
        u = [],
        " " !== e.zoomable && (h = e.w(), s = e.h(), "mtooltip" === e.name && ("top" === e.tt_placement || "bottom" === e.tt_placement ? s -= e.arrowSize() : h -= e.arrowSize()), e.isFullWidth() || u.push("width:" + h + "px"), u.push("height:" + s + "px")),
        "mtooltip" === e.name && (a = function() {
            var t, i, n, s;
            for (n = ["top", "right", "bottom", "left"], s = [], t = 0, i = n.length; t < i; t++) r = n[t],
            r === e.tt_placement ? s.push(e.tt_arrow_size + "px") : s.push("0");
            return s
        } (), u.push("margin: " + a.join(" "))),
        "number" == typeof e.left && u.push("left:" + e.l() + "px"),
        "number" == typeof e.top && u.push("top:" + e.t() + "px"),
        n.indexOf("tc") !== -1 && u.push("color:" + e.tc),
        n.indexOf("bg") !== -1 && u.push("background-color:" + e.bg),
        n.indexOf("bc") !== -1 && u.push("border-color:" + e.bc),
        e.ds > 0 && (d = MB.currentProject.isAndroid() ? MB.l.getMaterialShadow(e.ds, MB.hex2rgb(e.sc)) : "0 0 " + e.ds + "px " + e.sc, "icon_button" === e.name ? u.push("text-shadow: " + d) : u.push("box-shadow: " + d)),
        e.ts > 0 && u.push("text-shadow: 0 0 " + e.ts + "px " + e.tsc),
        n.indexOf("ro") !== -1 && (u.push("transform: rotate(" + e.ro + "deg)"), u.push("-webkit-transform: rotate(" + e.ro + "deg)")),
        n.indexOf("clip") !== -1 && (u.push("clip-path: " + e.clip), u.push("-webkit-clip-path:  " + e.clip)),
        n.indexOf("fs") !== -1 && e.fS() > 0 && u.push("font-size:" + e.fS() + "px"),
        n.indexOf("padding") !== -1 && "mtextarea" !== e.name && u.push("padding:" + e.paddingS() + "px"),
        n.indexOf("br") !== -1 && u.push("border-radius:" + e.bR() + "px"),
        n.indexOf("bs") !== -1 && u.push("border-width:" + e.bs + "px"),
        n.indexOf("ls") !== -1 && u.push("border-style:" + e.lineStyle()),
        n.indexOf("ha") !== -1 && "label" !== e.name && u.push("text-align:" + e.ha),
        n.indexOf("lh") !== -1 && u.push("line-height:" + e.lH() + "px"),
        u.push("font-weight:" + (e.bo ? "bold": "normal")),
        u.push("font-style:" + (e.i ? "italic": "normal")),
        "label" === e.name && (o = {
            left: "flex-start",
            center: "center",
            right: "flex-end"
        } [e.ha], i = {
            top: "flex-start",
            middle: "center",
            bottom: "flex-end"
        } [e.va], u.push("justify-content: " + o), u.push("align-items: " + i)),
        !MB.isPhantom() && "none" !== e.ani_name && t && (u.push("animation-delay: " + e.ani_delay), u.push("animation-iteration-count: " + e.ani_count), "0" !== e.ani_duration && u.push("animation-duration: " + e.ani_duration)),
        e.v ? (c = "auto", l = n.indexOf("o") !== -1 ? e.o / 100 : "", e.fixed ? (p = Widget.MAXZ + e.z, /(p|pgh|pgf)$/.test(t) && (l = 0)) : p = e.z) : t ? (c = "none", l = 0, p = e.z) : (l = .4, p = -Widget.MAXZ),
        u.push("z-index:" + p),
        u.push("opacity:" + l),
        u.push("pointer-events:" + c),
        u
    },
    MB.widgetClassName = function(e, t) {
        var i, n;
        return null == t && (t = ""),
        i = "widget " + e.name,
        e.inspectables().indexOf("va") !== -1 && (i += " v" + e.va),
        "normal" !== e.td && (i += " td" + e.td),
        "pg" === e.name && (i += " s" + e.icon),
        "switch" === e.name && e.checked && (i += " checked"),
        t && (n = Link.find(e.gid)) && e.v && (i += " clickable"),
        !MB.isPhantom() && "none" !== e.ani_name && t && e.v && (i += " animated " + e.ani_name),
        i
    },
    MB.widget = function(t, i) {
        var n, r, s, o, a, l;
        return null == i && (i = ""),
        n = MB.widgetClassName(t, i),
        l = MB.widgetStyle(t, i),
        i && (s = Link.find(t.gid)) && t.v && (o = s.cid, r = "tap" !== s.gesture ? s.gesture: "", a = "<div class='region gesture " + r + "'></div>"),
        '<div class="' + n + '" id="widget' + t.cid + i + '" data-cid="' + t.cid + '" data-link_cid="' + (o || "") + '" style="' + l.join(";") + '">\n  ' + e[t.name](t, i) + "\n  " + (a || "") + "\n</div>"
    },
    MB.PanelState = function(e, t, i) {
        var n, r, s, o, a, l, c, d, u;
        for (o = t ? "state" + e.panel_cid + e.cid + "p": "state" + e.panel_cid + e.cid, r = t ? "pstate state": "state", i && (r += " active"), n = e.bgimage ? "background-image:url(" + e.getRealBgImage() + ");": "", c = t ? "p": "", s = "", d = e.cwidgets(), a = 0, l = d.length; a < l; a++) u = d[a],
        "sticky" !== u.name && ("pg" === u.name && (u.top = u.left = null), s += MB.widget(u, e.panel_cid + c));
        return '<div id="' + o + '" class="' + r + '" data-cid="' + e.cid + '" data-selectable="true" style="background-color:' + e.bgcolor + ";width:" + e.w() + "px;height:" + e.h() + "px;" + n + '"><div class="pwidgets"><div class="pscontainer">' + s + "</div></div></div>"
    },
    t = function(e, t) {
        var i, n, r, s;
        return e.v ? (s = e.fixed ? Widget.MAXZ + e.z: e.z, n = e.fixed && t ? 0 : 1) : (s = -Widget.MAXZ, n = t ? 0 : .4),
        r = "top:" + e.t() + "px;left:" + e.l() + "px;width:" + e.w() + "px;height:" + e.h() + "px;z-index:" + s + ";opacity:" + n + ";",
        !MB.isPhantom() && t || (r += "overflow:hidden;"),
        i = e.mainState(),
        (e.w() < i.w() || e.h() < i.h()) && (r += "pointer-events:auto;"),
        r
    },
    MB.Panel = function(e) {
        var i, n;
        return n = t(e, !1),
        '<div id="panel' + e.cid + '" class="panel" data-cid="' + e.cid + '" style="' + n + '">\n  <div class="behavior">' + I18N.dblclick_to_edit + "</div>\n  " +
        function() {
            var t, n, r, s;
            for (r = e.states(), s = [], t = 0, n = r.length; t < n; t++) i = r[t],
            s.push(MB.PanelState(i, !1, i.cid === e.mainState().cid));
            return s
        } ().join("") + "\n</div>"
    },
    MB.PanelPreview = function(e) {
        var i, n, r, s, o, a, l, c;
        return c = t(e, !0),
        i = "ppanel panel",
        (s = Link.find(e.gid)) && e.v ? (i += " clickable", o = s.cid, r = "tap" !== s.gesture ? s.gesture: "", a = "<div class='region gesture " + r + "'></div>") : (n = "", o = null, a = ""),
        l = e.mainState(),
        l.panel_cid = e.cid,
        '<div id="panel' + e.cid + 'p" class="' + i + '" data-cid="' + e.cid + '" data-link_cid="' + o + '" style="' + c + '">\n  <div class="fixed"></div>\n  ' + MB.PanelState(l, !0, !0) + "\n  " + a + "\n</div>"
    }
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty,
    i = [].indexOf ||
    function(e) {
        for (var t = 0,
        i = this.length; t < i; t++) if (t in this && this[t] === e) return t;
        return - 1
    };
    this.Project = function(t) {
        function n() {
            n.__super__.constructor.apply(this, arguments)
        }
        return e(n, t),
        n.configure("Project", "cid", "created_at", "updated_at", "password", "access", "access_token", "name", "icon", "splash", "screens_count", "width", "height", "scale", "device", "model", "shell_type", "archived", "deleted", "destroyed", "highlight", "combo", "template", "wechat", "duplicating", "owner_id", "owner_email", "owner_name", "owner_avatar", "owner_plan", "expired", "validated", "parent_cid", "auto_scale", "description", "version", "team_cid", "slack_web_hook_url", "channels"),
        n.include(Spine.Model.Dirty),
        n.extend(Spine.Model.Ajax),
        n.prototype.load = function(e) {
            return this.id = e.cid,
            n.__super__.load.call(this, e),
            this.access_token || (this.access_token = Math.uuid(33)),
            this.model || (this.model = this.device_model())
        },
        n.prototype.cscreens = function() {
            return Screen.findAllByAttribute("project_cid", this.cid)
        },
        n.prototype.cteam = function() {
            return Team.find(this.team_cid)
        },
        n.prototype.type = function() {
            return this.template ? "template": this.combo ? "combo": "project"
        },
        n.prototype.instanceScale = function() {
            return 100
        },
        n.prototype.rootScreens = function() {
            var e;
            return e = Screen.select(function(e) {
                return function(t) {
                    return t.project_cid === e.cid && !t.parent_cid
                }
            } (this)),
            e.sort(function(e, t) {
                return e.position - t.position
            })
        },
        n.prototype.rootFlows = function() {
            var e;
            return e = Flow.select(function(e) {
                return function(t) {
                    return t.project_cid === e.cid && !t.parent_cid && "fullview" !== t.cid
                }
            } (this)),
            e.sort(function(e, t) {
                return e.position - t.position
            })
        },
        n.prototype.homeScreen = function() {
            return this.rootScreens()[0]
        },
        n.prototype.homeFlow = function() {
            return this.rootFlows()[0]
        },
        n.prototype.orient = function() {
            return "customize" === this.model || "web" === this.device ? "portrait": this.width > this.height ? "landscape": "portrait"
        },
        n.prototype.isPrivate = function() {
            return "private" === this.access
        },
        n.prototype.isPublic = function() {
            return "public" === this.access
        },
        n.prototype.isWeb = function() {
            return "web" === this.device || "none" === this.shell_type
        },
        n.prototype.isAndroid = function() {
            return "android" === this.device && ("customize" !== this.model || this.width <= 720)
        },
        n.prototype.swidth = function(e) {
            return e === this.orient() ? this.width: this.height
        },
        n.prototype.sheight = function(e) {
            return e === this.orient() ? this.height: this.width
        },
        n.prototype.deviceShell = function() {
            var e;
            return ["customize", "Meizu"].indexOf(this.model) !== -1 || "device" !== this.shell_type ? null: MB.SHELLS[this.model] || MB.SHELLS[this.device] ? e = $.extend({},
            MB.SHELLS[this.model] || MB.SHELLS[this.device]) : null
        },
        n.prototype.defaultShell = function() {
            var e, t, i, n, r, s;
            return r = "none" === this.shell_type ? 0 : 21,
            s = this.width + 2 * r,
            n = this.height + 2 * r,
            i = this.template || this.combo || "customize" === this.model || "web" === this.device ? s: Math.min(s, n),
            t = this.template || this.combo || "customize" === this.model || "web" === this.device ? n: Math.max(s, n),
            e = {
                device: "default",
                width: i,
                height: t,
                top: r,
                left: r
            }
        },
        n.prototype.icon_size = function() {
            return MB.DEVICES[this.device][this.model].icon_size
        },
        n.prototype.splash_width = function() {
            return MB.DEVICES[this.device][this.model].width
        },
        n.prototype.splash_height = function() {
            return "android" === this.device ? MB.DEVICES[this.device][this.model].height: MB.DEVICES[this.device][this.model].height - 20
        },
        n.prototype.shell = function() {
            var e, t, i, n;
            return n = this.deviceShell() || this.defaultShell(),
            t = this.homeScreen(),
            t && "landscape" === t.orientation && (e = n.height, i = n.left, n.height = n.width, n.width = e, n.left = n.top, n.top = i),
            n
        },
        n.prototype.os_icon = function() {
            return "android" === this.device ? "android": "apple"
        },
        n.prototype.device_icon = function() {
            return "ipad" === this.device ? "tablet": "mobile"
        },
        n.prototype.device_model = function() {
            var e, t, i, n, r;
            r = Math.min(this.width, this.height),
            e = Math.max(this.width, this.height),
            i = MB.DEVICES[this.device];
            for (t in i) if (n = i[t], r === n.width && e === n.height) return t
        },
        n.prototype.device_name = function() {
            switch (this.device) {
            case "android":
                return "Android";
            case "web":
                return MB.DEVICES.web.desktop.name;
            default:
                return MB.DEVICES[this.device][this.model].name
            }
        },
        n.prototype.hasPassword = function() {
            return !! this.password
        },
        n.prototype.setResolution = function(e, t) {
            var i;
            if (this.width !== e || this.height !== t) return i = this.width,
            this.width = e,
            this.height = t,
            i ? this.download(function(i) {
                return function() {
                    var n, r, s, o;
                    for (s = i.cscreens(), n = 0, r = s.length; n < r; n++) o = s[n],
                    "portrait" === o.orientation ? (o.width = e, o.height = t + o.height - i.height) : (o.width = t, o.height = e + o.height - i.height, o.height < e && (o.height = e)),
                    o.lsave();
                    return i.setComponentWidth(i.width),
                    MB.safeLoading(I18N.in_progress),
                    MB.triggerProgress(function() {
                        return $("#safemode").hide()
                    })
                }
            } (this)) : this.setComponentWidth(this.width)
        },
        n.prototype.setComponentWidth = function(e) {
            var t;
            return t = this.cscreens().map(function(e) {
                return e.cid
            }),
            Widget.select(function() {
                return function(n) {
                    var r, s;
                    if (("status_bar" === (r = n.name) || "navigation_bar" === r || "tab_bar" === r || "keyboard" === r) && (s = n.screen_cid, i.call(t, s) >= 0)) return n.left = null,
                    n.top = null,
                    n.width = e,
                    "status_bar" === n.name && (n.height = MB.COMPONENTS[n.name].height),
                    "keyboard" === n.name && (n.height = n.cs().kbDH()),
                    n.lsave()
                }
            } (this))
        },
        n.prototype.setDevice = function(e) {
            return this.device = e,
            this.setup()
        },
        n.prototype.setup = function() {
            return "android" === this.device ? this.setupAndroid() : this.setupiOS()
        },
        n.prototype.setupAndroid = function() {
            var e;
            return MB.COMPONENTS.status_bar.height = 23,
            MB.COMPONENTS.navigation_bar.top = 23,
            MB.COMPONENTS.navigation_bar.height = 55,
            e = document.getElementById("fontawesome"),
            e.style.fontFamily = '"Roboto", "Noto Sans CJK SC", "Nato Sans CJK TC", "Nato Sans CJK JP", "Nato Sans CJK KR", -apple-system,".SFNSText-Regular", "Helvetica Neue","PingFang SC","Hiragino Sans GB","Microsoft YaHei","WenQuanYi Zen Hei",Arial,sans-serif'
        },
        n.prototype.setupiOS = function() {
            var e;
            return MB.COMPONENTS.status_bar.height = 20,
            MB.COMPONENTS.navigation_bar.top = 20,
            MB.COMPONENTS.navigation_bar.height = 45,
            e = document.getElementById("fontawesome"),
            e.style.fontFamily = ""
        },
        n.prototype.isTeam = function() {
            return ! 1
        },
        n.prototype.collaborators = function() {
            return Collaborator.select(function(e) {
                return function(t) {
                    return "MOCK" !== t.email && (t.project_cid === e.cid || e.team_cid && t.team_cid === e.team_cid)
                }
            } (this))
        },
        n.prototype.collaboratorByUid = function(e) {
            var t, i, n, r;
            for (r = this.collaborators(), i = 0, n = r.length; i < n; i++) if (t = r[i], t.user_id === e) return t;
            return null
        },
        n.prototype.roleByUid = function(e) {
            var t;
            return e === this.owner_id ? "admin": (t = this.collaboratorByUid(e), t ? t.role: "none")
        },
        n.prototype.canEdit = function() {
            var e;
            return "admin" === (e = this.roleByUid(MB.user.id)) || "editor" === e
        },
        n.prototype.canAdmin = function() {
            return "admin" === this.roleByUid(MB.user.id)
        },
        n.prototype.isCollaborated = function() {
            return this.collaborators().length > 1
        },
        n.prototype.leftPanelMode = function() {
            return localStorage[this.cid + "_leftPanelMode"]
        },
        n.prototype.rightPanelMode = function() {
            return localStorage[this.cid + "_rightPanelMode"]
        },
        n.prototype.setLeftPanelMode = function(e) {
            return localStorage[this.cid + "_leftPanelMode"] = e
        },
        n.prototype.setRightPanelMode = function(e) {
            return localStorage[this.cid + "_rightPanelMode"] = e
        },
        n.prototype.fixBadScreens = function() {
            return Screen.each(function(e) {
                return function(t) {
                    var i, n;
                    if (t.project_cid === e.cid && (n = t.parent_cid) && (i = Screen.find(n), !i || i && i.project_cid !== e.cid)) return MB.ga("send", "event", "bug", "\u53d1\u73b0\u4e00\u4e2a\u9519\u4e71\u9875\u9762: " + t.cid),
                    t.parent_cid = null,
                    t.lsave()
                }
            } (this))
        },
        n.prototype.download = function(e, t) {
            return this.cscreens().length > 0 ? e() : (MB.safeLoading(I18N.load_project), MB.pusher.subscribe(this.cid), $.getJSON("/templates.json",
            function(i) {
                return function(n) {
                    return Template.refresh(n.templates),
                    Combo.refresh(n.combos),
                    Screen.refresh(n.screens),
                    Widget.refresh(n.widgets),
                    Link.refresh(n.links),
                    $.ajax({
                        type: "GET",
                        url: "/app/" + i.access_token + ".json?password=" + md5(i.password),
                        timeout: 18e4,
                        success: function(t) {
                            var n, r, s, o, a, l, c;
                            for (a = t.templates, n = 0, s = a.length; n < s; n++) c = a[n],
                            c.host_cid = i.cid;
                            for (Template.refresh(t.templates), Screen.refresh(t.screens), i.fixBadScreens(), Widget.refresh(t.widgets), Link.refresh(t.links), Panel.refresh(t.panels), ScreenAlign.refresh(t.screen_aligns), Screenstate.refresh(t.screenstates), Widgetstate.refresh(t.widgetstates), Panelstate.refresh(t.panelstates), CommentThread.refresh(t.threads), Comment.refresh(t.comments), l = t.templates, r = 0, o = l.length; r < o; r++) c = l[r],
                            MB.pusher.subscribe(c.cid);
                            return MB.pusher.open || !i.isCollaborated() ? ($("#safemode").hide(), e()) : ($("#safemode .text").text(I18N.connect_to_push_server), MB.pusher.onOpen = function() {
                                return $("#safemode").hide(),
                                e()
                            },
                            MB.pusher.pusher.open())
                        },
                        error: t
                    })
                }
            } (this)))
        },
        n.prototype.duplicate = function(e, t, i) {
            var r, s, o, a, l, c, d, u, h, p, f, g, m, v, b, y, _, w, M, x, B, k, S, E, C, R, I, $, N, T, P, A, L, D, z, j, W, O, H, F, Y, X, U, V, q;
            for (null == e && (e = !0), null == t && (t = !1), null == i && (i = {}), I = this.template ? "t": this.combo ? "c": "p", s = I + Math.uuid(10, 16) + (new Date).valueOf(), u = this.template ? Template: this.combo ? Combo: n, S = "break_away" === this.behavior ? this.name: this.name + I18N.name_copy, R = new u({
                name: S,
                access_token: Math.uuid(31),
                scale: this.scale,
                width: this.width,
                height: this.height,
                device: this.device,
                access: this.access,
                cid: s,
                icon: "/images/icon_normal.png",
                splash: this.splash,
                password: this.password,
                template: this.template,
                combo: this.combo,
                builtin: !1,
                master: !!e && this.master,
                behavior: this.behavior,
                created_at: (new Date).toISOString(),
                updated_at: (new Date).toISOString(),
                model: this.model,
                archived: !1,
                auto_scale: this.auto_scale,
                parent_cid: t ? this.cid: null,
                shell_type: this.shell_type,
                team_cid: this.team_cid,
                owner_id: MB.user.id,
                owner_email: MB.user.email,
                owner_name: MB.user.name,
                owner_avatar: MB.user.avatar
            }), this.team_cid && (R.owner_id = this.owner_id, R.owner_email = this.owner_email, R.owner_name = this.owner_name, R.owner_avatar = this.owner_avatar), R.template && (R.host_cid = MB.project().cid), R.lsave(), H = {},
            p = {},
            V = {},
            C = {},
            F = {
                "default": "default"
            },
            T = this.cscreens(), c = 0, f = T.length; c < f; c++) O = T[c],
            O.parent_cid || (a = new Screen({
                name: O.name,
                project_cid: R.cid,
                cid: "s" + Math.uuid(10, 16) + (new Date).valueOf(),
                orientation: O.orientation,
                position: O.position,
                expanded: O.expanded,
                width: O.width,
                height: O.height,
                hh: O.hh,
                fh: O.fh,
                bgcolor: O.bgcolor,
                bgimage: O.bgimage
            }), a.lsave(), H[O.cid] = a.cid);
            for (P = this.cscreens(), d = 0, g = P.length; d < g; d++) r = P[d],
            r.parent_cid && (o = new Screen({
                name: r.name,
                project_cid: R.cid,
                parent_cid: H[r.parent_cid],
                cid: "s" + Math.uuid(10, 16) + (new Date).valueOf(),
                orientation: r.orientation,
                position: r.position,
                expanded: r.expanded,
                width: r.width,
                height: r.height,
                hh: r.hh,
                fh: r.fh,
                bgcolor: r.bgcolor,
                bgimage: r.bgimage
            }), o.lsave(), H[r.cid] = o.cid);
            for (A = this.cscreens(), x = 0, m = A.length; x < m; x++) for (O = A[x], L = O.clinks(), B = 0, v = L.length; B < v; B++) M = L[B],
            Y = "prev" === M.target_cid ? M.target_cid: H[M.target_cid],
            h = new Link,
            h.restore(M),
            h.load({
                screen_cid: H[O.cid],
                target_cid: Y,
                cid: "l" + Math.uuid(10, 16) + (new Date).valueOf(),
                widget_cids: null,
                sourcestate_cid: F[M.sourcestate_cid],
                targetstate_cid: F[M.targetstate_cid]
            }),
            h.lsave(),
            p[M.cid] = h.cid;
            for (D = this.cscreens(), $ = 0, b = D.length; $ < b; $++) for (O = D[$], z = O.cwidgets(), N = 0, y = z.length; N < y; N++) U = z[N],
            E = null,
            E = Link.exists(U.gid) ? p[U.gid] : C[k = U.gid] || (C[k] = MB.nextgid(U.gid)),
            l = new Widget,
            l.restore(U),
            l.load({
                screen_cid: H[O.cid],
                cid: "w" + Math.uuid(10, 16) + (new Date).valueOf(),
                gid: E
            }),
            l.lsave(),
            this.template && (V[U.cid] = l.cid);
            if (this.template) for (j = this.cscreens(), X = 0, _ = j.length; X < _; X++) for (O = j[X], W = Link.findAllByAttribute("state_cid", O.cid), q = 0, w = W.length; q < w; q++) M = W[q],
            Y = "prev" === M.target_cid ? M.target_cid: i[M.target_cid] || M.target_cid,
            h = new Link,
            h.restore(M),
            h.load({
                screen_cid: null,
                state_cid: H[M.state_cid],
                target_cid: Y,
                cid: "l" + Math.uuid(10, 16) + (new Date).valueOf(),
                widget_cids: function() {
                    var e, t, i, n;
                    for (t = M.widget_cids.split(","), i = [], n = 0, e = t.length; n < e; n++) s = t[n],
                    i.push(V[s]);
                    return i
                } ().join(",")
            }),
            h.lsave();
            return MB.pusher.subscribe(this.cid),
            R
        },
        n
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Asset = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Asset", "cid", "sid", "user_id", "width", "height", "thumb", "image", "raw", "name", "deleted", "destroyed", "uri", "project_cid", "timestamp", "size"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.createFromFiles = function(e, t) {
            var i, n, r, s, o;
            if (! (MB.user.assets > 104857600 && MB.promptRenew(MB.currentProject, "exceed_quota"))) {
                for (o = [], i = n = 0, r = e.length; n < r; i = ++n) s = e[i],
                o.push(this.createFromFile(s, i + 1 === e.length, t));
                return o
            }
        },
        i.createFromFile = function(e, t, n) {
            return MB.readDataURL(e,
            function(r, s, o) {
                var a;
                if (a = new i({
                    cid: "i" + Math.uuid(10, 16) + (new Date).valueOf(),
                    user_id: MB.user.id,
                    raw: r,
                    name: e.name,
                    width: s,
                    height: o,
                    thumb: r,
                    deleted: !1,
                    project_cid: MB.project().cid,
                    timestamp: (new Date).valueOf()
                }), a.lsave(), MB.user.assets += e.size, $("body").trigger("queue:save"), n && n(a), Projectasset.findByProjectAndAsset(MB.project(), a).length || Projectasset.create({
                    project_cid: MB.project().cid,
                    asset_id: a.sid
                }), t && $("#assets_manager").is(":visible") && MB.assetsManager) return MB.assetsManager.forceUpdate(),
                MB.assetsManager.handleSelect(a)
            })
        },
        i.prototype.load = function(e) {
            return this.id = e.cid,
            i.__super__.load.call(this, e),
            this.sid || (this.sid = this.cid),
            this.scale = Math.min(158 / this.width, 94 / this.height)
        },
        i.prototype.thumbWidth = function() {
            return this.width * this.scale
        },
        i.prototype.thumbHeight = function() {
            return ! this.height || this.height < 94 ? this.height: this.height * this.scale
        },
        i
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Assettag = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Assettag", "cid", "tag", "asset_cids"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.prototype.load = function(e) {
            return this.id = e.cid,
            i.__super__.load.call(this, e),
            this.asset_cids || (this.asset_cids = ""),
            this.assets_count = this.cids().length
        },
        i.prototype.cids = function() {
            var e, t, i, n, r;
            for (n = this.asset_cids.split(","), r = [], t = 0, i = n.length; t < i; t++) e = n[t],
            e && r.push(e);
            return r
        },
        i.prototype.addAsset = function(e) {
            var t;
            return t = this.cids(),
            t.push(e),
            this.asset_cids = t.join(","),
            this.lsave()
        },
        i.prototype.removeAsset = function(e) {
            var t, i;
            return t = this.cids(),
            i = t.indexOf(e),
            t.splice(i, 1),
            this.asset_cids = t.join(","),
            this.lsave()
        },
        i
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.CoWorker = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("CoWorker", "name", "avatar", "screen_cid", "last_seen"),
        i.prototype.load = function(e) {
            return i.__super__.load.call(this, e)
        },
        i
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Collaborator = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Collaborator", "name", "email", "role", "project_cid", "avatar", "cid", "team_cid", "user_id", "channel"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.prototype.load = function(e) {
            return this.id = e.cid,
            i.__super__.load.call(this, e)
        },
        i.prototype.updateHostChannel = function(e) {
            var t, i;
            if (this.channel && (t = Project.find(this.project_cid) || Team.find(this.team_cid))) return i = t.channels.indexOf(this.channel),
            i === -1 && "update" === e ? t.channels.push(this.channel) : i !== -1 && "destroy" === e && t.channels.splice(i, 1),
            t.lsave(!1)
        },
        i
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Colorset = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Colorset", "cid", "name", "index", "tc", "sc", "bg", "ds", "bc", "o", "ls", "bs", "fs", "is", "br", "ro", "lh", "ha", "va", "ts", "tsc", "bo", "i", "td", "clip"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.attrs = ["bg", "tc", "bc", "sc", "ds", "o", "ls", "bs", "fs", "ha", "va", "is", "lh", "ro", "ts", "tsc", "bo", "i", "td", "clip"],
        i.prototype.load = function(e) {
            return this.id = e.cid,
            i.__super__.load.call(this, e)
        },
        i
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Combo = function(t) {
        function i() {
            i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Project", "cid", "created_at", "updated_at", "password", "access", "access_token", "name", "icon", "splash", "screens_count", "width", "height", "scale", "device", "model", "shell_type", "archived", "deleted", "destroyed", "highlight", "combo", "template", "wechat", "owner_id", "owner_email", "owner_name", "owner_avatar", "owner_plan", "expired", "validated", "parent_cid", "auto_scale", "description", "version", "builtin"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.prototype.load = function(e) {
            return this.id = e.cid,
            i.__super__.load.call(this, e),
            this.access_token || (this.access_token = Math.uuid(33)),
            this.model || (this.model = this.device_model())
        },
        i.prototype.swidth = function() {
            return this.width
        },
        i.prototype.sheight = function() {
            return this.height
        },
        i.prototype.instanceScale = function(e) {
            var t, i, n;
            return (i = MB.DEVICES[this.device][this.model]) ? (t = i.width, n = this.auto_scale ? 100 * e / t: 100) : 100
        },
        i.prototype.orient = function() {
            return "portrait"
        },
        i.prototype.updatePanelSize = function(e, t) {
            var i, n, r, s, o, a, l, c;
            for (a = Panel.findAllByAttribute("template_cid", this.cid), i = 0, r = a.length; i < r; i++) o = a[i],
            o.height = t,
            o.width === this.width && (o.width = e),
            o.lsave();
            for (l = this.cscreens(), n = 0, s = l.length; n < s; n++) c = l[n],
            c.height = t,
            c.width = e,
            c.lsave();
            return this.height = t,
            this.width = e,
            this.lsave()
        },
        i
    } (Project)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.CommentThread = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("CommentThread", "cid", "screen_cid", "user_id", "created_at", "updated_at", "left", "top"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.prototype.load = function(e) {
            return this.id = e.cid,
            i.__super__.load.call(this, e)
        },
        i.prototype.s = function() {
            return $("body").data("scale")
        },
        i.prototype.getLeft = function() {
            return (this.left || 0) * this.s() / 100
        },
        i.prototype.getTop = function() {
            return (this.top || 0) * this.s() / 100
        },
        i.prototype.setLeft = function(e) {
            return this.left = Math.round(100 * e / this.s())
        },
        i.prototype.setTop = function(e) {
            return this.top = Math.round(100 * e / this.s())
        },
        i
    } (Spine.Model),
    this.Comment = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Comment", "cid", "thread_cid", "user_id", "created_at", "updated_at", "message"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.prototype.load = function(e) {
            return this.id = e.cid,
            i.__super__.load.call(this, e)
        },
        i
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Flow = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Flow", "cid", "project_cid", "name", "parent_cid", "position", "expanded"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.fullView = function() {
            return this.find("fullview") || this.createFullView()
        },
        i.createFullView = function() {
            var e, t, n, r, s, o, a, l, c, d, u, h, p;
            for (n = new i({
                cid: "fullview",
                project_cid: MB.project().cid,
                parent_cid: null,
                name: "Full View",
                position: -1e4
            }), n.lsave(!1), s = MB.project().homeScreen(), e = function(i) {
                var n, r, s, o, a;
                for (r = i.children(), a = [], s = 0, o = r.length; s < o; s++) n = r[s],
                t.push(n),
                a.push(e(n));
                return a
            },
            t = [], u = MB.project().rootScreens(), a = 0, c = u.length; a < c; a++) h = u[a],
            t.push(h),
            e(h);
            for (p = Math.floor(Math.sqrt(t.length)), o = l = 0, d = t.length; l < d; o = ++l) h = t[o],
            r = new Flowscreen({
                cid: "fs" + h.cid,
                flow_cid: n.cid,
                screen_cid: h.cid,
                root: s.cid === h.cid,
                level: Math.floor(o / p) + 1,
                position: o % p + 1
            }),
            r.lsave(!1);
            return n
        },
        i.prototype.load = function(e) {
            return this.id = e.cid,
            i.__super__.load.call(this, e),
            this.expanded || (this.expanded = !1),
            this.parent_cid || (this.parent_cid = null)
        },
        i.prototype.expandClass = function() {
            return this.expanded ? "expanded": ""
        },
        i.prototype.cp = function() {
            return Project.find(this.project_cid)
        },
        i.prototype.children = function() {
            var e, t;
            return e = this.cid,
            t = i.select(function(t) {
                return t.parent_cid === e
            }),
            t.sort(function(e, t) {
                return e.position - t.position
            })
        },
        i.prototype.rootScreen = function() {
            var e, t, i, n;
            for (n = Flowscreen.all(), t = 0, i = n.length; t < i; t++) if (e = n[t], e.root && e.flow_cid === this.cid) return e;
            return null
        },
        i.prototype.rootScreens = function() {
            var e;
            return e = this.cid,
            Flowscreen.select(function(t) {
                return 1 === t.level && t.flow_cid === e
            })
        },
        i
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Flowscreen = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Flowscreen", "cid", "flow_cid", "screen_cid", "level", "position", "root", "top"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.prototype.load = function(e) {
            return this.id = e.cid,
            i.__super__.load.call(this, e),
            this.level || (this.level = 1)
        },
        i.prototype.cscreen = function() {
            return Screen.find(this.screen_cid)
        },
        i.prototype.children = function() {
            var e, t, n;
            return n = this.level,
            e = this.flow_cid,
            t = i.select(function(t) {
                return 1 === t.position && t.level === n + 1 && t.flow_cid === e
            }),
            t.sort(function(e, t) {
                return e.position - t.position
            })
        },
        i.prototype.cf = function() {
            return Flow.find(this.flow_cid)
        },
        i.prototype._w = function() {
            return this.cscreen() ? this.cscreen().dW() : this.cf().cp().width
        },
        i.prototype._h = function() {
            return this.cscreen() ? this.cscreen().dH() : this.cf().cp().height
        },
        i.prototype.w = function() {
            return this._w() * MB.flowScale / 100
        },
        i.prototype.h = function() {
            return this._h() * MB.flowScale / 100
        },
        i.prototype.l = function() {
            return this.level
        },
        i
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Link = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Link", "cid", "target_cid", "screen_cid", "transition", "gesture", "destroyed", "timer", "left", "right", "top", "bottom", "width", "height", "state_cid", "widget_cids", "menu_offset", "timestamp", "targetstate_cid", "sourcestate_cid", "ani_duration", "easing", "ani_delay", "reset"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.prototype.load = function(e) {
            var t;
            return this.id = e.cid,
            i.__super__.load.call(this, e),
            this.panel_cid = "",
            this.widget_cids || (this.widget_cids = ""),
            this.menu_offset || (this.menu_offset = 75),
            this.ani_duration || (this.ani_duration = this.targetstate_cid ? "0.4s": "0.2s"),
            this.ani_delay || (this.ani_delay = ""),
            this.easing || (this.easing = "linear"),
            this.sourcestate_cid || (this.sourcestate_cid = "default"),
            this.targetstate_cid || (this.targetstate_cid = null),
            t = Screen.find(this.target_cid),
            t && t.cp() ? this.template = t.cp().template: this.template = !1
        },
        i.prototype.cs = function() {
            return Screen.find(this.screen_cid)
        },
        i.prototype.cwidgets = function() {
            var e, t, i, n, r, s, o;
            if (MB.linkCaches || (MB.linkCaches = {}), i = this.cs() ? this.cid + this.cs().state_cid: this.cid, MB.linkCaches[i]) return MB.linkCaches[i];
            if (o = [], this.state_cid || (o = Widget.findAllByAttribute("gid", this.cid), o = o.concat(Panel.findAllByAttribute("gid", this.cid))), 0 === o.length) for (r = this.widget_cids.split(","), t = 0, n = r.length; t < n; t++) e = r[t],
            s = Widget.find(e) || Panel.find(e),
            s && o.push(s);
            return MB.linkCaches[i] = o,
            o
        },
        i.prototype.delay = function() {
            return this.ani_duration
        },
        i.prototype.restore = function(e) {
            return this.transition = e.transition,
            this.timer = e.timer,
            this.menu_offset = e.menu_offset,
            this.gesture = e.gesture,
            this.ani_duration = e.ani_duration,
            this.ani_delay = e.ani_delay,
            this.target_cid = e.target_cid,
            this.targetstate_cid = e.targetstate_cid
        },
        i.prototype.reload = function() {
            return this.left = this.top = null,
            this.lsave(!1)
        },
        i
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Panel = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Panel", "cid", "screen_cid", "template_cid", "top", "left", "width", "height", "name", "gid", "behavior", "z", "timestamp", "v", "fixed", "fixed_type", "main_state_cid", "screenstate_cid", "locked", "timerFired"),
        i.include(Spine.Model.Dirty),
        i.include(Spine.Model.State),
        i.extend(Spine.Model.Ajax),
        i.prototype.load = function(e) {
            return this.id = e.cid,
            this.moveable = !0,
            this.gestureable = !0,
            this.name = "panel",
            i.__super__.load.call(this, e),
            this.timestamp || (this.timestamp = MB.lastTimestamp()),
            this.timestamp > MB.maxTimestamp && (MB.maxTimestamp = this.timestamp),
            this.zoomable = "e,w,n,s",
            0 !== this.z && (this.z || (this.z = 5)),
            this.ro = 0,
            this.v !== !1 && (this.v || (this.v = !0)),
            this.locked || (this.locked = !1),
            this.fixed || (this.fixed = !1),
            this.fixed_type || (this.fixed_type = 1),
            this.o || (this.o = 100),
            this.main_state_cid || (this.main_state_cid = null),
            this.screenstate_cid || (this.screenstate_cid = "default")
        },
        i.prototype.getState = function(e) {
            var t;
            return t = Panelstate.find(e + this.cid),
            t || new Panelstate({
                cid: e + this.cid,
                screenstate_cid: e,
                panel_cid: this.cid
            }).restore(this)
        },
        i.ATTRS = ["top", "left", "width", "height", "v", "fixed", "fixed_type", "z", "gid", "behavior", "template_cid", "timestamp", "main_state_cid", "locked"],
        i.prototype.restore = function(e) {
            var t, n, r, s;
            for (e.screen_cid && (this.screen_cid = e.screen_cid), s = i.ATTRS, n = 0, r = s.length; n < r; n++) t = s[n],
            this[t] = e[t];
            return this
        },
        i.prototype.equals = function(e) {
            var t, n, r, s;
            for (s = i.ATTRS, n = 0, r = s.length; n < r; n++) if (t = s[n], this[t] !== e[t]) return ! 1;
            return ! 0
        },
        i.prototype.ct = function() {
            return Template.find(this.template_cid)
        },
        i.prototype.states = function() {
            var e, t, i, n, r;
            for (i = this.ct().cscreens(), n = [], e = 0, t = i.length; e < t; e++) r = i[e],
            r.panel_cid = this.cid,
            n.push(r);
            return n
        },
        i.prototype.mainState = function() {
            var e;
            return e = Screen.find(this.main_state_cid),
            e && e.project_cid === this.template_cid ? e: this.ct().homeScreen()
        },
        i.prototype.l = function() {
            return this.left * this.s() / 100
        },
        i.prototype.t = function() {
            return this.top * this.s() / 100
        },
        i.prototype.w = function() {
            return this.width * this.s() / 100
        },
        i.prototype.h = function() {
            return this.height * this.s() / 100
        },
        i.prototype.r = function() {
            return this.l() + this.w()
        },
        i.prototype.b = function() {
            return this.t() + this.h()
        },
        i.prototype.bR = function() {
            return 0
        },
        i.prototype._setAttr = function(e, t, i) {
            if (this[e] = 100 * t / this.s(), this[i]() < t && (this[e] += 1), this[i]() > t) return this[e] -= 1
        },
        i.prototype.setL = function(e) {
            return this._setAttr("left", e, "l")
        },
        i.prototype.setT = function(e) {
            return this._setAttr("top", e, "t")
        },
        i.prototype.setW = function(e) {
            return this._setAttr("width", e, "w")
        },
        i.prototype.setH = function(e) {
            return this._setAttr("height", e, "h")
        },
        i.prototype.s = function() {
            return $("body").data("scale")
        },
        i.prototype.inspectables = function() {
            return ["states", "left", "top", "width", "height", "fixed", "fixed_type", "v", "main_state_cid", "locked"]
        },
        i.prototype.cs = function() {
            return this._cs || (this._cs = Screen.find(this.screen_cid))
        },
        i.prototype.isFooter = function() {
            return ! 1
        },
        i.prototype.inScreen = function() {
            return this.r() > 0 && this.l() < this.cs().w()
        },
        i.prototype.inHeader = function() {
            return this.b() <= this.cs().headerHeight()
        },
        i.prototype.inFooter = function() {
            return this.t() >= this.cs().footerTop() && this.t() <= this.cs().h()
        },
        i.prototype.isContainer = function() {
            return ! 1
        },
        i.prototype.valid = function() {
            var e;
            return e = Template.find(this.template_cid),
            !(!e || !e.cscreens().length) || (this.ldestroy(), !1)
        },
        i.prototype.minWidthS = function() {
            return 0
        },
        i.prototype.minHeightS = function() {
            return 0
        },
        i.prototype.isBottomFixed = function(e) {
            return parseInt(this.fixed_type) === Widget.FIX_TYPE.bottom || this.fixed_type === Widget.FIX_TYPE.auto && this.t() > e.h() - e.dH() / 2
        },
        i
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Panelstate = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Panelstate", "screen_cid", "cid", "template_cid", "top", "left", "width", "height", "name", "gid", "behavior", "z", "timestamp", "v", "fixed", "fixed_type", "main_state_cid", "screenstate_cid", "panel_cid", "locked"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.prototype.load = function(e) {
            if (i.__super__.load.call(this, e), "default" !== this.screenstate_cid) return this.screen_cid = null
        },
        i
    } (Panel)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Preference = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Preference", "cid", "gt", "gl", "asset", "at", "al", "rt", "rl", "link_line", "grid", "ct", "cl", "pt", "pl", "ruler", "app_order"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.prototype.load = function(e) {
            return i.__super__.load.call(this, e),
            this.states = !0
        },
        i
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Projectasset = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Projectasset", "project_cid", "asset_id"),
        i.findByProjectAndAsset = function(e, t) {
            return this.select(function(i) {
                return i.project_cid === e.cid && (i.asset_id === t.sid || i.asset_id === t.cid)
            })
        },
        i
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Screen = function(t) {
        function i() {
            i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Screen", "cid", "name", "orientation", "position", "project_cid", "parent_cid", "expanded", "height", "hh", "fh", "bgcolor", "bgimage", "width", "state_cid", "artboard_id", "artboard_asset_id"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.prototype.load = function(e) {
            if (this.id = e.cid, i.__super__.load.call(this, e), this.project_cid) return this.height || (this.height = this.cp().sheight(this.orientation || this.orient())),
            this.width || (this.width = this.cp().swidth(this.orientation || this.orient())),
            this.bgcolor || (this.bgcolor = "#F0F0F2"),
            this.state_cid || (this.state_cid = "default")
        },
        i.prototype.device = function() {
            return this.cp().device
        },
        i.prototype.scale = function() {
            return this.cp().scale
        },
        i.prototype.orient = function() {
            return "customize" === this.cp().model ? this.width && this.cp().width !== this.width ? "landscape": "portrait": this.orientation.toLowerCase()
        },
        i.prototype.h = function() {
            return Math.round(this.height * MB.scale() / 100)
        },
        i.prototype.w = function() {
            return Math.round(this.width * MB.scale() / 100)
        },
        i.prototype.cp = function() {
            return Project.find(this.project_cid) || Template.find(this.project_cid) || Combo.find(this.project_cid)
        },
        i.prototype.cwidgets = function() {
            return Widget.findAllByAttribute("screen_cid", this.cid).sort(function(e, t) {
                return e.timestamp - t.timestamp
            })
        },
        i.prototype.cpanels = function() {
            return Panel.findAllByAttribute("screen_cid", this.cid).sort(function(e, t) {
                return e.timestamp - t.timestamp
            })
        },
        i.prototype.cscreenstates = function() {
            return Screenstate.findAllByAttribute("screen_cid", this.cid).sort(function(e, t) {
                return e.timestamp - t.timestamp
            })
        },
        i.prototype.citems = function() {
            var e, t;
            return t = Widget.findAllByAttribute("screen_cid", this.cid),
            e = Panel.findAllByAttribute("screen_cid", this.cid),
            t.concat(e).sort(function(e, t) {
                return e.z !== t.z ? e.z - t.z: e.timestamp - t.timestamp
            })
        },
        i.prototype.citemsByTop = function() {
            var e, t;
            return t = Widget.findAllByAttribute("screen_cid", this.cid),
            e = Panel.findAllByAttribute("screen_cid", this.cid),
            t.concat(e).sort(function(e, t) {
                return e.t() - t.t() || e.z - t.z || e.timestamp - t.timestamp
            })
        },
        i.prototype.clinks = function() {
            return Link.select(function(e) {
                return function(t) {
                    return t.screen_cid === e.cid && !t.state_cid
                }
            } (this))
        },
        i.prototype.children = function() {
            var e, t;
            return e = this.cid,
            t = i.select(function(t) {
                return t.parent_cid === e
            }),
            t.sort(function(e, t) {
                return e.position - t.position
            })
        },
        i.prototype.getState = function(e) {
            return Screenstate.find(e) || new Screenstate({
                cid: e
            })
        },
        i.prototype.setState = function(e, t) {
            var i, n;
            if (e !== this.state_cid) return i = this.getState(this.cid + "default"),
            "default" === this.state_cid && (i.hh = this.hh, i.fh = this.fh, i.lsave(!1)),
            this.state_cid = e,
            n = this.getState(e),
            this.hh = n.hh || 0 === n.hh ? n.hh: i.hh,
            this.fh = n.fh || 0 === n.fh ? n.fh: i.fh,
            t ? this.lsave(!1) : void 0
        },
        i.prototype.setOrientation = function(e) {
            return this.orientation = e,
            this.height = this.cp().sheight(e),
            this.width = this.cp().swidth(e)
        },
        i.prototype.setup = function(e) {
            var t;
            if (! ("none" === this.cp().shell_type && this.width > 720)) return t = new Widget({
                name: "status_bar",
                text: MB.COMPONENTS.status_bar.text,
                left: null,
                top: null,
                width: this.width,
                height: MB.COMPONENTS.status_bar.height,
                screen_cid: this.cid,
                cid: "w" + Math.uuid(10, 16) + (new Date).valueOf()
            }),
            t.lsave(),
            e ? (t = new Widget({
                name: "navigation_bar",
                left: null,
                top: null,
                height: MB.COMPONENTS.navigation_bar.height,
                text: e,
                width: this.width,
                screen_cid: this.cid,
                cid: "w" + Math.uuid(10, 16) + (new Date).valueOf()
            }), t.lsave()) : void 0
        },
        i.prototype.maxWidgetHeight = function() {
            var e, t, i, n, r;
            for (e = 0, n = this.citems(), t = 0, i = n.length; t < i; t++) r = n[t],
            !r.isFooter() && !r.inFooter() && e < r.b() && r.inScreen() && (e = r.b());
            return e += this.footerHeight(),
            100 * e / MB.scale()
        },
        i.prototype.maxZ = function() {
            var e, t;
            return t = -(1 / 0),
            e = !0,
            Widget.select(function(i) {
                return function(n) {
                    return n.screen_cid === i.cid && "sticky" !== n.name && (t = Math.max(t, n.z), e = !1),
                    !1
                }
            } (this)),
            Panel.select(function(i) {
                return function(n) {
                    return n.screen_cid === i.cid && "sticky" !== n.name && (t = Math.max(t, n.z), e = !1),
                    !1
                }
            } (this)),
            e ? 5 : t
        },
        i.prototype.minZ = function() {
            var e, t;
            return t = 1 / 0,
            e = !0,
            Widget.select(function(i) {
                return function(n) {
                    return n.screen_cid === i.cid && "sticky" !== n.name && (e = !1, t = Math.min(t, n.z)),
                    !1
                }
            } (this)),
            Panel.select(function(i) {
                return function(n) {
                    return n.screen_cid === i.cid && "sticky" !== n.name && (e = !1, t = Math.min(t, n.z)),
                    !1
                }
            } (this)),
            e ? 5 : t
        },
        i.prototype.widgetsByName = function() {
            var e, t, i, n;
            if (!this._widgetsByName) for (this._widgetsByName = {},
            i = this.cwidgets(), e = 0, t = i.length; e < t; e++) n = i[e],
            this._widgetsByName[n.name] = n;
            return this._widgetsByName
        },
        i.prototype.sb = function() {
            return this.widgetsByName().status_bar
        },
        i.prototype.tb = function() {
            return this.widgetsByName().tab_bar
        },
        i.prototype.nb = function() {
            return this.widgetsByName().navigation_bar
        },
        i.prototype.kb = function() {
            return this.widgetsByName().keyboard
        },
        i.prototype.sbH = function() {
            return this.sb() ? this.sb().height: 0
        },
        i.prototype.tbH = function() {
            return this.tb() ? this.tb().height: 0
        },
        i.prototype.nbH = function() {
            return this.nb() ? this.nb().height: 0
        },
        i.prototype.kbH = function() {
            return this.kb() ? this.kbDH() : 0
        },
        i.KEYBOARDS = {
            ipad: {
                portrait: [1536, 526],
                landscape: [2048, 704]
            },
            iphone: {
                portrait: [640, 348],
                landscape: [1136, 252]
            },
            android: {
                portrait: [574, 354],
                landscape: [956, 278]
            }
        },
        i.prototype.kbDH = function() {
            var e, t, n, r;
            return e = this.cp().device,
            n = i.KEYBOARDS[e][this.orient()],
            r = n[0],
            t = n[1],
            Math.round(t * this.width / r)
        },
        i.prototype.headerHeight = function() {
            var e, t;
            return this.cp().template || 0 === this.hh ? 0 : (t = this.sbH(), e = (this.hh || t + this.nbH()) * MB.scale() / 100, t && e === t && (e += 1), e)
        },
        i.prototype.footerHeight = function() {
            return this.cp().template || 0 === this.fh ? 0 : (this.fh || Math.max(this.kbH(), this.tbH())) * MB.scale() / 100
        },
        i.prototype.footerTop = function() {
            return this.h() - this.footerHeight()
        },
        i.prototype.outerHeight = function() {
            return this.h() + 62
        },
        i.prototype.outerWidth = function() {
            return this.w() + 42
        },
        i.prototype.dW = function() {
            return Math.round(this.cp().swidth(this.orient()) * MB.scale() / 100)
        },
        i.prototype.dH = function() {
            return Math.round(this.cp().sheight(this.orient()) * MB.scale() / 100)
        },
        i.prototype.eH = function() {
            return this.h() - this.dH()
        },
        i.prototype.splash = function() {
            return this.cp().splash || ""
        },
        i.prototype.expandable = function() {
            return ! this.parent_cid || !(i.find(this.parent_cid) || {}).parent_cid
        },
        i.prototype.sa = function() {
            return ScreenAlign.find(this.cid) || new ScreenAlign({
                cid: this.cid
            })
        },
        i.prototype.halignLines = function() {
            var e, t, i, n, r;
            for (n = this.sa().h.split(","), r = [], e = 0, i = n.length; e < i; e++) t = n[e],
            t && r.push(t);
            return r
        },
        i.prototype.valignLines = function() {
            var e, t, i, n, r;
            for (n = this.sa().v.split(","), r = [], e = 0, i = n.length; e < i; e++) t = n[e],
            t && r.push(t);
            return r
        },
        i.prototype.duplicate = function() {
            var e, t, n, r, s, o, a, l, c, d, u, h, p, f, g, m, v, b, y, _, w, M, x, B, k, S, E, C, R, I, $, N, T, P, A, L, D, z, j, W, O, H;
            for (t = new i({
                name: this.name + " Copy",
                project_cid: this.project_cid,
                orientation: this.orientation,
                cid: "s" + Math.uuid(10, 16) + (new Date).valueOf(),
                parent_cid: this.parent_cid,
                width: this.width,
                height: this.height,
                hh: this.hh,
                fh: this.fh,
                bgcolor: this.bgcolor,
                bgimage: this.bgimage,
                state_cid: "default",
                position: this.position + 1,
                artboard_id: this.artboard_id,
                artboard_asset_id: this.artboard_asset_id
            }), t.lsave(), (D = ScreenAlign.find(this.cid)) && (n = new ScreenAlign({
                cid: t.cid,
                h: D.h,
                v: D.v
            }), n.lsave()), c = {},
            E = {},
            j = {
                "default": "default"
            },
            $ = this.cscreenstates(), s = 0, d = $.length; s < d; s++) z = $[s],
            B = new Screenstate({
                screen_cid: t.cid,
                name: z.name,
                timestamp: z.timestamp,
                cid: "ss" + Math.uuid(10, 16) + (new Date).valueOf()
            }),
            B.lsave(),
            j[z.cid] = B.cid;
            for (N = this.clinks(), o = 0, u = N.length; o < u; o++) m = N[o],
            l = new Link,
            l.restore(m),
            l.load({
                screen_cid: t.cid,
                widget_cids: null,
                cid: "l" + Math.uuid(10, 16) + (new Date).valueOf(),
                sourcestate_cid: j[m.sourcestate_cid],
                targetstate_cid: j[m.targetstate_cid]
            }),
            l.lsave(),
            c[m.cid] = l.cid;
            for (T = this.cwidgets(), a = 0, h = T.length; a < h; a++) for (O = T[a], O.setState("default", !1), S = null, S = Link.exists(O.gid) ? c[O.gid] : E[y = O.gid] || (E[y] = MB.nextgid(O.gid)), r = new Widget, r.restore(O), r.load({
                screen_cid: t.cid,
                cid: "w" + Math.uuid(10, 16) + (new Date).valueOf(),
                gid: S
            }), r.lsave(), P = Widgetstate.findAllByAttribute("widget_cid", O.cid), v = 0, p = P.length; v < p; v++) H = P[v],
            j[H.screenstate_cid] && "default" !== H.screenstate_cid && (S = Link.exists(H.gid) ? c[H.gid] : E[_ = H.gid] || (E[_] = MB.nextgid(H.gid)), k = new Widgetstate, k.restore(H), k.load({
                cid: j[H.screenstate_cid] + r.cid,
                screenstate_cid: j[H.screenstate_cid],
                widget_cid: r.cid,
                gid: S
            }), k.lsave());
            for (A = this.cpanels(), b = 0, f = A.length; b < f; b++) for (C = A[b], C.setState("default", !1), S = null, S = Link.exists(C.gid) ? c[C.gid] : E[w = C.gid] || (E[w] = MB.nextgid(C.gid)), W = Template.find(C.template_cid), "break_away" === W.behavior && (W = W.duplicate(!1)), e = new Panel, e.restore(C), e.load({
                screen_cid: t.cid,
                cid: "p" + Math.uuid(10, 16) + (new Date).valueOf(),
                template_cid: W.cid,
                gid: S
            }), e.lsave(), L = Panelstate.findAllByAttribute("panel_cid", C.cid), I = 0, g = L.length; I < g; I++) R = L[I],
            j[R.screenstate_cid] && "default" !== R.screenstate_cid && (x = new Panelstate, x.restore(R), S = Link.exists(R.gid) ? c[R.gid] : E[M = R.gid] || (E[M] = MB.nextgid(R.gid)), x.load({
                cid: j[R.screenstate_cid] + e.cid,
                template_cid: e.template_cid,
                screenstate_cid: j[R.screenstate_cid],
                panel_cid: e.cid,
                gid: S
            }), x.lsave());
            return t
        },
        i.prototype.setupSplash = function(e) {
            return this.w() > this.dH() ? ($(e).css("top", 0 - this.dW() + "px"), $(e).width(this.dH()), $(e).height(this.dW())) : ($(e).css("top", "0px"), $(e).width(this.dW()), $(e).height("101%"))
        },
        i.prototype.setImage = function(e) {
            return this.bgimage = e.cid,
            $("#canvas").css("background-image", "url(" + this.getRealBgImage() + ")"),
            this.lsave()
        },
        i.prototype.getImage = function() {
            return this.bgimage
        },
        i.prototype.getRealBgImage = function() {
            var e;
            return e = Asset.find(this.bgimage),
            e ? e.image || e.raw: this.bgimage
        },
        i.prototype.detectConflict = function(e) {
            var t, i, n, r, s, o, a, l;
            for (o = e ? [e] : this.clinks(), t = 0, r = o.length; t < r; t++) if (n = o[t], ["up", "down"].indexOf(n.gesture) !== -1) {
                if (this.height > this.dH()) return $("#gesture_conflict .horizontal").hide(),
                $("#gesture_conflict .vertical").show(),
                void $("#gesture_conflict").modal()
            } else if (["left", "right"].indexOf(n.gesture) !== -1) for (l = this.cpanels(), i = 0, s = l.length; i < s; i++) if (a = l[i], a.width < a.ct().width) return $("#gesture_conflict .horizontal").show(),
            $("#gesture_conflict .vertical").hide(),
            void $("#gesture_conflict").modal()
        },
        i
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.ScreenAlign = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("screen_align", "cid", "h", "v"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.prototype.load = function(e) {
            return i.__super__.load.call(this, e),
            this.h || (this.h = ""),
            this.v || (this.v = "")
        },
        i
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Screenstate = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Screenstate", "cid", "name", "screen_cid", "timestamp", "hh", "fh"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.prototype.load = function(e) {
            return this.id = e.cid,
            i.__super__.load.call(this, e)
        },
        i.prototype.cs = function() {
            return Screen.find(this.screen_cid)
        },
        i.prototype.widgetStates = function() {
            return Widgetstate.findAllByAttribute("screenstate_cid", this.cid)
        },
        i.prototype.panelStates = function() {
            return Panelstate.findAllByAttribute("screenstate_cid", this.cid)
        },
        i.prototype.stateLinks = function() {
            return Link.select(function(e) {
                return function(t) {
                    return t.sourcestate_cid === e.cid || t.targetstate_cid === e.cid
                }
            } (this))
        },
        i
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Team = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Team", "name", "icon", "cid", "owner_id", "owner_email", "owner_name", "owner_avatar", "color", "updated_at", "created_at", "channels"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.prototype.load = function(e) {
            return this.id = e.cid,
            i.__super__.load.call(this, e)
        },
        i.prototype.cprojects = function() {
            return Project.select(function(e) {
                return function(t) {
                    return t.team_cid === e.cid && !t.deleted && !t.template && !t.combo && t.screens_count
                }
            } (this))
        },
        i.prototype.collaborators = function() {
            return Collaborator.select(function(e) {
                return function(t) {
                    return "MOCK" !== t.email && t.team_cid === e.cid
                }
            } (this))
        },
        i.prototype.collaboratorByUid = function(e) {
            var t, i, n, r;
            for (r = this.collaborators(), i = 0, n = r.length; i < n; i++) if (t = r[i], t.user_id === e) return t;
            return null
        },
        i.prototype.roleByUid = function(e) {
            var t;
            return e === this.owner_id ? "admin": (t = this.collaboratorByUid(e), t ? t.role: "none")
        },
        i.prototype.canAdmin = function() {
            return "admin" === this.roleByUid(MB.user.id)
        },
        i.prototype.isTeam = function() {
            return ! 0
        },
        i.prototype.colorO = function(e) {
            return this.color.replace("RGB", "RGBA").replace(")", "," + e + ")")
        },
        i
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Template = function(t) {
        function i() {
            i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Project", "cid", "created_at", "updated_at", "password", "access", "access_token", "name", "icon", "splash", "screens_count", "width", "height", "scale", "device", "model", "shell_type", "archived", "deleted", "destroyed", "highlight", "combo", "template", "wechat", "owner_id", "owner_email", "owner_name", "owner_avatar", "owner_plan", "expired", "validated", "parent_cid", "auto_scale", "description", "version", "team_cid", "builtin", "master", "behavior", "host_cid"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.masters = function() {
            return this.select(function(e) {
                return e.master && !e.deleted
            })
        },
        i.prototype.load = function(e) {
            return this.id = e.cid,
            i.__super__.load.call(this, e),
            this.access_token || (this.access_token = Math.uuid(33)),
            this.model || (this.model = this.device_model())
        },
        i.prototype.swidth = function() {
            return this.width
        },
        i.prototype.sheight = function() {
            return this.height
        },
        i.prototype.orient = function() {
            return "portrait"
        },
        i.prototype.updatePanelSize = function(e, t) {
            var i, n, r, s, o, a, l, c;
            for (a = Panel.findAllByAttribute("template_cid", this.cid), i = 0, r = a.length; i < r; i++) o = a[i],
            o.height = t,
            o.width === this.width && (o.width = e),
            o.lsave();
            for (l = this.cscreens(), n = 0, s = l.length; n < s; n++) c = l[n],
            c.height = t,
            c.width = e,
            c.lsave();
            return this.height = t,
            this.width = e,
            this.lsave()
        },
        i
    } (Project)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Widget = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Widget", "screen_cid", "name", "text", "icon", "top", "left", "width", "height", "cid", "fs", "br", "bs", "is", "ha", "va", "image", "z", "th", "lh", "o", "ds", "sc", "bg", "tc", "bc", "bo", "i", "td", "f", "ts", "tsc", "p", "destroyed", "ro", "gid", "timestamp", "padding", "ls", "checked", "numeric", "tt_placement", "tt_offset", "tt_arrow_size", "v", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration", "screenstate_cid", "input_type", "slw", "slt", "clip", "filter", "locked"),
        i.include(Spine.Model.Dirty),
        i.include(Spine.Model.State),
        i.extend(Spine.Model.Ajax),
        i.ATTRS = ["name", "text", "icon", "width", "height", "left", "top", "gid", "timestamp", "fs", "is", "bs", "br", "va", "ha", "lh", "z", "th", "image", "bg", "tc", "bc", "ds", "sc", "ts", "tsc", "o", "bo", "i", "td", "p", "ro", "ls", "padding", "checked", "numeric", "v", "fixed", "fixed_type", "tt_placement", "tt_offset", "tt_arrow_size", "ani_name", "ani_delay", "ani_count", "ani_duration", "input_type", "slw", "slt", "clip", "filter", "locked"],
        i.FIX_TYPE = {
            auto: 1,
            top: 2,
            bottom: 3
        },
        i.MAXZ = Math.pow(2, 30) - 1,
        i.prototype.load = function(e) {
            var t;
            if (this.id = e.cid, i.__super__.load.call(this, e), this.multiline = ["text_view", "sticky", "rounded_rect", "circle_rect", "mtooltip", "mselect"].indexOf(this.name) !== -1, this.richedit = ["label", "text_view", "sticky", "rounded_rect", "circle_rect", "mtooltip"].indexOf(this.name) !== -1, this.iconic = ["icon_button", "tab_item", "button"].indexOf(this.name) !== -1, this.moveable = ["status_bar", "tab_bar", "keyboard", "navigation_bar"].indexOf(this.name) === -1, this.gestureable = ["pg", "lr", "image_view", "rectangle", "rounded_rect", "circle_rect"].indexOf(this.name) !== -1, "mcheckbox" === this.name && (this.name = "mcheckbox2"), MB.COMPONENTS[this.name] ? this.zoomable = MB.COMPONENTS[this.name].zoomable || "n,s,e,w,ne,nw,se,sw": this.zoomable = " ", ["text_field"].indexOf(this.name) !== -1 && (this.zoomable = "n,s,e,w,ne,nw,se,sw"), t = MB.COMPONENTS[this.name], t && ("number" != typeof this.fs && (this.fs = t.fs), "number" != typeof this.is && (this.is = t.is), "number" != typeof this.br && (this.br = t.br), "number" != typeof this.bs && (this.bs = t.bs), this.ha || (this.ha = t.ha), this.va || (this.va = t.va), 0 !== this.z && (this.z || (this.z = t.z)), t.lh && (this.lh || (this.lh = Math.floor(this.fs * t.lh))), this.padding || (this.padding = t.padding)), this.text || (this.text = ""), "label" === this.name && (this.text = this.text.replace(/\n$/, "")), this.autoWidth = "label" === this.name, this.autoHeight = ["mtooltip", "text_view"].indexOf(this.name) !== -1, this.th || (this.th = "status_bar" === this.name ? "light": ""), 0 !== this.o && (this.o || (this.o = 100)), this.ds || (this.ds = 0), this.bs || (this.bs = 0), this.br || (this.br = 0), this.sc || (this.sc = MB.currentProject && MB.currentProject.isAndroid() ? "#222222": "#aaaaaa"), this.ts || (this.ts = 0), this.tsc || (this.tsc = "#aaaaaa"), this.bo || (this.bo = 0), this.i || (this.i = 0), this.td || (this.td = "normal"), this.bg || (this.bg = ""), this.tc || (this.tc = ""), this.bc || (this.bc = ""), 0 !== this.z && (this.z || (this.z = 5)), this.ro || (this.ro = 0), this.ls || (this.ls = 0), this.filter || (this.filter = ""), this.input_type || (this.input_type = "text"), this.timestamp || (this.timestamp = MB.lastTimestamp()), this.timestamp > MB.maxTimestamp && (MB.maxTimestamp = this.timestamp), this.padding || (this.padding = 0), this.checked !== !1 && (this.checked || (this.checked = !0)), this.numeric || (this.numeric = !1), this.v !== !1 && (this.v || (this.v = !0)), this.locked || (this.locked = !1), this.fixed || (this.fixed = !1), this.fixed_type = parseInt(this.fixed_type || 1), this.tt_placement || (this.tt_placement = "left"), this.tt_offset || (this.tt_offset = 10), this.tt_arrow_size || (this.tt_arrow_size = 10), this.screenstate_cid || (this.screenstate_cid = "default"), this.ani_name || (this.ani_name = "none"), this.slt || (this.slt = 20), this.slw || (this.slw = 50), void 0 === this.p ? this.p = 1 : this.p = this.p ? 1 : 0, "sticky" === this.name && (this.z = i.MAXZ), "label" === this.name && /\n/.test(this.text)) return this.name = "text_view",
            this.lsave()
        },
        i.prototype.cs = function() {
            return this._cs || (this._cs = Screen.find(this.screen_cid))
        },
        i.prototype.isContainer = function() {
            return ["navigation_bar", "rectangle", "rounded_rect"].indexOf(this.name) !== -1
        },
        i.prototype.isFullWidth = function() {
            return ["navigation_bar", "status_bar", "tab_bar", "keyboard"].indexOf(this.name) !== -1
        },
        i.prototype.isFooter = function() {
            return ["tab_bar", "keyboard"].indexOf(this.name) !== -1
        },
        i.prototype.themeable = function() {
            return ["status_bar", "navigation_bar", "tab_bar", "search_bar", "image_view", "keyboard"].indexOf(this.name) !== -1
        },
        i.prototype.inScreen = function() {
            return this.r() > 0 && this.l() < this.cs().w()
        },
        i.prototype.inHeader = function() {
            return this.b() <= this.cs().headerHeight()
        },
        i.prototype.inFooter = function() {
            return ! this.isFooter() && this.t() >= this.cs().footerTop() && this.t() <= this.cs().h()
        },
        i.prototype.getState = function(e) {
            var t;
            return t = Widgetstate.find(e + this.cid),
            t || new Widgetstate({
                cid: e + this.cid,
                screenstate_cid: e,
                widget_cid: this.cid
            }).restore(this)
        },
        i.prototype.restore = function(e) {
            var t, n, r, s;
            for (e.screen_cid && (this.screen_cid = e.screen_cid), s = i.ATTRS, n = 0, r = s.length; n < r; n++) t = s[n],
            this[t] = e[t];
            return this
        },
        i.prototype.equals = function(e) {
            var t, n, r, s;
            for (s = i.ATTRS, n = 0, r = s.length; n < r; n++) if (t = s[n], this[t] !== e[t]) return ! 1;
            return ! 0
        },
        i.prototype.status_bar_t = function() {
            return 0
        },
        i.prototype.keyboard_t = function() {
            return this.cs().height - this.height
        },
        i.prototype.tab_bar_t = function() {
            return this.cs().height - this.height
        },
        i.prototype.navigation_bar_t = function() {
            return this.cs().sbH()
        },
        i.prototype.l = function() {
            return (this.left || 0) * this.s() / 100
        },
        i.prototype.t = function() {
            var e;
            return e = this.moveable ? this.top: this[this.name + "_t"](),
            e * this.s() / 100
        },
        i.prototype.w = function() {
            return "pg" === this.name ? this.width: this.width * this.s() / 100
        },
        i.prototype.h = function() {
            return "pg" === this.name ? this.height: this.height * this.s() / 100
        },
        i.prototype.r = function() {
            return this.l() + this.w()
        },
        i.prototype.b = function() {
            return this.t() + this.h()
        },
        i.prototype._setAttr = function(e, t) {
            return this[e] = Math.round(100 * t / this.s())
        },
        i.prototype.setL = function(e) {
            return this._setAttr("left", e, "l")
        },
        i.prototype.setT = function(e) {
            return this._setAttr("top", e, "t")
        },
        i.prototype.setW = function(e) {
            return this._setAttr("width", e, "w")
        },
        i.prototype.setH = function(e) {
            return this._setAttr("height", e, "h")
        },
        i.prototype.setTheme = function(e) {
            var t;
            if (e) return this.th = e,
            this.bg = this.tc = this.bc = null,
            t = MB.themes[this.th],
            ["status_bar", "navigation_bar", "tab_bar", "search_bar", "keyboard", "hr", "ve", "mtooltip"].indexOf(this.name) !== -1 && (this.bg || (this.bg = t[1] || ""), this.bc || (this.bc = t[0] || ""), this.tc || (this.tc = "light" !== this.th ? "#fff": "")),
            ["label", "text_view", "icon_button", "tab_item", "triangleb", "triangletl"].indexOf(this.name) !== -1 && (this.tc || (this.tc = t[1] || "#fff")),
            ["rectangle", "rounded_rect", "button", "text_field", "mtext_input", "mtextarea", "mselect", "circle_rect", "image_view", "sticky"].indexOf(this.name) !== -1 ? (this.bg || (this.bg = t[2] || ""), this.bc || (this.bc = t[0] || ""), this.tc || (this.tc = "light" !== this.th ? "#fff": "")) : void 0
        },
        i.prototype.s = function() {
            return $("body").data("scale")
        },
        i.prototype.fS = function() {
            var e;
            return e = (this.fs * this.s() / 100).toFixed(1),
            !MB.isMobile() && !MB.isPhantom() && !MB.config.minFSWarned && e < MB.config.minFS && e > 0 && (MB.config.minFSWarned = !0, $("#chrome-warning").modal()),
            e
        },
        i.prototype.bS = function() {
            return Math.floor(this.bs * this.s() / 100)
        },
        i.prototype.iS = function() {
            return Math.round(this.is * this.s() / 100)
        },
        i.prototype.bR = function() {
            return Math.round(this.br * this.s() / 100)
        },
        i.prototype.lH = function() {
            return Math.round(this.lh * this.s() / 100)
        },
        i.prototype.paddingS = function() {
            return Math.round(this.padding * this.s() / 100)
        },
        i.prototype.lineStyle = function() {
            return ["solid", "dotted", "dashed"][this.ls]
        },
        i.prototype.arrowSize = function() {
            return Math.round(this.tt_arrow_size * this.s() / 100)
        },
        i.prototype.ttOffset = function() {
            return Math.round(this.tt_offset * this.s() / 100)
        },
        i.prototype.inspectables = function() {
            return MB.INSPECTABLES[this.name]
        },
        i.prototype.textWidth = function() {
            var e;
            return $("#fontawesome .aw").css("font-size", this.fs),
            $("#fontawesome .aw").css("font-weight", this.bo ? "bold": "normal"),
            e = $("#fontawesome .aw").html(this.text).width() + 1 + 2 * this.padding + 2 * this.bs,
            e < 20 && (e = 20),
            e
        },
        i.prototype.textHeightS = function() {
            return this._textHeight(this.text) * this.s() / 100
        },
        i.prototype.textHeight = function() {
            return this._textHeight(this.text)
        },
        i.prototype._textHeight = function(e) {
            var t, i, n, r, s;
            return s = this.width - 2 * this.padding - 2 * this.bs,
            "mtooltip" === this.name && ["left", "right"].indexOf(this.tt_placement) !== -1 && (s -= 10),
            n = this.bo ? "bold": "normal",
            i = document.getElementById("fontawesome"),
            t = i.getElementsByClassName("ah")[0],
            t.style.fontSize !== this.fs + "px" && (t.style.fontSize = this.fs + "px"),
            t.style.width !== s + "px" && (t.style.width = s + "px"),
            t.style.lineHeight !== this.lh + "px" && (t.style.lineHeight = this.lh + "px"),
            t.style.fontWeight !== n && (t.style.fontWeight = n),
            t.innerHTML = MB.v.multiline(e),
            r = t.offsetHeight + 2 * this.padding + 2 * this.bs,
            r < 10 && (r = 10),
            r
        },
        i.prototype.minWidthS = function() {
            return Math.round(this.minWidth() * this.s() / 100)
        },
        i.prototype.minHeightS = function() {
            return Math.round(this.minHeight() * this.s() / 100)
        },
        i.prototype.minWidth = function() {
            return ["label", "button"].indexOf(this.name) !== -1 ? this.textWidth() : 10
        },
        i.prototype.minHeight = function() {
            return ["label", "button"].indexOf(this.name) !== -1 ? this.lh + 2 * this.padding + 2 * this.bs: ["mtooltip", "text_view"].indexOf(this.name) !== -1 ? this.textHeight() : 10
        },
        i.prototype.initialWidth = function() {
            return ["label"].indexOf(this.name) !== -1 ? this.textWidth() : null
        },
        i.prototype.initialHeight = function() {
            return ["mtooltip", "text_view"].indexOf(this.name) !== -1 ? this.textHeight() : null
        },
        i.prototype.updateSideline = function(e, t) {
            if (20 !== this.slt || 50 !== this.slw) return this.slt = this.initialSlt - t,
            this.slw = this.initialSlw + (this.initialL > 160 ? e: 0 - e),
            this.slw < 20 ? this.slw = 20 : void 0
        },
        i.prototype.clipType = function() {
            var e;
            return this.clip ? (e = /(.*?)\(/.exec(this.clip)[1], e.charAt(0).toUpperCase() + e.slice(1)) : null
        },
        i.prototype.clipPolygonPoints = function() {
            var e, t, i, n, r;
            for (n = this.clip.split(","), r = [], e = 0, t = n.length; e < t; e++) i = n[e],
            r.push(i.replace(/[^\d\s\%]/g, ""));
            return r
        },
        i.prototype.clipInsetPoints = function() {
            var e, t, i, n, r;
            for (n = this.clip.split(/\s/), r = [], e = 0, t = n.length; e < t; e++) i = n[e],
            r.push(parseInt(i.replace(/[^\d]/g, "")));
            return r
        },
        i.prototype.clipCenter = function() {
            var e;
            return e = /at (\d*?)\% (\d*?)\%/.exec(this.clip) || [50, 50],
            {
                x: parseInt(e[1]),
                y: parseInt(e[2])
            }
        },
        i.prototype.clipCRadius = function() {
            return parseInt(/(\d*?)\% at/.exec(this.clip)[1])
        },
        i.prototype.clipXRadius = function() {
            return parseInt(/(\d*?)\% (\d*?)\% at/.exec(this.clip)[1])
        },
        i.prototype.clipYRadius = function() {
            return parseInt(/(\d*?)\% (\d*?)\% at/.exec(this.clip)[2])
        },
        i.prototype.setClipPoint = function(e, t, i) {
            return "number" == typeof e ? this.set_poly_point(e, t) : this["set_clip_" + e](t, i),
            this.lsave(!1)
        },
        i.prototype.set_clip_xradius = function(e) {
            var t, i;
            return t = this.clipCenter(),
            i = Math.round(Math.abs(t.x - e.left)),
            this.clip = "ellipse(" + i + "% " + this.clipYRadius() + "% at " + t.x + "% " + t.y + "%)"
        },
        i.prototype.set_clip_yradius = function(e) {
            var t, i;
            return t = this.clipCenter(),
            i = Math.round(Math.abs(t.y - e.top)),
            this.clip = "ellipse(" + this.clipXRadius() + "% " + i + "% at " + t.x + "% " + t.y + "%)"
        },
        i.prototype.set_clip_cradius = function(e, t) {
            var i, n, r, s, o, a, l;
            return i = this.clipCenter(),
            r = this.w() * i.x / 100,
            s = this.h() * i.y / 100,
            a = t.position.left - r,
            l = t.position.top - s,
            o = Math.sqrt(Math.pow(a, 2) + Math.pow(l, 2)),
            n = Math.round(o / (this.w() + this.h()) * 200),
            this.clip = "circle(" + n + "% at " + i.x + "% " + i.y + "%)"
        },
        i.prototype.set_clip_ccenter = function(e) {
            return this.clip = "circle(" + this.clipCRadius() + "% at " + e.left + "% " + e.top + "%)"
        },
        i.prototype.set_clip_ecenter = function(e) {
            return this.clip = "ellipse(" + this.clipXRadius() + "% " + this.clipYRadius() + "% at " + e.left + "% " + e.top + "%)"
        },
        i.prototype.set_clip_linset = function(e) {
            var t;
            return t = this.clipInsetPoints(),
            this.clip = "inset(" + t[0] + "% " + t[1] + "% " + t[2] + "% " + e.left + "%)"
        },
        i.prototype.set_clip_tinset = function(e) {
            var t;
            return t = this.clipInsetPoints(),
            this.clip = "inset(" + e.top + "% " + t[1] + "% " + t[2] + "% " + t[3] + "%)"
        },
        i.prototype.set_clip_rinset = function(e) {
            var t;
            return t = this.clipInsetPoints(),
            this.clip = "inset(" + t[0] + "% " + (100 - e.left) + "% " + t[2] + "% " + t[3] + "%)"
        },
        i.prototype.set_clip_binset = function(e) {
            var t;
            return t = this.clipInsetPoints(),
            this.clip = "inset(" + t[0] + "% " + t[1] + "% " + (100 - e.top) + "% " + t[3] + "%)"
        },
        i.prototype.set_clip_cinset = function(e) {
            var t, i, n;
            return t = this.clipInsetPoints(),
            i = (100 - t[1] - t[3]) / 2,
            n = (100 - t[0] - t[2]) / 2,
            e.top > 100 - n && (e.top = 100 - n),
            e.top < n && (e.top = n),
            e.left > 100 - i && (e.left = 100 - i),
            e.left < i && (e.left = i),
            this.clip = "inset(" + (e.top - n) + "% " + (100 - e.left - i) + "% " + (100 - e.top - n) + "% " + (e.left - i) + "%)"
        },
        i.prototype.set_poly_point = function(e, t) {
            var i;
            return i = this.clipPolygonPoints(),
            i[e] = t.left + "% " + t.top + "%",
            this.clip = "polygon(" + i.join(",") + ")"
        },
        i.prototype.isBottomFixed = function(e) {
            return parseInt(this.fixed_type) === i.FIX_TYPE.bottom || this.fixed_type === i.FIX_TYPE.auto && this.t() > e.h() - e.dH() / 2
        },
        i.prototype.iconClassesAndText = function(e) {
            var t, i, n, r, s, o, a;
            return o = /^(fa|md|ci)\-/,
            i = o.test(this.icon),
            s = (this.icon || "").replace(o, ""),
            r = i ? this.icon.split("-")[0] : "fa",
            n = r + "-" + s,
            t = r + " " + n,
            !MB.isPhantom() && e && "fa-spinner" === n && (t += " is-spinning"),
            a = "md" === r ? s: "",
            [t, a]
        },
        i
    } (Spine.Model)
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.Widgetstate = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.configure("Widgetstate", "screen_cid", "name", "text", "icon", "top", "left", "width", "height", "cid", "fs", "br", "bs", "is", "ha", "va", "image", "z", "th", "lh", "o", "ds", "sc", "bg", "tc", "bc", "bo", "i", "td", "f", "ts", "tsc", "p", "destroyed", "ro", "gid", "timestamp", "padding", "ls", "checked", "numeric", "tt_placement", "tt_offset", "tt_arrow_size", "v", "fixed", "fixed_type", "ani_name", "ani_delay", "ani_count", "ani_duration", "screenstate_cid", "widget_cid", "input_type", "slt", "slw", "clip", "filter", "locked"),
        i.include(Spine.Model.Dirty),
        i.extend(Spine.Model.Ajax),
        i.serverCount = function() {
            return this.records.reduce(function(e, t) {
                return e += "d" !== t.screenstate_cid[0] ? 1 : 0
            },
            0)
        },
        i.prototype.load = function(e) {
            if (i.__super__.load.call(this, e), "default" !== this.screenstate_cid && (this.screen_cid = null), "label" === this.name && /\n/.test(this.text)) return this.name = "text_view",
            this.lsave()
        },
        i
    } (Widget)
}.call(this),
function() {
    var e;
    e = function(e, t) {
        var i, n;
        return $(".tooltip").remove(),
        i = function() {
            if (e.removeClass("leave").hide(), t && "function" == typeof t) return t()
        },
        n = setTimeout(function() {
            return e.off("animationend"),
            i()
        },
        400),
        e.one("animationend",
        function() {
            return clearTimeout(n),
            i()
        }),
        e.addClass("leave")
    },
    this.Designer = function() {
        function t() {
            this.screenManager = new ScreenManager,
            this.slider = new Slider,
            this.undoStack = new UndoStack,
            this.keyManager = new KeyManager,
            this.widgetManager = new WidgetManager,
            this.panelManager = new PanelManager,
            this.exportManager = new ExportManager,
            MB.selection = new Selection,
            MB.runner = new DesignerRunner,
            $(window).resize(function(e) {
                return function(t) {
                    return e.resize(t)
                }
            } (this)),
            $("#design").on("click", "a.home",
            function(e) {
                return function(t) {
                    return e.backList(t)
                }
            } (this)),
            $("#design").on("click", "a.launch",
            function(e) {
                return function(t) {
                    return e.preview(t)
                }
            } (this)),
            $("#design").on("design:goto",
            function(e) {
                return function(t, i) {
                    return e["goto"](i)
                }
            } (this))
        }
        return t.prototype.designApp = function(t) {
            var i;
            return i = $("#list-page"),
            e(i,
            function() {
                return MB.webpackInterface.navigateTo("/workspace/apps/" + t)
            })
        },
        t.prototype.backList = function(t) {
            var i, n, r, s;
            if (t.preventDefault(), !MB.workspace.autoSaver || !MB.workspace.autoSaver.queue.length || confirm(I18N.data_lost_warning)) return $("body").trigger("selection:clear"),
            MB.currentProject.screens_count = MB.currentProject.cscreens().length,
            MB.currentProject.lsave(!1),
            i = $("#design"),
            $("#links").hide(),
            s = MB.webpackInterface.getState(),
            $("#workspace").data("enter") || s ? e(i,
            function() {
                return MB.webpackInterface.goBack(s)
            }) : (r = "/workspace/apps", (n = MB.currentProject) && (n.team_cid ? r = "/workspace/teams/" + n.team_cid: n.owner_id !== MB.user.id ? r = "/workspace/apps?type=" + n.owner_id: n.archived && (r = "/workspace/apps?type=archives")), e(i,
            function() {
                return i.html(""),
                MB.webpackInterface.navigateTo(r)
            }))
        },
        t.prototype.preview = function(t) {
            var i;
            return MB.ga("send", "event", "goal", "\u70b9\u51fb\u4e86\u8fd0\u884c\u6309\u94ae"),
            MB.mp("\u70b9\u51fb\u4e86\u8fd0\u884c\u6309\u94ae"),
            t.preventDefault(),
            $("#links").hide(),
            $("#design").trigger("position:reset"),
            $("body").trigger("selection:clear"),
            MB.activePanel() && (i = Panel.find($(".panel.selected").data("cid")), i && PanelManager.deactivate(i)),
            e($("#design"),
            function() {
                return MB.webpackInterface.navigateTo("/workspace/apps/" + MB.currentProject.cid + "/preview")
            })
        },
        t.prototype.backDesign = function(t) {
            return t.preventDefault(),
            e($("#preview"),
            function() {
                return MB.webpackInterface.goBack()
            })
        },
        t.prototype.resize = function(e) {
            if (e.target === window && MB.currentScreen && !$("#preview").is(":visible")) return this.resizeTimer && clearTimeout(this.resizeTimer),
            this.resizeTimer = setTimeout(function() {
                return function() {
                    if ($("body").trigger("selection:render"), MB.renderLinks(), ScreenManager.renderRuler(MB.currentScreen), $("#screens").perfectScrollbar("update"), MB.project()) return $("#design").trigger("status_bar:update", !!$("#screen .status_bar").length)
                }
            } (this), 500)
        },
        t.prototype["goto"] = function(t) {
            var i, n;
            return $("body").trigger("selection:clear"),
            $("#links").hide(),
            /^t/.test(t) ? i = "templates": /^c/.test(t) && (i = "combos"),
            n = {
                leftNavTab: i,
                screenCid: MB.currentScreen.cid,
                stateCid: MB.currentScreen.state_cid
            },
            e($("#design"),
            function() {
                return MB.webpackInterface.navigateTo("/workspace/apps/" + t, n)
            })
        },
        t.prototype.updateScreenContainer = function() {
            return $(window).width() % 2 !== 0 ? MB.project() && MB.project().combo ? $("#screens").css("right", 1) : MB.project() && "compact" === MB.project().rightPanelMode() ? $("#screens").css("right", 97) : $("#screens").css("right", 239) : MB.project() && MB.project().combo ? $("#screens").css("right", 0) : MB.project() && "compact" === MB.project().rightPanelMode() ? $("#screens").css("right", 98) : $("#screens").css("right", 238)
        },
        t
    } ()
}.call(this),
function() {
    this.AlignLines = function() {
        function e() {}
        return e.prototype.hide = function() {
            return $("#screen .vertical_line").hide(),
            $("#screen .horizon_line").hide(),
            $("#screen .widget").removeClass("highlight"),
            $("#screen .panel").removeClass("highlight")
        },
        e.prototype.init = function(e) {
            var t, i, n, r, s, o, a, l, c, d, u, h, p, f, g, m, v, b, y, _, w, M, x, B, k, S, E, C, R, I, N, T, P, A, L, D, z, j, W, O, H, F, Y, X, U;
            if (this.vertical_points = {},
            this.vertical_points[0] = [], this.vertical_points[MB.canvasHeight()] = [], this.horizon_points = {},
            this.horizon_points[0] = [], this.horizon_points[MB.canvasWidth()] = [], H = MB.currentScreen) {
                if (MB.preference().grid) {
                    for (h = 10; h < $("#canvas").height();) this.vertical_points[h * MB.scale() / 100] = [],
                    h += 10;
                    for (h = 10; h < $("#canvas").width();) this.horizon_points[h * MB.scale() / 100] = [],
                    h += 10
                } else this.horizon_points[10 * MB.scale() / 100] = [],
                this.horizon_points[MB.canvasWidth() - 10 * MB.scale() / 100] = [];
                if (MB.preference().ruler) {
                    for (I = H.halignLines(), p = 0, v = I.length; p < v; p++) g = I[p],
                    this.horizon_points[g * MB.scale() / 100] = [];
                    for (N = H.valignLines(), f = 0, b = N.length; f < b; f++) g = N[f],
                    this.vertical_points[g * MB.scale() / 100] = []
                }
                for (this.vcenter_points = {},
                this.vcenter_points[MB.canvasHeight() / 2] = [], a = function() {
                    var t, i, n;
                    for (n = [], i = 0, t = e.length; i < t; i++) X = e[i],
                    X.moveable && n.push(X.cid);
                    return n
                } (), this.enabled = a.length === e.length, c = new GroupedItems, T = H.citems(), k = 0, y = T.length; k < y; k++) h = T[k],
                a.indexOf(h.cid) === -1 && c._iv(h).length && c.push(h);
                for (P = c.groupByGid(), j = [], S = 0, _ = P.length; S < _; S++) {
                    for (l = P[S], 1 === l.items().length && 0 === (h = l.first()).ro ? (F = h.t(), m = h.l(), u = h.h(), U = h.w(), o = h.b(), W = h.r()) : (F = l.realT() - MB.canvasTop(), m = l.realL() - MB.canvasLeft(), u = l.realH(), U = l.realW(), o = l.realB() - MB.canvasTop(), W = l.realR() - MB.canvasLeft()), Y = F + u / 2, d = m + U / 2, (t = this.vertical_points)[F] || (t[F] = []), A = l.items(), E = 0, w = A.length; E < w; E++) X = A[E],
                    this.vertical_points[F].push(X);
                    for ((i = this.vertical_points)[o] || (i[o] = []), L = l.items(), C = 0, M = L.length; C < M; C++) X = L[C],
                    this.vertical_points[o].push(X);
                    if (l.isContainer()) for ((n = this.vcenter_points)[Y] || (n[Y] = []), D = l.items(), R = 0, x = D.length; R < x; R++) X = D[R],
                    this.vcenter_points[Y].push(X);
                    if (l.moveable()) {
                        for ((r = this.horizon_points)[m] || (r[m] = []), z = l.items(), O = 0, B = z.length; O < B; O++) X = z[O],
                        this.horizon_points[m].push(X); (s = this.horizon_points)[W] || (s[W] = []),
                        j.push(function() {
                            var e, t, i, n;
                            for (t = l.items(), i = [], n = 0, e = t.length; n < e; n++) X = t[n],
                            i.push(this.horizon_points[W].push(X));
                            return i
                        }.call(this))
                    } else j.push(void 0)
                }
                return j
            }
        },
        e.prototype.smart = function(e, t, i, n) {
            var r, s, o, a, l, c, d, u, h, p, f, g, m, v, b, y;
            if (!this.enabled) return {
                offset_x: 0,
                offset_y: 0
            };
            f = e + i,
            l = e + i / 2,
            r = t + n,
            v = t + n / 2,
            a = {},
            m = s = b = 1 / 0,
            u = this.vertical_points;
            for (d in u) y = u[d],
            Math.abs(m - t) > Math.abs(d - t) && (m = d),
            Math.abs(s - r) > Math.abs(d - r) && (s = d);
            h = this.vcenter_points;
            for (d in h) y = h[d],
            Math.abs(b - v) > Math.abs(d - v) && (b = d);
            a.top_offset = m - t,
            a.vcenter_offset = b - v,
            a.bottom_offset = s - r,
            o = Math.min(Math.abs(a.top_offset), Math.abs(a.vcenter_offset), Math.abs(a.bottom_offset)),
            o === Math.abs(a.top_offset) && (a.offset_y = a.top_offset),
            o === Math.abs(a.vcenter_offset) && (a.offset_y = a.vcenter_offset),
            o === Math.abs(a.bottom_offset) && (a.offset_y = a.bottom_offset),
            c = g = 1 / 0,
            p = this.horizon_points;
            for (d in p) y = p[d],
            Math.abs(c - e) > Math.abs(d - e) && (c = d),
            Math.abs(g - f) > Math.abs(d - f) && (g = d);
            return a.left_offset = c - e,
            a.hcenter_offset = MB.canvasWidth() / 2 - l,
            a.right_offset = g - f,
            o = Math.min(Math.abs(a.left_offset), Math.abs(a.hcenter_offset), Math.abs(a.right_offset)),
            o === Math.abs(a.left_offset) && (a.offset_x = a.left_offset),
            o === Math.abs(a.hcenter_offset) && (a.offset_x = a.hcenter_offset),
            o === Math.abs(a.right_offset) && (a.offset_x = a.right_offset),
            a
        },
        e.prototype.show = function(e, t, i, n) {
            var r, s, o, a, l, c;
            if (this.enabled) {
                for (r = "horizon" === e ? "top": "left", $("#screen ." + e + "_line." + t).css(r, i + "px").show(), a = [], s = 0, o = n.length; s < o; s++) l = n[s],
                c = "panel" === l.name ? $("#panel" + l.cid) : $("#widget" + l.cid),
                a.push(c.addClass("highlight"));
                return a
            }
        },
        e.prototype.update = function(e, t, i, n) {
            var r, s, o, a, l, c, d, u, h;
            if (this.enabled) {
                d = e + i,
                s = e + i / 2,
                r = t + n,
                u = t + n / 2,
                this.hide(),
                a = this.vertical_points;
                for (o in a) h = a[o],
                Math.abs(o - t) < .1 && this.show("horizon", "top", o, h),
                Math.abs(o - r) < .1 && this.show("horizon", "bottom", o - 1, h);
                l = this.vcenter_points;
                for (o in l) h = l[o],
                Math.abs(o - u) < .1 && this.show("horizon", "center", o - 1, h);
                c = this.horizon_points;
                for (o in c) h = c[o],
                Math.abs(o - e) < .1 && this.show("vertical", "left", o, h),
                Math.abs(o - d) < .1 && this.show("vertical", "right", o - 1, h);
                return Math.abs(MB.canvasWidth() / 2 - s) < 1 ? this.show("vertical", "center", s - 1, []) : void 0
            }
        },
        e
    } ()
}.call(this),
function() {
    this.AutoSaver = function() {
        function e() {
            $("body").on("queue:add",
            function(e) {
                return function(t, i, n) {
                    return e.add(i, n)
                }
            } (this)),
            $("body").on("queue:save",
            function(e) {
                return function() {
                    return e.save()
                }
            } (this)),
            this.queue = [],
            this.setup(),
            setInterval(function(e) {
                return function() {
                    if (e.save(), MB.refreshCoWorkers) return MB.refreshCoWorkers()
                }
            } (this), 2e4)
        }
        return e.prototype.updateQueueLength = function() {
            return this.queue.length ? $("#last_saved .progress").text("(" + this.queue.length + " " + I18N.unsaved + ")") : $("#last_saved .progress").text("(" + I18N.all_saved + ")")
        },
        e.prototype.add = function(e, t) {
            var i, n, r, s;
            for ($("#save").removeClass("saved"), this.updateQueueLength(), s = this.queue, n = 0, r = s.length; n < r; n++) if (i = s[n], i.cid === e.cid && !i.saving && i.constructor === e.constructor) return void(i.destroyed = t);
            return this.queue.push(e)
        },
        e.prototype.save = function() {
            var e, t;
            if (!this.queue.length) return $("#save").removeClass("saving"),
            void $("#save").addClass("saved");
            if (!this.queue[0].saving) {
                this.queue[0].saving = !0,
                $("#save").addClass("saving");
                try {
                    return this.queue[0].constructor.exists(this.queue[0].cid) ? this.queue[0].constructor === Asset ? (e = this.queue[0].constructor.find(this.queue[0].cid), e.id = null, e.save()) : this.queue[0].constructor.find(this.queue[0].cid).save() : this.queue[0].destroyed && this.queue[0].constructor !== Asset ? this.queue[0].destroy() : this.queue[0].save()
                } catch(e) {
                    return t = e,
                    MB.ga("send", "event", "saving", "exception", t.stack + ("(" + MB.user.email + ")")),
                    this.queue.splice(0, 1),
                    this.save()
                }
            }
        },
        e.prototype.pushObject = function(e) {
            var t, i, n, r, s, o;
            if (r = MB.project(), r && !r.combo && (r.template && (r = Project.find(r.host_cid)), r && r.channels && (i = r.channels.filter(function(e) {
                return e !== MB.user.channel
            }), i.length > 0 && (e.constructor === Widget ? (o = "Widget", t = Widget.find(e.cid) ? "update": "destroy") : e.constructor === Widgetstate ? "default" === e.screenstate_cid ? (o = "Widget", e = Widget.find(e.widget_cid), e && (t = "update")) : (o = "Widgetstate", t = "update") : e.constructor === Link ? (o = "Link", t = Link.find(e.cid) ? "update": "destroy") : e.constructor === Screen ? (o = "Screen", t = Screen.find(e.cid) ? "update": "destroy") : e.constructor === Screenstate ? (o = "Screenstate", t = Screenstate.find(e.cid) ? "update": "destroy") : e.constructor === Panel ? (o = "Panel", t = Panel.find(e.cid) ? "update": "destroy") : e.constructor === Panelstate && ("default" === e.screenstate_cid ? (o = "Panel", e = Panel.find(e.panel_cid), e && (t = "update")) : (o = "Panelstate", t = "update")), t)))) return "Panel" === o && (s = Template.find(e.template_cid), s && (n = {
                template_token: s.access_token
            })),
            MB.pusher.pusher.send({
                data: {
                    event: "collaboration",
                    action: t,
                    t: o,
                    from: {
                        id: MB.user.id,
                        name: MB.user.name,
                        avatar: MB.user.avatar
                    },
                    to: r.cid,
                    object: e,
                    extras: n
                },
                expiration_interval: 60,
                channels: i
            })
        },
        e.prototype.setup = function() {
            return MB.myXhr = $.ajaxSettings.xhr(),
            MB.myXhr.upload && MB.myXhr.upload.addEventListener("progress",
            function(e) {
                return function(t) {
                    var i, n;
                    if (i = Math.floor(100 * t.loaded / t.total), 100 !== i) return n = "(" + i + "% " + e.queue.length + " " + I18N.unsaved + ")",
                    $("#last_saved .progress").text(n)
                }
            } (this), !1),
            $.ajaxSettings.xhr = function() {
                return MB.myXhr
            },
            $.ajaxSetup({
                timeout: 6e4
            }),
            window.onbeforeunload = function(e) {
                return function() {
                    var t;
                    if (e.queue.length) return MB.isElectron() ? (t = confirm(I18N.data_lost_warning), !t || void 0) : I18N.data_lost_warning
                }
            } (this),
            window.onerror = function(e, t, i, n, r) {
                var s, o;
                if (!/(Network error|Uncaught InvalidStateError|Uncaught #<Event>|Blocked a frame)/.test(e) && r.stack) return s = (MB.currentProject || {
                    cid: "none"
                }).cid,
                o = $("#screen").data("cid"),
                MB.ga("send", "event", "exception", e + "," + MB.user.email + "," + s + "," + o, r.stack + ("(" + MB.user.email + ")"))
            },
            $(document).on("ajaxComplete",
            function(e) {
                return function(t, i, n) {
                    var r, s;
                    if (200 === i.status || 422 === i.status) {
                        if (!i.responseJSON || !i.responseJSON.cid) return;
                        return (s = MB.currentProject) && (s.updated_at = (new Date).toISOString(), s.lsave(!1)),
                        e.queue[0] && (e.queue[0].saving = !1, r = e.queue.splice(0, 1), e.pushObject(r[0])),
                        e.save(),
                        $("#last_saved").length && ($("#last_saved abbr.timeago").attr("title", (new Date).toISOString()), $("#last_saved abbr.timeago").timeago("updateFromDOM")),
                        e.updateQueueLength()
                    }
                    if (0 === i.status ? ($("#timeout_modal").modal({
                        backdrop: "static"
                    }), $.ajaxSettings.timeout < 12e4 && $.ajaxSetup({
                        timeout: 2 * $.ajaxSettings.timeout
                    }), MB.ga("send", "event", "saving", "saving timeout", n.url + "(" + n.type + ")(" + n.data + ")(" + MB.user.email + ")")) : $("#safemode").is(":visible") || (MB.safeAlert(I18N.unknown_error), MB.ga("send", "event", "saving", "saving error: " + i.status, i.status + ": " + n.url + "(" + n.type + ")(" + n.data + ")(" + MB.user.email + ")")), $("#save").removeClass("saving saved"), e.queue[0]) return e.queue[0].saving = !1
                }
            } (this))
        },
        e
    } ()
}.call(this),
function() {
    this.ExportManager = function() {
        function e() {
            $("#download").on("click", "a.close",
            function(e) {
                return function() {
                    return e.progressInterval && clearInterval(e.progressInterval),
                    $("#formats").translateY(0),
                    $("#download").css("background", "RGBA(0,0,0,.0)"),
                    setTimeout(function() {
                        return $("#download").hide()
                    },
                    300)
                }
            } (this)),
            $("#download").on("click", "a.format",
            function(e) {
                return function(t) {
                    var i, n;
                    if (!$("#download .loading").is(":visible") && (n = $(t.target).closest(".format").data("format"), i = MB.project(), !MB.promptRenew(i, "exporting"))) return "ipa" === n && "enterprise" !== MB.project().owner_plan ? void $("#enterprise_modal").modal() : MB.workspace.autoSaver.queue.length ? void alert(I18N.unsaved_changes) : ($("#download .loading").show(), $("#download .loading .progress").text(""), $("#download .file-link").hide(), $("#download .qrcode").hide(), $.ajax({
                        url: "/app/" + i.access_token + "/build/" + n + ".json",
                        data: "cid=" + MB.currentScreen.cid,
                        type: "put",
                        success: function(t) {
                            return e.checkProgress(n, t)
                        },
                        error: function() {
                            return $("#download .loading").hide(),
                            alert(I18N.wait_for_saving)
                        }
                    }))
                }
            } (this))
        }
        return e.prototype.checkProgress = function(e, t) {
            var i;
            if (i = MB.project(), "pngs" === e || "png" === e || "apk" === e || "htmlzip_async" === e) return this.progressInterval && clearInterval(this.progressInterval),
            this.progressInterval = setInterval(function(t) {
                return function() {
                    return $.ajax({
                        url: "/app/" + i.access_token + "/status/" + e + ".json",
                        data: "cid=" + MB.currentScreen.cid,
                        type: "get",
                        success: function(n) {
                            var r;
                            return 100 === n.progress ? ($("#download .loading").hide(), $("#download .file-link").show(), r = $("#download a.indicator"), MB.isElectron() || r.attr("download", n.name), r.attr("href", n.link), t.downloadInApp(), "apk" === e ? ($("#download .qrcode").html(""), $("#download .qrcode").qrcode({
                                text: "https://" + window.location.host + "/app/" + i.access_token + "?via=qrcode",
                                width: 150,
                                height: 150
                            }), $("#download .qrcode").show()) : $("#download .qrcode").hide(), clearInterval(t.progressInterval), t.progressInterval = null) : $("#download .loading .progress").text("(" + n.progress + "%)")
                        }
                    })
                }
            } (this), 5e3);
            if ($("#download .loading").hide(), "ipa" === e) {
                if (t.success) return $("#download .ipa-info").show();
                switch (t.code) {
                case 1:
                    break;
                case 2:
                    return alert(I18N["ipa_device.not_configured"]);
                case 3:
                    return alert(I18N.no_ios_certificate)
                }
            }
        },
        e.prototype.downloadInApp = function() {
            if (MB.isElectron() && !localStorage.inAppDownloaded) return $("#download a.indicator").on("click",
            function() {
                return function() {
                    return $(".file-link .text").text(I18N.electron_download_alert),
                    localStorage.inAppDownloaded = !0
                }
            } (this))
        },
        e
    } ()
}.call(this),
function() {
    this.GroupedItems = function() {
        function e(e) {
            this.panelCid = e,
            this._items = []
        }
        return e.prototype.push = function(e) {
            return this._attributes = null,
            this._items.push(e)
        },
        e.prototype.items = function(e) {
            return null == e && (e = !1),
            e ? this._selectedItems() : this._items
        },
        e.prototype._selectedItems = function() {
            var e;
            return this._selected || (this._selected = function() {
                var t, i, n, r;
                for (n = this._items, r = [], t = 0, i = n.length; t < i; t++) e = n[t],
                e.selected && r.push(e);
                return r
            }.call(this))
        },
        e.prototype.setItems = function(e) {
            return this._attributes = null,
            this._selected = null,
            this._items = e
        },
        e.prototype.clear = function() {
            return this._attributes = null,
            this._selected = null,
            this._items = []
        },
        e.prototype.reloadItem = function(e) {
            var t, i, n, r, s, o;
            for (s = this._items, o = [], t = n = 0, r = s.length; n < r; t = ++n) i = s[t],
            i.cid === e ? o.push(this._items[t] = this.find(i.cid)) : o.push(void 0);
            return o
        },
        e.prototype.find = function(e) {
            return Widget.find(e) || Panel.find(e)
        },
        e.prototype.first = function() {
            return this._items[0]
        },
        e.prototype.attributes = function() {
            var e, t, i, n, r, s, o, a;
            if (this._attributes) return this._attributes;
            for (this._attributes = [], this._selected = null, o = this.items(!0), i = 0, r = o.length; i < r; i++) for (t = o[i], a = t.inspectables(), n = 0, s = a.length; n < s; n++) e = a[n],
            this._attributes.indexOf(e) === -1 && this._attributes.push(e);
            return this._attributes
        },
        e.prototype.isSinglePanel = function() {
            return 1 === this._items.length && "panel" === this._items[0].name
        },
        e.prototype.isDraggable = function() {
            return this.attributes().indexOf("left") !== -1
        },
        e.prototype.panelStates = function() {
            return this.isSinglePanel() ? this._items[0].states() : []
        },
        e.prototype.canSetTheme = function() {
            return this.attributes().indexOf("th") !== -1
        },
        e.prototype.canSetText = function() {
            return this.attributes().indexOf("text") !== -1
        },
        e.prototype.canSetIcon = function() {
            return this.attributes().indexOf("icon") !== -1
        },
        e.prototype.canSetImage = function() {
            return this.attributes().indexOf("image") !== -1
        },
        e.prototype.canSetPosition = function() {
            return this.attributes().indexOf("left") !== -1 || this.attributes().indexOf("numeric") !== -1
        },
        e.prototype.canSetAttr = function(e) {
            return this.attributes().indexOf(e) !== -1
        },
        e.prototype.groupByGid = function() {
            var t, i, n, r, s, o, a, l;
            for (i = {},
            t = [], a = this._items, r = 0, s = a.length; r < s; r++) n = a[r],
            l = n.gid ? i[o = n.gid] || (i[o] = new e) : new e,
            l.itemLength() || t.push(l),
            l.push(n);
            return t
        },
        e.prototype.gids = function() {
            var e, t, i, n, r;
            for (e = [], n = this._items, t = 0, i = n.length; t < i; t++) r = n[t],
            e.indexOf(r.gid) === -1 && e.push(r.gid);
            return e
        },
        e.prototype.groupLinkCid = function() {
            var e, t, i, n, r;
            return MB.activePanel() ? (n = $(".panel.selected").find(".state.active").data("cid"), r = function() {
                var e, i, n, r;
                for (n = this._items, r = [], e = 0, i = n.length; e < i; e++) t = n[e],
                r.push(t.cid);
                return r
            }.call(this).sort().join(","), i = Link.select(function(e) {
                var t;
                return t = e.widget_cids.split(",").sort().join(","),
                e.state_cid === n && t === r
            }), i.length ? i[0].cid: null) : (e = this.gids(), 1 === e.length ? e[0] : null)
        },
        e.prototype.links = function() {
            var e;
            return function() {
                var t, i, n, r;
                for (n = this.gids(), r = [], t = 0, i = n.length; t < i; t++) e = n[t],
                e && r.push(Link.find(e));
                return r
            }.call(this).filter(function(e) {
                return e
            })
        },
        e.prototype.realL = function() {
            var e, t;
            return this._items.length ? (t = function() {
                var t, i, n, r;
                for (n = this._items, r = [], t = 0, i = n.length; t < i; t++) e = n[t],
                r.push(this._realIL(e));
                return r
            }.call(this), Math.min.apply(Math, t) + MB.canvasLeft()) : 0
        },
        e.prototype.realT = function() {
            var e, t;
            return this._items.length ? (t = function() {
                var t, i, n, r;
                for (n = this._items, r = [], t = 0, i = n.length; t < i; t++) e = n[t],
                r.push(this._realIT(e));
                return r
            }.call(this), Math.min.apply(Math, t) + MB.canvasTop()) : 0
        },
        e.prototype.realR = function() {
            var e, t;
            return this._items.length ? (t = function() {
                var t, i, n, r;
                for (n = this._items, r = [], t = 0, i = n.length; t < i; t++) e = n[t],
                r.push(this._realIR(e));
                return r
            }.call(this), Math.max.apply(Math, t) + MB.canvasLeft()) : 0
        },
        e.prototype.realB = function() {
            var e, t;
            return this._items.length ? (e = function() {
                var e, i, n, r;
                for (n = this._items, r = [], e = 0, i = n.length; e < i; e++) t = n[e],
                r.push(this._realIB(t));
                return r
            }.call(this), Math.max.apply(Math, e) + MB.canvasTop()) : 0
        },
        e.prototype.realW = function() {
            return this.realR() - this.realL()
        },
        e.prototype.realH = function() {
            return this.realB() - this.realT()
        },
        e.prototype.realRect = function() {
            return {
                left: this.realL() - MB.canvasLeft(),
                top: this.realT() - MB.canvasTop(),
                width: this.realW(),
                height: this.realH()
            }
        },
        e.prototype.l = function() {
            var e;
            return this._items.length ? Math.min.apply(Math,
            function() {
                var t, i, n, r;
                for (n = this._items, r = [], t = 0, i = n.length; t < i; t++) e = n[t],
                this._iv(e).position() && r.push(e.l());
                return r
            }.call(this)) + MB.canvasLeft() : 0
        },
        e.prototype.t = function() {
            var e;
            return this._items.length ? Math.min.apply(Math,
            function() {
                var t, i, n, r;
                for (n = this._items, r = [], t = 0, i = n.length; t < i; t++) e = n[t],
                this._iv(e).position() && r.push(e.t());
                return r
            }.call(this)) + MB.canvasTop() : 0
        },
        e.prototype.r = function() {
            var e;
            return this._items.length ? Math.max.apply(Math,
            function() {
                var t, i, n, r;
                for (n = this._items, r = [], t = 0, i = n.length; t < i; t++) e = n[t],
                this._iv(e).position() && r.push(e.r());
                return r
            }.call(this)) + MB.canvasLeft() : 0
        },
        e.prototype.b = function() {
            var e;
            return this._items.length ? Math.max.apply(Math,
            function() {
                var t, i, n, r;
                for (n = this._items, r = [], t = 0, i = n.length; t < i; t++) e = n[t],
                this._iv(e).position() && r.push(e.b());
                return r
            }.call(this)) + MB.canvasTop() : 0
        },
        e.prototype.w = function() {
            return this.r() - this.l()
        },
        e.prototype.h = function() {
            return this.b() - this.t()
        },
        e.prototype.getAttr = function(e) {
            var t, i, n, r;
            if ("left" === e && this._items.length) return 100 * (this.realL() - MB.canvasLeft()) / MB.scale();
            if ("top" === e && this._items.length) return 100 * (this.realT() - MB.canvasTop()) / MB.scale();
            for (r = this.items(!0), i = 0, n = r.length; i < n; i++) if (t = r[i], t.inspectables().indexOf(e) !== -1) return t[e];
            return ""
        },
        e.prototype.getColorAttr = function(e) {
            var t, i, n, r, s;
            for (s = this._items, n = 0, r = s.length; n < r; n++) if (i = s[n], "panel" !== i.name && i.inspectables().indexOf(e) !== -1) return t = document.getElementById("widget" + i.cid),
            WidgetManager[e](i, t);
            return ""
        },
        e.prototype.setAttr = function(e, t, i) {
            var n, r, s, o, a, l, c, d, u, h, p, f;
            if (null == i && (i = !0), o = this.items(i), "left" === e) return this.setRealL(t);
            if ("top" === e) return this.setRealT(t);
            for (p = [], a = 0, c = o.length; a < c; a++) s = o[a],
            s.inspectables().indexOf(e) !== -1 && (r = n = f = !1, "text" !== e && "bo" !== e && "fs" !== e && "lh" !== e && "padding" !== e && "bs" !== e || (r = s.autoWidth && s.width === s.minWidth(), n = s.autoHeight && s.height === s.minHeight()), s[e] = t, s.richedit && ("tc" === e && this.clearForeColor(s), "bg" === e && this.clearBackColor(s), "i" === e && this.clearFontStyle(s), "bo" === e && this.clearFontWeight(s), "td" === e && "underline" === t && this.clearUnderline(s), "td" === e && "line-through" === t && this.clearLineThrough(s)), "fs" === e && s.inspectables().indexOf("lh") !== -1 && (s.lh = Math.round(1.45 * t)), "text" !== e && "bo" !== e && "fs" !== e && "lh" !== e && "padding" !== e && "bs" !== e || (u = s.minWidth(), (r || s.width < u) && (f = !0, h = u - s.width, s.width = u, "center" === s.ha ? s.left -= h / 2 : "right" === s.ha && (s.left -= h)), d = s.minHeight(), (n || s.height < d) && (s.height = d, f = !0)), f && (l = Link.find(s.gid)) && l.reload(), "panel" === s.name ? p.push(PanelManager.design(s)) : p.push(WidgetManager.update(s)));
            return p
        },
        e.prototype.setTheme = function(e) {
            var t, i, n, r, s, o, a, l;
            for (t = $("#screen").data("cid"), a = Screen.find(t), l = a.sb(), s = this.items(!0), o = [], n = 0, r = s.length; n < r; n++) i = s[n],
            i.inspectables().indexOf("th") !== -1 && (i.setTheme(e), i.richedit && this.clearForeColor(i), WidgetManager.update(i), "navigation_bar" === i.name && l ? (l.setTheme(e), l.lsave(), o.push(WidgetManager.update(l))) : o.push(void 0));
            return o
        },
        e.prototype.setL = function(e) {
            var t, i, n, r, s, o;
            for (r = e + MB.canvasLeft() - this.l(), s = this._items, o = [], i = 0, n = s.length; i < n; i++) t = s[i],
            t.setL(t.l() + r),
            o.push(this._render(t));
            return o
        },
        e.prototype.setT = function(e) {
            var t, i, n, r, s, o;
            for (r = e + MB.canvasTop() - this.t(), s = this._items, o = [], i = 0, n = s.length; i < n; i++) t = s[i],
            t.setT(t.t() + r),
            o.push(this._render(t));
            return o
        },
        e.prototype.setRealL = function(e) {
            var t, i, n, r, s, o, a;
            for (a = this.getAttr("left"), r = e - a, s = this._selectedItems(), o = [], i = 0, n = s.length; i < n; i++) t = s[i],
            t.left += r,
            o.push(this._render(t));
            return o
        },
        e.prototype.setRealT = function(e) {
            var t, i, n, r, s, o, a;
            for (a = this.getAttr("top"), r = e - a, s = this._selectedItems(), o = [], i = 0, n = s.length; i < n; i++) t = s[i],
            t.top += r,
            o.push(this._render(t));
            return o
        },
        e.prototype.clearForeColor = function(e) {
            return e.text = e.text.replace(/\<font.*?\>(.*?)\<\/font\>/g, "$1")
        },
        e.prototype.clearBackColor = function(e) {
            return e.text = e.text.replace(/\<span.*?\>(.*?)\<\/span\>/g, "$1")
        },
        e.prototype.clearFontStyle = function(e) {
            return e.text = e.text.replace(/\<i\>(.*?)\<\/i\>/g, "$1")
        },
        e.prototype.clearFontWeight = function(e) {
            return e.text = e.text.replace(/\<b\>(.*?)\<\/b\>/g, "$1")
        },
        e.prototype.clearLineThrough = function(e) {
            return e.text = e.text.replace(/\<strike\>(.*?)\<\/strike\>/g, "$1")
        },
        e.prototype.clearUnderline = function(e) {
            return e.text = e.text.replace(/\<u\>(.*?)\<\/u\>/g, "$1")
        },
        e.prototype.removeShadow = function() {
            var e, t, i, n, r;
            for (n = this._items, r = [], t = 0, i = n.length; t < i; t++) e = n[t],
            r.push(this._iv(e).find(".shadow").remove());
            return r
        },
        e.prototype.renderShadow = function() {
            var e, t, i, n, r, s;
            if (MB.preference().link_line) {
                for (r = this._items, s = [], i = 0, n = r.length; i < n; i++) e = r[i],
                t = this._iv(e),
                t.find(".shadow").length ? s.push(void 0) : s.push(t.append("<div class='shadow'></div>"));
                return s
            }
        },
        e.prototype.bg = function() {
            return this.getColorAttr("bg")
        },
        e.prototype.tc = function() {
            return this.getColorAttr("tc")
        },
        e.prototype.bc = function() {
            return this.getColorAttr("bc")
        },
        e.prototype.sc = function() {
            return this.getAttr("sc")
        },
        e.prototype.tsc = function() {
            return this.getAttr("tsc")
        },
        e.prototype.maxZ = function() {
            var e;
            return Math.max.apply(Math,
            function() {
                var t, i, n, r;
                for (n = this._items, r = [], t = 0, i = n.length; t < i; t++) e = n[t],
                e.selected && "sticky" !== e.name && r.push(e.z);
                return r
            }.call(this))
        },
        e.prototype.itemLength = function() {
            return this._items.length
        },
        e.prototype.isContainer = function() {
            return 1 === this._items.length && this._items[0].isContainer()
        },
        e.prototype.moveable = function() {
            return this._items.length > 1 || this._items[0].moveable
        },
        e.prototype._render = function(e) {
            return "panel" === e.name ? PanelManager.design(e) : WidgetManager.renderOutline(e)
        },
        e.prototype._realIL = function(e) {
            return e.ro ? this._iv(e).position().left: e.l()
        },
        e.prototype._realIT = function(e) {
            return e.ro ? this._iv(e).position().top: e.t()
        },
        e.prototype._realIR = function(e) {
            return e.ro ? this._iv(e).position().left + 2 * (e.l() + this._iv(e).outerWidth() / 2 - this._iv(e).position().left) : e.r()
        },
        e.prototype._realIB = function(e) {
            return e.ro ? this._iv(e).position().top + 2 * (e.t() + this._iv(e).outerHeight() / 2 - this._iv(e).position().top) : e.b()
        },
        e.prototype._realIW = function(e) {
            return e.ro ? 2 * (e.l() + this._iv(e).outerWidth() / 2 - this._iv(e).position().left) : e.w()
        },
        e.prototype._realIH = function(e) {
            return e.ro ? 2 * (e.t() + this._iv(e).outerHeight() / 2 - this._iv(e).position().top) : e.h()
        },
        e.prototype._iv = function(e) {
            var t, i;
            return t = this.panelCid,
            MB.activePanel() && (t || (t = $(".panel.selected").data("cid"))),
            t || (t = ""),
            i = "panel" !== e.name ? $("#widget" + e.cid + t) : $("#panel" + e.cid)
        },
        e
    } ()
}.call(this),
function() {
    this.KeyManager = function() {
        function e() {
            key.filter = function(e) {
                var t;
                return t = (e.target || e.srcElement).tagName,
                "INPUT" !== t && "SELECT" !== t && "TEXTAREA" !== t && !MB.f.editing && MB.selection && !MB.selection.getAttr("locked")
            },
            key("esc",
            function() {
                return MB.selection && MB.selection.clear(),
                !1
            }),
            key("backspace, delete",
            function(e) {
                if (e.preventDefault(), !MB.selection.isEmpty()) return $("body").trigger("selection:delete"),
                !1
            }),
            key("f2",
            function() {
                var e;
                if (1 === MB.selection.groupedItems.itemLength()) return e = MB.selection.groupedItems.first(),
                e.inspectables().indexOf("text") !== -1 ? MB.selection.startEdit() : void 0
            }),
            key("h, left",
            function() {
                if (MB.currentProject && !$("#preview").is(":visible")) return MB.selection.isEmpty() ? document.getElementById("screens").scrollLeft += 10 : MB.selection.moveLeft(),
                !1
            }),
            key("l, right",
            function() {
                if (MB.currentProject && !$("#preview").is(":visible")) return MB.selection.isEmpty() ? document.getElementById("screens").scrollLeft -= 10 : MB.selection.moveRight(),
                !1
            }),
            key("k, up",
            function() {
                if (MB.currentProject && !$("#preview").is(":visible")) return MB.selection.isEmpty() ? document.getElementById("screens").scrollTop -= 10 : MB.selection.moveUp(),
                !1
            }),
            key("j, down",
            function() {
                if (MB.currentProject && !$("#preview").is(":visible")) return MB.selection.isEmpty() ? document.getElementById("screens").scrollTop += 10 : MB.selection.moveDown(),
                !1
            }),
            key("v",
            function() {
                var e;
                if (!MB.selection.isEmpty()) return e = MB.selection.groupedItems.getAttr("v"),
                MB.selection.setAttr("v", !e),
                MB.renderToolboxes(),
                !1
            }),
            key("shift+left",
            function() {
                if (MB.currentProject && !$("#preview").is(":visible")) return MB.selection.isEmpty() ? document.getElementById("screens").scrollLeft += 100 : MB.selection.moveLeft(10),
                !1
            }),
            key("shift+right",
            function() {
                if (MB.currentProject && !$("#preview").is(":visible")) return MB.selection.isEmpty() ? document.getElementById("screens").scrollLeft -= 100 : MB.selection.moveRight(10),
                !1
            }),
            key("shift+up",
            function() {
                if (MB.currentProject && !$("#preview").is(":visible")) return MB.selection.isEmpty() ? document.getElementById("screens").scrollTop -= 100 : MB.selection.moveUp(10),
                !1
            }),
            key("shift+down",
            function() {
                if (MB.currentProject && !$("#preview").is(":visible")) return MB.selection.isEmpty() ? document.getElementById("screens").scrollTop += 100 : MB.selection.moveDown(10),
                !1
            }),
            key("command+a, ctrl+a",
            function() {
                if (MB.project() && !$("#preview").is(":visible")) return $("body").trigger("selection:selectAll"),
                !1
            }),
            key("command+c, ctrl+c",
            function() {
                if (!MB.selection.isEmpty()) return $("body").trigger("selection:copy"),
                MB.isChrome() && MB.clearPasteBoard(),
                !1
            }),
            key("command+d, ctrl+d",
            function() {
                if (!MB.selection.isEmpty()) return $("body").trigger("selection:duplicate", [!1]),
                !1
            }),
            key("command+shift+d, ctrl+shift+d",
            function() {
                if (!MB.selection.isEmpty()) return $("body").trigger("selection:duplicate", [!0]),
                !1
            }),
            $(document).on("paste",
            function(e) {
                if (MB.f.editing && e.preventDefault(), MB.project() && !$("#preview").is(":visible") && (MB.f.editing || MB.isChrome())) return $("body").trigger("selection:paste", [e, !1])
            }),
            MB.isChrome() || key("command+v, ctrl+v",
            function(e) {
                if (MB.project() && !$("#preview").is(":visible") && !MB.f.editing) return $("body").trigger("selection:paste", [e, !1]),
                !1
            }),
            key("command+shift+v, ctrl+shift+v",
            function(e) {
                if (MB.project() && !$("#preview").is(":visible")) return $("body").trigger("selection:paste", [e, !0]),
                !1
            }),
            key("command+x, ctrl+x",
            function() {
                if (!MB.selection.isEmpty()) return $("body").trigger("selection:cut"),
                MB.isChrome() && MB.clearPasteBoard(),
                !1
            }),
            key("command+z, ctrl+z",
            function() {
                if (MB.project() && !$("#preview").is(":visible")) return $("body").trigger("undoStack:undo"),
                !1
            }),
            key("command+y, ctrl+y",
            function() {
                if (MB.project() && !$("#preview").is(":visible")) return $("body").trigger("undoStack:redo"),
                !1
            }),
            key("command+s, ctrl+s",
            function(e) {
                if (MB.project() && !$("#preview").is(":visible")) return e.preventDefault(),
                MB.workspace.autoSaver.save()
            }),
            key("]",
            function() {
                if (MB.project() && !$("#preview").is(":visible")) return MB.rightNav.handleToggle()
            }),
            key("4",
            function() {
                if (MB.project() && !$("#preview").is(":visible")) return MB.ga("send", "event", "feature", "\u70b9\u51fb\u4e86\u72b6\u6001\u5217\u8868"),
                MB.mp("\u70b9\u51fb\u4e86\u72b6\u6001\u5217\u8868"),
                MB.renderRightNav("states")
            }),
            key("5",
            function() {
                if (MB.project() && !$("#preview").is(":visible")) return MB.renderRightNav("screens")
            }),
            key("6",
            function() {
                if (MB.project() && !$("#preview").is(":visible")) return MB.ga("send", "event", "feature", "\u70b9\u51fb\u4e86\u7ec4\u4ef6\u5217\u8868"),
                MB.mp("\u70b9\u51fb\u4e86\u7ec4\u4ef6\u5217\u8868"),
                MB.renderRightNav("components")
            }),
            key("command+;, ctrl+;",
            function() {
                var e, t, i, n;
                if (MB.project() && !$("#preview").is(":visible")) {
                    for (i = MB.currentProject.cscreens(), e = 0, t = i.length; e < t; e++) n = i[e],
                    n.expandable() && (n.expanded = !0, n.lsave());
                    return MB.renderRightNav(),
                    MB.renderLinks()
                }
            }),
            key("command+', ctrl+'",
            function() {
                var e, t, i, n;
                if (MB.project() && !$("#preview").is(":visible")) {
                    for (i = MB.currentProject.cscreens(), e = 0, t = i.length; e < t; e++) n = i[e],
                    n.expandable() && (n.expanded = !1, n.lsave());
                    return MB.renderRightNav(),
                    MB.renderLinks()
                }
            }),
            key("command+-, ctrl+-",
            function(e) {
                if (MB.project() && !$("#preview").is(":visible")) return e.preventDefault(),
                MB.toolBar.zoom( - 1)
            }),
            key("command+=, ctrl+=",
            function(e) {
                if (MB.project() && !$("#preview").is(":visible")) return e.preventDefault(),
                MB.toolBar.zoom(1)
            }),
            key("command+g, ctrl+g",
            function(e) {
                if (e.preventDefault(), !MB.selection.isEmpty()) return $("body").trigger("selection:group")
            }),
            key("command+u, ctrl+u",
            function() {
                if (!MB.selection.isEmpty()) return $("body").trigger("selection:ungroup")
            }),
            key("a",
            function() {
                if (MB.project() && !$("#preview").is(":visible")) return MB.toolBar.handleAssetsManager(),
                !1
            })
        }
        return e
    } ()
}.call(this),
function() {
    this.PanelManager = function() {
        function e() {
            $("#design").on("click", ".panel",
            function(t) {
                return e.select(t)
            }),
            $("#design").on("click", ".pscontainer > .widget",
            function(t) {
                return e.selectWidget(t)
            })
        }
        return e.select = function(t) {
            var i, n, r;
            if (!$(t.target).closest(".panel").hasClass("selected")) return n = Panel.find($(".panel.selected").data("cid")),
            n && e.deactivate(n),
            t.preventDefault(),
            t.stopPropagation(),
            i = $(t.target).closest(".panel").attr("data-cid"),
            r = Panel.find(i),
            t.shiftKey ? $("body").trigger("selection:append", [r]) : t.ctrlKey || t.metaKey ? MB.penetrateSelect(t, r.cid) : ($("body").trigger("selection:clear"), $("body").trigger("selection:select", [[r]])),
            MB.selection.flagBucket.selectingMoved = !1,
            MB.selection.flagBucket.selectEffect = !1
        },
        e.selectWidget = function(e) {
            var t, i;
            if ($(e.target).closest(".panel").hasClass("selected")) return e.preventDefault(),
            e.stopPropagation(),
            t = $(e.target).closest(".widget").attr("data-cid"),
            i = Widget.find(t),
            e.shiftKey ? $("body").trigger("selection:append", [i]) : ($("body").trigger("selection:clear"), $("body").trigger("selection:select", [[i]]))
        },
        e.activate = function(e, t) {
            var i, n;
            return i = new GroupedItems,
            i.push(e),
            MB.selection.clear(),
            MB.toolboxes.setState({
                activePanelState: t,
                groupedItems: i
            }),
            $("#panel" + e.cid + " .state.active").removeClass("active"),
            n = document.getElementById("state" + e.cid + t),
            n.className += " active",
            $("#panel" + e.cid).addClass("selected"),
            MB.renderLinks()
        },
        e.deactivate = function(e) {
            var t;
            return $("#panel" + e.cid).removeClass("selected"),
            $("#panel" + e.cid + " .state.active").removeClass("active"),
            t = document.getElementById("state" + e.cid + e.mainState().cid),
            t.className += " active",
            MB.selection.clear(),
            MB.renderLinks(),
            MB.toolboxes.setState({
                activePanelState: null,
                groupedItems: MB.selection.groupedItems
            })
        },
        e.design = function(e) {
            var t, i, n, r;
            if (n = document.getElementById("panel" + e.cid)) return r = e.mainState(),
            t = $(n).find(".state.active"),
            i = $(n).find("#state" + e.cid + r.cid),
            t.data("cid") !== r.cid && (t.removeClass("active"), i.addClass("active")),
            n.style.top = e.t() + "px",
            n.style.left = e.l() + "px",
            n.style.width = e.w() + "px",
            n.style.height = e.h() + "px",
            e.v ? (n.style.zIndex = e.fixed ? Widget.MAXZ + e.z: e.z, n.style.opacity = 1) : (n.style.zIndex = -Widget.MAXZ, n.style.opacity = .4)
        },
        e.remove = function(e, t) {
            var i;
            if (null == t && (t = !0), $("#panel" + e).remove(), i = Panel.find(e)) return i.ldestroy(t)
        },
        e
    } ()
}.call(this),
function() {
    this.ScreenManager = function() {
        function e() {
            var t, i;
            t = $("#design"),
            i = $("#screen"),
            t.on("orient:update",
            function(e) {
                return function(t) {
                    return e.updateOrientation(t)
                }
            } (this)),
            t.on("carrier:update",
            function(e) {
                return function(t, i) {
                    return e.updateCarrier(i)
                }
            } (this)),
            t.on("status_bar:update",
            function(t, i) {
                return e.updateStatusBar(i)
            }),
            t.on("screens:setBgColor",
            function(e) {
                return function(t, i) {
                    return e.setBgColor(i)
                }
            } (this)),
            t.on("click", ".sbgcolor",
            function(e) {
                return function(t) {
                    return e.chooseBgColor(t)
                }
            } (this)),
            t.on("click", ".sbgimage",
            function(e) {
                return function(t) {
                    return e.chooseBgImage(t)
                }
            } (this)),
            t.on("click", ".enlarge",
            function(e) {
                return function() {
                    return i.enableTransition("0.3s"),
                    e.updateSize(0, 80, !0, !0),
                    MB.renderLinks(!0)
                }
            } (this)),
            t.on("click", ".reduce",
            function(e) {
                return function() {
                    return i.enableTransition("0.3s"),
                    e.updateSize(0, -80, !0, !0),
                    MB.renderLinks(!0)
                }
            } (this)),
            t.on("screen:restore",
            function(e) {
                return function(t, i) {
                    return e.restoreScreen(i)
                }
            } (this)),
            t.on("click", "#new_screen",
            function(t) {
                return e.add(t)
            }),
            t.on("position:reset", e.resetPosition),
            $("body").sortable("#screen_list .sortable", Screen, e.sort),
            this.initScreenListDnD(),
            this.initCanvasDnd(),
            this.initScreenResizer()
        }
        return e.resetPosition = function() {
            var e;
            if (e = document.getElementById("screens")) return e.scrollTop = 0,
            e.scrollLeft = ($("#screens .screen_container").width() - e.clientWidth) / 2
        },
        e.append = function(e, t) {
            var i, n, r, s, o;
            if (o = Screen.find($("#screen").data("cid"))) {
                for (s = o.citems(), n = 0, r = s.length; n < r; n++) if (i = s[n], i.timestamp > t) return void("panel" === i.name ? $("#panel" + i.cid).before(e) : $("#widget" + i.cid).before(e));
                return $("#canvas").append(e)
            }
        },
        e.appendPanel = function(e) {
            return this.append(MB.Panel(e), e.timestamp)
        },
        e.appendWidget = function(e) {
            return this.append(MB.widget(e), e.timestamp)
        },
        e.activate = function(t) {
            var i, n;
            return MB.currentScreen = t,
            MB.selection.clear(),
            i = $("#canvas"),
            n = $("#screen"),
            i.html(""),
            n.data("cid", t.cid),
            n.attr("class", "screen " + t.orient() + " " + t.device() + " x" + t.scale()),
            t.setState("default"),
            this.render(t),
            n.css({
                width: t.outerWidth(),
                height: t.outerHeight(),
                marginLeft: 0 - t.outerWidth() / 2
            }),
            n.addClass("active"),
            $("#text_editor").remove(),
            MB.preference().grid && i.addClass("grid"),
            n.find(".actions .sbgcolor").css("background-color", t.bgcolor),
            MB.toolboxes.setState({
                activePanelState: null,
                groupedItems: MB.selection.groupedItems
            }),
            MB.renderRightNav(),
            MB.rightNav.stateList.activateGlobal(),
            $("#design").trigger("slider:update"),
            e.updateStatusBar( !! $("#screen .status_bar").length),
            e.updateScreenContainer(),
            MB.linkCaches = {},
            MB.renderLinks(),
            e.renderRuler(t),
            MB.preference().grid ? $("#screen .sgrid").show() : $("#screen .sgrid").hide(),
            $("#screen .actions a").tooltip({
                container: "body",
                trigger: "hover focus click"
            }),
            MB.renderToolbar()
        },
        e.renderRuler = function(e) {
            var t, i, n;
            if (MB.ruler && MB.ruler.destroy(), $("#screens").length > 0) return MB.preference().ruler ? (t = $("#canvas").offset(), i = $("#screens").offset(), n = 24, MB.ruler = $("#screens").getRuler({
                bgColor: "white",
                fgCOlor: "#333",
                shadowColor: "#e9e9e9",
                horLineValue: e.halignLines(),
                verLineValue: e.valignLines(),
                startX: i.left + n - t.left - $("#screens")[0].scrollLeft,
                startY: i.top + n - t.top - $("#screens")[0].scrollTop,
                perWidth: 10 * MB.scale() / 100,
                thick: n
            }), MB.ruler.setSelect(0, 0, e.width, e.height), $(".ltoggle").css("right", -37), $("#toolboxbar .tools").css("top", 23)) : ($(".ltoggle").css("right", -15), $("#toolboxbar .tools").css("top", 0)),
            $(document.body).unbind("setAlignLine"),
            $(document.body).on("setAlignLine",
            function(e, t) {
                var i;
                return i = MB.currentScreen.sa(),
                i.h = t.horValue.join(","),
                i.v = t.verValue.join(","),
                i.lsave()
            }),
            $("#screens").onScroll(this.onScroll)
        },
        e.onScroll = function() {
            if (ReactDOM.unmountComponentAtNode(document.getElementById("context-menu")), $("body").trigger("selection:render"), MB.renderLinks(!0), MB.ruler) return MB.ruler.update()
        },
        e.render = function(e) {
            var t, i, n, r, s, o, a, l, c, d;
            if (e) {
                for (t = $("#canvas"), t.css({
                    "background-color": e.bgcolor,
                    "background-image": e.bgimage ? "url(" + e.getRealBgImage() + ")": "none"
                }), n = '<div class="sgrid" data-selectable="true">\n  <div class="first-page-divider"></div>\n</div>\n<div class="vertical_line left"></div>\n<div class="vertical_line right"></div>\n<div class="vertical_line center"></div>\n<div class="horizon_line top"></div>\n<div class="horizon_line bottom"></div>\n<div class="horizon_line center"></div>', i = [], c = e.citems(), s = 0, a = c.length; s < a; s++) r = c[s],
                r.setState(e.state_cid, !0),
                "panel" === r.name ? r.valid() && (n += MB.Panel(r)) : n += MB.widget(r),
                ["sticky"].indexOf(r.name) !== -1 && i.push(r);
                for (t.html(n), o = 0, l = i.length; o < l; o++) d = i[o],
                WidgetManager.design(d);
                return this.renderFirstPageDivider()
            }
        },
        e.renderFirstPageDivider = function(e) {
            var t, i, n;
            return t = $("#screen .first-page-divider"),
            e = e || Screen.find($("#screen").data("cid")),
            n = Math.floor(e.height * (e.scale() / 100)),
            i = Math.floor(e.dH()),
            n > i ? t.css("top", i).show() : t.hide()
        },
        e.updateStatusBar = function(e) {
            var t, i;
            return t = $("#canvas"),
            e ? (t.addClass("sb"), $(".istatus_bar").hide(), i = $("#screen .status_bar span.text").text(), MB.COMPONENTS.status_bar.text = MB.COMPONENTS.status_bar.tb_text = i, $("#components .tstatus_bar span").html(i)) : (t.removeClass("sb"), MB.project().template ? void 0 : $(".istatus_bar").show())
        },
        e.updateScreenContainer = function() {
            var e;
            return e = document.getElementById("screens"),
            e.scrollTop = 0,
            e.scrollLeft = ($("#screens .screen_container").width() - $("#screens").width()) / 2
        },
        e.updateState = function(e, t) {
            var i, n, r, s, o, a, l, c, d, u;
            for (l = e.cwidgets(), i = 0, s = l.length; i < s; i++) u = l[i],
            u.setState(t, !0),
            (r = Link.find(u.gid)) && r.reload(),
            WidgetManager.update(u);
            for (c = e.cpanels(), d = [], n = 0, o = c.length; n < o; n++) a = c[n],
            a.setState(t, !0),
            (r = Link.find(a.gid)) && r.reload(),
            d.push(PanelManager.design(a));
            return d
        },
        e.remove = function(t) {
            var i;
            return t.cid === MB.currentScreen.cid && (i = Screen.find($("#sli" + t.cid).prev().data("cid")), i || (i = t.parent_cid ? Screen.find(t.parent_cid) : MB.project().homeScreen()), e.activate(i)),
            MB.renderRightNav(),
            MB.renderLinks()
        },
        e.add = function(e) {
            var t, i, n;
            if (e.preventDefault(), !MB.exceedWidgetLimit(MB.currentProject)) return n = MB.project().rootScreens(),
            i = MB.currentScreen.position + 1,
            t = I18N.screen + " " + (n.length + 1),
            this.newScreen(t, i, MB.currentScreen.parent_cid, MB.currentScreen.orientation, !0)
        },
        e.newScreen = function(e, t, i, n, r, s) {
            var o, a, l, c, d, u;
            for (null == s && (s = !0), o = MB.project().template ? "transparent": "#F0F0F2", c = new Screen({
                name: e,
                project_cid: MB.project().cid,
                parent_cid: i,
                orientation: n,
                cid: "s" + Math.uuid(10, 16) + (new Date).valueOf(),
                bgcolor: o,
                position: t
            }), c.lsave(), d = MB.project().cscreens(), a = 0, l = d.length; a < l; a++) u = d[a],
            u.cid !== c.cid && u.parent_cid === c.parent_cid && u.position >= c.position && (u.position += 1, u.lsave());
            return r && !MB.project().template && c.setup(null),
            s && (MB.EditableSpan.expecting = c.cid),
            this.activate(c),
            MB.renderRightNav(),
            c
        },
        e.prototype.initScreenListDnD = function() {
            return $("body").on("dragleave", "#screen_list",
            function(e) {
                if ($(e.target).closest(".item").length) return $(e.target).closest(".item").removeClass("linking")
            }),
            $("body").on("dragover", "#screen_list",
            function(e) {
                if (e.preventDefault(), e.originalEvent.dataTransfer.dropEffect = "copy", $(e.target).closest(".item").length) return $(e.target).closest(".item").addClass("linking")
            }),
            $("body").on("drop", "#screen_list",
            function(t) {
                return function(i) {
                    var n, r;
                    if (i.stopPropagation(), i.preventDefault(), n = i.originalEvent.dataTransfer.files, n.length) return MB.mp("\u521b\u5efa\u4e86\u5355\u56fe\u9875\u9762"),
                    $("#screen_list .item.linking").removeClass("linking"),
                    r = $(i.target).closest(".sli"),
                    r.hasClass("last_child") && (r = r.prev()),
                    r.length || (r = $("#screen_list > .sli").last()),
                    r = Screen.find(r.data("cid")),
                    Asset.createFromFiles(n,
                    function(i) {
                        var n, s, o;
                        return n = i.name.replace(/\.[^\.]+$/, ""),
                        s = e.newScreen(n, r.position + 1, r.parent_cid, MB.currentScreen.orientation, !1, !1),
                        o = WidgetManager.newImageView(i, 0, 0, s),
                        $("#design").trigger("height:adjust"),
                        t.updateSize(0, o.height - s.height, !0, !1)
                    })
                }
            } (this))
        },
        e.sort = function(e, t, i) {
            var n, r, s, o, a, l, c, d;
            for (d = Screen.find(e), d.position = t, d.parent_cid = i, d.lsave(), a = d.parent_cid ? $("#children" + d.parent_cid + " > .sli") : $("#screen_list > .sli"), r = 1, s = 0, o = a.length; s < o; s++) n = a[s],
            c = Screen.find($(n).data("cid")),
            r === t && (r += 1),
            c.cid !== d.cid && (l = c.position, c.position = r, l !== c.position && c.lsave(), r += 1);
            return MB.renderRightNav(),
            MB.renderLinks()
        },
        e.prototype.updateCarrier = function(e) {
            return MB.COMPONENTS.status_bar.text = MB.COMPONENTS.status_bar.tb_text = e,
            $("#components .tstatus_bar span").html(e)
        },
        e.prototype.updateOrientation = function() {
            var t, i, n, r, s, o, a, l;
            if (!this.inTransition) {
                for (this.inTransition = !0, s = $("#screen").hasClass("portrait") ? "landscape": "portrait", i = $("#screen").data("cid"), a = Screen.find(i), a.setOrientation(s), a.lsave(), o = a.cwidgets(), n = 0, r = o.length; n < r; n++) l = o[n],
                l.isFullWidth() && (l.setW(a.width), "keyboard" === l.name && (l.height = a.kbDH()), l.lsave(), WidgetManager.update(l));
                return $(".widget").hide(),
                $("#links").hide(),
                t = $("#screen"),
                t.hasClass("portrait") ? t.removeClass("portrait").addClass("landscape") : t.removeClass("landscape").addClass("portrait"),
                t.css({
                    width: a.outerWidth() + "px",
                    "margin-left": 0 - a.outerWidth() / 2 + "px",
                    height: a.outerHeight() + "px"
                }),
                setTimeout(function(t) {
                    return function() {
                        return $(".widget").show(),
                        $("#links").show(),
                        MB.renderLinks(),
                        $("#design").trigger("slider:update"),
                        t.inTransition = !1,
                        e.renderRuler(MB.currentScreen),
                        e.renderFirstPageDivider()
                    }
                } (this), 300)
            }
        },
        e.prototype.initCanvasDnd = function() {
            return $("#design").on("dragleave", "#screens",
            function() {
                return $(".canvas").removeClass("hover")
            }),
            $("#design").on("dragover", "#screens",
            function(e) {
                return e.stopPropagation(),
                e.preventDefault(),
                $("#canvas").addClass("hover"),
                e.originalEvent.dataTransfer.dropEffect = "copy"
            }),
            $("#design").on("drop", "#screens",
            function(e) {
                return function(t) {
                    return t.stopPropagation(),
                    t.preventDefault(),
                    MB.globalStateAlert() ? void $("#canvas").removeClass("hover") : e.dropImage(t)
                }
            } (this))
        },
        e.prototype.dropImage = function(e) {
            var t, i, n, r;
            return $("#canvas").removeClass("hover"),
            i = e.originalEvent.pageX - MB.canvasLeft(),
            r = e.originalEvent.pageY - MB.canvasTop(),
            t = e.originalEvent.dataTransfer.files,
            n = Screen.find($("#screen").data("cid")),
            Asset.createFromFiles(t,
            function(e) {
                var t;
                return t = WidgetManager.newImageView(e, i, r, n),
                MB.trigger("undoStack:add", [null, [t.dup()]]),
                MB.selection.clear(),
                MB.trigger("selection:select", [[t]]),
                $("#design").trigger("height:adjust"),
                r += e.height
            })
        },
        e.prototype.restoreScreen = function(e) {
            var t;
            if (t = Screen.find(e.cid)) return e.width !== t.width || e.height !== t.height ? (this.updateSize(e.width - t.width, e.height - t.height, !0, !1), $("#screen").css("margin-left", 0 - e.outerWidth() / 2 + "px"), MB.renderLinks(!0)) : e.bgcolor !== t.bgcolor && ($(".sbgcolor").css("background-color", e.bgcolor), $("#canvas").css("background-color", e.bgcolor), t.bgcolor = e.bgcolor),
            e.bgimage ? ($("#canvas").css("background-image", "url(" + e.getRealBgImage() + ")"), t.bgimage = e.bgimage) : ($("#canvas").css("background-image", ""), t.bgimage = ""),
            t.lsave()
        },
        e.prototype.updateSize = function(t, i, n, r, s) {
            var o, a, l, c, d, u, h, p, f;
            if (o = $("#screen"), p = Screen.find($("#screen").data("cid")), a = [p.dup()], u = p.height, p.height += i, d = Math.round(100 * p.dH() / MB.scale()), MB.project().template || MB.project().combo) p.width += t,
            p.height < 10 && (p.height = 10),
            p.width < 10 && (p.width = 10),
            s && (i && (p.height = 10 * Math.round(p.height / 10)), t && (p.width = 10 * Math.round(p.width / 10)));
            else for (s && (p.height = 10 * Math.round(p.height / 10)), p.height < d && (i = d - u, p.height = d), h = p.cwidgets(), l = 0, c = h.length; l < c; l++) f = h[l],
            f.inFooter() && (f.top && (f.top += i), n && f.lsave(), WidgetManager.renderOutline(f));
            return n && (p.lsave(), (MB.project().template || MB.project().combo) && MB.project().updatePanelSize(p.width, p.height)),
            r && $("body").trigger("undoStack:add", [a, [p.dup()]]),
            o.outerHeight(p.outerHeight()),
            o.outerWidth(p.outerWidth()),
            MB.ruler && MB.ruler.setSelect(0, 0, 100 * p.w() / MB.scale(), 100 * p.h() / MB.scale()),
            e.renderFirstPageDivider(),
            p
        },
        e.prototype.initScreenResizer = function() {
            return $(document).on("mousedown", ".screen .resizer",
            function(e) {
                return function(t) {
                    var i, n;
                    return e.origX = $(t.target).closest(".resizer_x").length ? t.pageX: 0,
                    e.origY = $(t.target).closest(".resizer_y").length ? t.pageY: 0,
                    n = $("#screens"),
                    i = $("#screen"),
                    e.scrollStartL = n[0].scrollLeft,
                    e.scrollStartT = n[0].scrollTop,
                    $("body").trigger("selection:clear"),
                    i.disableTransition()
                }
            } (this)),
            $(document).on("mousemove",
            function(t) {
                return function(i) {
                    var n, r, s, o, a, l, c, d;
                    if (t.origY || t.origX) return n = $("#screens"),
                    l = n[0].scrollLeft - t.scrollStartL,
                    c = n[0].scrollTop - t.scrollStartT,
                    o = t.origY ? Math.round(100 * (i.pageY - t.origY + c) / MB.scale()) : 0,
                    s = t.origX ? Math.round(100 * (i.pageX - t.origX + l) / MB.scale()) : 0,
                    a = t.updateSize(s, o, !1, !1, i.shiftKey),
                    d = a.width,
                    r = a.height,
                    e.renderFirstPageDivider(a),
                    $("#screen .resizer span.tip").text(d + "x" + r)
                }
            } (this)),
            $(window).mouseup(function(t) {
                return function(i) {
                    var n, r, s, o, a, l;
                    if (t.origY || t.origX) return n = $("#screen"),
                    a = $("#screens")[0].scrollLeft - t.scrollStartL,
                    l = $("#screens")[0].scrollTop - t.scrollStartT,
                    s = t.origY ? Math.round(100 * (i.pageY - t.origY + l) / MB.scale()) : 0,
                    r = t.origX ? Math.round(100 * (i.pageX - t.origX + a) / MB.scale()) : 0,
                    t.origY = t.origX = null,
                    o = t.updateSize(r, s, !0, !0, i.shiftKey),
                    o.detectConflict(),
                    n.css("margin-left", 0 - o.outerWidth() / 2),
                    n.find(".resizer span.tip").text(I18N.drag_to_resize),
                    n.enableTransition("0.3s"),
                    setTimeout(function() {
                        if (MB.renderLinks(!0), MB.project().template || MB.project().combo) return e.renderRuler(MB.currentScreen)
                    },
                    500)
                }
            } (this))
        },
        e.prototype.chooseBgColor = function(e) {
            return e.stopPropagation(),
            MB.selection.clear(),
            MB.toolboxes.setState({
                pickColorFor: "screen"
            })
        },
        e.prototype.setBgColor = function(e) {
            var t, i, n, r;
            return t = $("body"),
            i = $("#canvas"),
            $(".sbgcolor").css("background-color", e),
            i.css("background-color", e),
            r = Screen.find($("#screen").data("cid")),
            n = [r.dup()],
            r.bgcolor = e,
            r.bgimage = "",
            r.lsave(),
            i.css("background-image", ""),
            t.trigger("undoStack:add", [n, [r.dup()]])
        },
        e.prototype.chooseBgImage = function(e) {
            var t;
            return e.stopPropagation(),
            MB.selection.clear(),
            t = Screen.find(MB.currentScreen.cid),
            MB.renderAssetsManager(t)
        },
        e
    } ()
}.call(this),
function() {
    this.Selection = function() {
        function e() {
            this.groupedItems = new GroupedItems,
            $("body").on("selection:clear",
            function(e) {
                return function() {
                    return e.clear()
                }
            } (this)),
            $("body").on("selection:append",
            function(e) {
                return function(t, i) {
                    return e.append([i])
                }
            } (this)),
            $("body").on("selection:select",
            function(e) {
                return function(t, i) {
                    return e.select(i)
                }
            } (this)),
            $("body").on("selection:selectAll",
            function(e) {
                return function() {
                    return e.selectAll()
                }
            } (this)),
            $("body").on("selection:delete",
            function(e) {
                return function() {
                    return e.remove()
                }
            } (this)),
            $("body").on("selection:render",
            function() {
                return function() {
                    return MB.renderSelections()
                }
            } (this)),
            $("body").on("selection:save",
            function(e) {
                return function() {
                    return e.undoableSave()
                }
            } (this)),
            $("body").on("selection:copy",
            function(e) {
                return function() {
                    return e.copy()
                }
            } (this)),
            $("body").on("selection:cut",
            function(e) {
                return function() {
                    return e.cut()
                }
            } (this)),
            $("body").on("selection:duplicate",
            function(e) {
                return function(t, i) {
                    return e.duplicate(t, i)
                }
            } (this)),
            $("body").on("selection:paste",
            function(e) {
                return function(t, i, n) {
                    return e.paste(i, n)
                }
            } (this)),
            $("body").on("selection:combo",
            function(e) {
                return function() {
                    return e.combo()
                }
            } (this)),
            $("body").on("selection:template",
            function(e) {
                return function() {
                    return e.template()
                }
            } (this)),
            $("body").on("selection:seticon",
            function(e) {
                return function(t, i) {
                    return e.setIcon(i)
                }
            } (this)),
            $("body").on("selection:group",
            function(e) {
                return function() {
                    return e.group()
                }
            } (this)),
            $("body").on("selection:ungroup",
            function(e) {
                return function() {
                    return e.ungroup()
                }
            } (this)),
            $("#design").on("dblclick", ".selection-item",
            function(e) {
                return function(t) {
                    var i, n, r;
                    if (i = $(t.target).closest(".selection-item").data("cid"), n = e.find(i), n && "panel" === n.name) {
                        if (r = Template.find(n.template_cid), r && !r.builtin) return r.owner_id === MB.user.id || r.owner_id === MB.project().owner_id ? $("#design").trigger("design:goto", [n.template_cid]) : alert(I18N.no_permission)
                    } else if (n && n.inspectables().indexOf("text") !== -1) return e.clear(),
                    e.select([n]),
                    e.startEdit()
                }
            } (this)),
            $("#design").on("click", ".selection-item",
            function(e) {
                return function(t) {
                    var i, n;
                    return t.preventDefault(),
                    t.stopPropagation(),
                    t.shiftKey || t.ctrlKey || t.metaKey ? e.reduct(t) : (n = $(t.target).closest(".selection-item"), "single-selection" !== n.attr("id") ? (i = e.find(n.data("cid")), e.clear(), e.select([i])) : void 0)
                }
            } (this)),
            $("#design").on("mousemove",
            function(e) {
                return function(t) {
                    return e.clientX = t.clientX,
                    e.clientY = t.clientY
                }
            } (this)),
            $("#design").on("contextmenu",
            function(e) {
                return function(t) {
                    if (!MB.f.editing && $(t.target).closest("#screens")[0]) return t.preventDefault(),
                    $(t.target).closest(".selection-item")[0] || e.clear(),
                    $("#context-menu").css({
                        left: t.clientX,
                        top: t.clientY
                    }),
                    ReactDOM.unmountComponentAtNode(document.getElementById("context-menu")),
                    MB.renderContextMenu({
                        left: t.clientX,
                        top: t.clientY
                    })
                }
            } (this)),
            this.initSelecting(),
            this.flagBucket = {}
        }
        return e.prototype.select = function(e, t) {
            var i, n, r, s, o, a, l, c, d, u, h, p, f;
            if (null == t && (t = !0), !e.length) return this.clear();
            for (this.groupedItems.clear(), i = [], e = function() {
                var t, s, o;
                for (o = [], t = 0, s = e.length; t < s; t++) n = e[t],
                r = this.find(n.cid),
                r && (r.selected = !0, this.groupedItems.push(r), i.push(r.cid)),
                o.push(r);
                return o
            }.call(this), s = 0, a = e.length; s < a; s++) if (r = e[s], r && r.gid) {
                for (h = Widget.findAllByAttribute("gid", r.gid), o = 0, l = h.length; o < l; o++) f = h[o],
                f.screen_cid === e[0].screen_cid && i.indexOf(f.cid) === -1 && (this.groupedItems.push(f), i.push(f.cid));
                for (p = Panel.findAllByAttribute("gid", r.gid), d = 0, c = p.length; d < c; d++) u = p[d],
                u.screen_cid === e[0].screen_cid && i.indexOf(u.cid) === -1 && (this.groupedItems.push(u), i.push(u.cid))
            }
            if (t) {
                if (MB.renderSelections(), MB.renderLinks(), MB.renderToolbar(), MB.activePanel()) return;
                MB.toolboxes.setState({
                    active: !0,
                    groupedItems: this.groupedItems
                }),
                this.groupedItems.canSetImage() && MB.renderAssetUploader(),
                this.groupedItems.isDraggable() && this.initDragging()
            }
            return setTimeout(function(e) {
                return function() {
                    var t, i, n;
                    return e.cached = function() {
                        var e, r, s, o, a, l, c, d, u, h;
                        for (c = this.groupedItems.items(), h = [], o = 0, e = c.length; o < e; o++) {
                            if (f = c[o], i = f.dup(), i.selected = f.selected, i.itemstates = {},
                            $("#ssliglobal").hasClass("active")) {
                                for (d = Widgetstate.findAllByAttribute("widget_cid", f.cid), a = 0, r = d.length; a < r; a++) n = d[a],
                                i.itemstates[n.screenstate_cid] = n.dup();
                                for (u = Panelstate.findAllByAttribute("panel_cid", f.cid), l = 0, s = u.length; l < s; l++) t = u[l],
                                i.itemstates[t.screenstate_cid] = t.dup()
                            }
                            h.push(i)
                        }
                        return h
                    }.call(e)
                }
            } (this), 0)
        },
        e.prototype.reduct = function(e) {
            var t;
            if (t = $(e.target).closest(".selection-item").data("cid"), !e.ctrlKey && !e.metaKey || !MB.penetrateSelect(e, t)) return this.reductItem(t)
        },
        e.prototype.reductItem = function(e) {
            var t, i, n, r, s;
            for (n = this.groupedItems.items(!0), i = r = 0, s = n.length; r < s; i = ++r) t = n[i],
            t && t.cid === e && n.splice(i, 1);
            return $("#selection-frame" + e).remove(),
            $("#selection-item" + e).remove(),
            this.select(n)
        },
        e.prototype.selectAll = function() {
            var e, t, i, n, r, s, o, a, l;
            for (a = MB.currentScreen, e = [], s = a.cwidgets(), t = 0, n = s.length; t < n; t++) l = s[t],
            e.push(l);
            for (o = a.cpanels(), i = 0, r = o.length; i < r; i++) l = o[i],
            e.push(l);
            return this.select(e)
        },
        e.prototype.append = function(e) {
            var t, i, n, r;
            for (t = this.groupedItems.items(!0), n = 0, r = e.length; n < r; n++) i = e[n],
            t.push(i);
            return this.select(t),
            MB.renderLinks()
        },
        e.prototype.clear = function() {
            if ($("#text_editor").length) return this.endEdit();
            if (this.groupedItems.items().length) {
                try {
                    $(".selection-item").draggable("destroy")
                } catch(e) {}
                if (!MB.activePanel() && MB.iconsManager && this.groupedItems.canSetIcon() && MB.iconsManager.setState({
                    active: !1
                }), !MB.activePanel() && MB.assetUploader && this.groupedItems.canSetImage() && MB.assetUploader.setState({
                    active: !1
                }), this.groupedItems.clear(), MB.renderSelections(), MB.renderLinks(), MB.renderToolbar(), $("a.cut").addClass("disabled"), $("a.copy").addClass("disabled"), $("a.layer").addClass("disabled"), $("a.group").addClass("disabled"), $("a.ungroup").addClass("disabled"), $(".tool-group.alignment a").addClass("disabled"), $(".tool-group.distribute a").addClass("disabled"), $(".toolbox, .x-toolbox").css("display", ""), !MB.activePanel()) return MB.ruler && MB.ruler.setSelect(0, 0, MB.currentScreen.w(), MB.currentScreen.h()),
                MB.toolboxes.setState({
                    active: !1,
                    groupedItems: this.groupedItems,
                    pickColorFor: null,
                    activeColorset: null
                })
            }
        },
        e.prototype.remove = function() {
            var e, t, i, n, r, s, o, a, l, c, d, u, h, p, f, g, m, v, b, y;
            if (!this.groupedItems.items().length || MB.activePanel()) return ! 0;
            for (e = function() {
                var e, i, n, r;
                for (n = this.groupedItems.items(), r = [], e = 0, i = n.length; e < i; e++) t = n[e],
                r.push(t.dup());
                return r
            }.call(this), f = this.groupedItems.links(), i = 0, s = f.length; i < s; i++) d = f[i],
            e.push(d.dup()),
            d.ldestroy();
            for (g = this.groupedItems.items(), n = 0, o = g.length; n < o; n++) {
                if (t = g[n], t.template_cid) {
                    for (v = Panelstate.findAllByAttribute("panel_cid", t.cid), h = 0, l = v.length; h < l; h++) y = v[h],
                    (r = Link.find(y.gid)) && r.ldestroy();
                    PanelManager.remove(t.cid)
                } else {
                    for (m = Widgetstate.findAllByAttribute("widget_cid", t.cid), u = 0, a = m.length; u < a; u++) y = m[u],
                    (r = Link.find(y.gid)) && r.ldestroy();
                    WidgetManager.remove(t.cid)
                }
                for (b = Link.findAllByAttribute("state_cid", t.screen_cid), p = 0, c = b.length; p < c; p++) r = b[p],
                r.widget_cids.indexOf(t.cid) !== -1 && r.ldestroy()
            }
            return $("body").trigger("undoStack:add", [e, null]),
            0 === $("#screen .status_bar").length && $("#design").trigger("status_bar:update", [!1]),
            MB.renderRightNav(),
            this.clear()
        },
        e.prototype.copy = function() {
            if (!MB.activePanel() && this.groupedItems.items().length) return localStorage.pasteBoard = JSON.stringify([this.groupedItems.items(), this.groupedItems.links(), this.groupedItems.l() - MB.canvasLeft(), this.groupedItems.t() - MB.canvasTop()]),
            MB.renderToolbar()
        },
        e.prototype.duplicate = function(e, t) {
            if (!MB.globalStateAlert()) return this.copy(),
            this.paste(e, t)
        },
        e.prototype.paste = function(e, t) {
            var i, n, r, s, o, a, l, c;
            if (!$("input:focus, textarea:focus").length) {
                if (MB.f.editing) return this.handleTextPaste(e);
                if (! (e.originalEvent && e.originalEvent.clipboardData && MB.isChrome() && this.handleImagePaste(e)) && !MB.globalStateAlert() && localStorage.pasteBoard && (l = $.parseJSON(localStorage.pasteBoard), l && !MB.activePanel())) {
                    if (t) s = 100 * (l[2] + MB.canvasLeft()) / MB.scale(),
                    c = 100 * (l[3] + MB.canvasTop()) / MB.scale(),
                    o = 100 * this.clientX / MB.scale() - s,
                    a = 100 * this.clientY / MB.scale() - c;
                    else {
                        if (n = $("#screen").data("cid"), !l[0][0]) return;
                        c = Math.min.apply(Math,
                        function() {
                            var e, t, i, n;
                            for (i = l[0], n = [], e = 0, t = i.length; e < t; e++) r = i[e],
                            "number" == typeof r.top && n.push(r.top);
                            return n
                        } ()) - 100 * $("#screens")[0].scrollTop / MB.scale(),
                        c !== 1 / 0 && c >= 0 && c < 100 * $("#screens").height() / MB.scale() ? a = l[0][0].screen_cid === n && this.groupedItems.items().length ? 100 * this.groupedItems.h() / MB.scale() : 0 : (c = 100 * (l[3] + MB.canvasTop()) / MB.scale(), a = 100 * this.clientY / MB.scale() - c),
                        o = 0
                    }
                    return this.clear(),
                    l = this.pasteItems(l, o, a),
                    this.select(l[0]),
                    l.push(this.groupedItems.l() - MB.canvasLeft()),
                    l.push(this.groupedItems.t() - MB.canvasTop()),
                    localStorage.pasteBoard = JSON.stringify(l),
                    i = l[0].concat(l[1]),
                    $("body").trigger("undoStack:add", [null,
                    function() {
                        var e, t, n;
                        for (n = [], e = 0, t = i.length; e < t; e++) r = i[e],
                        n.push(r.dup());
                        return n
                    } ()]),
                    $("#design").trigger("slider:update")
                }
            }
        },
        e.prototype.pasteItems = function(e, t, i) {
            var n, r, s, o, a, l, c, d, u, h, p, f, g, m, v, b, y, _;
            return o = e[0].sort(function(e, t) {
                return e.z - t.z || e.timestamp - t.timestamp
            }),
            u = e[1],
            l = {},
            p = {},
            f = MB.currentScreen,
            s = function() {
                var e, t, i;
                for (i = [], e = 0, t = u.length; e < t; e++) d = u[e],
                d && (m = Screen.find(d.target_cid), v = Screenstate.find(d.targetstate_cid), m && m.project_cid === MB.project().cid && d.target_cid !== f.cid || v && d.targetstate_cid !== f.state_cid && v.screen_cid === f.cid || "prev" === d.target_cid ? (a = new Link({
                    screen_cid: f.cid,
                    sourcestate_cid: f.state_cid,
                    cid: "l" + Math.uuid(10, 16) + (new Date).valueOf()
                }), a.restore(d), a.lsave(), l[d.cid] = a.cid, i.push(a)) : i.push(void 0));
                return i
            } (),
            s = s.filter(function(e) {
                return e
            }),
            _ = f.maxZ(),
            r = function() {
                var e, r, s, a;
                for (a = [], e = 0, r = o.length; e < r; e++) y = o[e],
                "status_bar" === y.name && $("#canvas").hasClass("sb") || (c = y.left + t, b = y.top + i, "status_bar" === y.name && $("#canvas").addClass("sb"), h = Link.exists(y.gid) ? l[y.gid] : p[s = y.gid] || (p[s] = MB.nextgid(y.gid)), y.template_cid ? (g = Template.find(y.template_cid), n = new Panel, n.restore(y), n.load({
                    left: c,
                    top: b,
                    screen_cid: f.cid,
                    cid: "p" + Math.uuid(10, 16) + (new Date).valueOf(),
                    gid: h,
                    timestamp: MB.lastTimestamp() + 1,
                    z: _
                }), g ? ("break_away" === y.behavior && (g = g.duplicate(!1)), n.template_cid = g.cid, n.lsave(), $("#canvas").append(MB.Panel(n)), MB.renderLeftNav("templates")) : MB.workspace.cloneBuiltin(y.template_cid, null,
                function(e) {
                    return e.host_cid = MB.project().cid,
                    e.lsave(),
                    MB.renderLeftNav("templates"),
                    n.template_cid = e.cid,
                    n.lsave(),
                    $("#canvas").append(MB.Panel(n))
                })) : (n = new Widget, n.restore(y), n.load({
                    left: c,
                    top: b,
                    screen_cid: f.cid,
                    cid: "w" + Math.uuid(10, 16) + (new Date).valueOf(),
                    gid: h,
                    timestamp: MB.lastTimestamp() + 1,
                    z: _
                }), n.moveable || (n.left = null, n.top = null), n.lsave(), $("#canvas").append(MB.widget(n))), this.design(n), a.push(n));
                return a
            }.call(this),
            MB.renderLinks(),
            [r, s]
        },
        e.prototype.handleTextPaste = function(e) {
            var t, i;
            return t = e.clipboardData || e.originalEvent.clipboardData,
            i = t.getData("text/plain"),
            document.execCommand("insertText", !1, i)
        },
        e.prototype.handleImagePaste = function(e) {
            var t, i, n, r, s, o;
            for (t = e.clipboardData || e.originalEvent.clipboardData, r = t.items, s = 0, o = r.length; s < o; s++) n = r[s],
            n.type.match(/^image\//) && (i = n.getAsFile());
            return !! i && (i.name = "ClipBoard-" + (new Date).valueOf().toString(), Asset.createFromFiles([i],
            function(e) {
                var t, i, n;
                return t = MB.currentScreen,
                i = MB.selection.clientY - MB.canvasTop(),
                n = WidgetManager.newImageView(e, 0, i, t),
                $("body").trigger("undoStack:add", [null, [n.dup()]]),
                $("body").trigger("selection:select", [[n]])
            }), !0)
        },
        e.prototype.cut = function() {
            if (this.groupedItems.items().length && !MB.activePanel()) return this.copy(),
            this.remove()
        },
        e.prototype.setGId = function(e) {
            var t, i, n, r, s, o, a, l;
            for (t = function() {
                var e, t, i, n;
                for (i = this.groupedItems.items(), n = [], e = 0, t = i.length; e < t; e++) l = i[e],
                n.push(l.dup());
                return n
            }.call(this), a = this.groupedItems.items(), r = 0, s = a.length; r < s; r++) n = a[r],
            o = Link.find(n.gid),
            o && (t.push(o.dup()), o.ldestroy()),
            n.gid = e,
            n.lsave();
            return this.groupedItems.removeShadow(),
            MB.renderLinks(),
            i = function() {
                var e, t, i, n;
                for (i = this.groupedItems.items(), n = [], e = 0, t = i.length; e < t; e++) l = i[e],
                n.push(l.dup());
                return n
            }.call(this),
            $("body").trigger("undoStack:add", [t, i]),
            MB.renderSelections()
        },
        e.prototype.group = function() {
            var e;
            return e = "g" + Math.uuid(21, 16),
            this.setGId(e),
            MB.renderToolbar()
        },
        e.prototype.ungroup = function() {
            return this.setGId(null),
            this.select(this.groupedItems.items(!0)),
            MB.renderToolbar()
        },
        e.prototype.halign = function(e) {
            var t, i, n, r, s, o, a, l, c, d, u, h, p, f, g, m;
            if (n = this.groupedItems.groupByGid(), "left" === e) for (g = this.groupedItems.realL(), r = 0, l = n.length; r < l; r++) i = n[r],
            o = Math.round(g + i.realW() / 2 - i.w() / 2 - MB.canvasLeft()),
            i.setL(o);
            else if ("center" === e) for (t = this.groupedItems.realL() + this.groupedItems.realW() / 2 - MB.canvasLeft(), s = 0, c = n.length; s < c; s++) i = n[s],
            a = Math.round(t - i.w() / 2),
            i.setL(a);
            else if ("right" === e) for (m = this.groupedItems.realR(), h = 0, d = n.length; h < d; h++) i = n[h],
            o = Math.round(m - i.realW() / 2 + i.w() / 2 - MB.canvasLeft()) - i.w(),
            i.setL(o);
            for (f = MB.selection.groupedItems.links(), p = 0, u = f.length; p < u; p++) o = f[p],
            o.reload();
            return MB.renderLinks(),
            MB.renderSelections(),
            MB.toolboxes.updatePosition(),
            this.undoableSave(!1)
        },
        e.prototype.valign = function(e) {
            var t, i, n, r, s, o, a, l, c, d, u, h, p, f, g, m, v;
            if (n = this.groupedItems.groupByGid(), "top" === e) for (g = this.groupedItems.realT(), r = 0, a = n.length; r < a; r++) i = n[r],
            m = Math.floor(g + i.realH() / 2 - i.h() / 2 - MB.canvasTop()),
            i.setT(m);
            else if ("center" === e) for (t = this.groupedItems.realT() + this.groupedItems.realH() / 2 - MB.canvasTop(), s = 0, l = n.length; s < l; s++) i = n[s],
            v = Math.floor(t - i.h() / 2),
            i.setT(v);
            else if ("bottom" === e) for (p = this.groupedItems.realB(), u = 0, c = n.length; u < c; u++) i = n[u],
            m = Math.floor(p - i.realH() / 2 + i.h() / 2 - MB.canvasTop()) - i.h(),
            i.setT(m);
            for (f = MB.selection.groupedItems.links(), h = 0, d = f.length; h < d; h++) o = f[h],
            o.reload();
            return MB.renderLinks(),
            MB.renderSelections(),
            MB.toolboxes.updatePosition(),
            this.undoableSave(!1)
        },
        e.prototype.sendFront = function() {
            var e, t, i, n, r, s, o, a, l, c, d, u, h, p;
            for (e = this.groupedItems.items(!1), i = new Set, r = 0, o = e.length; r < o; r++) h = e[r],
            i.add(h.z);
            for (t = {},
            u = Array.from(i).sort(function(e, t) {
                return e - t
            }), n = s = 0, a = u.length; s < a; n = ++s) p = u[n],
            t[p] = n;
            for (d = MB.currentScreen.maxZ() + 1, c = 0, l = e.length; c < l; c++) n = e[c],
            n.z = Math.min(t[n.z] + d, Widget.MAXZ),
            this.design(n);
            return MB.renderSelections(),
            this.undoableSave(!1)
        },
        e.prototype.sendBack = function() {
            var e, t, i, n, r, s, o, a, l, c, d, u, h, p;
            for (e = this.groupedItems.items(!1), i = new Set, r = 0, o = e.length; r < o; r++) h = e[r],
            i.add(h.z);
            for (t = {},
            u = Array.from(i).sort(function(e, t) {
                return e - t
            }), n = s = 0, a = u.length; s < a; n = ++s) p = u[n],
            t[p] = n;
            for (d = MB.currentScreen.minZ() - i.size, c = 0, l = e.length; c < l; c++) n = e[c],
            n.z = Math.max(t[n.z] + d, -Widget.MAXZ),
            this.design(n);
            return MB.renderSelections(),
            this.undoableSave(!1)
        },
        e.prototype.forward = function() {
            var e, t, i, n;
            for (n = this.groupedItems.items(!1), t = 0, i = n.length; t < i; t++) e = n[t],
            e.z = Math.min(e.z + 1, Widget.MAXZ),
            this.design(e);
            return MB.renderSelections(),
            this.undoableSave(!1)
        },
        e.prototype.backward = function() {
            var e, t, i, n;
            for (n = this.groupedItems.items(!1), t = 0, i = n.length; t < i; t++) e = n[t],
            e.z = Math.max(e.z - 1, -Widget.MAXZ),
            this.design(e);
            return MB.renderSelections(),
            this.undoableSave(!1)
        },
        e.prototype.selectByRect = function(e, t) {
            var i, n, r, s, o, a, l, c, d, u, h;
            for (r = [], e.right = e.left + e.width, e.bottom = e.top + e.height, c = MB.activePanel() ? Screen.find($(".panel.selected .state.active").data("cid")) : MB.currentScreen, h = c.cwidgets().concat(c.cpanels()), n = new GroupedItems, s = 0, a = h.length; s < a; s++) u = h[s],
            n._iv(u).length && (n.setItems([u]), o = n.realL(), d = n.realT(), l = n.realR(), i = n.realB(), e.top < d && e.bottom > i && e.left < o && e.right > l && r.push(u));
            if (r.length) return t ? this.append(r) : this.select(r)
        },
        e.prototype.initDragging = function() {
            var e, t, i, n, r, s, o;
            return e = t = null,
            r = s = null,
            i = !1,
            n = [],
            o = null,
            $(".selection-item").draggable({
                start: function(a) {
                    return function(l) {
                        var c, d, u, h, p, f, g;
                        if (i = !1, l.ctrlKey || l.metaKey) {
                            if (MB.globalStateAlert()) return ! 1;
                            i = !0,
                            n = a.groupedItems.links(),
                            u = function() {
                                var e, t, i, n;
                                for (i = this.groupedItems.items(), n = [], e = 0, t = i.length; e < t; e++) d = i[e],
                                d.moveable && n.push(d);
                                return n
                            }.call(a),
                            c = a.pasteItems([u, n], 0, 0),
                            u = c[0],
                            n = c[1],
                            a.select(u, !1),
                            o = $(".selection").hide(),
                            1 === n.length && $("#link" + n[0].cid).addClass("selected")
                        }
                        for (a.alignLines = new AlignLines, a.alignLines.init(a.groupedItems.items()), a.groupLinks = a.groupedItems.links(), f = a.groupedItems.items(), h = 0, p = f.length; h < p; h++) g = f[h],
                        g.moveable && (g.initialLeft = g.left, g.initialTop = g.top, g.initialL = g.l(), g.initialT = g.t(), g.initialSlt = g.slt, g.initialSlw = g.slw);
                        return e = a.groupedItems.realL() - MB.canvasLeft(),
                        t = a.groupedItems.realT() - MB.canvasTop(),
                        r = $("#screens")[0].scrollLeft,
                        s = $("#screens")[0].scrollTop,
                        a.flagBucket.selectingMoved = !0,
                        $(".toolbox, .x-toolbox").hide()
                    }
                } (this),
                drag: function(i) {
                    return function(n, o) {
                        var a, l, c, d, u, h, p, f, g;
                        if (u = o.position.left - o.originalPosition.left + $("#screens")[0].scrollLeft - r, h = o.position.top - o.originalPosition.top + $("#screens")[0].scrollTop - s, n.shiftKey ? (null == i.dragDirection && (i.dragDirection = Math.abs(u) <= Math.abs(h)), i.dragDirection ? u = 0 : h = 0) : i.dragDirection = null, f = e + u, g = t + h, a = i.alignLines.smart(f, g, i.groupedItems.realW(), i.groupedItems.realH()), Math.abs(a.offset_x) < 8 && !n.shiftKey && (u += a.offset_x, f += a.offset_x), Math.abs(a.offset_y) < 8 && !n.shiftKey && (h += a.offset_y, g += a.offset_y), i.updateItemsByOffset(u, h, !1), i.alignLines.update(f, g, i.groupedItems.realW(), i.groupedItems.realH()), $("#combos").is(":visible") && (i.groupedItems.realL() < 180 ? ($("html,body").css("cursor", "copy"), $("#components .droparea").addClass("hover")) : ($("html,body").css("cursor", "auto"), $("#components .droparea").removeClass("hover"))), i.groupLinks.length < 5) {
                            for (p = i.groupLinks, l = 0, d = p.length; l < d; l++) c = p[l],
                            c.reload();
                            return MB.renderLinks()
                        }
                    }
                } (this),
                stop: function(e) {
                    return function() {
                        var t, r, s, a, l, c, d, u, h;
                        if ($("#components .droparea").removeClass("hover"), $(".toolbox, .x-toolbox").css("display", ""), e.groupedItems.realL() < 180 && $("#combos").is(":visible")) e.updateItemsByOffset(0, 0, !1),
                        $(".newCombo").click();
                        else {
                            for (d = e.groupedItems.items(), r = 0, l = d.length; r < l; r++) h = d[r],
                            h.moveable && (h.left = h.initialLeft + Math.round(h.left - h.initialLeft), h.top = h.initialTop + Math.round(h.top - h.initialTop), h.initialL = h.initialT = h.initailSlt = h.initialSlw = null, h.lsave(i), h.template_cid ? PanelManager.design(h) : WidgetManager.renderOutline(h));
                            i ? (i = !1, o.remove(), $("body").trigger("undoStack:add", [null,
                            function() {
                                var e, i, r, s;
                                for (r = this.groupedItems.items().concat(n), s = [], e = 0, i = r.length; e < i; e++) t = r[e],
                                s.push(t.dup());
                                return s
                            }.call(e)])) : e.undoableSave(!1)
                        }
                        if (e.alignLines.hide(), delete e.alignLines, e.groupLinks.length >= 5) {
                            for (u = e.groupLinks, s = 0, c = u.length; s < c; s++) a = u[s],
                            a.reload();
                            MB.renderLinks()
                        }
                        return MB.toolboxes.setState({
                            groupedItems: e.groupedItems
                        }),
                        setTimeout(function() {
                            return e.dragDirection = null,
                            e.flagBucket.selectingMoved = !1
                        },
                        500)
                    }
                } (this)
            })
        },
        e.prototype.initSelecting = function() {
            return $("#design").on("click", "#screens",
            function(e) {
                return function(t) {
                    if (!$(t.target).closest(".selection-item").length) return e.flagBucket.selectingMoved ? void 0 : e.clear()
                }
            } (this)),
            $("#design").on("mousedown", "#screens",
            function(e) {
                return function(t) {
                    var i;
                    if (MB.project()) return ! $("#design").is(":visible") || ( !! $(t.target).hasClass("ui-draggable") || (!$(t.target).data("selectable") && !$(t.target).closest(".widget").length || (!(!$("#text_editor").length && 3 !== t.which) || (!$(t.target).closest(".state").length && MB.activePanel() && (i = Panel.find($(".panel.selected").data("cid")), i && PanelManager.deactivate(i)), e.selectingStarted = !0, e.start_x = t.pageX, e.start_y = t.pageY, !0))))
                }
            } (this)),
            $(window).on("mousemove",
            function(e) {
                return function(t) {
                    var i, n;
                    return ! e.selectingStarted || (e.flagBucket.selectingMoved || (t.shiftKey || e.clear(), e.flagBucket.selectingMoved = !0), t.preventDefault(), t.stopPropagation(), i = t.pageX, n = t.pageY, (Math.abs(i - e.start_x) > 5 || Math.abs(n - e.start_y) > 5) && (e.flagBucket.selectEffect = !0), n > $(window).height() && $("#screens")[0].scrollTop < $("#screens")[0].scrollHeight - $("#screens").height() ? ($("#screens")[0].scrollTop += 10, e.start_y -= 10) : n < $("#screens").offset().top && $("#screens")[0].scrollTop > 0 && ($("#screens")[0].scrollTop = $("#screens")[0].scrollTop - 10, e.start_y += 10), i > $("#screens").offset().left + $("#screens").width() && $("#screens")[0].scrollLeft < $("#screens")[0].scrollWidth - $("#screens").width() ? ($("#screens")[0].scrollLeft += 10, e.start_x -= 10) : i < $("#screens").offset().left && $("#screens")[0].scrollLeft > 0 && ($("#screens")[0].scrollLeft -= 10, e.start_x += 10), $("#selection").show().css({
                        top: Math.min(e.start_y, n),
                        left: Math.min(e.start_x, i),
                        width: Math.abs(i - e.start_x),
                        height: Math.abs(n - e.start_y)
                    }), !0)
                }
            } (this)),
            $(window).mouseup(function(e) {
                return function(t) {
                    var i, n, r, s, o, a, l, c;
                    if (!e.selectingStarted) return ! 0;
                    if (e.selectingStarted = !1, !e.flagBucket.selectingMoved) return ! 0;
                    if (setTimeout(function() {
                        return e.flagBucket.selectingMoved = !1,
                        e.flagBucket.selectEffect = !1
                    },
                    500), t.preventDefault(), t.stopPropagation(), l = t.pageX, c = t.pageY, $("#selection").hide(), n = Math.min(e.start_x, l), s = Math.min(e.start_y, c), a = Math.abs(l - e.start_x), i = Math.abs(c - e.start_y), t.metaKey || t.ctrlKey) {
                        if (! (a > 10 && i > 10)) return;
                        if (MB.globalStateAlert()) return;
                        r = MB.currentScreen,
                        o = new Widget({
                            name: "lr",
                            screen_cid: r.cid,
                            cid: "w" + Math.uuid(10, 16) + (new Date).valueOf(),
                            z: r.maxZ()
                        }),
                        o.setL(n - MB.canvasLeft()),
                        o.setT(s - MB.canvasTop()),
                        o.setW(a),
                        o.setH(i),
                        $("#canvas").append(MB.widget(o)),
                        o.lsave(),
                        MB.trigger("undoStack:add", [null, [o.dup()]]),
                        MB.trigger("selection:select", [[o]])
                    } else e.selectByRect({
                        left: n,
                        top: s,
                        width: a,
                        height: i
                    },
                    t.shiftKey);
                    return ! 0
                }
            } (this))
        },
        e.prototype.startEdit = function() {
            var e;
            return e = this.groupedItems.first(),
            this.editing = e,
            MB.f.editing = !0,
            $("#widget" + e.cid).find(".text, input, textarea").css("visibility", "hidden"),
            $("#widget" + e.cid + ".label p").css("visibility", "hidden"),
            $(".selection-item .handler").hide(),
            $(".selection-item .ui-rotatable-handle").hide(),
            $(".link.design").hide(),
            e.richedit ? this._showText = MB.toolboxes.state.showText: $(".toolbox, .x-toolbox").hide(),
            this.startSingleEdit(e)
        },
        e.prototype.startSingleEdit = function(e) {
            var t, i, n, r, s, o, a, l, c, d;
            switch (t = $("#screens > .screen_container"), d = e.w(), n = e.h(), r = e.l() + MB.canvasLeft() - t.offset().left, c = e.t() + MB.canvasTop() - t.offset().top, t.append("<div id='text_editor' contentEditable style='line-height:" + e.lH() + "px;' />"), e.multiline ? o = parseInt(e.padding) + e.bs + 1 : (o = (n - e.fS() - 1) / 2 + "px 0", "center" === e.ha ? r -= (960 - d) / 2 : "right" === e.ha && (r -= 960 - d), d = 960), e.name) {
            case "mtooltip":
                "left" === e.tt_placement && (r += 10),
                "top" === e.tt_placement && (c += 10);
                break;
            case "status_bar":
                r += 45;
                break;
            case "search_bar":
                r += 36;
                break;
            case "mselect":
                n = 200,
                $("#text_editor").css("background", "white");
                break;
            case "tab_item":
                n = 18,
                c += 30,
                o = 0;
                break;
            case "mtextarea":
                n = 30,
                c += e.bS(),
                o = Math.floor((30 - e.lH()) / 2) + "px " + (8 + e.bS());
                break;
            case "mtext_input":
                o = Math.floor((n - e.fS()) / 2) + "px " + (8 + e.bS());
                break;
            case "webpage":
                n = 50,
                o = "18px 0"
            }
            return "android" === MB.project().device && $("#text_editor").css("font-family", 'Roboto, Arial, "Noto Sans CJK SC", "Noto Sans CJK TC", "Noto Sans CJK JP", "Noto Sans CJK KR", "WenQuanYi Zen Hei", sans-serif'),
            $("#text_editor").css({
                padding: o + "px",
                width: d + "px",
                "min-height": n + "px",
                left: r + "px",
                color: e.tc,
                "font-size": e.fS() + "px"
            }),
            e.richedit && ($("#text_editor").css("font-weight", e.bo ? "bold": ""), $("#text_editor").css("font-style", e.i ? "italic": ""), $("#text_editor").css("text-decoration", e.td)),
            $("#text_editor").css("top", c + "px"),
            $("#text_editor").css("text-align", e.ha),
            $("#text_editor").css("display", "block"),
            e.richedit || "mselect" === e.name ? $("#text_editor").html(MB.v.multiline(e.text)) : $("#text_editor").text(MB.unescape(e.text)),
            $("#text_editor").focus(),
            i = document.getElementById("text_editor"),
            a = document.createRange(),
            l = window.getSelection(),
            e.multiline ? (a.setStartBefore(i.childNodes[0]), a.setEndAfter(i.childNodes[i.childNodes.length - 1])) : (s = i.childNodes[0], 1 === s.nodeType && (s = s.childNodes[0]), a.setStartAfter(s), a.collapse()),
            l.removeAllRanges(),
            l.addRange(a),
            MB.toolboxes.setState({
                showText: !0
            }),
            $("#text_editor").click(function(e) {
                return e.stopPropagation()
            }),
            $("#text_editor").keydown(function(t) {
                return function(i) {
                    return 13 !== i.which || e.multiline || t.endEdit(),
                    MB.toolboxes.forceUpdate()
                }
            } (this)),
            $("#text_editor").mouseup(function() {
                return function() {
                    return MB.toolboxes.forceUpdate()
                }
            } (this)),
            $("#text_editor").keyup(function(t) {
                return function() {
                    if (t.editing) return t.setAttr("text", t.editorContent(), !0, !1),
                    $("#widget" + e.cid).find(".text, input, textarea").css("visibility", "hidden"),
                    $("#widget" + e.cid + ".label p").css("visibility", "hidden"),
                    MB.renderSelections(),
                    MB.toolboxes.updatePosition()
                }
            } (this))
        },
        e.prototype.editorContent = function() {
            var e;
            return this.editing.richedit ? $("#text_editor").html() : "mselect" === this.editing.name ?
            function() {
                var t, i, n, r;
                for (n = $("#text_editor p"), r = [], t = 0, i = n.length; t < i; t++) e = n[t],
                r.push(e.innerText);
                return r
            } ().join("\n") : $("#text_editor").text()
        },
        e.prototype.endEdit = function() {
            var e;
            if (this.editing) return $(".selection-item .handler").show(),
            $(".selection-item .ui-rotatable-handle").show(),
            $(".link.design").show(),
            $("#widget" + this.editing.cid).find(".text, input, .icon, textarea").css("visibility", ""),
            $("#widget" + this.editing.cid + ".label p").css("visibility", ""),
            $(".toolbox, .x-toolbox").css("display", ""),
            e = this.editorContent(),
            this.editing = null,
            MB.f.editing = !1,
            this.setAttr("text", e),
            MB.renderSelections(),
            MB.toolboxes.updatePosition(),
            $("#text_editor").remove()
        },
        e.prototype.setIcon = function(e) {
            var t, i, n, r;
            for (r = this.groupedItems.items(!0), i = 0, n = r.length; i < n; i++) t = r[i],
            t.constructor === Widget && t.iconic && (t.icon = e, WidgetManager.update(t));
            return this.undoableSave()
        },
        e.prototype.setImage = function(e) {
            var t, i, n, r;
            for (Projectasset.findByProjectAndAsset(MB.project(), e).length || Projectasset.create({
                project_cid: MB.project().cid,
                asset_id: e.sid
            }), r = this.groupedItems.items(!0), i = 0, n = r.length; i < n; i++) t = r[i],
            t.constructor === Widget && (t.image = e.cid, WidgetManager.update(t));
            return this.undoableSave()
        },
        e.prototype.getImage = function() {
            return this.groupedItems.getAttr("image")
        },
        e.prototype.getAttr = function(e) {
            return this.groupedItems.getAttr(e)
        },
        e.prototype.setTheme = function(e) {
            return this.editing ? document.execCommand("foreColor", !1, MB.themes[e][1]) : (this.groupedItems.setTheme(e), MB.selection.undoableSave(), MB.renderSelections(), MB.toolboxes.setState({
                groupedItems: this.groupedItems,
                activeColorset: null
            }))
        },
        e.prototype.saveAndUpdate = function(e) {
            return null == e && (e = !0),
            this.undoableSave(e),
            MB.renderSelections(),
            MB.toolboxes.setState({
                groupedItems: this.groupedItems
            })
        },
        e.prototype.setAttr = function(e, t, i, n) {
            if (null == i && (i = !0), null == n && (n = !0), ["left", "top", "v", "fixed", "fixed_type", "locked"].indexOf(e) !== -1 && (i = !1), this.groupedItems.setAttr(e, t, i, n), n && (this.saveAndUpdate(i), "text" === e || "bo" === e || "fs" === e || "lh" === e || "padding" === e || "bs" === e)) return MB.renderLinks()
        },
        e.prototype.squareize = function() {
            var e, t, i, n;
            for (this.groupedItems.setAttr("height", this.groupedItems.getAttr("width")), this.groupedItems.setAttr("br", 0), this.saveAndUpdate(), n = MB.selection.groupedItems.links(), e = 0, i = n.length; e < i; e++) t = n[e],
            t.reload();
            return MB.renderLinks()
        },
        e.prototype.circularize = function() {
            var e, t, i, n;
            for (this.groupedItems.setAttr("height", this.groupedItems.getAttr("width")), this.groupedItems.setAttr("br", this.groupedItems.getAttr("width") / 2), this.saveAndUpdate(), n = MB.selection.groupedItems.links(), e = 0, i = n.length; e < i; e++) t = n[e],
            t.reload();
            return MB.renderLinks()
        },
        e.prototype.setColorSet = function(e) {
            var t, i, n, r, s, o, a, l, c, d, u;
            for (d = this.groupedItems.items(), r = 0, o = d.length; r < o; r++) {
                for (n = d[r], i = n.inspectables(), u = Colorset.attrs, s = 0, a = u.length; s < a; s++) t = u[s],
                ("number" != typeof e[t] && e[t] || "number" == typeof e[t] && e[t] >= 0) && i.indexOf(t) !== -1 && (n[t] = e[t]);
                i.indexOf("clip") !== -1 && (n.clip = e.clip),
                i.indexOf("br") !== -1 && (n.br = Math.round(Math.min(n.width, n.height) * e.br / 100)),
                c = n.minWidth(),
                l = n.minHeight(),
                n.autoWidth && n.width < c && (n.width = c),
                n.autoHeight && n.height < l && (n.height = l),
                WidgetManager.update(n)
            }
            return this.saveAndUpdate()
        },
        e.prototype.design = function(e) {
            return e.template_cid ? PanelManager.design(e) : WidgetManager.update(e)
        },
        e.prototype.moveLeft = function(e) {
            var t;
            if (null == e && (e = 1), !MB.activePanel()) return t = this.groupedItems.l(),
            t -= Math.round(e * MB.scale() / 100),
            this.updateItemsByOffset(0 - Math.round(e * MB.scale() / 100), 0)
        },
        e.prototype.moveRight = function(e) {
            var t;
            if (null == e && (e = 1), !MB.activePanel()) return t = this.groupedItems.l(),
            t += Math.round(e * MB.scale() / 100),
            this.updateItemsByOffset(Math.round(e * MB.scale() / 100), 0)
        },
        e.prototype.moveUp = function(e) {
            var t;
            if (null == e && (e = 1), !MB.activePanel()) return t = this.groupedItems.t(),
            t -= Math.round(e * MB.scale() / 100),
            this.updateItemsByOffset(0, 0 - Math.round(e * MB.scale() / 100))
        },
        e.prototype.moveDown = function(e) {
            var t;
            if (null == e && (e = 1), !MB.activePanel()) return t = this.groupedItems.t(),
            t += Math.round(e * MB.scale() / 100),
            this.updateItemsByOffset(0, Math.round(e * MB.scale() / 100))
        },
        e.prototype.updateItemsByOffset = function(e, t, i) {
            var n, r, s, o, a, l, c, d, u, h;
            if (null == i && (i = !0), this.groupedItems.items().length) {
                for (u = this.groupedItems.items(), o = 0, c = u.length; o < c; o++) n = u[o],
                n.moveable && (r = n.initialL || 0 === n.initialL ? n.initialL: n.l(), s = n.initialT || 0 === n.initialT ? n.initialT: n.t(), n.setL(r + e), n.setT(s + t), "sticky" === n.name && n.updateSideline(e, t), n.lsave(i), n.template_cid ? PanelManager.design(n) : (WidgetManager.renderOutline(n), ["sticky"].indexOf(n.name) !== -1 && WidgetManager.design(n)));
                if (i) {
                    for (this.saveAndUpdate(!1), h = MB.selection.groupedItems.links(), a = 0, d = h.length; a < d; a++) l = h[a],
                    l.reload();
                    return MB.renderLinks()
                }
                return MB.toolboxes.updatePosition(),
                MB.renderSelections()
            }
        },
        e.prototype.isEmpty = function() {
            return ! this.groupedItems.items().length
        },
        e.prototype.find = function(e) {
            return Widget.find(e) || Panel.find(e)
        },
        e.prototype.hDistribute = function() {
            var e, t, i, n, r, s, o, a, l, c, d, u, h;
            for (t = this.groupedItems.groupByGid().sort(function(e, t) {
                return e.l() - t.l()
            }), h = 0, i = 0, s = t.length; i < s; i++) e = t[i],
            h += e.realW();
            for (c = (this.groupedItems.realW() - h) / (t.length - 1), r = this.groupedItems.realL() - MB.canvasLeft(), n = 0, o = t.length; n < o; n++) e = t[n],
            u = e.realW(),
            e.setL(r + u / 2 - e.w() / 2),
            r += u + c;
            for (d = MB.selection.groupedItems.links(), l = 0, a = d.length; l < a; l++) r = d[l],
            r.reload();
            return MB.renderLinks(),
            MB.renderSelections(),
            MB.toolboxes.updatePosition(),
            this.undoableSave(!1)
        },
        e.prototype.vDistribute = function() {
            var e, t, i, n, r, s, o, a, l, c, d, u, h, p;
            for (t = this.groupedItems.groupByGid().sort(function(e, t) {
                return e.t() - t.t()
            }), p = 0, i = 0, s = t.length; i < s; i++) e = t[i],
            p += e.realH();
            for (c = (this.groupedItems.realH() - p) / (t.length - 1), h = this.groupedItems.realT() - MB.canvasTop(), n = 0, o = t.length; n < o; n++) e = t[n],
            u = e.realH(),
            e.setT(h + u / 2 - e.h() / 2),
            h += u + c;
            for (d = MB.selection.groupedItems.links(), l = 0, a = d.length; l < a; l++) r = d[l],
            r.reload();
            return MB.renderLinks(),
            MB.renderSelections(),
            MB.toolboxes.updatePosition(),
            this.undoableSave(!1)
        },
        e.prototype.undoableSave = function(e) {
            var t, i, n, r, s, o, a, l, c, d, u, h, p;
            for (null == e && (e = !0), n = this.groupedItems.items(e), r = 0, o = n.length; r < o; r++) u = n[r],
            u.lsave();
            for (t = function() {
                var e, t, i, r, s, o, a, c, d;
                for (d = [], e = 0, t = n.length; e < t; e++) {
                    if (u = n[e], h = u.dup(), h.selected = u.selected, h.itemstates = {},
                    $("#ssliglobal").hasClass("active")) {
                        for (a = Widgetstate.findAllByAttribute("widget_cid", u.cid), s = 0, i = a.length; s < i; s++) p = a[s],
                        h.itemstates[p.screenstate_cid] = p.dup();
                        for (c = Panelstate.findAllByAttribute("panel_cid", u.cid), o = 0, r = c.length; o < r; o++) l = c[o],
                        h.itemstates[l.screenstate_cid] = l.dup()
                    }
                    d.push(h)
                }
                return d
            } (), d = e ?
            function() {
                var t, n, r, s;
                for (r = this.cached, s = [], t = 0, n = r.length; t < n; t++) i = r[t],
                i.selected === e && s.push(i);
                return s
            }.call(this) : this.cached, $("body").trigger("undoStack:add", [d, t]), this.cached = t, c = [], s = 0, a = n.length; s < a; s++) i = n[s],
            "status_bar" === i.name && c.push($("#design").trigger("carrier:update", i.text));
            return c
        },
        e.prototype.combo = function() {
            var e, t, i;
            return this.groupedItems.items().length && (i = Math.round(100 * MB.selection.groupedItems.w() / MB.scale()), e = Math.round(100 * MB.selection.groupedItems.h() / MB.scale())),
            t = new Combo({
                combo: 1,
                width: i || 200,
                height: e || 80,
                access: MB.project().access,
                name: "",
                access_token: Math.uuid(22),
                scale: MB.project().scale,
                device: MB.project().device,
                model: MB.project().model,
                auto_scale: !1
            }),
            MB.renderTemplateModal(t),
            $("#template-modal").modal()
        },
        e.prototype.template = function() {
            var e, t, i;
            return this.groupedItems.items().length && (i = Math.round(100 * MB.selection.groupedItems.w() / MB.scale()), e = Math.round(100 * MB.selection.groupedItems.h() / MB.scale())),
            t = new Template({
                name: "",
                access_token: Math.uuid(33),
                scale: MB.project().scale,
                width: i || MB.project().width,
                height: e || 200,
                device: MB.project().device,
                access: MB.project().access,
                behavior: "inherit",
                master: 1,
                template: 1,
                host_cid: MB.project().cid,
                auto_scale: !1,
                owner_id: MB.user.id,
                owner_avatar: MB.user.avatar
            }),
            MB.renderTemplateModal(t),
            $("#template-modal").modal()
        },
        e
    } ()
}.call(this),
function() {
    this.Slider = function() {
        function e() {
            $("#design").on("slider:update",
            function(e) {
                return function() {
                    return e.updatePin()
                }
            } (this)),
            this.initPin()
        }
        return e.prototype.initPin = function() {
            return this.htY = this.ftY = null,
            $("#design").on("mousedown", ".slider .hh",
            function(e) {
                return function(t) {
                    var i, n, r, s, o;
                    for (e.htY = t.pageY, s = MB.currentScreen, e.points = [], r = s.cwidgets(), i = 0, n = r.length; i < n; i++) o = r[i],
                    e.points.push(o.t()),
                    e.points.push(o.b());
                    return $("#screen .hh .counter").show()
                }
            } (this)),
            $("#design").on("mousedown", ".slider .fh",
            function(e) {
                return function(t) {
                    var i, n, r, s, o;
                    for (e.ftY = t.pageY, s = MB.currentScreen, e.points = [], r = s.cwidgets(), i = 0, n = r.length; i < n; i++) o = r[i],
                    e.points.push(s.h() - o.t()),
                    e.points.push(s.h() - o.b());
                    return $("#screen .fh .counter").show()
                }
            } (this)),
            $("#design").on("mousemove",
            function(e) {
                return function(t) {
                    var i, n, r, s, o, a, l, c, d;
                    if (e.htY || e.ftY) {
                        if (o = t.pageY - (e.htY || e.ftY), d = MB.currentScreen, $("#screen .horizon_line.top").hide(), null !== e.htY) {
                            if (e.pinY = d.headerHeight() + o, e.pinY < 0 && (e.pinY = 0), !t.shiftKey) for (l = e.points, i = 0, r = l.length; i < r; i++) a = l[i],
                            Math.abs(e.pinY - a) <= 3 && (e.pinY = a);
                            $("#screen .horizon_line.top").css("top", e.pinY + "px").show(),
                            $("#screen .hh").css("top", e.pinY + "px"),
                            $("#screen .hh .counter").text(e.pinY)
                        }
                        if (null !== e.ftY) {
                            if (e.pinY = d.footerHeight() - o, e.pinY < 0 && (e.pinY = 0), !t.shiftKey) for (c = e.points, n = 0, s = c.length; n < s; n++) a = c[n],
                            Math.abs(e.pinY - a) <= 3 && (e.pinY = a);
                            return $("#screen .horizon_line.top").css("top", d.h() - e.pinY + "px").show(),
                            $("#screen .fh").css("bottom", e.pinY + "px"),
                            $("#screen .fh .counter").text(e.pinY)
                        }
                    }
                }
            } (this)),
            $(window).mouseup(function(e) {
                return function() {
                    var t, i, n, r, s, o;
                    if (e.htY || e.ftY) {
                        for (n = MB.currentScreen, null !== e.htY && (n.hh = Math.round(100 * e.pinY / MB.scale())), null !== e.ftY && (n.fh = Math.round(100 * e.pinY / MB.scale())), n.lsave(), $("#ssliglobal").hasClass("active") ? (o = n.cscreenstates(), o.push(Screenstate.find(n.cid + "default"))) : (s = n.state_cid, "default" === s && (s = n.cid + s), o = [Screenstate.find(s)]), t = 0, i = o.length; t < i; t++) r = o[t],
                        r && (r.hh = n.hh, r.fh = n.fh, r.lsave(r.cid !== n.cid + "default"));
                        return e.htY = e.ftY = null,
                        $("#screen .horizon_line").hide(),
                        $("#screen .slider .counter").hide()
                    }
                }
            } (this))
        },
        e.prototype.updatePin = function(e) {
            return e = MB.currentScreen,
            e._widgetsByName = null,
            $("#screen .hh").css("top", e.headerHeight() + "px"),
            $("#screen .hh .counter").text(e.headerHeight()),
            $("#screen .fh").css("bottom", e.footerHeight() + "px"),
            $("#screen .fh .counter").text(e.footerHeight())
        },
        e
    } ()
}.call(this),
function() {
    var e;
    this.UndoStack = function() {
        function t() {
            MB.stacks = {},
            $("body").on("undoStack:add",
            function(e) {
                return function(t, i, n) {
                    return e.stack().add(i, n)
                }
            } (this)),
            $("body").on("undoStack:undo",
            function(e) {
                return function() {
                    return e.stack().undo()
                }
            } (this)),
            $("body").on("undoStack:redo",
            function(e) {
                return function() {
                    return e.stack().redo()
                }
            } (this))
        }
        return t.prototype.stack = function() {
            var t, i;
            return i = $("#screen").data("cid") + $("#screenstate_list .item.active").data("cid"),
            (t = MB.stacks)[i] || (t[i] = new e(i))
        },
        t
    } (),
    e = function() {
        function e(e) {
            this.cid = e,
            this.index = 0,
            this.stack = []
        }
        return e.prototype.add = function(e, t) {
            return this.stack[this.index] = [e, t],
            this.index += 1,
            this.stack.splice(this.index, this.stack.length - this.index),
            this.stack.length > 50 && (this.stack.splice(0, 1), this.index -= 1),
            MB.renderToolbar()
        },
        e.prototype.canUndo = function() {
            return this.index > 0
        },
        e.prototype.canRedo = function() {
            return this.index < this.stack.length
        },
        e.prototype.updateStatusBar = function() {
            return $("#design").trigger("status_bar:update", !!$("#screen .status_bar").length)
        },
        e.prototype.undo = function() {
            var e, t;
            if (0 !== this.index) return this.index -= 1,
            this.stack[this.index] && (e = this.stack[this.index][0], t = this.stack[this.index][1], e ? this.restore(e) : this.remove(t)),
            MB.renderToolbar(),
            this.updateStatusBar(),
            MB.renderLinks(!0),
            $("#design").trigger("slider:update")
        },
        e.prototype.redo = function() {
            var e, t;
            if (! (this.index >= this.stack.length)) return this.stack[this.index] && (e = this.stack[this.index][0], t = this.stack[this.index][1], t ? this.restore(t) : this.remove(e)),
            this.index += 1,
            MB.renderToolbar(),
            this.updateStatusBar(),
            MB.renderLinks(!0),
            $("#design").trigger("slider:update")
        },
        e.prototype.restore = function(e) {
            var t, i, n, r;
            for (r = [], t = 0, n = e.length; t < n; t++) i = e[t],
            i.z && "panel" !== i.name && (this.restoreWidget(i), r.push(i)),
            i.template_cid && (this.restorePanel(i), r.push(i)),
            i.transition && this.restoreLink(i),
            i.orientation && this.restoreScreen(i);
            if (r.length) return MB.selection.select(r)
        },
        e.prototype.remove = function(e) {
            var t, i, n, r, s;
            for (s = [], t = 0, r = e.length; t < r; t++) i = e[t],
            i.sc && (WidgetManager.remove(i.cid), s.push(i)),
            i.template_cid && (PanelManager.remove(i.cid), s.push(i)),
            i.transition && (n = Link.find(i.cid), n && n.ldestroy(), MB.renderLinks());
            if (s.length) return $("body").trigger("selection:clear")
        },
        e.prototype.restoreWidget = function(e) {
            var t, i, n, r, s, o, a, l, c;
            if (l = Widget.find(e.cid), !l) {
                for (l = e, l.lsave(), o = Widgetstate.findAllByAttribute("widget_cid", e.cid), i = 0, r = o.length; i < r; i++) c = o[i],
                c.screenstate_cid !== e.screenstate_cid && c.lsave();
                return ScreenManager.appendWidget(e)
            }
            if (l.restore(e), l.lsave(), WidgetManager.update(l), "status_bar" === l.name && $("#design").trigger("carrier:update", [l.text]), e.itemstates) {
                for (s = Widgetstate.findAllByAttribute("widget_cid", e.cid), a = [], t = 0, n = s.length; t < n; t++) c = s[t],
                e.itemstates[c.screenstate_cid] && (c.load(e.itemstates[c.screenstate_cid]), a.push(c.lsave(!0, !1)));
                return a
            }
        },
        e.prototype.restorePanel = function(e) {
            var t, i, n, r, s, o, a, l, c, d;
            if (s = Panel.find(e.cid), !s) {
                for (s = e, s.lsave(), d = Template.find(s.template_cid), d.deleted && (d.deleted = !1, d.lsave()), l = Panelstate.findAllByAttribute("panel_cid", e.cid), i = 0, r = l.length; i < r; i++) o = l[i],
                o.screenstate_cid !== e.screenstate_cid && o.lsave();
                return ScreenManager.appendPanel(s)
            }
            if (s.restore(e), s.lsave(), PanelManager.design(s), e.itemstates) {
                for (a = Panelstate.findAllByAttribute("panel_cid", e.cid), c = [], t = 0, n = a.length; t < n; t++) o = a[t],
                e.itemstates[o.screenstate_cid] && (o.load(e.itemstates[o.screenstate_cid]), c.push(o.lsave(!0, !1)));
                return c
            }
        },
        e.prototype.restoreLink = function(e) {
            var t, i, n, r, s;
            if (Link.exists(e.cid) && (n = Link.find(e.cid)), n) return n.restore(e),
            n.lsave(),
            MB.selection.select(n.cwidgets());
            if (n = e, n.screen_cid = $("#screen").data("cid"), n.panel_cid = $(".panel.selected").data("cid") || "", n.lsave(), !n.panel_cid) for (r = n.cwidgets(), t = 0, i = r.length; t < i; t++) s = r[t],
            s.gid = n.cid,
            s.lsave();
            return MB.selection.select(n.cwidgets())
        },
        e.prototype.restoreScreen = function(e) {
            return $("#design").trigger("screen:restore", [e])
        },
        e
    } ()
}.call(this),
function() {
    this.WidgetManager = function() {
        function e() {
            $("#design").on("click", "#canvas > .widget",
            function(t) {
                var i;
                return i = $(t.target).closest(".widget"),
                i.css("border", i.data("old-border")),
                e.select(t)
            }),
            $("#design").on("mousedown", "#canvas select",
            function(e) {
                return e.preventDefault()
            }),
            $("#design").on("mousedown", "#canvas input",
            function(e) {
                return e.preventDefault()
            }),
            $("#design").on("mousedown", "#canvas textarea",
            function(e) {
                return e.preventDefault()
            })
        }
        return e.select = function(e) {
            var t, i;
            if (! (MB.selection.flagBucket.selectingMoved && MB.selection.flagBucket.selectEffect || $("#text_editor").length)) return e.preventDefault(),
            e.stopPropagation(),
            t = $(e.target).closest(".widget").attr("data-cid"),
            i = Widget.find(t),
            e.shiftKey ? $("body").trigger("selection:append", [i]) : e.ctrlKey || e.metaKey ? MB.penetrateSelect(e, i.cid) : ($("body").trigger("selection:clear"), $("body").trigger("selection:select", [[i]])),
            MB.selection.flagBucket.selectingMoved = !1,
            MB.selection.flagBucket.selectEffect = !1
        },
        e.remove = function(e) {
            var t;
            return $("#widget" + e).remove(),
            Widget.exists(e) && (t = Widget.find(e), t.ldestroy()),
            $("#design").trigger("slider:update")
        },
        e.update = function(e, t) {
            var i;
            if (null == t && (t = ""), i = document.getElementById("widget" + e.cid + t)) return i.outerHTML = MB.widget(e, t),
            i = document.getElementById("widget" + e.cid + t),
            "sticky" === e.name ? this.renderSticky(e, i, t) : void 0
        },
        e.updateClipPath = function(e) {
            var t;
            return t = document.getElementById("widget" + e.cid),
            t.style.clipPath = t.style.webkitClipPath = e.clip
        },
        e.renderOutline = function(e) {
            var t;
            if (t = document.getElementById("widget" + e.cid)) return "number" == typeof e.left && (t.style.left = e.l() + "px"),
            "number" == typeof e.top ? t.style.top = e.t() + "px": void 0
        },
        e.bg = function(e, t) {
            return MB.rgb2hex($(t).css("background-color"))
        },
        e.bc = function(e, t) {
            var i;
            return i = $(t).css("border-left-color") || $(t).css("border-top-color") || $(t).css("border-right-color") || $(t).css("border-bottom-color"),
            MB.rgb2hex(i)
        },
        e.tc = function(e, t) {
            return MB.rgb2hex($(t).css("color"))
        },
        e.newImageView = function(e, t, i, n) {
            var r, s, o, a;
            return a = e.width,
            r = e.height,
            a > n.width && (r = Math.round(r * (n.width / a)), a = n.width),
            s = "image_view",
            o = new Widget({
                name: s,
                width: a,
                height: r,
                bs: MB.COMPONENTS[s].bs,
                br: MB.COMPONENTS[s].br,
                image: e.cid,
                screen_cid: n.cid,
                cid: "w" + Math.uuid(10, 16) + (new Date).valueOf(),
                z: Math.max(n.maxZ(), MB.COMPONENTS.image_view.z)
            }),
            o.setL(t),
            o.setT(i),
            $("#canvas").append(MB.widget(o)),
            o.lsave(),
            o
        },
        e.render = function(e, t) {
            var i, n, r, s, o, a;
            if (null == t && (t = ""), "panel" !== e.name && (i = document.getElementById("widget" + e.cid + t))) {
                for (i.className = MB.widgetClassName(e, t), s = MB.widgetStyle(e, t), n = 0, r = s.length; n < r; n++) a = s[n],
                o = a.split(":"),
                i.style[o[0]] = o[1];
                return this.renderText(e, i),
                this.renderExtras(e, i, t),
                "sticky" === e.name ? this.renderSticky(e, i, t) : void 0
            }
        },
        e.renderText = function(e, t) {
            var i;
            if (t && (i = t.getElementsByClassName("text")[0])) return e.richedit ? i.innerHTML = MB.v.multiline(e.text) : i.innerHTML = "" + e.text
        },
        e.renderExtras = function(e, t, i) {
            var n;
            if (t) return n = "_render_" + e.name,
            "function" == typeof this[n] ? this[n](e, t, i) : void 0
        },
        e._render_label = function(e, t) {
            var i;
            return i = e.text,
            /<p>/.test(e.text) || (i = "<p>" + i + "</p>"),
            t.innerHTML = i
        },
        e._render_text_align = function(e, t) {
            var i;
            return t.className = t.className.replace(/v(middle|top|bottom)/, "v" + e.va),
            i = t.getElementsByClassName("text")[0],
            "middle" === e.va ? i.style.marginTop = 0 - e.textHeightS() / 2 + "px": i.style.marginTop = "0px"
        },
        e._render_text_view = function(e, t) {
            var i;
            return t.style.clipPath = e.clip,
            t.style.webkitClipPath = e.clip,
            i = t.getElementsByClassName("text")[0],
            i.style.padding = e.paddingS() + "px",
            this._render_text_align(e, t)
        },
        e._render_rounded_rect = function(e, t) {
            if (e.text) return this._render_text_align(e, t)
        },
        e._render_circle_rect = function(e, t) {
            if (e.text) return this._render_text_align(e, t)
        },
        e._render_hr = function(e, t) {
            var i, n;
            return n = t.getElementsByTagName("span")[0],
            i = e.h() - 10 * MB.scale() / 100,
            i < 1 && (i = 1),
            n.style.borderTopWidth = i + "px"
        },
        e._render_ve = function(e, t) {
            var i, n;
            return n = t.getElementsByTagName("span")[0],
            i = e.w() - 10 * MB.scale() / 100,
            i < 1 && (i = 1),
            n.style.borderLeftWidth = i + "px"
        },
        e._render_triangleb = function(e, t) {
            var i;
            return i = t.getElementsByTagName("span")[0],
            i.style.borderLeftWidth = e.w() / 2 + "px",
            i.style.borderRightWidth = e.w() / 2 + "px",
            i.style.borderBottomWidth = e.h() + "px",
            i.style.borderBottomColor = e.tc || $(t).css("color")
        },
        e._render_triangletl = function(e, t) {
            var i;
            return i = t.getElementsByTagName("span")[0],
            i.style.borderTopWidth = e.h() + "px",
            i.style.borderRightWidth = e.w() + "px",
            i.style.borderTopColor = e.tc || $(t).css("color")
        },
        e._render_status_bar = function(e, t) {
            var i, n, r, s, o, a, l;
            for (n = t.getElementsByClassName("body")[0], s = t.getElementsByClassName("inner")[0], r = t.getElementsByClassName("head")[0], l = t.getElementsByClassName("ball"), o = 0, a = l.length; o < a; o++) i = l[o],
            i.style.backgroundColor = e.tc;
            return n.style.borderColor = e.tc,
            s.style.backgroundColor = e.tc,
            r.style.backgroundColor = e.tc
        },
        e._render_search_bar = function(e, t) {
            var i;
            if (e.th && "light" !== e.th) return i = t.getElementsByClassName("text_edit")[0],
            i.style.background = MB.themes[e.th][2] || ""
        },
        e._render_button = function(e, t) {
            return this._render_icon_button(e, t)
        },
        e._render_icon_button = function(e, t) {
            var i, n;
            if (n = t.getElementsByTagName("i")[0]) return i = e.iconClassesAndText(!0),
            n.className = i[0],
            n.innerText = i[1],
            n.style.fontSize = e.iS() + "px"
        },
        e._render_image_view = function(e, t) {
            var i, n, r, s;
            return t.style.clipPath = e.clip,
            t.style.webkitClipPath = e.clip,
            e.image ? ("i" === e.image[0] && e.image.indexOf("images") === -1 ? (i = Asset.find(e.image), i && (s = i.raw || i.image)) : s = e.image, n = t.getElementsByTagName("img")[0], s && n.src !== s && (n.src = s), n.style.filter = e.filter.trim(), n.style.webkitFilter = e.filter.trim(), n.style.display = null, r = t.getElementsByTagName("span")[0], r.style.display = "none") : (n = t.getElementsByTagName("img")[0], n.style.display = "none", r = t.getElementsByTagName("span")[0], r.style.display = null)
        },
        e._render_webpage = function(e, t) {
            var i;
            if (i = $(t).find(".iframe"), i[0] && i.attr("data") !== e.text) return i.attr("data", MB.unescape(e.text))
        },
        e._render_switch = function(e, t) {
            return e.checked ? t.classList.add("checked") : t.classList.remove("checked")
        },
        e._render_mtooltip = function(e, t) {
            var i, n, r, s, o, a, l, c, d, u;
            for (r = t.querySelectorAll(".arrow"), l = 0, c = r.length; l < c; l++) s = r[l],
            s.classList.remove("top", "right", "bottom", "left"),
            s.classList.add(e.tt_placement),
            s.style.borderWidth = e.arrowSize() + "px",
            s.style.borderColor = "transparent",
            s.style.left = s.style.top = s.style.bottom = s.style.right = null;
            return i = t.querySelector(".arrow1"),
            n = t.querySelector(".arrow2"),
            i.style[e.tt_placement] = 0 - e.arrowSize() + "px",
            n.style[e.tt_placement] = 0 - e.arrowSize() + e.bS() + "px",
            o = {
                top: "borderBottomColor",
                bottom: "borderTopColor",
                left: "borderRightColor",
                right: "borderLeftColor"
            },
            a = o[e.tt_placement],
            i.style[a] = e.bc || "#aaa",
            n.style[a] = e.bg || "white",
            "top" === e.tt_placement || "bottom" === e.tt_placement ? (t.style.height = e.h() - e.arrowSize() + "px", i.style.left = n.style.left = e.ttOffset() + "px") : (t.style.width = e.w() - e.arrowSize() + "px", i.style.top = n.style.top = e.ttOffset() + "px"),
            d = function() {
                var t, i, n, r;
                for (n = ["top", "right", "bottom", "left"], r = [], t = 0, i = n.length; t < i; t++) a = n[t],
                a === e.tt_placement ? r.push(e.tt_arrow_size + "px") : r.push("0");
                return r
            } (),
            t.style.margin = d.join(" "),
            u = t.getElementsByClassName("text")[0],
            u.style.padding = e.paddingS() + "px",
            this._render_text_align(e, t)
        },
        e._render_mtext_input = function(e, t) {
            var i;
            return i = t.getElementsByTagName("input")[0],
            i.placeholder = e.text
        },
        e._render_mtextarea = function(e, t) {
            var i, n, r;
            return i = t.getElementsByTagName("textarea")[0],
            n = Math.round(e.padding * MB.scale() / 100),
            r = Math.round(n - (e.lh - e.fs) / 2),
            r < 0 && (r = 0),
            i.placeholder = e.text,
            i.style.padding = r + "px " + n + "px"
        },
        e._render_mcheckbox2 = function(e, t) {
            var i;
            return i = t.getElementsByTagName("input")[0],
            i.checked = e.checked
        },
        e._render_mradiobutton = function(e, t) {
            var i;
            return i = t.getElementsByTagName("input")[0],
            i.checked = e.checked
        },
        e._render_mselect = function(e, t) {
            var i, n;
            return n = function() {
                var t, n, r, s;
                for (r = e.text.split(/\n/), s = [], t = 0, n = r.length; t < n; t++) i = r[t],
                s.push("<option>" + i + "</option>");
                return s
            } ().join(""),
            t.innerHTML = "<select>" + n + "</select>"
        },
        e.design = function(e, t) {
            var i;
            if (null == t && (t = ""), i = document.getElementById("widget" + e.cid + t)) return "sticky" === e.name ? this.renderSticky(e, i, t) : void 0
        },
        e.renderSticky = function(t, i, n) {
            var r, s, o, a, l, c, d, u, h, p;
            if (l = i.className.replace(/(l|r)sticky/, ""), o = t.l() > 160 ? "rsticky": "lsticky", i.className = l.replace("sticky", "sticky " + o), d = $(i).find(".sideline"), s = $(i).find(".box"), a = $(i).find(".line"), r = $(i).find(".arrow"), d.css("width", t.slw * t.s() / 100 + "px"), d.css("display", ""), u = t.slt, t.slt < 20 ? (u = 20, s.css("border-bottom-width", "2px"), s.css("border-top-width", "0")) : t.slt > t.height - 20 && (u = t.height - 20, s.css("border-bottom-width", "0"), s.css("border-top-width", "2px")), c = (t.slt - u) * t.s() / 100, d.css("top", u * t.s() / 100 + "px"), t.bg && d.css("border-color", t.bg), s.css("height", Math.abs(c) + "px"), t.slt <= t.top - 20 ? s.css("top", c + "px") : s.css("top", ""), a.css("top", c + "px"), /p$/.test(n)) {
                if (20 === t.slt && 50 === t.slw) return d.css("display", "none")
            } else if (!r.hasClass("ui-draggable")) return r.on("click",
            function(e) {
                return e.stopPropagation()
            }),
            h = p = null,
            r.draggable({
                scroll: !1,
                start: function() {
                    return d.css("opacity", "1"),
                    t = Widget.find(t.cid),
                    h = t.slt,
                    p = t.slw
                },
                drag: function(n, r) {
                    return t.slt = h + r.position.top + 6,
                    t.l() > 160 ? t.slw = p - r.position.left - 10 : t.slw = p + r.position.left - .64 * p,
                    t.slw < 20 && (t.slw = 20),
                    e.renderSticky(t, i)
                },
                stop: function() {
                    return d.css("opacity", ""),
                    h = t.slt,
                    p = t.slw,
                    t.lsave()
                }
            })
        },
        e.transform = function(e, t, i, n) {
            var r, s;
            if (n.className = MB.widgetClassName(i, "p").replace("animated", ""), s = n.style, t.fs !== i.fs && (s.fontSize = i.fS() + "px"), t.bs !== i.bs && (s.borderWidth = i.bs + "px"), t.br !== i.br && (s.borderRadius = i.bR() + "px"), t.lh !== i.lh && (s.lineHeight = i.lH() + "px"), t.padding !== i.padding && (s.padding = i.paddingS() + "px"), i.bg !== t.bg && (s.backgroundColor = i.bg), i.tc !== t.tc && (s.color = i.tc), i.bc !== t.bc && (s.borderColor = i.bc), i.ls !== t.ls && (s.borderStyle = i.lineStyle()), i.bo !== t.bo && (s.fontWeight = i.bo ? "bold": "normal"), i.i !== t.i && (s.fontStyle = i.i ? "italic": "normal"), i.ds === t.ds && i.sc === t.sc || (r = MB.currentProject.isAndroid() ? MB.l.getMaterialShadow(i.ds, MB.hex2rgb(i.sc)) : "0 0 " + i.ds + "px " + i.sc, "icon_button" !== i.name ? s.boxShadow = r: s.textShadow = r), i.ts === t.ts && i.tsc === t.tsc || (s.textShadow = "0 0 " + i.ts + "px " + i.tsc), "label" === i.name && (i.ha !== t.ha && (s.justifyContent = {
                left: "flex-start",
                center: "center",
                right: "flex-end"
            } [i.ha]), i.va !== t.va && (s.alignItems = {
                top: "flex-start",
                middle: "center",
                bottom: "flex-end"
            } [i.va])), MB.isPhantom() || "none" === i.ani_name || ("0" !== i.ani_delay && (s.animationDelay = i.ani_delay), s.animationIterationCount = i.ani_count, "0" !== i.ani_duration && (s.animationDuration = i.ani_duration)), i.ro !== t.ro) return s.transform = "rotate(" + i.ro + "deg)"
        },
        e
    } ()
}.call(this),
function() {
    var e, t, i, n, r, s = function(e, t) {
        function i() {
            this.constructor = e
        }
        for (var n in t) o.call(t, n) && (e[n] = t[n]);
        return i.prototype = t.prototype,
        e.prototype = new i,
        e.__super__ = t.prototype,
        e
    },
    o = {}.hasOwnProperty;
    e = 50,
    t = 320,
    r = [50, 75, 100, 150, 200],
    n = {},
    i = function() {
        function i() {
            var i;
            MB.setRunnerExtra(n),
            this.scrollSync = new n.ScrollSync,
            this.webpackInvasion = new n.WebpackInvasion,
            this.timeoutBucket = new n.TimeoutBucket,
            this.eventBucket = new n.EventBucket,
            this.runnerUtil = new n.RunnerUtil,
            this.transitionUtil = new n.TransitionUtil,
            this.muteSimulatorMouseDown = !1,
            i = function(e) {
                return function(t) {
                    return e.muteSimulatorMouseDown = t
                }
            } (this),
            this.toggleBoard = new n.ToggleBoard(function(n) {
                var r, s, o, a, l, c, d, u;
                if (o = n.Screen, s = n.Comment, a = n.TextSelecting, $("#simulator-container").length) return c = Math.max(o ? t + e: 0, e),
                r = $("#simulator-container"),
                l = r[0],
                u = l.scrollLeft / (l.scrollWidth - r.width()),
                d = Math.round((l.scrollWidth + c - $(window).width()) * u),
                l.style.right = c + "px",
                r.animate({
                    scrollLeft: d,
                    duration: 100
                }),
                i(s || a)
            }),
            this.toggleBoard.addToggle("Screen", !1,
            function(e) {
                return function(t) {
                    return t && e.webpackInvasion.safeCall("webpackInterface", "callViewMethod", "screen", "start"),
                    t && e.webpackInvasion.safeCall("webpackInterface", "updateCurrentScreen"),
                    !t && e.webpackInvasion.safeCall("webpackInterface", "callViewMethod", "screen", "stop")
                }
            } (this)),
            this.toggleBoard.addToggle("Comment", !1,
            function(e) {
                return function(t) {
                    return t && e.webpackInvasion.safeCall("webpackInterface", "callViewMethod", "comment", "start"),
                    t && e.webpackInvasion.safeCall("webpackInterface", "updateCurrentScreen"),
                    !t && e.webpackInvasion.safeCall("webpackInterface", "callViewMethod", "comment", "stop")
                }
            } (this)),
            this.toggleBoard.addToggle("TextSelecting", !1,
            function() {
                return function(e) {
                    return $("#switch-mode").toggleClass("active", e),
                    $("#app").toggleClass("text-selecting", e),
                    $("#sticky-container").toggleClass("text-selecting", e),
                    $("#simulator-container").toggleClass("text-selecting", e)
                }
            } (this)),
            this.clearCallbackBucket = {},
            this.clearCallbackBucket.webpackInvasion = function(e) {
                return function() {
                    return e.webpackInvasion.clear()
                }
            } (this),
            this.clearCallbackBucket.toggleBoard = function(e) {
                return function() {
                    return e.toggleBoard.toggle("Screen", !1),
                    e.toggleBoard.toggle("Comment", !1),
                    e.toggleBoard.toggle("TextSelecting", !1)
                }
            } (this),
            $("body").on("click", "#switch-sharing",
            function() {
                return function() {
                    return MB.ga("send", "event", "feature", "\u70b9\u51fb\u4e86\u5206\u4eab\u6309\u94ae"),
                    MB.mp("\u70b9\u51fb\u4e86\u5206\u4eab\u6309\u94ae"),
                    MB.renderSharing(MB.project()),
                    $("#sharing-modal").modal()
                }
            } (this)),
            $("body").on("click", "#switch-screen",
            function(e) {
                return function() {
                    return MB.ga("send", "event", "feature", "\u70b9\u51fb\u4e86\u8fd0\u884c\u9875\u9875\u9762\u5217\u8868"),
                    MB.mp("\u70b9\u51fb\u4e86\u8fd0\u884c\u9875\u9875\u9762\u5217\u8868"),
                    e.toggleBoard.toggle("Screen")
                }
            } (this)),
            $("body").on("click", "#switch-comment",
            function(e) {
                return function() {
                    var t, i;
                    return MB.mp("\u70b9\u51fb\u4e86\u8bc4\u8bba\u6309\u94ae"),
                    t = MB.project(),
                    i = t.owner_plan,
                    t.expired && MB.user.id ? MB.promptRenew(t, "comments") : (MB.mp("\u6253\u5f00\u4e86\u8bc4\u8bba\u9762\u677f"), e.toggleBoard.toggle("Comment"))
                }
            } (this)),
            $("body").on("click", "#switch-mode",
            function(e) {
                return function() {
                    return e.toggleBoard.toggle("TextSelecting")
                }
            } (this)),
            $("body").on("click", "#back_prev",
            function(e) {
                return function() {
                    return e.backPrev()
                }
            } (this)),
            $("body").on("click", "#zoomin",
            function(e) {
                return function() {
                    return e.zoom(1)
                }
            } (this)),
            $("body").on("click", "#zoomout",
            function(e) {
                return function() {
                    return e.zoom( - 1)
                }
            } (this)),
            this.eventBucket.bind({
                onScreenFocus: function(e) {
                    return function() {
                        return MB.config.fileSelecting ? MB.config.fileSelecting = !1 : e.reload()
                    }
                } (this)
            }),
            MB.isMobile() ? this.eventBucket.bindMobile({
                onOrientationChange: function(e) {
                    return function() {
                        return setTimeout(function() {
                            return e.reload(!0)
                        },
                        100)
                    }
                } (this)
            }) : this.eventBucket.bindDesktop({
                onAppMouseDown: function(e) {
                    return function(t, i) {
                        var n, r, s, o;
                        return !! e.muteSimulatorMouseDown || ( !! $(t.target).closest(".sticky, .webpage, .comment-marker").length || (n = $(t.target).closest(".map_view .image"), !(!n.length && (n = $(t.target).closest(".ppanel"), s = Panel.find(n.data("cid")), s && s.timerFired)) && (n.length ? r = o = n[0] : (r = $(t.target).closest(".widgets")[0], r && "web" !== MB.currentProject.device || (r = $("#simulator-container")[0]), o = $(t.target).closest(".widgets")[0] || r), !r && !o || (!($(r).width() < r.scrollWidth || $(o).height() < o.scrollHeight) || (i.vScrollTarget = o, i.hScrollTarget = r, i.top = o.scrollTop, i.left = r.scrollLeft, !1)))))
                    }
                } (this),
                onAppMouseMove: function() {
                    return function(e, t, i) {
                        var n, r, s, o, a, l;
                        return n = t.hScrollTarget,
                        o = t.vScrollTarget,
                        s = t.top,
                        r = t.left,
                        a = t.x,
                        l = t.y,
                        !i.down || (e.preventDefault(), n && (n.scrollLeft = Math.min(r - e.clientX + a, n.scrollWidth - $(n).width())), o ? o.scrollTop = Math.min(s - e.clientY + l, o.scrollHeight - $(o).height()) : void 0)
                    }
                } (this)
            }),
            window.addEventListener("message",
            function(e) {
                return function(t) {
                    var i;
                    try {
                        if (i = JSON.parse(t.data), "back" === i.event) return e.backPrev()
                    } catch(e) {}
                }
            } (this), !1),
            MB.isMobile() || $(document).on("dragstart",
            function(e) {
                if ("IMG" === e.target.nodeName.toUpperCase()) return e.preventDefault(),
                !1
            })
        }
        return i.prototype.init = function() {
            var e, t;
            return e = "transparent" === this.home.bgcolor ? "#f2f2f2": this.home.bgcolor,
            $("#simulator .splash").css("background-color", e),
            $("#app").show(),
            $("#simulator").css("overflow", "hidden"),
            this.prepareOrientation(this.home),
            this.home.setupSplash("#simulator .splash img"),
            this.project.setup(),
            this.pages = {},
            this.setupPG(),
            this.currentScreen = this.currentMenu = null,
            t = setTimeout(function(e) {
                return function() {
                    return $("#gs").show(),
                    $("#simulator .splash").hide(),
                    $("#splash").hide(),
                    $("#simulator").css("overflow", "visible"),
                    e.renderScreen(),
                    e.doneTransition($(".pcanvas.active")),
                    "function" == typeof MB.onload && MB.onload(),
                    window.parent.postMessage(JSON.stringify({
                        event: "ready"
                    }), "*"),
                    window.parent.WebViewBridge && window.parent.WebViewBridge.send("ready"),
                    e.webpackInvasion.initWebpackInterface(e.webpackInvasion.getPreviewObserverMap(e))
                }
            } (this), 1e3),
            this.clearCallbackBucket.init = function() {
                return clearTimeout(t)
            }
        },
        i.prototype.clear = function() {
            var e, t, i;
            i = this.clearCallbackBucket;
            for (t in i)(e = i[t])();
            return this.timeoutBucket.clear(),
            this.pages = {}
        },
        i.prototype.loadScreen = function(e) {
            var t, i, n, r;
            if (this.currentMenu) return void this.closeMenu(function(t) {
                return function() {
                    return t.loadScreen(e)
                }
            } (this));
            if ($(".pcanvas.active").data("cid") !== e && (this.currentScreen = this.currentMenu = null, n = Screen.find(e))) return this.timeoutBucket.clear(),
            r = this.setOrientation(n.cid, "none", !0),
            this.prepareTransition(n.cid, r),
            $(".pcanvas.menu").removeClass("lmenu rmenu menu"),
            t = $(".pcanvas.active"),
            i = $("#pscreen" + n.cid),
            this.transitionUtil.doTransition("none", t, i, new Link)
        },
        i.prototype.backPrev = function() {
            var e;
            return this.home.cid === $(".pcanvas.active").data("cid") ? void window.parent.postMessage(JSON.stringify({
                event: "exit"
            }), "*") : (e = new Link({
                target_cid: "prev",
                transition: "none"
            }), this.j(e))
        },
        i.prototype.closeMenu = function(e) {
            var t, i, n;
            return i = $("#pscreen" + this.currentScreen),
            t = $("#pscreen" + this.currentMenu),
            n = function(n) {
                return function() {
                    return n.transitionUtil.hideScreen(t),
                    t.removeClass("drawer ldrawer rdrawer"),
                    i.removeClass("menu lmenu rmenu"),
                    n.doneTransition(i),
                    n.currentScreen = n.currentMenu = null,
                    $.nextTick(function() {
                        if ("function" == typeof e) return e()
                    })
                }
            } (this),
            i.hasClass("menu") ? (i.transitionEnd(n), i.enableTransition("0.3s"), i.translateX(0)) : t.hasClass("drawer") ? (t.transitionEnd(n), t.enableTransition("0.3s"), t.hasClass("ldrawer") ? t.translateX(0 - this.transitionUtil.activeWidth()) : t.translateX(this.transitionUtil.activeWidth())) : void 0;
        },
        i.prototype.pj = function(e, t) {
            var i, n, r, s, o, a, l, c, d, u, h;
            if (!this.muteSimulatorMouseDown && this.eventBucket.isCoolDown() && !this.timerFired) {
                if (i = $(e.target).closest(".clickable"), r = $(e.target).closest(".ppanel"), n = $(e.target).closest(".pcanvas"), "shake" === t && (n = this.currentMenu ? $("#pscreen" + this.currentMenu) : $(".pcanvas.active")), this.currentMenu && n.data("cid") !== this.currentMenu && !$(e.target).closest("#gh, #gf").length) return this.closeMenu();
                if (r.length) {
                    if (this.panelEventHandler(e, t)) return
                } else if (i.length && (l = Link.find(i.attr("data-link_cid")), l && l.gesture === t)) return this.j(l);
                if (s = n.data("cid"), d = Screen.find(s)) {
                    for (c = Widget.records, o = 0, a = c.length; o < a; o++) if (u = c[o], u.screen_cid === d.cid && "pg" === u.name && (h = u.getState(d.state_cid), h.gid && (l = Link.find(h.gid)) && l.gesture === t)) return this.j(l);
                    if (!this.eventBucket.mouseState.moved) {
                        if ("hold" === t) return window.parent.postMessage(JSON.stringify({
                            event: "settings",
                            payload: JSON.stringify(MB.currentProject.cscreens())
                        }), "*"),
                        void(window.parent.WebViewBridge && window.parent.WebViewBridge.send("settings"));
                        if (!$(e.target).closest(".widget").hasClass("sticky")) return MB.project().highlight ? this.highlightClickables(e) : void 0
                    }
                }
            }
        },
        i.prototype.panelEventHandler = function(e, t) {
            var i, n, r, s, o, a, l, c, d, u, h, p;
            if (n = $(e.target).closest(".clickable"), i = $(e.target).closest(".ppanel"), r = i.find(".pstate.active"), s = i.data("cid"), c = Panel.find(s), n.length) {
                if (l = Link.find(n.attr("data-link_cid")), !l) return ! 1;
                if ("prev" === l.target_cid) return this.j(l),
                !0;
                if (l.gesture === t) {
                    if (i[0] === n[0]) this.j(l);
                    else if ($("#pscreen" + l.target_cid).length) this.j(l);
                    else {
                        if (c.timerFired) return ! 1;
                        h = "#" + i.attr("id").replace(/pg[h|f]$/, "p"),
                        this.panelWJ(l, $(h)),
                        $("#panel" + s + "pgh").length && this.panelWJ(l, $("#panel" + s + "pgh")),
                        $("#panel" + s + "pgf").length && this.panelWJ(l, $("#panel" + s + "pgf"))
                    }
                    return ! 0
                }
            }
            if (u = Screen.find(r.data("cid")), !u) return ! 1;
            for (d = u.cwidgets(), o = 0, a = d.length; o < a; o++) if (p = d[o], "pg" === p.name && (l = Link.find(p.gid), p.icon === t && l)) return ! c.timerFired && (h = "#" + i.attr("id").replace(/pg[h|f]$/, "p"), this.panelWJ(l, $(h)), $("#panel" + s + "pgh").length && this.panelWJ(l, $("#panel" + s + "pgh")), $("#panel" + s + "pgf").length && this.panelWJ(l, $("#panel" + s + "pgf")), !0);
            return ! 1
        },
        i.prototype.highlightClickables = function() {
            return $(".pcanvas.active .region, #gh .region, #gf .region").show(),
            $(".pcanvas.active .pg").css("opacity", "0.8").show(),
            this.hightTimer = setTimeout(function() {
                return $(".pcanvas.active .region, #gh .region, #gf .region").hide(),
                $(".pcanvas.active .pg").css("opacity", "0").hide()
            },
            400)
        },
        i.prototype.j = function(e) {
            var t, i, n, r, s, o;
            if (e) {
                if (this.timeoutBucket.clear(), s = e.screen_cid, i = e.target_cid, o = e.transition, this.currentMenu) return i === $(".pcanvas.active").data("cid") ? this.closeMenu() : e.targetstate_cid ? this.stateTransition(e) : void this.closeMenu(function(t) {
                    return function() {
                        return t.j(e)
                    }
                } (this));
                if (e.targetstate_cid) return this.stateTransition(e);
                if (i && ("prev" === i || $("#pscreen" + i).length)) {
                    if ("prev" === i) {
                        if (r = $(".pcanvas.active").data("prev"), !r) return;
                        if (i = r.pop(), !i) return;
                        $(".pcanvas.active").data("prev", r)
                    } else r = $("#pscreen" + i).data("prev"),
                    r || (r = []),
                    r.push($(".pcanvas.active").data("cid")),
                    $("#pscreen" + i).data("prev", r);
                    return t = $(".pcanvas.active"),
                    n = $("#pscreen" + i),
                    o = this.setOrientation(i, o, e.reset),
                    this.prepareTransition(i, o),
                    this.transitionUtil.doTransition(o, t, n, e)
                }
            }
        },
        i.prototype.panelWJ = function(e, t) {
            var i, n, r;
            if (e && (i = e.target_cid, r = e.transition, n = t.data("cid"), i)) return this.preparePanelTransition(i, r, t,
            function(s) {
                return function() {
                    var o, a;
                    return o = t.find(".pstate.active"),
                    a = t.find("#state" + n + i + "p"),
                    s.transitionUtil.doTransition(r, o, a, e)
                }
            } (this))
        },
        i.prototype.prepareTransition = function(e, t) {
            var i, n, r, s, o, a, l, c, d;
            if (this.timerFired = !0, i = $(".pcanvas.active").removeClass("top drawer ldrawer rdrawer"), i.find(".pstate").css("transition", "none"), n = $("#pscreen" + e), n.show(), d = Screen.find(e), this.renderWidgets(d), "leftmenu" !== t && "rightmenu" !== t && "leftdrawer" !== t && "rightdrawer" !== t || (this.currentScreen = i.data("cid"), this.currentMenu = e, t.indexOf("menu") !== -1 && ($(".pcanvas.active .widgets")[0].scrollTop = 0)), "slideleft" !== t && "slideright2" !== t && "slideright" !== t && "slideleft2" !== t && this.runnerUtil.setScreenBg(i), "slideright" !== t && "slideleft" !== t && "slidebottom" !== t && "slidetop" !== t && this.runnerUtil.setScreenBg(n), this.transitionUtil.transitionHandler(t, i, n, this.transitionUtil.activeWidth() - 1, this.transitionUtil.activeHeight() - 1), $("#gf .keyboard").hide(), $(".pcanvas.active .sheader").css("height", 0), $(".pcanvas.active .sfooter").css("height", 0), "slideright" !== t && "slideleft" !== t && "none" !== t && ($("#gh").css("top", 0 - $("#gh").height()), $("#gf").css("bottom", 0 - $("#gf").height())), $("#pscreen" + d.cid + " .panel").length) {
                for (l = d.cpanels(), c = [], s = 0, o = l.length; s < o; s++) a = l[s],
                (r = $("#panel" + a.cid + "p")[0]) && this.activatePanelMainState(a, r, "p"),
                (r = $("#panel" + a.cid + "pgh")[0]) && this.activatePanelMainState(a, r, "pgh"),
                (r = $("#panel" + a.cid + "pgf")[0]) ? c.push(this.activatePanelMainState(a, r, "pgf")) : c.push(void 0);
                return c
            }
        },
        i.prototype.preparePanelTransition = function(e, t, i, n) {
            var r, s, o, a, l;
            return null == n && (n = null),
            "leftmenu" !== t && "rightmenu" !== t && "leftdrawer" !== t && "rightdrawer" !== t || (t = "none"),
            a = i.data("cid"),
            o = Panel.find(a),
            l = Screen.find(e),
            s = i.find("#state" + a + e + "p"),
            s.length || (l.panel_cid = o.cid, i[0].innerHTML += MB.PanelState(l, !0, !1), s = i.find("#state" + a + e + "p")),
            r = i.find(".pstate.active"),
            s.show(),
            s.enableTransition("10ms"),
            n && "function" == typeof n && ("popin" === t || "slidebottom" === t || "topin" === t || "slidetop" === t || "slideright" === t || "slideleft2" === t || "slideleft" === t || "slideright2" === t ? s.transitionEnd(function() {
                return n()
            }) : setTimeout(function() {
                return n()
            },
            10)),
            setTimeout(function(e) {
                return function() {
                    return e.transitionUtil.transitionHandler(t, r, s, i.width() - 1, i.height() - 1)
                }
            } (this))
        },
        i.prototype.doneTransition = function(e) {
            var t, i, n;
            return e.removeClass("menu lmenu rmenu"),
            e.zindex(""),
            e.disableTransition(),
            e.hasClass("state") ? (this.setupPanelLinks(e), this.setupPanelAnimationAndFixed(e), t = Panel.find(e.closest(".ppanel").data("cid")), i = Screen.find(e.data("cid")), this.setupPanelTimers(t, i), t.timerFired = !1, void t.lsave(!1)) : (n = Screen.find(e.data("cid")), this.setupBackground(e, n), this.setupPageTimers(n), this.setupFixedWidgets(n), this.setupStatusBar(n), MB.isAndroid() && this.setupPageGesture(n), this.timerFired = !1, MB.isMobile() || (this.updateBackButton(e), MB.currentScreen = n, this.webpackInvasion.safeCall("webpackInterface", "updateCurrentScreen"), $("#sticky-container #stickies").html($(".pcanvas.active .stickies").html()), this.scrollSync.init($(".pcanvas.active .widgets")[0], $("#sticky-container")[0]), MB.isPhantom() || ($("#gs .ppanel, #gh .ppanel, #gf .ppanel").perfectScrollbar({
                handlers: ["click-rail", "drag-scrollbar", "wheel", "touch"]
            }), e.find(".ppanel").perfectScrollbar({
                handlers: ["click-rail", "drag-scrollbar", "wheel", "touch"]
            }))), "function" == typeof MB.screenLoaded && MB.screenLoaded(n.cid), setTimeout(function(e) {
                return function() {
                    var t, i, r, s, o, a;
                    for (s = n.clinks(), o = [], t = 0, r = s.length; t < r; t++) i = s[t],
                    i.target_cid && "prev" !== i.target_cid && (a = Screen.find(i.target_cid), a && a.project_cid === n.project_cid ? (e.renderWidgets(a), o.push($("#pscreen" + a.cid).enableTransition("10ms"))) : o.push(void 0));
                    return o
                }
            } (this), 10))
        },
        i.prototype.updateBackButton = function(e) {
            return e.data("cid") !== this.project.homeScreen().cid ? $("#back_prev").removeClass("disabled") : $("#back_prev").addClass("disabled")
        },
        i.prototype.prepareOrientation = function(e) {
            var t, i, n, r, s, o, a, l, c, d, u, h, p;
            return t = $("#simulator"),
            MB.isMobile() ? (h = [], s = "", n = u = 0, MB.validDevice(this.project) ? this.runnerUtil.deviceOrient() === e.orient() ? (p = $(window).width(), i = $(window).height()) : (i = $(window).width(), p = $(window).height(), u = 0 - i, h.push("rotate(90deg)"), s = "bottom left") : (p = e.dW(), i = e.dH(), MB.isiPad() && ["ipad_3_4", "ipad_pro"].indexOf(this.project.model) !== -1 && p <= $(window).width() ? (n = 0, u = ($(window).height() - i) / 2) : (this.runnerUtil.deviceOrient() === e.orient() || "web" === e.cp().device ? (this.scale = $(window).width() / p, i = Math.round($(window).height() / this.scale)) : (this.scale = $(window).height() / p, i = Math.round($(window).width() / this.scale), u = 0 - i, h.push("rotate(90deg)"), s = "bottom left"), MB.isWechat() && MB.isAndroid() ? (r = window.onresize, window.onresize = null, document.querySelector("meta[name=viewport]").setAttribute("content", "width=device-width, initial-scale=" + this.scale + ", maximum-scale=" + this.scale + ", user-scalable=0"), setTimeout(function() {
                return window.onresize = r
            },
            10)) : h.push("scale(" + this.scale + ")"))), s ? setTimeout(function() {
                return t.css({
                    "transform-origin": s,
                    transform: h.join(" ")
                })
            },
            0) : t.css({
                "transform-origin": s,
                transform: h.join(" ")
            })) : MB.isEmbedded() || MB.isPhantom() ? (p = e.dW(), i = e.dH(), u = n = 0) : this.project.isWeb() ? (p = e.dW(), i = Math.min(e.h(), $(window).height()), u = i > $(window).height() ? 0 : Math.round(($(window).height() - i) / 2) + "px", n = 600, t.css({
                padding: 0,
                "border-radius": 0
            }), $("#sticky-container").css({
                top: 0,
                left: 0
            }), $("#simulator-wrapper").css("height", ""), this.setupSimulatorWrapper(p)) : (d = e.cp().shell(), c = this.project.scale / 100, p = Math.round(d.width * c), i = Math.round(d.height * c), a = Math.round(d.top * c), o = Math.round(d.left * c), e.orient() !== MB.currentProject.homeScreen().orient() && (l = [i, p, o, a], p = l[0], i = l[1], a = l[2], o = l[3]), $("#sticky-container").css({
                top: a,
                left: o
            }), t.css({
                "padding-top": a,
                "padding-left": o,
                "padding-bottom": i - e.dH() - a,
                "padding-right": p - e.dW() - o,
                "border-radius": 10
            }), u = Math.max(10, Math.round(($(window).height() - i) / 2)), $("#simulator-wrapper").outerHeight(2 * u + i), n = 600, this.setupSimulatorWrapper(p)),
            this.scale || (this.scale = 1),
            p && t.outerWidth(p),
            i && t.outerHeight(i),
            t.css({
                left: n,
                top: u
            }),
            t.attr("class", this.project.shell().device + " " + e.orient() + " " + this.project.device + " x" + this.project.scale)
        },
        i.prototype.setupSimulatorWrapper = function(e) {
            var t, i;
            return $("#simulator-wrapper").outerWidth(e + 1200),
            t = $("#simulator-container").width(),
            e + 1200 < t ? ($("#simulator-wrapper").css("left", (t - (e + 1200)) / 2), i = 0) : i = (e - t + 1200) / 2,
            $("#simulator-container")[0].scrollLeft = i
        },
        i.prototype.setOrientation = function(e, t, i) {
            var n, r, s;
            if (Screen.exists(e)) return s = Screen.find(e),
            r = s.orient(),
            n = $("#simulator"),
            n.hasClass(r) || (n.removeClass("portrait landscape"), n.addClass(r), this.prepareOrientation(s), this.hideActive(), this.clearCanvas(), t = "none"),
            i && "default" !== s.state_cid && this.resetScreen(e),
            t
        },
        i.prototype.hideActive = function() {
            var e;
            return e = $(".pcanvas.active").data("cid"),
            $(".pcanvas.active").hide()
        },
        i.prototype.resetScreen = function(e) {
            return $("#pscreen" + e + " .scontainer").html('<div class="sheader"></div><div class="sfooter"></div>'),
            $("#pscreen" + e + " .stickies").html(""),
            setTimeout(function() {
                return $("#pscreen" + e + " .widgets")[0].scrollTop = 0
            },
            100)
        },
        i.prototype.clearCanvas = function() {
            var e, t, i, n, r;
            for ($(".scontainer").html('<div class="sheader"></div><div class="sfooter"></div>'), $(".stickies").html(""), $("#gh").html(""), $("#gf").html(""), $("#gs").html(""), n = $(".pcanvas .widgets"), r = [], t = 0, i = n.length; t < i; t++) e = n[t],
            r.push(e.scrollTop = 0);
            return r
        },
        i.prototype.reload = function(e) {
            var t, i;
            return null == e && (e = !1),
            this.currentMenu ? void this.closeMenu(function(t) {
                return function() {
                    return t.reload(e)
                }
            } (this)) : (t = $(".pcanvas.active").data("cid"), Screen.exists(t) ? (i = Screen.find(t), e && this.prepareOrientation(i), this.clearCanvas(), this.prepareTransition(t, "none"), this.doneTransition($(".pcanvas.active"))) : void 0)
        },
        i.prototype.transformItem = function(e, t, i, n, r) {
            var s, o, a, l, c, d, u;
            return c = n.style,
            c.transition = r,
            t.width !== i.width && (c.width = i.w() + "px"),
            t.height !== i.height && (c.height = i.h() + "px"),
            d = i.t(),
            i.fixed ? i.isBottomFixed(e) && (d = MB.isIOS9() && MB.runner.deviceOrient() === e.orient() ? $("#simulator").height() - (e.h() - d) + MB.COMPONENTS.status_bar.height: $("#simulator").height() - (e.h() - d)) : /gf$/.test(n.id) && (s = i.t() + i.h(), o = 0 === e.footerHeight() ? Number.MAX_VALUE: Math.floor(e.h() - e.footerHeight()), s >= o && d < e.h() && (d -= o)),
            !i.fixed || t.fixed || /gh$/.test(n.id) ? !i.fixed && t.fixed && /gh$/.test(n.id) && (d -= $(".pcanvas.active .widgets")[0].scrollTop) : d += $(".pcanvas.active .widgets")[0].scrollTop,
            d !== t.t() && (c.top = d + "px"),
            t.l() !== i.l() && (c.left = i.l() + "px"),
            i.v ? (l = "auto", a = i.o / 100, u = i.fixed ? Widget.MAXZ + i.z: i.z) : (a = 0, u = i.z, l = "none"),
            c.zIndex = u,
            c.opacity = a,
            c.pointerEvents = l
        },
        i.prototype.transformWidget = function(e, t, i, n, r) {
            return this.transformItem(e, t, i, n, r),
            WidgetManager.transform(e, t, i, n, r)
        },
        i.prototype.activatePanelMainState = function(e, t, i) {
            var n;
            return this.timeoutBucket.clearTimeoutByKey(e.cid),
            n = e.mainState(),
            $("#panel" + e.cid + i + " .state").disableTransition(function() {
                var r, s;
                return s = $(t).find("#state" + e.cid + n.cid + i),
                s.length || (n.panel_cid = e.cid, t.innerHTML += MB.PanelState(n, !0, !1), s = $(t).find("#state" + e.cid + n.cid + i), MB.runner.setupPanelLinks(s)),
                r = $(t).find(".state.active"),
                r.css("transform", ""),
                r.removeClass("active top"),
                MB.runner.transitionUtil.hideScreen(r),
                MB.runner.setupPanelAnimationAndFixed(s),
                s.css("transform", ""),
                s.addClass("active top"),
                s.show()
            })
        },
        i.prototype.transformPanel = function(e, t, i, n, r, s) {
            var o;
            if (this.transformItem(e, t, i, n, r), o = !(!i.main_state_cid || t.main_state_cid === i.main_state_cid)) return this.activatePanelMainState(i, n, s),
            this.setupPanelTimers(i, i.mainState())
        },
        i.prototype.stateTransition = function(e) {
            var t, i, n, r, s, o, a, l, c, d, u;
            if (r = Screen.find(e.screen_cid), r.state_cid !== e.targetstate_cid) return l = e.targetstate_cid,
            d = e.ani_duration + " " + (e.ani_delay || "0s") + " " + (e.ani_easing || "linear"),
            a = Screenstate.find(l),
            u = [],
            Widget.select(function(e) {
                var t, i, n, s, o;
                return e.screen_cid === r.cid && (o = Widgetstate.find(r.state_cid + e.cid), s = Widgetstate.find(l + e.cid), o || s ? (o && (o.screen_cid = r.cid), s && (s.screen_cid = r.cid), o || (o = e), s || (s = e), (t = $("#widget" + e.cid + "p")[0]) && MB.runner.transformWidget(r, o, s, t, d), (i = $("#widget" + e.cid + "pgf")[0]) && MB.runner.transformWidget(r, o, s, i, d), (n = $("#widget" + e.cid + "pgh")[0]) && MB.runner.transformWidget(r, o, s, n, d), u.push([o, s, t, n, i]), !1) : void 0)
            }),
            n = [],
            Panel.select(function(e) {
                var t, i, s, o, a;
                if (e.screen_cid === r.cid && (a = Panelstate.find(r.state_cid + e.cid), o = Panelstate.find(l + e.cid), a || o)) return o && (o.cid = e.cid),
                a || (a = e),
                o || (o = e),
                (t = $("#panel" + e.cid + "p")[0]) && MB.runner.transformPanel(r, a, o, t, d, "p"),
                (s = $("#panel" + e.cid + "pgh")[0]) && MB.runner.transformPanel(r, a, o, s, d, "pgh"),
                (i = $("#panel" + e.cid + "pgf")[0]) && MB.runner.transformPanel(r, a, o, i, d, "pgf"),
                n.push([a, o, t, s, i]),
                !1
            }),
            i = r.headerHeight(),
            t = r.footerHeight(),
            r.setState(l, !0),
            this.timerFired = !1,
            o = u.sort(function(e, t) {
                return e[1].timestamp - t[1].timestamp
            }),
            s = n.sort(function(e, t) {
                return e[1].timestamp - t[1].timestamp
            }),
            this.timeoutBucket.setTimeout("stateTimer",
            function(e) {
                return function() {
                    var n, a, l, c, d, h, p, f, g, m, v, b, y, _, w, M, x;
                    for (d = r.headerHeight(), l = r.footerHeight(), i !== d && ($("#gh").css("height", d), $(".pcanvas.active .scontainer > .sheader").css("height", d)), t !== l && ($("#gf").css("height", l), $(".pcanvas.active .scontainer > .sfooter").css("height", l)), o = u.sort(function(e, t) {
                        return e[1].timestamp - t[1].timestamp
                    }), p = 0, m = o.length; p < m; p++) h = o[p],
                    _ = h[0],
                    x = h[1],
                    n = h[2],
                    c = h[3],
                    a = h[4],
                    "none" !== x.ani_name && (n && (n.className += " animated"), c && (c.className += " animated"), a && (a.className += " animated")),
                    _.text !== x.text && (WidgetManager.renderText(x, n), WidgetManager.renderText(x, a), WidgetManager.renderText(x, c)),
                    WidgetManager.renderExtras(x, n, "p"),
                    WidgetManager.renderExtras(x, c, "p"),
                    WidgetManager.renderExtras(x, a, "p");
                    for (w = o.concat(s), M = [], f = 0, v = w.length; f < v; f++) h = w[f],
                    y = h[0],
                    b = h[1],
                    n = h[2],
                    c = h[3],
                    a = h[4],
                    g = Link.find(b.gid),
                    g && (g.targetstate_cid && g.sourcestate_cid === b.screenstate_cid || g.target_cid) ? (b.v && (n && e.setupWidgetLink($(n), g), c && e.setupWidgetLink($(c), g), a && e.setupWidgetLink($(a), g)), MB.isPhantom() || !(g.timer > 0) || g.targetstate_cid && g.sourcestate_cid !== b.screenstate_cid ? M.push(void 0) : M.push(e.pageTimer(g))) : M.push($(n).removeClass("clickable"));
                    return M
                }
            } (this), 0),
            c = 1e3 * (parseFloat(e.ani_duration) + parseFloat(e.ani_delay || "0")),
            this.timeoutBucket.setTimeout("stateTimer2",
            function(t) {
                return function() {
                    var i, n, a, l, c, d, u, h, p, f, g, m, v;
                    for (u = r.headerHeight(), l = r.footerHeight(), v = o.concat(s), p = 0, f = v.length; p < f; p++) h = v[p],
                    m = h[0],
                    g = h[1],
                    n = h[2],
                    d = h[3],
                    a = h[4],
                    !m.fixed && g.fixed ? (d && d.remove(), d = t.runnerUtil.cloneFixed(r, g, $(n))[0], $("#gs")[0].appendChild(d)) : m.fixed && !g.fixed && ($(n).show(), d && d.remove(), d = null),
                    !g.fixed && n && (g.t() < u && !d ? (d = $(n).clone()[0], d.id = n.id + "gh", $("#gh")[0].appendChild(d)) : g.t() >= u && d && (d.remove(), d = null, $(n).show()), i = g.t() + g.h(), c = 0 === r.footerHeight() ? Number.MAX_VALUE: Math.floor(r.h() - r.footerHeight()), i >= c ? (a || (a = $(n).clone()[0], a.id = a.id + "gf", $("#gf")[0].appendChild(a)), $(a).disableTransition(function() {
                        return $(a).enableTransition(),
                        a.style.top = g.t() - c + "px"
                    })) : i < c && a && ($(n).show(), a.remove(), a = null));
                    if (!MB.isMobile()) return $("#sticky-container #stickies").html($("#pscreen" + e.screen_cid + " .stickies").html())
                }
            } (this), c)
        },
        i.prototype.setupWidgetLink = function(e, t) {
            var i, n;
            if (n = this.currentMenu ? Screen.find(this.currentMenu) : Screen.find($(".pcanvas.active").data("cid")), !(t.target_cid === n.cid || t.targetstate_cid && t.targetstate_cid === n.state_cid)) return e.addClass("clickable"),
            e.attr("data-link_cid", t.cid),
            e.find(".region").length ? void 0 : (i = "tap" !== t.gesture ? t.gesture: "", e.append("<div class='region gesture " + i + "'></div>"))
        },
        i.prototype.setupPanelLinks = function(e) {
            var t, i, n, r, s, o, a, l, c, d, u, h, p, f;
            for (d = Link.findAllByAttribute("screen_cid", e.data("cid")), i = 0, s = d.length; i < s; i++) r = d[i],
            h = e[0].id.replace(e.data("cid"), r.target_cid),
            $("#" + h).enableTransition("10ms");
            for (c = e[0].parentElement.dataset.cid, p = Link.findAllByAttribute("state_cid", e.data("cid")), n = 0, o = p.length; n < o; n++) for (r = p[n], u = r.cwidgets(), l = 0, a = u.length; l < a; l++) f = u[l],
            f.v && (t = e.find("#widget" + f.cid + c + "p"), this.setupWidgetLink(t, r));
            return setTimeout(function(e) {
                return function() {
                    var t, i, n, s;
                    for (n = [], i = 0, t = p.length; i < t; i++) r = p[i],
                    s = Screen.find(r.target_cid),
                    s ? (e.renderWidgets(s), n.push($("#pscreen" + s.cid).enableTransition("10ms"))) : n.push(void 0);
                    return n
                }
            } (this), 100)
        },
        i.prototype.setupPanelAnimationAndFixed = function(e) {
            var t, i, n, r, s, o, a, l, c, d;
            for (s = e[0].parentElement, i = s.getElementsByClassName("fixed")[0], o = s.dataset.cid, c = Screen.find(e.data("cid")), i.innerHTML = "", a = c.cwidgets(), l = [], n = 0, r = a.length; n < r; n++) d = a[n],
            t = e.find("#widget" + d.cid + o + "p"),
            d.fixed && (t = this.runnerUtil.cloneFixed(c, d, t, !1), i.appendChild(t[0])),
            "webpage" === d.name && d.text && !MB.isPhantom() ? l.push(this.runnerUtil.setObjectUrl(t.find(".iframe")[0], d.text.replace(/&amp;/g, "&"))) : l.push(void 0);
            return l
        },
        i.prototype.setupFixedWidgets = function(e) {
            var t, i, n, r, s, o, a, l, c, d, u, h, p, f, g, m, v, b, y, _, w, M, x, B;
            if (e) {
                for (h = e.headerHeight(), a = e.footerHeight(), $("#gh").css("height", h).css("top", 0).html("").removeClass("sb"), $("#gf").css("height", a).css("bottom", 0).html("").removeClass("sb"), $(".pcanvas.active .scontainer > .sheader").css("height", h), $(".pcanvas.active .scontainer > .sfooter").css("height", a), $("#gs").html(this.pages[e.cid].sbHTML), this.pages[e.cid].sbHTML && $("#gh, #gf").addClass("sb"), l = 0 === a ? Number.MAX_VALUE: Math.floor(e.h() - a), u = document.createDocumentFragment(), d = document.createDocumentFragment(), c = document.createDocumentFragment(), g = function() {
                    var t, i, n, r;
                    for (n = e.citems(), r = [], t = 0, i = n.length; t < i; t++) p = n[t],
                    ["sticky", "pg"].indexOf(p.name) === -1 && r.push(p);
                    return r
                } (), m = 0, b = g.length; m < b; m++) p = g[m],
                B = p.t(),
                i = "panel" === p.name ? $("#panel" + p.cid + "p") : $("#widget" + p.cid + "p"),
                s = Math.floor(B + i.outerHeight()),
                "webpage" === p.name && (p.text && !MB.isPhantom() ? this.runnerUtil.setObjectUrl(i.find(".iframe")[0], p.text.replace(/&amp;/g, "&")) : this.runnerUtil.setObjectUrl(i.find(".iframe")[0], "about:blank")),
                "image_view" === p.name && (/.gif$/.test(p.image) || (n = Asset.find(p.image)) && /.gif$/.test(n.image)) && (f = i.find("img")[0], f.src = f.src),
                p.fixed ? (i.removeClass("animated"), u.appendChild(this.runnerUtil.cloneFixed(e, p, i)[0])) : (B < h && (t = i.clone(), t.attr("id", t.attr("id") + "gh"), d.appendChild(t[0])), s >= l && B < e.h() && (t = i.clone(), t.attr("id", t.attr("id") + "gf"), t.css("top", B - l), c.appendChild(t[0])));
                for ($("#gs")[0].appendChild(u), $("#gh")[0].appendChild(d), $("#gf")[0].appendChild(c), v = 0, y = g.length; v < y; v++) if (p = g[v], "panel" === p.name) for (x = ["p", "pgh", "pgf"], w = 0, _ = x.length; w < _; w++) M = x[w],
                "panel" === p.name && (o = document.getElementById("panel" + p.cid + M), o && (r = $(o).find(".state.active"), this.setupPanelLinks(r), this.setupPanelAnimationAndFixed(r)));
                return $("#gf .keyboard").show(),
                $("#gs .status_bar").css("background-color", "transparent")
            }
        },
        i.prototype.setupStatusBar = function(e) {
            var t, i;
            if (e) return MB.isIOS() && window.navigator.standalone && ($(window).height() > $(window).width() ? ($("#gs .status_bar").addClass("standalone"), t = e.sb(), !t || t.th && "light" !== t.th || $("#gs .status_bar").addClass("light")) : ($("#gs .status_bar").removeClass("standalone"), $("#gs .status_bar").removeClass("light")), MB.isIOS9() && this.runnerUtil.deviceOrient() === e.orient()) ? (this.scale < 1 && (this.scale = 1), i = MB.COMPONENTS.status_bar.height, $("#app").css({
                position: "absolute",
                height: ($(window).height() + i) / this.scale,
                top: 0 - i / this.scale,
                bottom: 0
            })) : void 0
        },
        i.prototype.setupPG = function() {
            var e;
            return this.hammertime = new Hammer($("#app")[0], {
                touchAction: "auto"
            }),
            this.hammertime.get("swipe").set({
                direction: Hammer.DIRECTION_ALL,
                velocity: .05,
                threshold: 50
            }),
            this.hammertime.on("swipeleft",
            function(e) {
                return function(t) {
                    return setTimeout(function() {
                        return e.pj(t, "left")
                    })
                }
            } (this)),
            this.hammertime.on("swiperight",
            function(e) {
                return function(t) {
                    return setTimeout(function() {
                        return e.pj(t, "right")
                    })
                }
            } (this)),
            this.hammertime.on("swipeup",
            function(e) {
                return function(t) {
                    return setTimeout(function() {
                        return e.pj(t, "up")
                    })
                }
            } (this)),
            this.hammertime.on("swipedown",
            function(e) {
                return function(t) {
                    return setTimeout(function() {
                        return e.pj(t, "down")
                    })
                }
            } (this)),
            this.hammertime.on("press",
            function(e) {
                return function(t) {
                    return setTimeout(function() {
                        return e.pj(t, "hold")
                    })
                }
            } (this)),
            this.hammertime.on("tap",
            function(e) {
                return function(t) {
                    var i;
                    if (1 === t.tapCount) {
                        if (i = $(t.target).closest(".widget"), i.hasClass("switch")) return i.toggleClass("checked"),
                        void setTimeout(function() {
                            if (i.hasClass("clickable")) return e.pj(t, "tap")
                        },
                        250);
                        setTimeout(function() {
                            return e.pj(t, "tap")
                        })
                    }
                    if (2 === t.tapCount) return e.eventBucket.resetCoolDown(),
                    e.hightTimer && clearTimeout(e.hightTimer),
                    setTimeout(function() {
                        return e.pj(t, "dtap")
                    })
                }
            } (this)),
            e = new Shake({
                threshold: 15
            }),
            e.start(),
            window.addEventListener("shake",
            function(e) {
                return function(t) {
                    return setTimeout(function() {
                        return e.pj(t, "shake")
                    })
                }
            } (this), !1),
            $("#sticky-container").on("click", ".sticky",
            function(e) {
                return function(t) {
                    return e.pj(t, "tap")
                }
            } (this))
        },
        i.prototype.setupPageGesture = function(e) {
            var t, i, n, r, s, o;
            for (t = [], s = e.clinks(), i = 0, r = s.length; i < r; i++) n = s[i],
            "left" !== n.gesture && "right" !== n.gesture || t.indexOf("pan-y") === -1 && t.push("pan-y"),
            "up" !== n.gesture && "down" !== n.gesture || t.indexOf("pan-x") === -1 && t.push("pan-x");
            return o = t.length ? t.join(" ") : "auto",
            this.hammertime.touchAction.actions = o,
            $(".pcanvas.active .widgets").css("touch-action", o)
        },
        i.prototype.pageTimer = function(e) {
            return this.timeoutBucket.setTimeout(e.cid,
            function(t) {
                return function() {
                    if (!t.timerFired) return t.timerFired = !0,
                    t.j(e)
                }
            } (this), 1e3 * e.timer)
        },
        i.prototype.panelTimer = function(e, t) {
            if (Screen.find(e.target_cid)) return this.timeoutBucket.setTimeout(t.cid,
            function(i) {
                return function() {
                    if (!t.timerFired && !i.timerFired) return t.timerFired = !0,
                    t.lsave(!1),
                    i.panelWJ(e, $("#panel" + t.cid + "p")),
                    $("#panel" + t.cid + "pgh").length && i.panelWJ(e, $("#panel" + t.cid + "pgh")),
                    $("#panel" + t.cid + "pgf").length ? i.panelWJ(e, $("#panel" + t.cid + "pgf")) : void 0
                }
            } (this), 1e3 * e.timer)
        },
        i.prototype.setupPanelTimers = function(e, t) {
            var i, n, r, s, o, a, l, c, d;
            if (!MB.isPhantom() && (t || (i = $("#panel" + e.cid + "p .pstate.active").data("cid"), t = Screen.find(i)), t)) {
                for (this.timeoutBucket.clearTimeoutByKey(e.cid), e.timerFired = !1, e.lsave(!1), l = t.clinks(), n = 0, s = l.length; n < s; n++) a = l[n],
                a.timer > 0 && this.panelTimer(a, e);
                for (c = Link.findAllByAttribute("state_cid", t.cid), d = [], r = 0, o = c.length; r < o; r++) a = c[r],
                a.timer > 0 && d.push(this.pageTimer(a));
                return d
            }
        },
        i.prototype.setupPageTimers = function(e, t) {
            var i, n, r, s, o, a, l, c, d, u;
            if (null == t && (t = "default"), !MB.isPhantom()) {
                for (this.timeoutBucket.clear(), c = e.cwidgets(), n = 0, o = c.length; n < o; n++) i = c[n],
                t && i.setState(t, !1),
                s = Link.find(i.gid),
                s && s.timer > 0 && (!s.targetstate_cid || s.sourcestate_cid === t) && this.pageTimer(s);
                for (d = e.cpanels(), u = [], r = 0, a = d.length; r < a; r++) l = d[r],
                u.push(this.setupPanelTimers(l));
                return u
            }
        },
        i.prototype.setupBackground = function(e, t) {
            var i;
            if (i = "transparent" === t.bgcolor ? "#f0f0f2": t.bgcolor, $("#app").css({
                "background-color": i,
                "background-image": t.bgimage ? "url(" + t.getRealBgImage() + ")": ""
            }), $(".pcanvas.active .sheader, .pcanvas.active .sfooter").css("background-color", i), t.bgimage && $(".pcanvas.active .sheader").css("background-image", "url(" + t.getRealBgImage() + ")"), !e.hasClass("drawer")) return e.css({
                "background-image": "",
                "background-color": "transparent"
            })
        },
        i.prototype.renderScreen = function() {
            var e, t, i, n, r, s, o, a;
            for (a = "", r = this.project.cscreens(), e = 0, i = r.length; e < i; e++) o = r[e],
            a += this.runnerUtil.screenPreview(o);
            for ($("#app").append(a), s = this.project.cscreens(), t = 0, n = s.length; t < n; t++) o = s[t],
            o.cid !== this.home.cid && this.transitionUtil.hideScreen("#pscreen" + o.cid);
            return $("#pscreen" + this.home.cid).addClass("active"),
            this.renderWidgets(this.home)
        },
        i.prototype.renderWidgets = function(e) {
            var t, i, n, r, s, o, a, l, c, d, u, h, p, f, g, m, v, b, y;
            if (!$("#pscreen" + e.cid + " .widget").length) {
                for (m = new Date, e.setState("default", !0), f = e.citems(), a = 0, c = f.length; a < c; a++) o = f[a],
                o.setState("default", !0);
                for (p = document.getElementById("pscreen" + e.cid), t = p.getElementsByClassName("scontainer")[0], v = p.getElementsByClassName("stickies")[0], i = "", b = "", n = [], this.pages[e.cid] = {
                    sbHTML: ""
                },
                g = e.citems(), l = 0, d = g.length; l < d; l++) if (o = g[l], "panel" === o.name) o.valid() && (i += MB.PanelPreview(o));
                else {
                    if (y = o, "sticky" === y.name) {
                        MB.isMobile() || MB.isPhantom() || (n.push(y), b += MB.widget(y, "p"));
                        continue
                    }
                    s = "",
                    ("pg" !== y.name || /^l/.test(y.gid)) && ("pg" === y.name && (y.top = y.left = null), s = MB.widget(y, "p")),
                    "status_bar" === y.name && (p.className.indexOf("sb") === -1 && (p.className += " sb"), this.pages[e.cid].sbHTML = s),
                    i += s
                }
                for (t.innerHTML += i, v.innerHTML += b, t.style.height = e.h() + "px", h = 0, u = n.length; h < u; h++) y = n[h],
                WidgetManager.design(y, "p");
                return MB.isMobile() || (this.scrollSync.init($(".pcanvas.active .widgets")[0], $("#sticky-container")[0]), $("#pscreen" + e.cid + " .widgets").onScroll(this.scrollSync.delaySync), $("#pscreen" + e.cid + " .widgets").perfectScrollbar({
                    suppressScrollX: !0
                })),
                r = new Date,
                r - m > 500 ? MB.ga("send", "event", "performance", "render(" + (r - m) + ")(" + e.cid + ")(" + MB.project().model + ")(" + navigator.userAgent + ")") : void 0
            }
        },
        i.prototype.zoom = function(e) {
            var t, i;
            return t = r.indexOf(this.project.scale),
            i = t + e,
            this.project.scale = r[i],
            this.project.lsave(!1),
            $("body").data("scale", this.project.scale),
            $("a#zoomin").toggleClass("disabled", this.project.scale === r[r.length - 1]),
            $("a#zoomout").toggleClass("disabled", this.project.scale === r[0]),
            this.reload(!0)
        },
        i
    } (),
    this.DesignerRunner = function(e) {
        function t() {
            return t.__super__.constructor.apply(this, arguments)
        }
        return s(t, e),
        t.prototype.render = function(e, t) {
            return this.project = Project.find(e) || Template.find(e) || Combo.find(e),
            this.project ? ($("body").data("scale", this.project.scale), this.home = Screen.find(t), this.home.setState("default", !0), this.project.orientation = this.home.orientation, MB.renderSimulator(this.project, $("#preview")), this.init()) : MB.webpackInterface.navigateTo("/workspace/apps")
        },
        t
    } (i),
    this.SharingRunner = function(e) {
        function t(e) {
            this.project = e,
            t.__super__.constructor.apply(this, arguments),
            MB.isIOS() && this.disableRubberBand()
        }
        return s(t, e),
        t.prototype.disableRubberBand = function() {
            return document.body.ontouchstart = function(e) {
                return function(t) {
                    return e.touchStartY = t.touches[0].screenY
                }
            } (this),
            document.body.ontouchmove = function(e) {
                return function(t) {
                    var i;
                    if (!$(t.target).closest(".ppanel").length) return i = $(t.target).closest(".widgets")[0],
                    !i || t.touches[0].screenY > e.touchStartY && 0 === i.scrollTop || t.touches[0].screenY < e.touchStartY && i.scrollTop === i.scrollHeight - $(i).height() ? t.preventDefault() : void 0
                }
            } (this)
        },
        t.prototype.render = function() {
            return MB.currentScreen = this.home = this.project.homeScreen(),
            this.project.orientation = this.home.orientation,
            MB.isMobile() || MB.isEmbedded() ? (this.project.scale = 100, this.project.lsave(!1), $("body").data("scale", 100)) : $("body").data("scale", this.project.scale),
            MB.renderSimulator(this.project, $("#workspace")),
            setTimeout(function(e) {
                return function() {
                    return $("#workspace").show(),
                    $("a.design").hide(),
                    e.init()
                }
            } (this), 100)
        },
        t
    } (i)
}.call(this),
function() {
    var e;
    e = function() {
        function e(e) {
            if (this.opts = e, !this.opts.el) throw "MB.countdown: option el is required";
            this.el = $(this.opts.el),
            "function" == typeof this.opts.cb && (this.cb = this.opts.cb),
            this.originalText = this.el.text(),
            this.waitingID = null,
            this.el.data("countdown", this)
        }
        return e.prototype.opts = {
            el: null,
            hints: null
        },
        e.prototype.reset = function() {
            return this.waitingID && clearInterval(this.waitingID),
            this.waitingID = null,
            this.el.removeClass("disabled").text(this.originalText).removeProp("disabled"),
            this.cb && this.cb()
        },
        e.prototype.run = function(e) {
            var t;
            return null == e && (e = 60),
            t = function(t) {
                return function() {
                    return t.el.text(t.opts.hints ? t.opts.hints + " (" + (e -= 1) + "s)": (e -= 1) + "s")
                }
            } (this),
            this.el.addClass("disabled").prop("disabled"),
            t(),
            this.waitingID = setInterval(function(i) {
                return function() {
                    return e <= 1 ? i.reset() : t()
                }
            } (this), 1e3)
        },
        e.prototype.destroy = function() {
            return this.reset(),
            this.el.removeData("countdown")
        },
        e
    } (),
    MB.countdown = function(t) {
        return new e(t)
    }
}.call(this),
function() {
    MB.Notifier = function() {
        var e, t, i;
        return e = "neverAskForNotificationPermission",
        i = void 0,
        t = function() {
            var t;
            return i = Notifier(),
            t = function(t) {
                var i;
                return i = $("#notification"),
                i.translateY(70),
                i.find(".message").text(""),
                i.append('<span class="request_permission_message">\n  ' + I18N.notifications.request_permission + '\n  <ul>\n    <li><button class="request_permission">' + I18N.notifications.enable_notification + '</button>\n    <li><button class="ask_later">' + I18N.notifications.ask_later + '</button>\n    <li><button class="never_ask">' + I18N.notifications.never_ask_again + "</button>\n  </ul>\n</span>"),
                i.on("click", ".request_permission",
                function() {
                    return i.translateY(0),
                    t()
                }),
                i.on("click", ".never_ask",
                function() {
                    return i.translateY(0),
                    localStorage.setItem(e, !0)
                })
            },
            2 !== i.init() || localStorage.getItem(e) || t(i.requestPermission),
            i
        },
        {
            getNotifier: function() {
                return i || (i = t()),
                i
            }
        }
    } ()
}.call(this),
function() {
    this.Pusher = function() {
        function e() {
            var e, t, i, n;
            /modao.cc/.test(MBServer) ? (t = "zr0zakpglowydpzdfm9biewf3e1mv43ykz24ieu20vb8s3bl", i = "0qbkbb3sxie08vnnac8ns2bz86lu9m8oam4wlvynh3mu3n08", n = "cn") : (t = "mw2fpdz5dqyge9ag4u9oxj6bvmx6fs1m3zq6po8dy36zkl8v", i = "b3jezh7100lhusvjy7mzktticqzkrx7yj7y7j04lon7ct9c9", n = "us"),
            this.open = !1,
            this.subscribed = [],
            this.pusher = AV.push({
                appId: t,
                appKey: i,
                region: n
            });
            try {
                this.pusher.open(function(e) {
                    return function() {
                        return e.open = !0
                    }
                } (this)),
                this.pusher.subscribe([MB.user.channel],
                function() {
                    return console.log("\u8ba2\u9605\u6210\u529f\uff01")
                })
            } catch(e) {}
            this.pusher.on("close",
            function(e) {
                return function() {
                    return e.open = !1
                }
            } (this)),
            this.pusher.on("open",
            function(e) {
                return function() {
                    return e.open = !0,
                    e.onOpen && e.onOpen(),
                    e.onOpen = null
                }
            } (this)),
            this.pusher.on("message",
            function(e) {
                return function(t) {
                    return e.onReceive(t)
                }
            } (this)),
            this.pusher.on("error",
            function(e) {
                return function() {
                    return e.open = !1
                }
            } (this)),
            e = $("#notification"),
            e.on("click", ".close, .ask_later",
            function() {
                return e.find(".request_permission").remove(),
                e.translateY(0)
            })
        }
        return e.prototype.subscribe = function(e) {
            if (this.subscribed.indexOf(e) === -1) return this.subscribed.push(e)
        },
        e.prototype.onReceive = function(e) {
            var t, i, n;
            if (e._channel === MB.user.channel) switch (e.event) {
            case "notification":
                return MB.notifier && this.handleNotification(e);
            case "order":
                return this.handleOrder(e);
            case "collaboration":
                if ("Project" === e.t) return this.updateProject(e.action, e.object);
                if ("Team" === e.t) return this.updateTeam(e.action, e.object);
                if ("Collaborator" === e.t) return this.updateCollaborator(e.action, e.object);
                if (e.from.id === MB.user.id) return;
                switch (e.t) {
                case "Asset":
                    return this.updateAsset(e.action, e.object);
                case "PointComments::Thread":
                    return MB.webpackInterface && MB.webpackInterface.callViewMethod("comment", "pushData", "thread", e.action, e.object);
                case "PointComments::Comment":
                    return MB.webpackInterface && MB.webpackInterface.callViewMethod("comment", "pushData", "comment", e.action, e.object);
                default:
                    if (MB.pusher.subscribed.indexOf(e.to) === -1) return;
                    if (MB.f.inSharing) return;
                    switch (e.t) {
                    case "Widget":
                        this.updateWidget(e.action, e.object);
                        break;
                    case "Link":
                        this.updateLink(e.action, e.object);
                        break;
                    case "Screen":
                        this.updateScreen(e.action, e.object);
                        break;
                    case "Panel":
                        this.updatePanel(e.action, e.object, e.extras);
                        break;
                    case "Screenstate":
                        this.updateScreenstate(e.action, e.object);
                        break;
                    case "Widgetstate":
                        this.updateWidgetstate(e.action, e.object);
                        break;
                    case "Panelstate":
                        this.updatePanelstate(e.action, e.object)
                    }
                    if (i = "Screen" === e.t ? e.object.cid: e.object.screen_cid, !i && e.object.screenstate_cid && (n = Screenstate.find(e.object.screenstate_cid), n && (i = n.screen_cid)), !e.from.id) return;
                    return t = CoWorker.find(e.from.id),
                    t || (t = new CoWorker({
                        cid: e.from.id,
                        name: e.from.name,
                        avatar: e.from.avatar
                    })),
                    t.screen_cid = i,
                    t.last_seen = new Date,
                    t.save(),
                    MB.renderCoWorkers()
                }
            }
        },
        e.prototype.handleNotification = function(e) {
            var t, i;
            if (! (e._channel !== MB.user.channel || e._expired || "new_thread_comment" === e.event_type && MB.commentModeOn)) return i = {
                body: e.message
            },
            MB.isElectron() || (i.icon = "/images/mockingbot-logo80x80.png"),
            MB.notifier.notify(I18N.got_message, i, 1e4,
            function(t) {
                var i;
                return t.preventDefault(),
                i = window,
                i.focus(),
                MB.notification.markRead(e.id,
                function() {
                    return MB.notification.gotoDataUrl(e.url, i, e.need_reload, e.need_new_win)
                }),
                this.close()
            },
            void 0,
            function(t) {
                return function() {
                    return t.notifyFallback(e)
                }
            } (this)),
            t = $("#header .notifications-dropdown")[0],
            t ? (ReactDOM.unmountComponentAtNode(t), MB.renderNotifications(t)) : void 0
        },
        e.prototype.notifyFallback = function(e) {
            if ($("#notification").translateY(70), $("#notification .message").text(e.message), setTimeout(function() {
                return $("#notification").translateY(0)
            },
            1e4), e.url) return $("#notification .message").off("click"),
            $("#notification .message").on("click",
            function(t) {
                return t.preventDefault(),
                MB.notification.markRead(e.id,
                function() {
                    return MB.notification.gotoDataUrl(e.url, window, e.need_reload, e.need_new_win)
                })
            })
        },
        e.prototype.handleOrder = function(e) {
            return MB.trackOrder(e.order)
        },
        e.prototype.updateWidget = function(e, t) {
            var i, n, r;
            if (i = $("#screen").data("cid"), "update" === e) r = Widget.find(t.cid),
            r ? (r.refresh(t), i === r.screen_cid && (WidgetManager.update(r), MB.selection.select(MB.selection.groupedItems.items()), (n = Link.find(r.gid)) && (n.reload(), MB.renderLinks()))) : (r = new Widget, r.load(t), r.lsave(!1), i === r.screen_cid && ScreenManager.appendWidget(r));
            else if ("destroy" === e) {
                if (r = Widget.find(t.cid), !r) return;
                r.ldestroy(!1),
                i === r.screen_cid && ($("#widget" + r.cid).remove(), $("#design").trigger("slider:update"), MB.selection.reductItem(r.cid))
            }
            if (r && i === r.screen_cid) return MB.renderRightNav()
        },
        e.prototype.updatePanel = function(e, t, i) {
            var n, r, s;
            if (n = $("#screen").data("cid"), "update" === e) {
                if (s = Panel.find(t.cid), !s) return $.ajax({
                    type: "GET",
                    url: "/app/" + i.template_token + ".json",
                    success: function(e) {
                        if (Template.refresh([e.project]), Screen.refresh(e.screens), Widget.refresh(e.widgets), Link.refresh(e.links), MB.pusher.subscribe(e.project.cid), s = new Panel, s.load(t), s.lsave(!1), $(".mb-leftnav .tabs li:nth-child(2)").hasClass("active") && MB.renderLeftNav("templates"), n === s.screen_cid) return ScreenManager.appendPanel(s),
                        MB.renderLinks()
                    }
                });
                if (s.refresh(t), n === s.screen_cid) return PanelManager.design(s),
                MB.selection.select(MB.selection.groupedItems.items()),
                r = $("#panel" + s.cid + " .state.active").data("cid"),
                Link.select(function(e) {
                    if (e.cid === s.gid || e.state_cid === r) return e.reload()
                }),
                MB.renderLinks()
            } else if ("destroy" === e) {
                if (s = Panel.find(t.cid), !s) return;
                return n === s.screen_cid ? (PanelManager.remove(s.cid, !1), MB.selection.reductItem(s.cid)) : s.ldestroy(!1)
            }
        },
        e.prototype.updateLink = function(e, t) {
            var i, n;
            if (i = $("#screen").data("cid"), "update" === e) n = Link.find(t.cid),
            n ? n.refresh(t) : (n = new Link, n.load(t), n.lsave(!1));
            else if ("destroy" === e) {
                if (n = Link.find(t.cid), !n) return;
                n.ldestroy(!1)
            }
            if (n && i === n.screen_cid) return MB.renderLinks()
        },
        e.prototype.updateScreen = function(e, t) {
            var i, n;
            if (i = $("#screen").data("cid"), "update" === e) {
                if (n = Screen.find(t.cid)) {
                    if (n.refresh(t), MB.renderRightNav(), i !== n.cid) return;
                    return $("#screen").css("height", n.outerHeight() + "px"),
                    $("#screen").css("width", n.outerWidth() + "px"),
                    $("#design").trigger("slider:update"),
                    n.bgcolor ? ($(".sbgcolor").css("background-color", n.bgcolor), $("#canvas").css("background-color", n.bgcolor), $("#canvas").css("background-image", "")) : $("#canvas").css("background-image", "url(" + n.getRealBgImage() + ")")
                }
                if (n = new Screen, n.load(t), n.lsave(!1), MB.currentProject && MB.currentProject.cid === n.project_cid) return MB.renderRightNav()
            } else if ("destroy" === e) {
                if (n = Screen.find(t.cid), !n) return;
                if (n.ldestroy(!1), MB.currentProject && MB.currentProject.cid === n.project_cid) return ScreenManager.remove(n)
            }
        },
        e.prototype.updateProject = function(e, t) {
            var i, n, r;
            if (!MB.f.inSharing) return "update" === e && (i = Project.find(t.cid), i ? (n = i.screens_count, i.refresh(t), i.screens_count = n) : (i = new Project, i.load(t), i.screens_count || (i.screens_count = 2), i.lsave(!1)), MB.webpackInterface.refreshProject(), MB.webpackInterface.refreshTeam()),
            "destroy" === e && ((i = Project.find(t.cid)) ? MB.webpackInterface.deleteProjectByCid(i.cid) : (r = Template.find(t.cid)) && (r.ldestroy(!1), $(".mb-leftnav .tabs li:nth-child(2)").hasClass("active") && MB.renderLeftNav("templates"))),
            $(".timeago").timeago()
        },
        e.prototype.updateTeam = function(e, t) {
            var i;
            if (!MB.f.inSharing) return "update" === e && (i = Team.find(t.cid), i ? i.refresh(t) : (i = new Team, i.load(t), i.lsave(!1)), MB.webpackInterface.refreshProject(), MB.webpackInterface.refreshTeam()),
            "destroy" === e && (i = Team.find(t.cid)) ? MB.webpackInterface.deleteTeamByCid(i.cid) : void 0
        },
        e.prototype.updateCollaborator = function(e, t) {
            var i, n, r;
            if (!MB.f.inSharing && ("update" === e && (i = Collaborator.find(t.cid), i ? i.refresh(t) : (i = new Collaborator, i.load(t), i.lsave(!1)), i.updateHostChannel(e), MB.webpackInterface.refreshProject(), MB.webpackInterface.refreshTeam()), "destroy" === e)) {
                if (i = Collaborator.find(t.cid), !i) return;
                if (i.updateHostChannel(e), i.ldestroy(!1), i.user_id === MB.user.id && (i.project_cid && (n = Project.find(i.project_cid)), n && MB.webpackInterface.deleteProjectByCid(n.cid), i.team_cid && (r = Team.find(i.team_cid)), r)) return MB.webpackInterface.deleteTeamByCid(r.cid)
            }
        },
        e.prototype.updateScreenstate = function(e, t) {
            var i, n;
            if (i = MB.currentScreen, "update" === e) {
                if (n = Screenstate.find(t.cid), n ? n.refresh(t) : (n = new Screenstate, n.load(t), n.lsave(!1)), i && i.cid === n.screen_cid) return MB.renderRightNav()
            } else if ("destroy" === e) {
                if (n = Screenstate.find(t.cid), !n) return;
                if (n.ldestroy(!1), i && i.cid === n.screen_cid) return i.state_cid === n.cid && (ScreenManager.updateState(i, "default"), i.setState("default", !0)),
                MB.renderRightNav()
            }
        },
        e.prototype.updateWidgetstate = function(e, t) {
            var i, n, r, s;
            if (n = MB.currentScreen, "update" === e && (s = Widgetstate.find(t.cid), s ? s.refresh(t) : (s = new Widgetstate, s.load(t), s.lsave(!1)), n && n.state_cid === s.screenstate_cid && (r = Widget.find(s.widget_cid), r.screenstate_cid === s.screenstate_cid))) return r.restore(s),
            r.lsave(!1),
            (i = Link.find(r.gid)) && (i.reload(), MB.renderLinks()),
            WidgetManager.update(r),
            MB.selection.select(MB.selection.groupedItems.items())
        },
        e.prototype.updateAsset = function(e, t) {
            var i;
            if (!MB.f.inSharing) return "create" === e ? (i = new Asset, i.load(t), i.lsave(!1)) : void 0
        },
        e.prototype.updatePanelstate = function(e, t) {
            var i, n, r, s;
            if (s = MB.currentScreen, "update" === e && (r = Panelstate.find(t.cid), r ? r.refresh(t) : (r = new Panelstate, r.load(t), r.lsave(!1)), s && s.state_cid === r.screenstate_cid && (n = Panel.find(r.panel_cid), n.screenstate_cid === r.screenstate_cid))) return n.restore(r),
            n.lsave(!1),
            PanelManager.design(n),
            MB.selection.select(MB.selection.groupedItems.items()),
            i = $("#panel" + n.cid + " .state.active").data("cid"),
            Link.select(function(e) {
                if (e.cid === n.gid || e.state_cid === i) return e.reload()
            }),
            MB.renderLinks()
        },
        e
    } ()
}.call(this),
function() {
    var e = function(e, i) {
        function n() {
            this.constructor = e
        }
        for (var r in i) t.call(i, r) && (e[r] = i[r]);
        return n.prototype = i.prototype,
        e.prototype = new n,
        e.__super__ = i.prototype,
        e
    },
    t = {}.hasOwnProperty;
    this.WorkspaceController = function(t) {
        function i() {
            return i.__super__.constructor.apply(this, arguments)
        }
        return e(i, t),
        i.prototype.init = function() {
            var e;
            return $(".modal").on("shown.bs.modal",
            function() {
                return $(this).find("input[type=text],textarea").first().focus()
            }),
            e = MB.isMac() ? "mac": MB.isWindows ? "windows": "other-os",
            $("html").addClass(e),
            this.loadProjects()
        },
        i.prototype.loadProjects = function() {
            var e, t, i;
            return this.inited = !1,
            Asset.bind("refresh",
            function(e) {
                return function() {
                    if (!e.inited) return e.inited = !0,
                    clearInterval(e.interval),
                    $("#loading .indicator").css("height", "100%"),
                    Asset.unbind("refresh"),
                    setTimeout(function() {
                        return $("#loading").hide(),
                        e.initRoutes(),
                        e.setupReloadTimer(),
                        MB.notifier = MB.Notifier.getNotifier()
                    },
                    300)
                }
            } (this)),
            $("#loading .indicator").css("height", "40%"),
            e = 40,
            this.interval = setInterval(function() {
                if (e < 80) return e += 15,
                $("#loading .indicator").css("height", e + "%")
            },
            2e3),
            MB.supportedBrowser() ? (i = "/projects.json?" + (new Date).valueOf(), t = $.getJSON(i,
            function() {
                return function(e) {
                    return localStorage.email = e.user.email,
                    MB.DEVICES = e.devices,
                    MB.user = e.user,
                    MB.demos = e.demos,
                    MB.mpIdentify(),
                    MB.giIdentify(),
                    Preference.refresh(e.preference),
                    Project.refresh(e.projects),
                    Asset.refresh(e.assets),
                    Projectasset.refresh(e.projectassets),
                    Assettag.refresh(e.assettags),
                    Colorset.refresh(e.colorsets),
                    Collaborator.refresh(e.collaborators),
                    Team.refresh(e.teams),
                    (new Image).src = MB.staticMap(),
                    MB.webpackInterface && MB.webpackInterface.init(),
                    MB.user.login_times > 1 ? MB.mp("\u8fdb\u5165\u5de5\u4f5c\u533a") : (MB.mp("\u65b0\u7528\u6237\u6ce8\u518c"), MB.ga("send", "event", "user", "signup"), window.Intercom ? window.Intercom("boot", {
                        app_id: "eiurvray"
                    }) : void 0)
                }
            } (this)), t.fail(function(e) {
                return 403 === e.status ? window.location.pathname = "/signin": 500 === e.status ? window.location.href = "/500": void 0
            })) : ($("#loading").hide(), $("#workspace").hide())
        },
        i.prototype.setupReloadTimer = function() {
            var e;
            return setTimeout(function() {
                return MB.safeAlert(I18N.new_version_detected)
            },
            36e6),
            e = 1,
            MB.reportPerformance(0),
            setInterval(function() {
                return MB.reportPerformance(e),
                e += 1
            },
            36e5)
        },
        i.prototype.initRoutes = function() {
            return this.autoSaver = new AutoSaver,
            MB.pusher = new Pusher,
            $("#system-updates").length && !/posts/.test(location.hash) && setTimeout(function() {
                return $("#system-updates").modal(),
                $("#system-updates").on("hidden.bs.modal",
                function() {
                    return $("#updates-carousel").carousel("pause")
                })
            },
            1e3),
            /google/i.test(MB.user.coupon) && 1 === MB.user.login_times && !localStorage.google && (localStorage.google = "true", setTimeout(function() {
                return $("#google-coupon").modal()
            },
            2e3)),
            MB.designer = new Designer,
            MB.webpackInterface.refreshTeam(),
            MB.webpackInterface.refreshProject(),
            MB.webpackInterface.callViewMethod("listpage", "init"),
            MB.webpackInterface.callViewMethod("listpage", "start"),
            MB.webpackInterface.callViewMethod("listpage", "update")
        },
        i.prototype.cloneBuiltin = function(e, t, i) {
            var n;
            return n = "/app/" + e + "/duplicate.json",
            MB.safeLoading(I18N.load_project),
            $("#app-modal").modal("hide"),
            $.getJSON(n,
            function() {
                return function(e) {
                    var n;
                    if (e.project.combo) n = new Combo;
                    else {
                        if (!e.project.template) return;
                        n = new Template
                    }
                    return n.load(e.project),
                    t && (n.name = t, n.lsave()),
                    Screen.refresh(e.screens),
                    Widget.refresh(e.widgets),
                    Link.refresh(e.links),
                    Panel.refresh(e.panels),
                    ScreenAlign.refresh(e.screen_aligns),
                    $("#safemode").hide(),
                    i(n)
                }
            } (this))
        },
        i
    } (Spine.Controller),
    MB.checkFA(function() {
        return MB.workspace = new WorkspaceController
    })
}.call(this);